var El=Object.defineProperty,Tl=Object.defineProperties;var Ol=Object.getOwnPropertyDescriptors;var No=Object.getOwnPropertySymbols;var Il=Object.prototype.hasOwnProperty,Al=Object.prototype.propertyIsEnumerable;var Fo=(n,i,t)=>i in n?El(n,i,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[i]=t,Go=(n,i)=>{for(var t in i||(i={}))Il.call(i,t)&&Fo(n,t,i[t]);if(No)for(var t of No(i))Al.call(i,t)&&Fo(n,t,i[t]);return n},jo=(n,i)=>Tl(n,Ol(i));var Uo=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{};function Bl(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var Q={exports:{}};/* @preserve
 * Leaflet 1.7.1, a JS library for interactive maps. http://leafletjs.com
 * (c) 2010-2019 Vladimir Agafonkin, (c) 2010-2011 CloudMade
 */(function(n,i){(function(t,s){s(i)})(Uo,function(t){var s="1.7.1";function o(e){var a,f,m,b;for(f=1,m=arguments.length;f<m;f++){b=arguments[f];for(a in b)e[a]=b[a]}return e}var h=Object.create||function(){function e(){}return function(a){return e.prototype=a,new e}}();function c(e,a){var f=Array.prototype.slice;if(e.bind)return e.bind.apply(e,f.call(arguments,1));var m=f.call(arguments,2);return function(){return e.apply(a,m.length?m.concat(f.call(arguments)):arguments)}}var d=0;function y(e){return e._leaflet_id=e._leaflet_id||++d,e._leaflet_id}function _(e,a,f){var m,b,O,G;return G=function(){m=!1,b&&(O.apply(f,b),b=!1)},O=function(){m?b=arguments:(e.apply(f,arguments),setTimeout(G,a),m=!0)},O}function v(e,a,f){var m=a[1],b=a[0],O=m-b;return e===m&&f?e:((e-b)%O+O)%O+b}function x(){return!1}function w(e,a){var f=Math.pow(10,a===void 0?6:a);return Math.round(e*f)/f}function C(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}function A(e){return C(e).split(/\s+/)}function I(e,a){Object.prototype.hasOwnProperty.call(e,"options")||(e.options=e.options?h(e.options):{});for(var f in a)e.options[f]=a[f];return e.options}function R(e,a,f){var m=[];for(var b in e)m.push(encodeURIComponent(f?b.toUpperCase():b)+"="+encodeURIComponent(e[b]));return(!a||a.indexOf("?")===-1?"?":"&")+m.join("&")}var P=/\{ *([\w_-]+) *\}/g;function E(e,a){return e.replace(P,function(f,m){var b=a[m];if(b===void 0)throw new Error("No value provided for variable "+f);return typeof b=="function"&&(b=b(a)),b})}var z=Array.isArray||function(e){return Object.prototype.toString.call(e)==="[object Array]"};function j(e,a){for(var f=0;f<e.length;f++)if(e[f]===a)return f;return-1}var q="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=";function et(e){return window["webkit"+e]||window["moz"+e]||window["ms"+e]}var J=0;function ht(e){var a=+new Date,f=Math.max(0,16-(a-J));return J=a+f,window.setTimeout(e,f)}var lt=window.requestAnimationFrame||et("RequestAnimationFrame")||ht,dt=window.cancelAnimationFrame||et("CancelAnimationFrame")||et("CancelRequestAnimationFrame")||function(e){window.clearTimeout(e)};function gt(e,a,f){if(f&&lt===ht)e.call(a);else return lt.call(window,c(e,a))}function vt(e){e&&dt.call(window,e)}var At={extend:o,create:h,bind:c,lastId:d,stamp:y,throttle:_,wrapNum:v,falseFn:x,formatNum:w,trim:C,splitWords:A,setOptions:I,getParamString:R,template:E,isArray:z,indexOf:j,emptyImageUrl:q,requestFn:lt,cancelFn:dt,requestAnimFrame:gt,cancelAnimFrame:vt};function K(){}K.extend=function(e){var a=function(){this.initialize&&this.initialize.apply(this,arguments),this.callInitHooks()},f=a.__super__=this.prototype,m=h(f);m.constructor=a,a.prototype=m;for(var b in this)Object.prototype.hasOwnProperty.call(this,b)&&b!=="prototype"&&b!=="__super__"&&(a[b]=this[b]);return e.statics&&(o(a,e.statics),delete e.statics),e.includes&&(rt(e.includes),o.apply(null,[m].concat(e.includes)),delete e.includes),m.options&&(e.options=o(h(m.options),e.options)),o(m,e),m._initHooks=[],m.callInitHooks=function(){if(!this._initHooksCalled){f.callInitHooks&&f.callInitHooks.call(this),this._initHooksCalled=!0;for(var O=0,G=m._initHooks.length;O<G;O++)m._initHooks[O].call(this)}},a},K.include=function(e){return o(this.prototype,e),this},K.mergeOptions=function(e){return o(this.prototype.options,e),this},K.addInitHook=function(e){var a=Array.prototype.slice.call(arguments,1),f=typeof e=="function"?e:function(){this[e].apply(this,a)};return this.prototype._initHooks=this.prototype._initHooks||[],this.prototype._initHooks.push(f),this};function rt(e){if(!(typeof L=="undefined"||!L||!L.Mixin)){e=z(e)?e:[e];for(var a=0;a<e.length;a++)e[a]===L.Mixin.Events&&console.warn("Deprecated include of L.Mixin.Events: this property will be removed in future releases, please inherit from L.Evented instead.",new Error().stack)}}var ft={on:function(e,a,f){if(typeof e=="object")for(var m in e)this._on(m,e[m],a);else{e=A(e);for(var b=0,O=e.length;b<O;b++)this._on(e[b],a,f)}return this},off:function(e,a,f){if(!e)delete this._events;else if(typeof e=="object")for(var m in e)this._off(m,e[m],a);else{e=A(e);for(var b=0,O=e.length;b<O;b++)this._off(e[b],a,f)}return this},_on:function(e,a,f){this._events=this._events||{};var m=this._events[e];m||(m=[],this._events[e]=m),f===this&&(f=void 0);for(var b={fn:a,ctx:f},O=m,G=0,X=O.length;G<X;G++)if(O[G].fn===a&&O[G].ctx===f)return;O.push(b)},_off:function(e,a,f){var m,b,O;if(!!this._events&&(m=this._events[e],!!m)){if(!a){for(b=0,O=m.length;b<O;b++)m[b].fn=x;delete this._events[e];return}if(f===this&&(f=void 0),m)for(b=0,O=m.length;b<O;b++){var G=m[b];if(G.ctx===f&&G.fn===a){G.fn=x,this._firingCount&&(this._events[e]=m=m.slice()),m.splice(b,1);return}}}},fire:function(e,a,f){if(!this.listens(e,f))return this;var m=o({},a,{type:e,target:this,sourceTarget:a&&a.sourceTarget||this});if(this._events){var b=this._events[e];if(b){this._firingCount=this._firingCount+1||1;for(var O=0,G=b.length;O<G;O++){var X=b[O];X.fn.call(X.ctx||this,m)}this._firingCount--}}return f&&this._propagateEvent(m),this},listens:function(e,a){var f=this._events&&this._events[e];if(f&&f.length)return!0;if(a){for(var m in this._eventParents)if(this._eventParents[m].listens(e,a))return!0}return!1},once:function(e,a,f){if(typeof e=="object"){for(var m in e)this.once(m,e[m],a);return this}var b=c(function(){this.off(e,a,f).off(e,b,f)},this);return this.on(e,a,f).on(e,b,f)},addEventParent:function(e){return this._eventParents=this._eventParents||{},this._eventParents[y(e)]=e,this},removeEventParent:function(e){return this._eventParents&&delete this._eventParents[y(e)],this},_propagateEvent:function(e){for(var a in this._eventParents)this._eventParents[a].fire(e.type,o({layer:e.target,propagatedFrom:e.target},e),!0)}};ft.addEventListener=ft.on,ft.removeEventListener=ft.clearAllEventListeners=ft.off,ft.addOneTimeEventListener=ft.once,ft.fireEvent=ft.fire,ft.hasEventListeners=ft.listens;var zt=K.extend(ft);function ot(e,a,f){this.x=f?Math.round(e):e,this.y=f?Math.round(a):a}var It=Math.trunc||function(e){return e>0?Math.floor(e):Math.ceil(e)};ot.prototype={clone:function(){return new ot(this.x,this.y)},add:function(e){return this.clone()._add(kt(e))},_add:function(e){return this.x+=e.x,this.y+=e.y,this},subtract:function(e){return this.clone()._subtract(kt(e))},_subtract:function(e){return this.x-=e.x,this.y-=e.y,this},divideBy:function(e){return this.clone()._divideBy(e)},_divideBy:function(e){return this.x/=e,this.y/=e,this},multiplyBy:function(e){return this.clone()._multiplyBy(e)},_multiplyBy:function(e){return this.x*=e,this.y*=e,this},scaleBy:function(e){return new ot(this.x*e.x,this.y*e.y)},unscaleBy:function(e){return new ot(this.x/e.x,this.y/e.y)},round:function(){return this.clone()._round()},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},floor:function(){return this.clone()._floor()},_floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.clone()._ceil()},_ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},trunc:function(){return this.clone()._trunc()},_trunc:function(){return this.x=It(this.x),this.y=It(this.y),this},distanceTo:function(e){e=kt(e);var a=e.x-this.x,f=e.y-this.y;return Math.sqrt(a*a+f*f)},equals:function(e){return e=kt(e),e.x===this.x&&e.y===this.y},contains:function(e){return e=kt(e),Math.abs(e.x)<=Math.abs(this.x)&&Math.abs(e.y)<=Math.abs(this.y)},toString:function(){return"Point("+w(this.x)+", "+w(this.y)+")"}};function kt(e,a,f){return e instanceof ot?e:z(e)?new ot(e[0],e[1]):e==null?e:typeof e=="object"&&"x"in e&&"y"in e?new ot(e.x,e.y):new ot(e,a,f)}function Rt(e,a){if(!!e)for(var f=a?[e,a]:e,m=0,b=f.length;m<b;m++)this.extend(f[m])}Rt.prototype={extend:function(e){return e=kt(e),!this.min&&!this.max?(this.min=e.clone(),this.max=e.clone()):(this.min.x=Math.min(e.x,this.min.x),this.max.x=Math.max(e.x,this.max.x),this.min.y=Math.min(e.y,this.min.y),this.max.y=Math.max(e.y,this.max.y)),this},getCenter:function(e){return new ot((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,e)},getBottomLeft:function(){return new ot(this.min.x,this.max.y)},getTopRight:function(){return new ot(this.max.x,this.min.y)},getTopLeft:function(){return this.min},getBottomRight:function(){return this.max},getSize:function(){return this.max.subtract(this.min)},contains:function(e){var a,f;return typeof e[0]=="number"||e instanceof ot?e=kt(e):e=se(e),e instanceof Rt?(a=e.min,f=e.max):a=f=e,a.x>=this.min.x&&f.x<=this.max.x&&a.y>=this.min.y&&f.y<=this.max.y},intersects:function(e){e=se(e);var a=this.min,f=this.max,m=e.min,b=e.max,O=b.x>=a.x&&m.x<=f.x,G=b.y>=a.y&&m.y<=f.y;return O&&G},overlaps:function(e){e=se(e);var a=this.min,f=this.max,m=e.min,b=e.max,O=b.x>a.x&&m.x<f.x,G=b.y>a.y&&m.y<f.y;return O&&G},isValid:function(){return!!(this.min&&this.max)}};function se(e,a){return!e||e instanceof Rt?e:new Rt(e,a)}function Kt(e,a){if(!!e)for(var f=a?[e,a]:e,m=0,b=f.length;m<b;m++)this.extend(f[m])}Kt.prototype={extend:function(e){var a=this._southWest,f=this._northEast,m,b;if(e instanceof Bt)m=e,b=e;else if(e instanceof Kt){if(m=e._southWest,b=e._northEast,!m||!b)return this}else return e?this.extend(Ut(e)||$t(e)):this;return!a&&!f?(this._southWest=new Bt(m.lat,m.lng),this._northEast=new Bt(b.lat,b.lng)):(a.lat=Math.min(m.lat,a.lat),a.lng=Math.min(m.lng,a.lng),f.lat=Math.max(b.lat,f.lat),f.lng=Math.max(b.lng,f.lng)),this},pad:function(e){var a=this._southWest,f=this._northEast,m=Math.abs(a.lat-f.lat)*e,b=Math.abs(a.lng-f.lng)*e;return new Kt(new Bt(a.lat-m,a.lng-b),new Bt(f.lat+m,f.lng+b))},getCenter:function(){return new Bt((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new Bt(this.getNorth(),this.getWest())},getSouthEast:function(){return new Bt(this.getSouth(),this.getEast())},getWest:function(){return this._southWest.lng},getSouth:function(){return this._southWest.lat},getEast:function(){return this._northEast.lng},getNorth:function(){return this._northEast.lat},contains:function(e){typeof e[0]=="number"||e instanceof Bt||"lat"in e?e=Ut(e):e=$t(e);var a=this._southWest,f=this._northEast,m,b;return e instanceof Kt?(m=e.getSouthWest(),b=e.getNorthEast()):m=b=e,m.lat>=a.lat&&b.lat<=f.lat&&m.lng>=a.lng&&b.lng<=f.lng},intersects:function(e){e=$t(e);var a=this._southWest,f=this._northEast,m=e.getSouthWest(),b=e.getNorthEast(),O=b.lat>=a.lat&&m.lat<=f.lat,G=b.lng>=a.lng&&m.lng<=f.lng;return O&&G},overlaps:function(e){e=$t(e);var a=this._southWest,f=this._northEast,m=e.getSouthWest(),b=e.getNorthEast(),O=b.lat>a.lat&&m.lat<f.lat,G=b.lng>a.lng&&m.lng<f.lng;return O&&G},toBBoxString:function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join(",")},equals:function(e,a){return e?(e=$t(e),this._southWest.equals(e.getSouthWest(),a)&&this._northEast.equals(e.getNorthEast(),a)):!1},isValid:function(){return!!(this._southWest&&this._northEast)}};function $t(e,a){return e instanceof Kt?e:new Kt(e,a)}function Bt(e,a,f){if(isNaN(e)||isNaN(a))throw new Error("Invalid LatLng object: ("+e+", "+a+")");this.lat=+e,this.lng=+a,f!==void 0&&(this.alt=+f)}Bt.prototype={equals:function(e,a){if(!e)return!1;e=Ut(e);var f=Math.max(Math.abs(this.lat-e.lat),Math.abs(this.lng-e.lng));return f<=(a===void 0?1e-9:a)},toString:function(e){return"LatLng("+w(this.lat,e)+", "+w(this.lng,e)+")"},distanceTo:function(e){return _e.distance(this,Ut(e))},wrap:function(){return _e.wrapLatLng(this)},toBounds:function(e){var a=180*e/40075017,f=a/Math.cos(Math.PI/180*this.lat);return $t([this.lat-a,this.lng-f],[this.lat+a,this.lng+f])},clone:function(){return new Bt(this.lat,this.lng,this.alt)}};function Ut(e,a,f){return e instanceof Bt?e:z(e)&&typeof e[0]!="object"?e.length===3?new Bt(e[0],e[1],e[2]):e.length===2?new Bt(e[0],e[1]):null:e==null?e:typeof e=="object"&&"lat"in e?new Bt(e.lat,"lng"in e?e.lng:e.lon,e.alt):a===void 0?null:new Bt(e,a,f)}var ge={latLngToPoint:function(e,a){var f=this.projection.project(e),m=this.scale(a);return this.transformation._transform(f,m)},pointToLatLng:function(e,a){var f=this.scale(a),m=this.transformation.untransform(e,f);return this.projection.unproject(m)},project:function(e){return this.projection.project(e)},unproject:function(e){return this.projection.unproject(e)},scale:function(e){return 256*Math.pow(2,e)},zoom:function(e){return Math.log(e/256)/Math.LN2},getProjectedBounds:function(e){if(this.infinite)return null;var a=this.projection.bounds,f=this.scale(e),m=this.transformation.transform(a.min,f),b=this.transformation.transform(a.max,f);return new Rt(m,b)},infinite:!1,wrapLatLng:function(e){var a=this.wrapLng?v(e.lng,this.wrapLng,!0):e.lng,f=this.wrapLat?v(e.lat,this.wrapLat,!0):e.lat,m=e.alt;return new Bt(f,a,m)},wrapLatLngBounds:function(e){var a=e.getCenter(),f=this.wrapLatLng(a),m=a.lat-f.lat,b=a.lng-f.lng;if(m===0&&b===0)return e;var O=e.getSouthWest(),G=e.getNorthEast(),X=new Bt(O.lat-m,O.lng-b),W=new Bt(G.lat-m,G.lng-b);return new Kt(X,W)}},_e=o({},ge,{wrapLng:[-180,180],R:6371e3,distance:function(e,a){var f=Math.PI/180,m=e.lat*f,b=a.lat*f,O=Math.sin((a.lat-e.lat)*f/2),G=Math.sin((a.lng-e.lng)*f/2),X=O*O+Math.cos(m)*Math.cos(b)*G*G,W=2*Math.atan2(Math.sqrt(X),Math.sqrt(1-X));return this.R*W}}),Ve=6378137,ue={R:Ve,MAX_LATITUDE:85.0511287798,project:function(e){var a=Math.PI/180,f=this.MAX_LATITUDE,m=Math.max(Math.min(f,e.lat),-f),b=Math.sin(m*a);return new ot(this.R*e.lng*a,this.R*Math.log((1+b)/(1-b))/2)},unproject:function(e){var a=180/Math.PI;return new Bt((2*Math.atan(Math.exp(e.y/this.R))-Math.PI/2)*a,e.x*a/this.R)},bounds:function(){var e=Ve*Math.PI;return new Rt([-e,-e],[e,e])}()};function $(e,a,f,m){if(z(e)){this._a=e[0],this._b=e[1],this._c=e[2],this._d=e[3];return}this._a=e,this._b=a,this._c=f,this._d=m}$.prototype={transform:function(e,a){return this._transform(e.clone(),a)},_transform:function(e,a){return a=a||1,e.x=a*(this._a*e.x+this._b),e.y=a*(this._c*e.y+this._d),e},untransform:function(e,a){return a=a||1,new ot((e.x/a-this._b)/this._a,(e.y/a-this._d)/this._c)}};function k(e,a,f,m){return new $(e,a,f,m)}var T=o({},_e,{code:"EPSG:3857",projection:ue,transformation:function(){var e=.5/(Math.PI*ue.R);return k(e,.5,-e,.5)}()}),F=o({},T,{code:"EPSG:900913"});function U(e){return document.createElementNS("http://www.w3.org/2000/svg",e)}function Z(e,a){var f="",m,b,O,G,X,W;for(m=0,O=e.length;m<O;m++){for(X=e[m],b=0,G=X.length;b<G;b++)W=X[b],f+=(b?"L":"M")+W.x+" "+W.y;f+=a?ln?"z":"x":""}return f||"M0 0"}var it=document.documentElement.style,st="ActiveXObject"in window,nt=st&&!document.addEventListener,bt="msLaunchUri"in navigator&&!("documentMode"in document),Mt=he("webkit"),St=he("android"),Pt=he("android 2")||he("android 3"),Jt=parseInt(/WebKit\/([0-9]+)|$/.exec(navigator.userAgent)[1],10),Et=St&&he("Google")&&Jt<537&&!("AudioNode"in window),Dt=!!window.opera,Vt=!bt&&he("chrome"),Ht=he("gecko")&&!Mt&&!Dt&&!st,Xt=!Vt&&he("safari"),ee=he("phantom"),oe="OTransition"in it,Se=navigator.platform.indexOf("Win")===0,Ce=st&&"transition"in it,pe="WebKitCSSMatrix"in window&&"m11"in new window.WebKitCSSMatrix&&!Pt,ce="MozPerspective"in it,Wt=!window.L_DISABLE_3D&&(Ce||pe||ce)&&!oe&&!ee,fe=typeof orientation!="undefined"||he("mobile"),fi=fe&&Mt,He=fe&&pe,ye=!window.PointerEvent&&window.MSPointerEvent,we=!!(window.PointerEvent||ye),Ee=!window.L_NO_TOUCH&&(we||"ontouchstart"in window||window.DocumentTouch&&document instanceof window.DocumentTouch),Fi=fe&&Dt,ki=fe&&Ht,$e=(window.devicePixelRatio||window.screen.deviceXDPI/window.screen.logicalXDPI)>1,me=function(){var e=!1;try{var a=Object.defineProperty({},"passive",{get:function(){e=!0}});window.addEventListener("testPassiveEventSupport",x,a),window.removeEventListener("testPassiveEventSupport",x,a)}catch{}return e}(),di=function(){return!!document.createElement("canvas").getContext}(),ln=!!(document.createElementNS&&U("svg").createSVGRect),Mi=!ln&&function(){try{var e=document.createElement("div");e.innerHTML='<v:shape adj="1"/>';var a=e.firstChild;return a.style.behavior="url(#default#VML)",a&&typeof a.adj=="object"}catch{return!1}}();function he(e){return navigator.userAgent.toLowerCase().indexOf(e)>=0}var Gi={ie:st,ielt9:nt,edge:bt,webkit:Mt,android:St,android23:Pt,androidStock:Et,opera:Dt,chrome:Vt,gecko:Ht,safari:Xt,phantom:ee,opera12:oe,win:Se,ie3d:Ce,webkit3d:pe,gecko3d:ce,any3d:Wt,mobile:fe,mobileWebkit:fi,mobileWebkit3d:He,msPointer:ye,pointer:we,touch:Ee,mobileOpera:Fi,mobileGecko:ki,retina:$e,passiveEvents:me,canvas:di,svg:ln,vml:Mi},hn=ye?"MSPointerDown":"pointerdown",un=ye?"MSPointerMove":"pointermove",cn=ye?"MSPointerUp":"pointerup",ji=ye?"MSPointerCancel":"pointercancel",Re={},kr=!1;function Mr(e,a,f,m){return a==="touchstart"?Nn(e,f,m):a==="touchmove"?_s(e,f,m):a==="touchend"&&Sr(e,f,m),this}function zn(e,a,f){var m=e["_leaflet_"+a+f];return a==="touchstart"?e.removeEventListener(hn,m,!1):a==="touchmove"?e.removeEventListener(un,m,!1):a==="touchend"&&(e.removeEventListener(cn,m,!1),e.removeEventListener(ji,m,!1)),this}function Nn(e,a,f){var m=c(function(b){b.MSPOINTER_TYPE_TOUCH&&b.pointerType===b.MSPOINTER_TYPE_TOUCH&&be(b),Pi(b,a)});e["_leaflet_touchstart"+f]=m,e.addEventListener(hn,m,!1),kr||(document.addEventListener(hn,Fn,!0),document.addEventListener(un,gs,!0),document.addEventListener(cn,Pr,!0),document.addEventListener(ji,Pr,!0),kr=!0)}function Fn(e){Re[e.pointerId]=e}function gs(e){Re[e.pointerId]&&(Re[e.pointerId]=e)}function Pr(e){delete Re[e.pointerId]}function Pi(e,a){e.touches=[];for(var f in Re)e.touches.push(Re[f]);e.changedTouches=[e],a(e)}function _s(e,a,f){var m=function(b){b.pointerType===(b.MSPOINTER_TYPE_MOUSE||"mouse")&&b.buttons===0||Pi(b,a)};e["_leaflet_touchmove"+f]=m,e.addEventListener(un,m,!1)}function Sr(e,a,f){var m=function(b){Pi(b,a)};e["_leaflet_touchend"+f]=m,e.addEventListener(cn,m,!1),e.addEventListener(ji,m,!1)}var Ue=ye?"MSPointerDown":we?"pointerdown":"touchstart",fn=ye?"MSPointerUp":we?"pointerup":"touchend",Si="_leaflet_";function ys(e,a,f){var m,b,O=!1,G=250;function X(at){if(we){if(!at.isPrimary||at.pointerType==="mouse")return}else if(at.touches.length>1)return;var pt=Date.now(),wt=pt-(m||pt);b=at.touches?at.touches[0]:at,O=wt>0&&wt<=G,m=pt}function W(at){if(O&&!b.cancelBubble){if(we){if(at.pointerType==="mouse")return;var pt={},wt,Zt;for(Zt in b)wt=b[Zt],pt[Zt]=wt&&wt.bind?wt.bind(b):wt;b=pt}b.type="dblclick",b.button=0,a(b),m=null}}return e[Si+Ue+f]=X,e[Si+fn+f]=W,e[Si+"dblclick"+f]=a,e.addEventListener(Ue,X,me?{passive:!1}:!1),e.addEventListener(fn,W,me?{passive:!1}:!1),e.addEventListener("dblclick",a,!1),this}function Cr(e,a){var f=e[Si+Ue+a],m=e[Si+fn+a],b=e[Si+"dblclick"+a];return e.removeEventListener(Ue,f,me?{passive:!1}:!1),e.removeEventListener(fn,m,me?{passive:!1}:!1),e.removeEventListener("dblclick",b,!1),this}var Gn=Ui(["transform","webkitTransform","OTransform","MozTransform","msTransform"]),pi=Ui(["webkitTransition","transition","OTransition","MozTransition","msTransition"]),Ke=pi==="webkitTransition"||pi==="OTransition"?pi+"End":"transitionend";function jn(e){return typeof e=="string"?document.getElementById(e):e}function mi(e,a){var f=e.style[a]||e.currentStyle&&e.currentStyle[a];if((!f||f==="auto")&&document.defaultView){var m=document.defaultView.getComputedStyle(e,null);f=m?m[a]:null}return f==="auto"?null:f}function Nt(e,a,f){var m=document.createElement(e);return m.className=a||"",f&&f.appendChild(m),m}function Qt(e){var a=e.parentNode;a&&a.removeChild(e)}function dn(e){for(;e.firstChild;)e.removeChild(e.firstChild)}function Xe(e){var a=e.parentNode;a&&a.lastChild!==e&&a.appendChild(e)}function Ci(e){var a=e.parentNode;a&&a.firstChild!==e&&a.insertBefore(e,a.firstChild)}function pn(e,a){if(e.classList!==void 0)return e.classList.contains(a);var f=mn(e);return f.length>0&&new RegExp("(^|\\s)"+a+"(\\s|$)").test(f)}function Ct(e,a){if(e.classList!==void 0)for(var f=A(a),m=0,b=f.length;m<b;m++)e.classList.add(f[m]);else if(!pn(e,a)){var O=mn(e);Un(e,(O?O+" ":"")+a)}}function ie(e,a){e.classList!==void 0?e.classList.remove(a):Un(e,C((" "+mn(e)+" ").replace(" "+a+" "," ")))}function Un(e,a){e.className.baseVal===void 0?e.className=a:e.className.baseVal=a}function mn(e){return e.correspondingElement&&(e=e.correspondingElement),e.className.baseVal===void 0?e.className:e.className.baseVal}function Te(e,a){"opacity"in e.style?e.style.opacity=a:"filter"in e.style&&vs(e,a)}function vs(e,a){var f=!1,m="DXImageTransform.Microsoft.Alpha";try{f=e.filters.item(m)}catch{if(a===1)return}a=Math.round(a*100),f?(f.Enabled=a!==100,f.Opacity=a):e.style.filter+=" progid:"+m+"(opacity="+a+")"}function Ui(e){for(var a=document.documentElement.style,f=0;f<e.length;f++)if(e[f]in a)return e[f];return!1}function Ye(e,a,f){var m=a||new ot(0,0);e.style[Gn]=(Ce?"translate("+m.x+"px,"+m.y+"px)":"translate3d("+m.x+"px,"+m.y+"px,0)")+(f?" scale("+f+")":"")}function ne(e,a){e._leaflet_pos=a,Wt?Ye(e,a):(e.style.left=a.x+"px",e.style.top=a.y+"px")}function Je(e){return e._leaflet_pos||new ot(0,0)}var Zi,qi,gn;if("onselectstart"in document)Zi=function(){Tt(window,"selectstart",be)},qi=function(){te(window,"selectstart",be)};else{var We=Ui(["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"]);Zi=function(){if(We){var e=document.documentElement.style;gn=e[We],e[We]="none"}},qi=function(){We&&(document.documentElement.style[We]=gn,gn=void 0)}}function Zn(){Tt(window,"dragstart",be)}function qn(){te(window,"dragstart",be)}var gi,Vn;function ei(e){for(;e.tabIndex===-1;)e=e.parentNode;!e.style||(ii(),gi=e,Vn=e.style.outline,e.style.outline="none",Tt(window,"keydown",ii))}function ii(){!gi||(gi.style.outline=Vn,gi=void 0,Vn=void 0,te(window,"keydown",ii))}function Ei(e){do e=e.parentNode;while((!e.offsetWidth||!e.offsetHeight)&&e!==document.body);return e}function _n(e){var a=e.getBoundingClientRect();return{x:a.width/e.offsetWidth||1,y:a.height/e.offsetHeight||1,boundingClientRect:a}}var Er={TRANSFORM:Gn,TRANSITION:pi,TRANSITION_END:Ke,get:jn,getStyle:mi,create:Nt,remove:Qt,empty:dn,toFront:Xe,toBack:Ci,hasClass:pn,addClass:Ct,removeClass:ie,setClass:Un,getClass:mn,setOpacity:Te,testProp:Ui,setTransform:Ye,setPosition:ne,getPosition:Je,disableTextSelection:Zi,enableTextSelection:qi,disableImageDrag:Zn,enableImageDrag:qn,preventOutline:ei,restoreOutline:ii,getSizedParentNode:Ei,getScale:_n};function Tt(e,a,f,m){if(typeof a=="object")for(var b in a)Hi(e,b,a[b],f);else{a=A(a);for(var O=0,G=a.length;O<G;O++)Hi(e,a[O],f,m)}return this}var ve="_leaflet_events";function te(e,a,f,m){if(typeof a=="object")for(var b in a)Oe(e,b,a[b],f);else if(a){a=A(a);for(var O=0,G=a.length;O<G;O++)Oe(e,a[O],f,m)}else{for(var X in e[ve])Oe(e,X,e[ve][X]);delete e[ve]}return this}function Vi(){if(we)return!(bt||Xt)}var ni={mouseenter:"mouseover",mouseleave:"mouseout",wheel:!("onwheel"in window)&&"mousewheel"};function Hi(e,a,f,m){var b=a+y(f)+(m?"_"+y(m):"");if(e[ve]&&e[ve][b])return this;var O=function(X){return f.call(m||e,X||window.event)},G=O;we&&a.indexOf("touch")===0?Mr(e,a,O,b):Ee&&a==="dblclick"&&!Vi()?ys(e,O,b):"addEventListener"in e?a==="touchstart"||a==="touchmove"||a==="wheel"||a==="mousewheel"?e.addEventListener(ni[a]||a,O,me?{passive:!1}:!1):a==="mouseenter"||a==="mouseleave"?(O=function(X){X=X||window.event,Ki(e,X)&&G(X)},e.addEventListener(ni[a],O,!1)):e.addEventListener(a,G,!1):"attachEvent"in e&&e.attachEvent("on"+a,O),e[ve]=e[ve]||{},e[ve][b]=O}function Oe(e,a,f,m){var b=a+y(f)+(m?"_"+y(m):""),O=e[ve]&&e[ve][b];if(!O)return this;we&&a.indexOf("touch")===0?zn(e,a,b):Ee&&a==="dblclick"&&!Vi()?Cr(e,b):"removeEventListener"in e?e.removeEventListener(ni[a]||a,O,!1):"detachEvent"in e&&e.detachEvent("on"+a,O),e[ve][b]=null}function Ie(e){return e.stopPropagation?e.stopPropagation():e.originalEvent?e.originalEvent._stopped=!0:e.cancelBubble=!0,$n(e),this}function Ti(e){return Hi(e,"wheel",Ie),this}function _i(e){return Tt(e,"mousedown touchstart dblclick",Ie),Hi(e,"click",$i),this}function be(e){return e.preventDefault?e.preventDefault():e.returnValue=!1,this}function ke(e){return be(e),Ie(e),this}function yn(e,a){if(!a)return new ot(e.clientX,e.clientY);var f=_n(a),m=f.boundingClientRect;return new ot((e.clientX-m.left)/f.x-a.clientLeft,(e.clientY-m.top)/f.y-a.clientTop)}var Tr=Se&&Vt?2*window.devicePixelRatio:Ht?window.devicePixelRatio:1;function Hn(e){return bt?e.wheelDeltaY/2:e.deltaY&&e.deltaMode===0?-e.deltaY/Tr:e.deltaY&&e.deltaMode===1?-e.deltaY*20:e.deltaY&&e.deltaMode===2?-e.deltaY*60:e.deltaX||e.deltaZ?0:e.wheelDelta?(e.wheelDeltaY||e.wheelDelta)/2:e.detail&&Math.abs(e.detail)<32765?-e.detail*20:e.detail?e.detail/-32765*60:0}var vn={};function $i(e){vn[e.type]=!0}function $n(e){var a=vn[e.type];return vn[e.type]=!1,a}function Ki(e,a){var f=a.relatedTarget;if(!f)return!0;try{for(;f&&f!==e;)f=f.parentNode}catch{return!1}return f!==e}var Kn={on:Tt,off:te,stopPropagation:Ie,disableScrollPropagation:Ti,disableClickPropagation:_i,preventDefault:be,stop:ke,getMousePosition:yn,getWheelDelta:Hn,fakeStop:$i,skipped:$n,isExternalTarget:Ki,addListener:Tt,removeListener:te},bn=zt.extend({run:function(e,a,f,m){this.stop(),this._el=e,this._inProgress=!0,this._duration=f||.25,this._easeOutPower=1/Math.max(m||.5,.2),this._startPos=Je(e),this._offset=a.subtract(this._startPos),this._startTime=+new Date,this.fire("start"),this._animate()},stop:function(){!this._inProgress||(this._step(!0),this._complete())},_animate:function(){this._animId=gt(this._animate,this),this._step()},_step:function(e){var a=+new Date-this._startTime,f=this._duration*1e3;a<f?this._runFrame(this._easeOut(a/f),e):(this._runFrame(1),this._complete())},_runFrame:function(e,a){var f=this._startPos.add(this._offset.multiplyBy(e));a&&f._round(),ne(this._el,f),this.fire("step")},_complete:function(){vt(this._animId),this._inProgress=!1,this.fire("end")},_easeOut:function(e){return 1-Math.pow(1-e,this._easeOutPower)}}),Ft=zt.extend({options:{crs:T,center:void 0,zoom:void 0,minZoom:void 0,maxZoom:void 0,layers:[],maxBounds:void 0,renderer:void 0,zoomAnimation:!0,zoomAnimationThreshold:4,fadeAnimation:!0,markerZoomAnimation:!0,transform3DLimit:8388608,zoomSnap:1,zoomDelta:1,trackResize:!0},initialize:function(e,a){a=I(this,a),this._handlers=[],this._layers={},this._zoomBoundLayers={},this._sizeChanged=!0,this._initContainer(e),this._initLayout(),this._onResize=c(this._onResize,this),this._initEvents(),a.maxBounds&&this.setMaxBounds(a.maxBounds),a.zoom!==void 0&&(this._zoom=this._limitZoom(a.zoom)),a.center&&a.zoom!==void 0&&this.setView(Ut(a.center),a.zoom,{reset:!0}),this.callInitHooks(),this._zoomAnimated=pi&&Wt&&!Fi&&this.options.zoomAnimation,this._zoomAnimated&&(this._createAnimProxy(),Tt(this._proxy,Ke,this._catchTransitionEnd,this)),this._addLayers(this.options.layers)},setView:function(e,a,f){if(a=a===void 0?this._zoom:this._limitZoom(a),e=this._limitCenter(Ut(e),a,this.options.maxBounds),f=f||{},this._stop(),this._loaded&&!f.reset&&f!==!0){f.animate!==void 0&&(f.zoom=o({animate:f.animate},f.zoom),f.pan=o({animate:f.animate,duration:f.duration},f.pan));var m=this._zoom!==a?this._tryAnimatedZoom&&this._tryAnimatedZoom(e,a,f.zoom):this._tryAnimatedPan(e,f.pan);if(m)return clearTimeout(this._sizeTimer),this}return this._resetView(e,a),this},setZoom:function(e,a){return this._loaded?this.setView(this.getCenter(),e,{zoom:a}):(this._zoom=e,this)},zoomIn:function(e,a){return e=e||(Wt?this.options.zoomDelta:1),this.setZoom(this._zoom+e,a)},zoomOut:function(e,a){return e=e||(Wt?this.options.zoomDelta:1),this.setZoom(this._zoom-e,a)},setZoomAround:function(e,a,f){var m=this.getZoomScale(a),b=this.getSize().divideBy(2),O=e instanceof ot?e:this.latLngToContainerPoint(e),G=O.subtract(b).multiplyBy(1-1/m),X=this.containerPointToLatLng(b.add(G));return this.setView(X,a,{zoom:f})},_getBoundsCenterZoom:function(e,a){a=a||{},e=e.getBounds?e.getBounds():$t(e);var f=kt(a.paddingTopLeft||a.padding||[0,0]),m=kt(a.paddingBottomRight||a.padding||[0,0]),b=this.getBoundsZoom(e,!1,f.add(m));if(b=typeof a.maxZoom=="number"?Math.min(a.maxZoom,b):b,b===1/0)return{center:e.getCenter(),zoom:b};var O=m.subtract(f).divideBy(2),G=this.project(e.getSouthWest(),b),X=this.project(e.getNorthEast(),b),W=this.unproject(G.add(X).divideBy(2).add(O),b);return{center:W,zoom:b}},fitBounds:function(e,a){if(e=$t(e),!e.isValid())throw new Error("Bounds are not valid.");var f=this._getBoundsCenterZoom(e,a);return this.setView(f.center,f.zoom,a)},fitWorld:function(e){return this.fitBounds([[-90,-180],[90,180]],e)},panTo:function(e,a){return this.setView(e,this._zoom,{pan:a})},panBy:function(e,a){if(e=kt(e).round(),a=a||{},!e.x&&!e.y)return this.fire("moveend");if(a.animate!==!0&&!this.getSize().contains(e))return this._resetView(this.unproject(this.project(this.getCenter()).add(e)),this.getZoom()),this;if(this._panAnim||(this._panAnim=new bn,this._panAnim.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},this)),a.noMoveStart||this.fire("movestart"),a.animate!==!1){Ct(this._mapPane,"leaflet-pan-anim");var f=this._getMapPanePos().subtract(e).round();this._panAnim.run(this._mapPane,f,a.duration||.25,a.easeLinearity)}else this._rawPanBy(e),this.fire("move").fire("moveend");return this},flyTo:function(e,a,f){if(f=f||{},f.animate===!1||!Wt)return this.setView(e,a,f);this._stop();var m=this.project(this.getCenter()),b=this.project(e),O=this.getSize(),G=this._zoom;e=Ut(e),a=a===void 0?G:a;var X=Math.max(O.x,O.y),W=X*this.getZoomScale(G,a),at=b.distanceTo(m)||1,pt=1.42,wt=pt*pt;function Zt(ae){var Gr=ae?-1:1,Ml=ae?W:X,Pl=W*W-X*X+Gr*wt*wt*at*at,Sl=2*Ml*wt*at,Cs=Pl/Sl,zo=Math.sqrt(Cs*Cs+1)-Cs,Cl=zo<1e-9?-18:Math.log(zo);return Cl}function Li(ae){return(Math.exp(ae)-Math.exp(-ae))/2}function Ji(ae){return(Math.exp(ae)+Math.exp(-ae))/2}function Fr(ae){return Li(ae)/Ji(ae)}var Di=Zt(0);function Ss(ae){return X*(Ji(Di)/Ji(Di+pt*ae))}function xl(ae){return X*(Ji(Di)*Fr(Di+pt*ae)-Li(Di))/wt}function Ll(ae){return 1-Math.pow(1-ae,1.5)}var wl=Date.now(),Do=(Zt(1)-Di)/pt,kl=f.duration?1e3*f.duration:1e3*Do*.8;function Ro(){var ae=(Date.now()-wl)/kl,Gr=Ll(ae)*Do;ae<=1?(this._flyToFrame=gt(Ro,this),this._move(this.unproject(m.add(b.subtract(m).multiplyBy(xl(Gr)/at)),G),this.getScaleZoom(X/Ss(Gr),G),{flyTo:!0})):this._move(e,a)._moveEnd(!0)}return this._moveStart(!0,f.noMoveStart),Ro.call(this),this},flyToBounds:function(e,a){var f=this._getBoundsCenterZoom(e,a);return this.flyTo(f.center,f.zoom,a)},setMaxBounds:function(e){if(e=$t(e),e.isValid())this.options.maxBounds&&this.off("moveend",this._panInsideMaxBounds);else return this.options.maxBounds=null,this.off("moveend",this._panInsideMaxBounds);return this.options.maxBounds=e,this._loaded&&this._panInsideMaxBounds(),this.on("moveend",this._panInsideMaxBounds)},setMinZoom:function(e){var a=this.options.minZoom;return this.options.minZoom=e,this._loaded&&a!==e&&(this.fire("zoomlevelschange"),this.getZoom()<this.options.minZoom)?this.setZoom(e):this},setMaxZoom:function(e){var a=this.options.maxZoom;return this.options.maxZoom=e,this._loaded&&a!==e&&(this.fire("zoomlevelschange"),this.getZoom()>this.options.maxZoom)?this.setZoom(e):this},panInsideBounds:function(e,a){this._enforcingBounds=!0;var f=this.getCenter(),m=this._limitCenter(f,this._zoom,$t(e));return f.equals(m)||this.panTo(m,a),this._enforcingBounds=!1,this},panInside:function(e,a){a=a||{};var f=kt(a.paddingTopLeft||a.padding||[0,0]),m=kt(a.paddingBottomRight||a.padding||[0,0]),b=this.getCenter(),O=this.project(b),G=this.project(e),X=this.getPixelBounds(),W=X.getSize().divideBy(2),at=se([X.min.add(f),X.max.subtract(m)]);if(!at.contains(G)){this._enforcingBounds=!0;var pt=O.subtract(G),wt=kt(G.x+pt.x,G.y+pt.y);(G.x<at.min.x||G.x>at.max.x)&&(wt.x=O.x-pt.x,pt.x>0?wt.x+=W.x-f.x:wt.x-=W.x-m.x),(G.y<at.min.y||G.y>at.max.y)&&(wt.y=O.y-pt.y,pt.y>0?wt.y+=W.y-f.y:wt.y-=W.y-m.y),this.panTo(this.unproject(wt),a),this._enforcingBounds=!1}return this},invalidateSize:function(e){if(!this._loaded)return this;e=o({animate:!1,pan:!0},e===!0?{animate:!0}:e);var a=this.getSize();this._sizeChanged=!0,this._lastCenter=null;var f=this.getSize(),m=a.divideBy(2).round(),b=f.divideBy(2).round(),O=m.subtract(b);return!O.x&&!O.y?this:(e.animate&&e.pan?this.panBy(O):(e.pan&&this._rawPanBy(O),this.fire("move"),e.debounceMoveend?(clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(c(this.fire,this,"moveend"),200)):this.fire("moveend")),this.fire("resize",{oldSize:a,newSize:f}))},stop:function(){return this.setZoom(this._limitZoom(this._zoom)),this.options.zoomSnap||this.fire("viewreset"),this._stop()},locate:function(e){if(e=this._locateOptions=o({timeout:1e4,watch:!1},e),!("geolocation"in navigator))return this._handleGeolocationError({code:0,message:"Geolocation not supported."}),this;var a=c(this._handleGeolocationResponse,this),f=c(this._handleGeolocationError,this);return e.watch?this._locationWatchId=navigator.geolocation.watchPosition(a,f,e):navigator.geolocation.getCurrentPosition(a,f,e),this},stopLocate:function(){return navigator.geolocation&&navigator.geolocation.clearWatch&&navigator.geolocation.clearWatch(this._locationWatchId),this._locateOptions&&(this._locateOptions.setView=!1),this},_handleGeolocationError:function(e){var a=e.code,f=e.message||(a===1?"permission denied":a===2?"position unavailable":"timeout");this._locateOptions.setView&&!this._loaded&&this.fitWorld(),this.fire("locationerror",{code:a,message:"Geolocation error: "+f+"."})},_handleGeolocationResponse:function(e){var a=e.coords.latitude,f=e.coords.longitude,m=new Bt(a,f),b=m.toBounds(e.coords.accuracy*2),O=this._locateOptions;if(O.setView){var G=this.getBoundsZoom(b);this.setView(m,O.maxZoom?Math.min(G,O.maxZoom):G)}var X={latlng:m,bounds:b,timestamp:e.timestamp};for(var W in e.coords)typeof e.coords[W]=="number"&&(X[W]=e.coords[W]);this.fire("locationfound",X)},addHandler:function(e,a){if(!a)return this;var f=this[e]=new a(this);return this._handlers.push(f),this.options[e]&&f.enable(),this},remove:function(){if(this._initEvents(!0),this.off("moveend",this._panInsideMaxBounds),this._containerId!==this._container._leaflet_id)throw new Error("Map container is being reused by another instance");try{delete this._container._leaflet_id,delete this._containerId}catch{this._container._leaflet_id=void 0,this._containerId=void 0}this._locationWatchId!==void 0&&this.stopLocate(),this._stop(),Qt(this._mapPane),this._clearControlPos&&this._clearControlPos(),this._resizeRequest&&(vt(this._resizeRequest),this._resizeRequest=null),this._clearHandlers(),this._loaded&&this.fire("unload");var e;for(e in this._layers)this._layers[e].remove();for(e in this._panes)Qt(this._panes[e]);return this._layers=[],this._panes=[],delete this._mapPane,delete this._renderer,this},createPane:function(e,a){var f="leaflet-pane"+(e?" leaflet-"+e.replace("Pane","")+"-pane":""),m=Nt("div",f,a||this._mapPane);return e&&(this._panes[e]=m),m},getCenter:function(){return this._checkIfLoaded(),this._lastCenter&&!this._moved()?this._lastCenter:this.layerPointToLatLng(this._getCenterLayerPoint())},getZoom:function(){return this._zoom},getBounds:function(){var e=this.getPixelBounds(),a=this.unproject(e.getBottomLeft()),f=this.unproject(e.getTopRight());return new Kt(a,f)},getMinZoom:function(){return this.options.minZoom===void 0?this._layersMinZoom||0:this.options.minZoom},getMaxZoom:function(){return this.options.maxZoom===void 0?this._layersMaxZoom===void 0?1/0:this._layersMaxZoom:this.options.maxZoom},getBoundsZoom:function(e,a,f){e=$t(e),f=kt(f||[0,0]);var m=this.getZoom()||0,b=this.getMinZoom(),O=this.getMaxZoom(),G=e.getNorthWest(),X=e.getSouthEast(),W=this.getSize().subtract(f),at=se(this.project(X,m),this.project(G,m)).getSize(),pt=Wt?this.options.zoomSnap:1,wt=W.x/at.x,Zt=W.y/at.y,Li=a?Math.max(wt,Zt):Math.min(wt,Zt);return m=this.getScaleZoom(Li,m),pt&&(m=Math.round(m/(pt/100))*(pt/100),m=a?Math.ceil(m/pt)*pt:Math.floor(m/pt)*pt),Math.max(b,Math.min(O,m))},getSize:function(){return(!this._size||this._sizeChanged)&&(this._size=new ot(this._container.clientWidth||0,this._container.clientHeight||0),this._sizeChanged=!1),this._size.clone()},getPixelBounds:function(e,a){var f=this._getTopLeftPoint(e,a);return new Rt(f,f.add(this.getSize()))},getPixelOrigin:function(){return this._checkIfLoaded(),this._pixelOrigin},getPixelWorldBounds:function(e){return this.options.crs.getProjectedBounds(e===void 0?this.getZoom():e)},getPane:function(e){return typeof e=="string"?this._panes[e]:e},getPanes:function(){return this._panes},getContainer:function(){return this._container},getZoomScale:function(e,a){var f=this.options.crs;return a=a===void 0?this._zoom:a,f.scale(e)/f.scale(a)},getScaleZoom:function(e,a){var f=this.options.crs;a=a===void 0?this._zoom:a;var m=f.zoom(e*f.scale(a));return isNaN(m)?1/0:m},project:function(e,a){return a=a===void 0?this._zoom:a,this.options.crs.latLngToPoint(Ut(e),a)},unproject:function(e,a){return a=a===void 0?this._zoom:a,this.options.crs.pointToLatLng(kt(e),a)},layerPointToLatLng:function(e){var a=kt(e).add(this.getPixelOrigin());return this.unproject(a)},latLngToLayerPoint:function(e){var a=this.project(Ut(e))._round();return a._subtract(this.getPixelOrigin())},wrapLatLng:function(e){return this.options.crs.wrapLatLng(Ut(e))},wrapLatLngBounds:function(e){return this.options.crs.wrapLatLngBounds($t(e))},distance:function(e,a){return this.options.crs.distance(Ut(e),Ut(a))},containerPointToLayerPoint:function(e){return kt(e).subtract(this._getMapPanePos())},layerPointToContainerPoint:function(e){return kt(e).add(this._getMapPanePos())},containerPointToLatLng:function(e){var a=this.containerPointToLayerPoint(kt(e));return this.layerPointToLatLng(a)},latLngToContainerPoint:function(e){return this.layerPointToContainerPoint(this.latLngToLayerPoint(Ut(e)))},mouseEventToContainerPoint:function(e){return yn(e,this._container)},mouseEventToLayerPoint:function(e){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(e))},mouseEventToLatLng:function(e){return this.layerPointToLatLng(this.mouseEventToLayerPoint(e))},_initContainer:function(e){var a=this._container=jn(e);if(a){if(a._leaflet_id)throw new Error("Map container is already initialized.")}else throw new Error("Map container not found.");Tt(a,"scroll",this._onScroll,this),this._containerId=y(a)},_initLayout:function(){var e=this._container;this._fadeAnimated=this.options.fadeAnimation&&Wt,Ct(e,"leaflet-container"+(Ee?" leaflet-touch":"")+($e?" leaflet-retina":"")+(nt?" leaflet-oldie":"")+(Xt?" leaflet-safari":"")+(this._fadeAnimated?" leaflet-fade-anim":""));var a=mi(e,"position");a!=="absolute"&&a!=="relative"&&a!=="fixed"&&(e.style.position="relative"),this._initPanes(),this._initControlPos&&this._initControlPos()},_initPanes:function(){var e=this._panes={};this._paneRenderers={},this._mapPane=this.createPane("mapPane",this._container),ne(this._mapPane,new ot(0,0)),this.createPane("tilePane"),this.createPane("shadowPane"),this.createPane("overlayPane"),this.createPane("markerPane"),this.createPane("tooltipPane"),this.createPane("popupPane"),this.options.markerZoomAnimation||(Ct(e.markerPane,"leaflet-zoom-hide"),Ct(e.shadowPane,"leaflet-zoom-hide"))},_resetView:function(e,a){ne(this._mapPane,new ot(0,0));var f=!this._loaded;this._loaded=!0,a=this._limitZoom(a),this.fire("viewprereset");var m=this._zoom!==a;this._moveStart(m,!1)._move(e,a)._moveEnd(m),this.fire("viewreset"),f&&this.fire("load")},_moveStart:function(e,a){return e&&this.fire("zoomstart"),a||this.fire("movestart"),this},_move:function(e,a,f){a===void 0&&(a=this._zoom);var m=this._zoom!==a;return this._zoom=a,this._lastCenter=e,this._pixelOrigin=this._getNewPixelOrigin(e),(m||f&&f.pinch)&&this.fire("zoom",f),this.fire("move",f)},_moveEnd:function(e){return e&&this.fire("zoomend"),this.fire("moveend")},_stop:function(){return vt(this._flyToFrame),this._panAnim&&this._panAnim.stop(),this},_rawPanBy:function(e){ne(this._mapPane,this._getMapPanePos().subtract(e))},_getZoomSpan:function(){return this.getMaxZoom()-this.getMinZoom()},_panInsideMaxBounds:function(){this._enforcingBounds||this.panInsideBounds(this.options.maxBounds)},_checkIfLoaded:function(){if(!this._loaded)throw new Error("Set map center and zoom first.")},_initEvents:function(e){this._targets={},this._targets[y(this._container)]=this;var a=e?te:Tt;a(this._container,"click dblclick mousedown mouseup mouseover mouseout mousemove contextmenu keypress keydown keyup",this._handleDOMEvent,this),this.options.trackResize&&a(window,"resize",this._onResize,this),Wt&&this.options.transform3DLimit&&(e?this.off:this.on).call(this,"moveend",this._onMoveEnd)},_onResize:function(){vt(this._resizeRequest),this._resizeRequest=gt(function(){this.invalidateSize({debounceMoveend:!0})},this)},_onScroll:function(){this._container.scrollTop=0,this._container.scrollLeft=0},_onMoveEnd:function(){var e=this._getMapPanePos();Math.max(Math.abs(e.x),Math.abs(e.y))>=this.options.transform3DLimit&&this._resetView(this.getCenter(),this.getZoom())},_findEventTargets:function(e,a){for(var f=[],m,b=a==="mouseout"||a==="mouseover",O=e.target||e.srcElement,G=!1;O;){if(m=this._targets[y(O)],m&&(a==="click"||a==="preclick")&&!e._simulated&&this._draggableMoved(m)){G=!0;break}if(m&&m.listens(a,!0)&&(b&&!Ki(O,e)||(f.push(m),b))||O===this._container)break;O=O.parentNode}return!f.length&&!G&&!b&&Ki(O,e)&&(f=[this]),f},_handleDOMEvent:function(e){if(!(!this._loaded||$n(e))){var a=e.type;(a==="mousedown"||a==="keypress"||a==="keyup"||a==="keydown")&&ei(e.target||e.srcElement),this._fireDOMEvent(e,a)}},_mouseEvents:["click","dblclick","mouseover","mouseout","contextmenu"],_fireDOMEvent:function(e,a,f){if(e.type==="click"){var m=o({},e);m.type="preclick",this._fireDOMEvent(m,m.type,f)}if(!e._stopped&&(f=(f||[]).concat(this._findEventTargets(e,a)),!!f.length)){var b=f[0];a==="contextmenu"&&b.listens(a,!0)&&be(e);var O={originalEvent:e};if(e.type!=="keypress"&&e.type!=="keydown"&&e.type!=="keyup"){var G=b.getLatLng&&(!b._radius||b._radius<=10);O.containerPoint=G?this.latLngToContainerPoint(b.getLatLng()):this.mouseEventToContainerPoint(e),O.layerPoint=this.containerPointToLayerPoint(O.containerPoint),O.latlng=G?b.getLatLng():this.layerPointToLatLng(O.layerPoint)}for(var X=0;X<f.length;X++)if(f[X].fire(a,O,!0),O.originalEvent._stopped||f[X].options.bubblingMouseEvents===!1&&j(this._mouseEvents,a)!==-1)return}},_draggableMoved:function(e){return e=e.dragging&&e.dragging.enabled()?e:this,e.dragging&&e.dragging.moved()||this.boxZoom&&this.boxZoom.moved()},_clearHandlers:function(){for(var e=0,a=this._handlers.length;e<a;e++)this._handlers[e].disable()},whenReady:function(e,a){return this._loaded?e.call(a||this,{target:this}):this.on("load",e,a),this},_getMapPanePos:function(){return Je(this._mapPane)||new ot(0,0)},_moved:function(){var e=this._getMapPanePos();return e&&!e.equals([0,0])},_getTopLeftPoint:function(e,a){var f=e&&a!==void 0?this._getNewPixelOrigin(e,a):this.getPixelOrigin();return f.subtract(this._getMapPanePos())},_getNewPixelOrigin:function(e,a){var f=this.getSize()._divideBy(2);return this.project(e,a)._subtract(f)._add(this._getMapPanePos())._round()},_latLngToNewLayerPoint:function(e,a,f){var m=this._getNewPixelOrigin(f,a);return this.project(e,a)._subtract(m)},_latLngBoundsToNewLayerBounds:function(e,a,f){var m=this._getNewPixelOrigin(f,a);return se([this.project(e.getSouthWest(),a)._subtract(m),this.project(e.getNorthWest(),a)._subtract(m),this.project(e.getSouthEast(),a)._subtract(m),this.project(e.getNorthEast(),a)._subtract(m)])},_getCenterLayerPoint:function(){return this.containerPointToLayerPoint(this.getSize()._divideBy(2))},_getCenterOffset:function(e){return this.latLngToLayerPoint(e).subtract(this._getCenterLayerPoint())},_limitCenter:function(e,a,f){if(!f)return e;var m=this.project(e,a),b=this.getSize().divideBy(2),O=new Rt(m.subtract(b),m.add(b)),G=this._getBoundsOffset(O,f,a);return G.round().equals([0,0])?e:this.unproject(m.add(G),a)},_limitOffset:function(e,a){if(!a)return e;var f=this.getPixelBounds(),m=new Rt(f.min.add(e),f.max.add(e));return e.add(this._getBoundsOffset(m,a))},_getBoundsOffset:function(e,a,f){var m=se(this.project(a.getNorthEast(),f),this.project(a.getSouthWest(),f)),b=m.min.subtract(e.min),O=m.max.subtract(e.max),G=this._rebound(b.x,-O.x),X=this._rebound(b.y,-O.y);return new ot(G,X)},_rebound:function(e,a){return e+a>0?Math.round(e-a)/2:Math.max(0,Math.ceil(e))-Math.max(0,Math.floor(a))},_limitZoom:function(e){var a=this.getMinZoom(),f=this.getMaxZoom(),m=Wt?this.options.zoomSnap:1;return m&&(e=Math.round(e/m)*m),Math.max(a,Math.min(f,e))},_onPanTransitionStep:function(){this.fire("move")},_onPanTransitionEnd:function(){ie(this._mapPane,"leaflet-pan-anim"),this.fire("moveend")},_tryAnimatedPan:function(e,a){var f=this._getCenterOffset(e)._trunc();return(a&&a.animate)!==!0&&!this.getSize().contains(f)?!1:(this.panBy(f,a),!0)},_createAnimProxy:function(){var e=this._proxy=Nt("div","leaflet-proxy leaflet-zoom-animated");this._panes.mapPane.appendChild(e),this.on("zoomanim",function(a){var f=Gn,m=this._proxy.style[f];Ye(this._proxy,this.project(a.center,a.zoom),this.getZoomScale(a.zoom,1)),m===this._proxy.style[f]&&this._animatingZoom&&this._onZoomTransitionEnd()},this),this.on("load moveend",this._animMoveEnd,this),this._on("unload",this._destroyAnimProxy,this)},_destroyAnimProxy:function(){Qt(this._proxy),this.off("load moveend",this._animMoveEnd,this),delete this._proxy},_animMoveEnd:function(){var e=this.getCenter(),a=this.getZoom();Ye(this._proxy,this.project(e,a),this.getZoomScale(a,1))},_catchTransitionEnd:function(e){this._animatingZoom&&e.propertyName.indexOf("transform")>=0&&this._onZoomTransitionEnd()},_nothingToAnimate:function(){return!this._container.getElementsByClassName("leaflet-zoom-animated").length},_tryAnimatedZoom:function(e,a,f){if(this._animatingZoom)return!0;if(f=f||{},!this._zoomAnimated||f.animate===!1||this._nothingToAnimate()||Math.abs(a-this._zoom)>this.options.zoomAnimationThreshold)return!1;var m=this.getZoomScale(a),b=this._getCenterOffset(e)._divideBy(1-1/m);return f.animate!==!0&&!this.getSize().contains(b)?!1:(gt(function(){this._moveStart(!0,!1)._animateZoom(e,a,!0)},this),!0)},_animateZoom:function(e,a,f,m){!this._mapPane||(f&&(this._animatingZoom=!0,this._animateToCenter=e,this._animateToZoom=a,Ct(this._mapPane,"leaflet-zoom-anim")),this.fire("zoomanim",{center:e,zoom:a,noUpdate:m}),setTimeout(c(this._onZoomTransitionEnd,this),250))},_onZoomTransitionEnd:function(){!this._animatingZoom||(this._mapPane&&ie(this._mapPane,"leaflet-zoom-anim"),this._animatingZoom=!1,this._move(this._animateToCenter,this._animateToZoom),gt(function(){this._moveEnd(!0)},this))}});function Oi(e,a){return new Ft(e,a)}var Ae=K.extend({options:{position:"topright"},initialize:function(e){I(this,e)},getPosition:function(){return this.options.position},setPosition:function(e){var a=this._map;return a&&a.removeControl(this),this.options.position=e,a&&a.addControl(this),this},getContainer:function(){return this._container},addTo:function(e){this.remove(),this._map=e;var a=this._container=this.onAdd(e),f=this.getPosition(),m=e._controlCorners[f];return Ct(a,"leaflet-control"),f.indexOf("bottom")!==-1?m.insertBefore(a,m.firstChild):m.appendChild(a),this._map.on("unload",this.remove,this),this},remove:function(){return this._map?(Qt(this._container),this.onRemove&&this.onRemove(this._map),this._map.off("unload",this.remove,this),this._map=null,this):this},_refocusOnMap:function(e){this._map&&e&&e.screenX>0&&e.screenY>0&&this._map.getContainer().focus()}}),Ii=function(e){return new Ae(e)};Ft.include({addControl:function(e){return e.addTo(this),this},removeControl:function(e){return e.remove(),this},_initControlPos:function(){var e=this._controlCorners={},a="leaflet-",f=this._controlContainer=Nt("div",a+"control-container",this._container);function m(b,O){var G=a+b+" "+a+O;e[b+O]=Nt("div",G,f)}m("top","left"),m("top","right"),m("bottom","left"),m("bottom","right")},_clearControlPos:function(){for(var e in this._controlCorners)Qt(this._controlCorners[e]);Qt(this._controlContainer),delete this._controlCorners,delete this._controlContainer}});var Or=Ae.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0,hideSingleBase:!1,sortLayers:!1,sortFunction:function(e,a,f,m){return f<m?-1:m<f?1:0}},initialize:function(e,a,f){I(this,f),this._layerControlInputs=[],this._layers=[],this._lastZIndex=0,this._handlingClick=!1;for(var m in e)this._addLayer(e[m],m);for(m in a)this._addLayer(a[m],m,!0)},onAdd:function(e){this._initLayout(),this._update(),this._map=e,e.on("zoomend",this._checkDisabledLayers,this);for(var a=0;a<this._layers.length;a++)this._layers[a].layer.on("add remove",this._onLayerChange,this);return this._container},addTo:function(e){return Ae.prototype.addTo.call(this,e),this._expandIfNotCollapsed()},onRemove:function(){this._map.off("zoomend",this._checkDisabledLayers,this);for(var e=0;e<this._layers.length;e++)this._layers[e].layer.off("add remove",this._onLayerChange,this)},addBaseLayer:function(e,a){return this._addLayer(e,a),this._map?this._update():this},addOverlay:function(e,a){return this._addLayer(e,a,!0),this._map?this._update():this},removeLayer:function(e){e.off("add remove",this._onLayerChange,this);var a=this._getLayer(y(e));return a&&this._layers.splice(this._layers.indexOf(a),1),this._map?this._update():this},expand:function(){Ct(this._container,"leaflet-control-layers-expanded"),this._section.style.height=null;var e=this._map.getSize().y-(this._container.offsetTop+50);return e<this._section.clientHeight?(Ct(this._section,"leaflet-control-layers-scrollbar"),this._section.style.height=e+"px"):ie(this._section,"leaflet-control-layers-scrollbar"),this._checkDisabledLayers(),this},collapse:function(){return ie(this._container,"leaflet-control-layers-expanded"),this},_initLayout:function(){var e="leaflet-control-layers",a=this._container=Nt("div",e),f=this.options.collapsed;a.setAttribute("aria-haspopup",!0),_i(a),Ti(a);var m=this._section=Nt("section",e+"-list");f&&(this._map.on("click",this.collapse,this),St||Tt(a,{mouseenter:this.expand,mouseleave:this.collapse},this));var b=this._layersLink=Nt("a",e+"-toggle",a);b.href="#",b.title="Layers",Ee?(Tt(b,"click",ke),Tt(b,"click",this.expand,this)):Tt(b,"focus",this.expand,this),f||this.expand(),this._baseLayersList=Nt("div",e+"-base",m),this._separator=Nt("div",e+"-separator",m),this._overlaysList=Nt("div",e+"-overlays",m),a.appendChild(m)},_getLayer:function(e){for(var a=0;a<this._layers.length;a++)if(this._layers[a]&&y(this._layers[a].layer)===e)return this._layers[a]},_addLayer:function(e,a,f){this._map&&e.on("add remove",this._onLayerChange,this),this._layers.push({layer:e,name:a,overlay:f}),this.options.sortLayers&&this._layers.sort(c(function(m,b){return this.options.sortFunction(m.layer,b.layer,m.name,b.name)},this)),this.options.autoZIndex&&e.setZIndex&&(this._lastZIndex++,e.setZIndex(this._lastZIndex)),this._expandIfNotCollapsed()},_update:function(){if(!this._container)return this;dn(this._baseLayersList),dn(this._overlaysList),this._layerControlInputs=[];var e,a,f,m,b=0;for(f=0;f<this._layers.length;f++)m=this._layers[f],this._addItem(m),a=a||m.overlay,e=e||!m.overlay,b+=m.overlay?0:1;return this.options.hideSingleBase&&(e=e&&b>1,this._baseLayersList.style.display=e?"":"none"),this._separator.style.display=a&&e?"":"none",this},_onLayerChange:function(e){this._handlingClick||this._update();var a=this._getLayer(y(e.target)),f=a.overlay?e.type==="add"?"overlayadd":"overlayremove":e.type==="add"?"baselayerchange":null;f&&this._map.fire(f,a)},_createRadioElement:function(e,a){var f='<input type="radio" class="leaflet-control-layers-selector" name="'+e+'"'+(a?' checked="checked"':"")+"/>",m=document.createElement("div");return m.innerHTML=f,m.firstChild},_addItem:function(e){var a=document.createElement("label"),f=this._map.hasLayer(e.layer),m;e.overlay?(m=document.createElement("input"),m.type="checkbox",m.className="leaflet-control-layers-selector",m.defaultChecked=f):m=this._createRadioElement("leaflet-base-layers_"+y(this),f),this._layerControlInputs.push(m),m.layerId=y(e.layer),Tt(m,"click",this._onInputClick,this);var b=document.createElement("span");b.innerHTML=" "+e.name;var O=document.createElement("div");a.appendChild(O),O.appendChild(m),O.appendChild(b);var G=e.overlay?this._overlaysList:this._baseLayersList;return G.appendChild(a),this._checkDisabledLayers(),a},_onInputClick:function(){var e=this._layerControlInputs,a,f,m=[],b=[];this._handlingClick=!0;for(var O=e.length-1;O>=0;O--)a=e[O],f=this._getLayer(a.layerId).layer,a.checked?m.push(f):a.checked||b.push(f);for(O=0;O<b.length;O++)this._map.hasLayer(b[O])&&this._map.removeLayer(b[O]);for(O=0;O<m.length;O++)this._map.hasLayer(m[O])||this._map.addLayer(m[O]);this._handlingClick=!1,this._refocusOnMap()},_checkDisabledLayers:function(){for(var e=this._layerControlInputs,a,f,m=this._map.getZoom(),b=e.length-1;b>=0;b--)a=e[b],f=this._getLayer(a.layerId).layer,a.disabled=f.options.minZoom!==void 0&&m<f.options.minZoom||f.options.maxZoom!==void 0&&m>f.options.maxZoom},_expandIfNotCollapsed:function(){return this._map&&!this.options.collapsed&&this.expand(),this},_expand:function(){return this.expand()},_collapse:function(){return this.collapse()}}),bs=function(e,a,f){return new Or(e,a,f)},xn=Ae.extend({options:{position:"topleft",zoomInText:"+",zoomInTitle:"Zoom in",zoomOutText:"&#x2212;",zoomOutTitle:"Zoom out"},onAdd:function(e){var a="leaflet-control-zoom",f=Nt("div",a+" leaflet-bar"),m=this.options;return this._zoomInButton=this._createButton(m.zoomInText,m.zoomInTitle,a+"-in",f,this._zoomIn),this._zoomOutButton=this._createButton(m.zoomOutText,m.zoomOutTitle,a+"-out",f,this._zoomOut),this._updateDisabled(),e.on("zoomend zoomlevelschange",this._updateDisabled,this),f},onRemove:function(e){e.off("zoomend zoomlevelschange",this._updateDisabled,this)},disable:function(){return this._disabled=!0,this._updateDisabled(),this},enable:function(){return this._disabled=!1,this._updateDisabled(),this},_zoomIn:function(e){!this._disabled&&this._map._zoom<this._map.getMaxZoom()&&this._map.zoomIn(this._map.options.zoomDelta*(e.shiftKey?3:1))},_zoomOut:function(e){!this._disabled&&this._map._zoom>this._map.getMinZoom()&&this._map.zoomOut(this._map.options.zoomDelta*(e.shiftKey?3:1))},_createButton:function(e,a,f,m,b){var O=Nt("a",f,m);return O.innerHTML=e,O.href="#",O.title=a,O.setAttribute("role","button"),O.setAttribute("aria-label",a),_i(O),Tt(O,"click",ke),Tt(O,"click",b,this),Tt(O,"click",this._refocusOnMap,this),O},_updateDisabled:function(){var e=this._map,a="leaflet-disabled";ie(this._zoomInButton,a),ie(this._zoomOutButton,a),(this._disabled||e._zoom===e.getMinZoom())&&Ct(this._zoomOutButton,a),(this._disabled||e._zoom===e.getMaxZoom())&&Ct(this._zoomInButton,a)}});Ft.mergeOptions({zoomControl:!0}),Ft.addInitHook(function(){this.options.zoomControl&&(this.zoomControl=new xn,this.addControl(this.zoomControl))});var Xn=function(e){return new xn(e)},Yn=Ae.extend({options:{position:"bottomleft",maxWidth:100,metric:!0,imperial:!0},onAdd:function(e){var a="leaflet-control-scale",f=Nt("div",a),m=this.options;return this._addScales(m,a+"-line",f),e.on(m.updateWhenIdle?"moveend":"move",this._update,this),e.whenReady(this._update,this),f},onRemove:function(e){e.off(this.options.updateWhenIdle?"moveend":"move",this._update,this)},_addScales:function(e,a,f){e.metric&&(this._mScale=Nt("div",a,f)),e.imperial&&(this._iScale=Nt("div",a,f))},_update:function(){var e=this._map,a=e.getSize().y/2,f=e.distance(e.containerPointToLatLng([0,a]),e.containerPointToLatLng([this.options.maxWidth,a]));this._updateScales(f)},_updateScales:function(e){this.options.metric&&e&&this._updateMetric(e),this.options.imperial&&e&&this._updateImperial(e)},_updateMetric:function(e){var a=this._getRoundNum(e),f=a<1e3?a+" m":a/1e3+" km";this._updateScale(this._mScale,f,a/e)},_updateImperial:function(e){var a=e*3.2808399,f,m,b;a>5280?(f=a/5280,m=this._getRoundNum(f),this._updateScale(this._iScale,m+" mi",m/f)):(b=this._getRoundNum(a),this._updateScale(this._iScale,b+" ft",b/a))},_updateScale:function(e,a,f){e.style.width=Math.round(this.options.maxWidth*f)+"px",e.innerHTML=a},_getRoundNum:function(e){var a=Math.pow(10,(Math.floor(e)+"").length-1),f=e/a;return f=f>=10?10:f>=5?5:f>=3?3:f>=2?2:1,a*f}}),Jn=function(e){return new Yn(e)},Wn=Ae.extend({options:{position:"bottomright",prefix:'<a href="https://leafletjs.com" title="A JS library for interactive maps">Leaflet</a>'},initialize:function(e){I(this,e),this._attributions={}},onAdd:function(e){e.attributionControl=this,this._container=Nt("div","leaflet-control-attribution"),_i(this._container);for(var a in e._layers)e._layers[a].getAttribution&&this.addAttribution(e._layers[a].getAttribution());return this._update(),this._container},setPrefix:function(e){return this.options.prefix=e,this._update(),this},addAttribution:function(e){return e?(this._attributions[e]||(this._attributions[e]=0),this._attributions[e]++,this._update(),this):this},removeAttribution:function(e){return e?(this._attributions[e]&&(this._attributions[e]--,this._update()),this):this},_update:function(){if(!!this._map){var e=[];for(var a in this._attributions)this._attributions[a]&&e.push(a);var f=[];this.options.prefix&&f.push(this.options.prefix),e.length&&f.push(e.join(", ")),this._container.innerHTML=f.join(" | ")}}});Ft.mergeOptions({attributionControl:!0}),Ft.addInitHook(function(){this.options.attributionControl&&new Wn().addTo(this)});var xs=function(e){return new Wn(e)};Ae.Layers=Or,Ae.Zoom=xn,Ae.Scale=Yn,Ae.Attribution=Wn,Ii.layers=bs,Ii.zoom=Xn,Ii.scale=Jn,Ii.attribution=xs;var Ze=K.extend({initialize:function(e){this._map=e},enable:function(){return this._enabled?this:(this._enabled=!0,this.addHooks(),this)},disable:function(){return this._enabled?(this._enabled=!1,this.removeHooks(),this):this},enabled:function(){return!!this._enabled}});Ze.addTo=function(e,a){return e.addHandler(a,this),this};var Ls={Events:ft},Qn=Ee?"touchstart mousedown":"mousedown",Xi={mousedown:"mouseup",touchstart:"touchend",pointerdown:"touchend",MSPointerDown:"touchend"},Ai={mousedown:"mousemove",touchstart:"touchmove",pointerdown:"touchmove",MSPointerDown:"touchmove"},ri=zt.extend({options:{clickTolerance:3},initialize:function(e,a,f,m){I(this,m),this._element=e,this._dragStartTarget=a||e,this._preventOutline=f},enable:function(){this._enabled||(Tt(this._dragStartTarget,Qn,this._onDown,this),this._enabled=!0)},disable:function(){!this._enabled||(ri._dragging===this&&this.finishDrag(),te(this._dragStartTarget,Qn,this._onDown,this),this._enabled=!1,this._moved=!1)},_onDown:function(e){if(!(e._simulated||!this._enabled)&&(this._moved=!1,!pn(this._element,"leaflet-zoom-anim")&&!(ri._dragging||e.shiftKey||e.which!==1&&e.button!==1&&!e.touches)&&(ri._dragging=this,this._preventOutline&&ei(this._element),Zn(),Zi(),!this._moving))){this.fire("down");var a=e.touches?e.touches[0]:e,f=Ei(this._element);this._startPoint=new ot(a.clientX,a.clientY),this._parentScale=_n(f),Tt(document,Ai[e.type],this._onMove,this),Tt(document,Xi[e.type],this._onUp,this)}},_onMove:function(e){if(!(e._simulated||!this._enabled)){if(e.touches&&e.touches.length>1){this._moved=!0;return}var a=e.touches&&e.touches.length===1?e.touches[0]:e,f=new ot(a.clientX,a.clientY)._subtract(this._startPoint);!f.x&&!f.y||Math.abs(f.x)+Math.abs(f.y)<this.options.clickTolerance||(f.x/=this._parentScale.x,f.y/=this._parentScale.y,be(e),this._moved||(this.fire("dragstart"),this._moved=!0,this._startPos=Je(this._element).subtract(f),Ct(document.body,"leaflet-dragging"),this._lastTarget=e.target||e.srcElement,window.SVGElementInstance&&this._lastTarget instanceof window.SVGElementInstance&&(this._lastTarget=this._lastTarget.correspondingUseElement),Ct(this._lastTarget,"leaflet-drag-target")),this._newPos=this._startPos.add(f),this._moving=!0,vt(this._animRequest),this._lastEvent=e,this._animRequest=gt(this._updatePosition,this,!0))}},_updatePosition:function(){var e={originalEvent:this._lastEvent};this.fire("predrag",e),ne(this._element,this._newPos),this.fire("drag",e)},_onUp:function(e){e._simulated||!this._enabled||this.finishDrag()},finishDrag:function(){ie(document.body,"leaflet-dragging"),this._lastTarget&&(ie(this._lastTarget,"leaflet-drag-target"),this._lastTarget=null);for(var e in Ai)te(document,Ai[e],this._onMove,this),te(document,Xi[e],this._onUp,this);qn(),qi(),this._moved&&this._moving&&(vt(this._animRequest),this.fire("dragend",{distance:this._newPos.distanceTo(this._startPos)})),this._moving=!1,ri._dragging=!1}});function tr(e,a){if(!a||!e.length)return e.slice();var f=a*a;return e=Ir(e,f),e=ks(e,f),e}function er(e,a,f){return Math.sqrt(si(e,a,f,!0))}function ws(e,a,f){return si(e,a,f)}function ks(e,a){var f=e.length,m=typeof Uint8Array!=void 0+""?Uint8Array:Array,b=new m(f);b[0]=b[f-1]=1,ir(e,b,a,0,f-1);var O,G=[];for(O=0;O<f;O++)b[O]&&G.push(e[O]);return G}function ir(e,a,f,m,b){var O=0,G,X,W;for(X=m+1;X<=b-1;X++)W=si(e[X],e[m],e[b],!0),W>O&&(G=X,O=W);O>f&&(a[G]=1,ir(e,a,f,m,G),ir(e,a,f,G,b))}function Ir(e,a){for(var f=[e[0]],m=1,b=0,O=e.length;m<O;m++)de(e[m],e[b])>a&&(f.push(e[m]),b=m);return b<O-1&&f.push(e[O-1]),f}var Ar;function yi(e,a,f,m,b){var O=m?Ar:bi(e,f),G=bi(a,f),X,W,at;for(Ar=G;;){if(!(O|G))return[e,a];if(O&G)return!1;X=O||G,W=vi(e,a,X,f,b),at=bi(W,f),X===O?(e=W,O=at):(a=W,G=at)}}function vi(e,a,f,m,b){var O=a.x-e.x,G=a.y-e.y,X=m.min,W=m.max,at,pt;return f&8?(at=e.x+O*(W.y-e.y)/G,pt=W.y):f&4?(at=e.x+O*(X.y-e.y)/G,pt=X.y):f&2?(at=W.x,pt=e.y+G*(W.x-e.x)/O):f&1&&(at=X.x,pt=e.y+G*(X.x-e.x)/O),new ot(at,pt,b)}function bi(e,a){var f=0;return e.x<a.min.x?f|=1:e.x>a.max.x&&(f|=2),e.y<a.min.y?f|=4:e.y>a.max.y&&(f|=8),f}function de(e,a){var f=a.x-e.x,m=a.y-e.y;return f*f+m*m}function si(e,a,f,m){var b=a.x,O=a.y,G=f.x-b,X=f.y-O,W=G*G+X*X,at;return W>0&&(at=((e.x-b)*G+(e.y-O)*X)/W,at>1?(b=f.x,O=f.y):at>0&&(b+=G*at,O+=X*at)),G=e.x-b,X=e.y-O,m?G*G+X*X:new ot(b,O)}function ze(e){return!z(e[0])||typeof e[0][0]!="object"&&typeof e[0][0]!="undefined"}function Br(e){return console.warn("Deprecated use of _flat, please use L.LineUtil.isFlat instead."),ze(e)}var Ms={simplify:tr,pointToSegmentDistance:er,closestPointOnSegment:ws,clipSegment:yi,_getEdgeIntersection:vi,_getBitCode:bi,_sqClosestPointOnSegment:si,isFlat:ze,_flat:Br};function nr(e,a,f){var m,b=[1,4,2,8],O,G,X,W,at,pt,wt,Zt;for(O=0,pt=e.length;O<pt;O++)e[O]._code=bi(e[O],a);for(X=0;X<4;X++){for(wt=b[X],m=[],O=0,pt=e.length,G=pt-1;O<pt;G=O++)W=e[O],at=e[G],W._code&wt?at._code&wt||(Zt=vi(at,W,wt,a,f),Zt._code=bi(Zt,a),m.push(Zt)):(at._code&wt&&(Zt=vi(at,W,wt,a,f),Zt._code=bi(Zt,a),m.push(Zt)),m.push(W));e=m}return e}var rr={clipPolygon:nr},sr={project:function(e){return new ot(e.lng,e.lat)},unproject:function(e){return new Bt(e.y,e.x)},bounds:new Rt([-180,-90],[180,90])},or={R:6378137,R_MINOR:6356752314245179e-9,bounds:new Rt([-2003750834279e-5,-1549657073972e-5],[2003750834279e-5,1876465623138e-5]),project:function(e){var a=Math.PI/180,f=this.R,m=e.lat*a,b=this.R_MINOR/f,O=Math.sqrt(1-b*b),G=O*Math.sin(m),X=Math.tan(Math.PI/4-m/2)/Math.pow((1-G)/(1+G),O/2);return m=-f*Math.log(Math.max(X,1e-10)),new ot(e.lng*a*f,m)},unproject:function(e){for(var a=180/Math.PI,f=this.R,m=this.R_MINOR/f,b=Math.sqrt(1-m*m),O=Math.exp(-e.y/f),G=Math.PI/2-2*Math.atan(O),X=0,W=.1,at;X<15&&Math.abs(W)>1e-7;X++)at=b*Math.sin(G),at=Math.pow((1-at)/(1+at),b/2),W=Math.PI/2-2*Math.atan(O*at)-G,G+=W;return new Bt(G*a,e.x*a/f)}},r={LonLat:sr,Mercator:or,SphericalMercator:ue},l=o({},_e,{code:"EPSG:3395",projection:or,transformation:function(){var e=.5/(Math.PI*or.R);return k(e,.5,-e,.5)}()}),u=o({},_e,{code:"EPSG:4326",projection:sr,transformation:k(1/180,1,-1/180,.5)}),p=o({},ge,{projection:sr,transformation:k(1,0,-1,0),scale:function(e){return Math.pow(2,e)},zoom:function(e){return Math.log(e)/Math.LN2},distance:function(e,a){var f=a.lng-e.lng,m=a.lat-e.lat;return Math.sqrt(f*f+m*m)},infinite:!0});ge.Earth=_e,ge.EPSG3395=l,ge.EPSG3857=T,ge.EPSG900913=F,ge.EPSG4326=u,ge.Simple=p;var g=zt.extend({options:{pane:"overlayPane",attribution:null,bubblingMouseEvents:!0},addTo:function(e){return e.addLayer(this),this},remove:function(){return this.removeFrom(this._map||this._mapToAdd)},removeFrom:function(e){return e&&e.removeLayer(this),this},getPane:function(e){return this._map.getPane(e?this.options[e]||e:this.options.pane)},addInteractiveTarget:function(e){return this._map._targets[y(e)]=this,this},removeInteractiveTarget:function(e){return delete this._map._targets[y(e)],this},getAttribution:function(){return this.options.attribution},_layerAdd:function(e){var a=e.target;if(!!a.hasLayer(this)){if(this._map=a,this._zoomAnimated=a._zoomAnimated,this.getEvents){var f=this.getEvents();a.on(f,this),this.once("remove",function(){a.off(f,this)},this)}this.onAdd(a),this.getAttribution&&a.attributionControl&&a.attributionControl.addAttribution(this.getAttribution()),this.fire("add"),a.fire("layeradd",{layer:this})}}});Ft.include({addLayer:function(e){if(!e._layerAdd)throw new Error("The provided object is not a Layer.");var a=y(e);return this._layers[a]?this:(this._layers[a]=e,e._mapToAdd=this,e.beforeAdd&&e.beforeAdd(this),this.whenReady(e._layerAdd,e),this)},removeLayer:function(e){var a=y(e);return this._layers[a]?(this._loaded&&e.onRemove(this),e.getAttribution&&this.attributionControl&&this.attributionControl.removeAttribution(e.getAttribution()),delete this._layers[a],this._loaded&&(this.fire("layerremove",{layer:e}),e.fire("remove")),e._map=e._mapToAdd=null,this):this},hasLayer:function(e){return!!e&&y(e)in this._layers},eachLayer:function(e,a){for(var f in this._layers)e.call(a,this._layers[f]);return this},_addLayers:function(e){e=e?z(e)?e:[e]:[];for(var a=0,f=e.length;a<f;a++)this.addLayer(e[a])},_addZoomLimit:function(e){(isNaN(e.options.maxZoom)||!isNaN(e.options.minZoom))&&(this._zoomBoundLayers[y(e)]=e,this._updateZoomLevels())},_removeZoomLimit:function(e){var a=y(e);this._zoomBoundLayers[a]&&(delete this._zoomBoundLayers[a],this._updateZoomLevels())},_updateZoomLevels:function(){var e=1/0,a=-1/0,f=this._getZoomSpan();for(var m in this._zoomBoundLayers){var b=this._zoomBoundLayers[m].options;e=b.minZoom===void 0?e:Math.min(e,b.minZoom),a=b.maxZoom===void 0?a:Math.max(a,b.maxZoom)}this._layersMaxZoom=a===-1/0?void 0:a,this._layersMinZoom=e===1/0?void 0:e,f!==this._getZoomSpan()&&this.fire("zoomlevelschange"),this.options.maxZoom===void 0&&this._layersMaxZoom&&this.getZoom()>this._layersMaxZoom&&this.setZoom(this._layersMaxZoom),this.options.minZoom===void 0&&this._layersMinZoom&&this.getZoom()<this._layersMinZoom&&this.setZoom(this._layersMinZoom)}});var M=g.extend({initialize:function(e,a){I(this,a),this._layers={};var f,m;if(e)for(f=0,m=e.length;f<m;f++)this.addLayer(e[f])},addLayer:function(e){var a=this.getLayerId(e);return this._layers[a]=e,this._map&&this._map.addLayer(e),this},removeLayer:function(e){var a=e in this._layers?e:this.getLayerId(e);return this._map&&this._layers[a]&&this._map.removeLayer(this._layers[a]),delete this._layers[a],this},hasLayer:function(e){if(!e)return!1;var a=typeof e=="number"?e:this.getLayerId(e);return a in this._layers},clearLayers:function(){return this.eachLayer(this.removeLayer,this)},invoke:function(e){var a=Array.prototype.slice.call(arguments,1),f,m;for(f in this._layers)m=this._layers[f],m[e]&&m[e].apply(m,a);return this},onAdd:function(e){this.eachLayer(e.addLayer,e)},onRemove:function(e){this.eachLayer(e.removeLayer,e)},eachLayer:function(e,a){for(var f in this._layers)e.call(a,this._layers[f]);return this},getLayer:function(e){return this._layers[e]},getLayers:function(){var e=[];return this.eachLayer(e.push,e),e},setZIndex:function(e){return this.invoke("setZIndex",e)},getLayerId:function(e){return y(e)}}),S=function(e,a){return new M(e,a)},D=M.extend({addLayer:function(e){return this.hasLayer(e)?this:(e.addEventParent(this),M.prototype.addLayer.call(this,e),this.fire("layeradd",{layer:e}))},removeLayer:function(e){return this.hasLayer(e)?(e in this._layers&&(e=this._layers[e]),e.removeEventParent(this),M.prototype.removeLayer.call(this,e),this.fire("layerremove",{layer:e})):this},setStyle:function(e){return this.invoke("setStyle",e)},bringToFront:function(){return this.invoke("bringToFront")},bringToBack:function(){return this.invoke("bringToBack")},getBounds:function(){var e=new Kt;for(var a in this._layers){var f=this._layers[a];e.extend(f.getBounds?f.getBounds():f.getLatLng())}return e}}),B=function(e,a){return new D(e,a)},N=K.extend({options:{popupAnchor:[0,0],tooltipAnchor:[0,0]},initialize:function(e){I(this,e)},createIcon:function(e){return this._createIcon("icon",e)},createShadow:function(e){return this._createIcon("shadow",e)},_createIcon:function(e,a){var f=this._getIconUrl(e);if(!f){if(e==="icon")throw new Error("iconUrl not set in Icon options (see the docs).");return null}var m=this._createImg(f,a&&a.tagName==="IMG"?a:null);return this._setIconStyles(m,e),m},_setIconStyles:function(e,a){var f=this.options,m=f[a+"Size"];typeof m=="number"&&(m=[m,m]);var b=kt(m),O=kt(a==="shadow"&&f.shadowAnchor||f.iconAnchor||b&&b.divideBy(2,!0));e.className="leaflet-marker-"+a+" "+(f.className||""),O&&(e.style.marginLeft=-O.x+"px",e.style.marginTop=-O.y+"px"),b&&(e.style.width=b.x+"px",e.style.height=b.y+"px")},_createImg:function(e,a){return a=a||document.createElement("img"),a.src=e,a},_getIconUrl:function(e){return $e&&this.options[e+"RetinaUrl"]||this.options[e+"Url"]}});function H(e){return new N(e)}var Y=N.extend({options:{iconUrl:"marker-icon.png",iconRetinaUrl:"marker-icon-2x.png",shadowUrl:"marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],tooltipAnchor:[16,-28],shadowSize:[41,41]},_getIconUrl:function(e){return Y.imagePath||(Y.imagePath=this._detectIconPath()),(this.options.imagePath||Y.imagePath)+N.prototype._getIconUrl.call(this,e)},_detectIconPath:function(){var e=Nt("div","leaflet-default-icon-path",document.body),a=mi(e,"background-image")||mi(e,"backgroundImage");return document.body.removeChild(e),a===null||a.indexOf("url")!==0?a="":a=a.replace(/^url\(["']?/,"").replace(/marker-icon\.png["']?\)$/,""),a}}),V=Ze.extend({initialize:function(e){this._marker=e},addHooks:function(){var e=this._marker._icon;this._draggable||(this._draggable=new ri(e,e,!0)),this._draggable.on({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).enable(),Ct(e,"leaflet-marker-draggable")},removeHooks:function(){this._draggable.off({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).disable(),this._marker._icon&&ie(this._marker._icon,"leaflet-marker-draggable")},moved:function(){return this._draggable&&this._draggable._moved},_adjustPan:function(e){var a=this._marker,f=a._map,m=this._marker.options.autoPanSpeed,b=this._marker.options.autoPanPadding,O=Je(a._icon),G=f.getPixelBounds(),X=f.getPixelOrigin(),W=se(G.min._subtract(X).add(b),G.max._subtract(X).subtract(b));if(!W.contains(O)){var at=kt((Math.max(W.max.x,O.x)-W.max.x)/(G.max.x-W.max.x)-(Math.min(W.min.x,O.x)-W.min.x)/(G.min.x-W.min.x),(Math.max(W.max.y,O.y)-W.max.y)/(G.max.y-W.max.y)-(Math.min(W.min.y,O.y)-W.min.y)/(G.min.y-W.min.y)).multiplyBy(m);f.panBy(at,{animate:!1}),this._draggable._newPos._add(at),this._draggable._startPos._add(at),ne(a._icon,this._draggable._newPos),this._onDrag(e),this._panRequest=gt(this._adjustPan.bind(this,e))}},_onDragStart:function(){this._oldLatLng=this._marker.getLatLng(),this._marker.closePopup&&this._marker.closePopup(),this._marker.fire("movestart").fire("dragstart")},_onPreDrag:function(e){this._marker.options.autoPan&&(vt(this._panRequest),this._panRequest=gt(this._adjustPan.bind(this,e)))},_onDrag:function(e){var a=this._marker,f=a._shadow,m=Je(a._icon),b=a._map.layerPointToLatLng(m);f&&ne(f,m),a._latlng=b,e.latlng=b,e.oldLatLng=this._oldLatLng,a.fire("move",e).fire("drag",e)},_onDragEnd:function(e){vt(this._panRequest),delete this._oldLatLng,this._marker.fire("moveend").fire("dragend",e)}}),tt=g.extend({options:{icon:new Y,interactive:!0,keyboard:!0,title:"",alt:"",zIndexOffset:0,opacity:1,riseOnHover:!1,riseOffset:250,pane:"markerPane",shadowPane:"shadowPane",bubblingMouseEvents:!1,draggable:!1,autoPan:!1,autoPanPadding:[50,50],autoPanSpeed:10},initialize:function(e,a){I(this,a),this._latlng=Ut(e)},onAdd:function(e){this._zoomAnimated=this._zoomAnimated&&e.options.markerZoomAnimation,this._zoomAnimated&&e.on("zoomanim",this._animateZoom,this),this._initIcon(),this.update()},onRemove:function(e){this.dragging&&this.dragging.enabled()&&(this.options.draggable=!0,this.dragging.removeHooks()),delete this.dragging,this._zoomAnimated&&e.off("zoomanim",this._animateZoom,this),this._removeIcon(),this._removeShadow()},getEvents:function(){return{zoom:this.update,viewreset:this.update}},getLatLng:function(){return this._latlng},setLatLng:function(e){var a=this._latlng;return this._latlng=Ut(e),this.update(),this.fire("move",{oldLatLng:a,latlng:this._latlng})},setZIndexOffset:function(e){return this.options.zIndexOffset=e,this.update()},getIcon:function(){return this.options.icon},setIcon:function(e){return this.options.icon=e,this._map&&(this._initIcon(),this.update()),this._popup&&this.bindPopup(this._popup,this._popup.options),this},getElement:function(){return this._icon},update:function(){if(this._icon&&this._map){var e=this._map.latLngToLayerPoint(this._latlng).round();this._setPos(e)}return this},_initIcon:function(){var e=this.options,a="leaflet-zoom-"+(this._zoomAnimated?"animated":"hide"),f=e.icon.createIcon(this._icon),m=!1;f!==this._icon&&(this._icon&&this._removeIcon(),m=!0,e.title&&(f.title=e.title),f.tagName==="IMG"&&(f.alt=e.alt||"")),Ct(f,a),e.keyboard&&(f.tabIndex="0"),this._icon=f,e.riseOnHover&&this.on({mouseover:this._bringToFront,mouseout:this._resetZIndex});var b=e.icon.createShadow(this._shadow),O=!1;b!==this._shadow&&(this._removeShadow(),O=!0),b&&(Ct(b,a),b.alt=""),this._shadow=b,e.opacity<1&&this._updateOpacity(),m&&this.getPane().appendChild(this._icon),this._initInteraction(),b&&O&&this.getPane(e.shadowPane).appendChild(this._shadow)},_removeIcon:function(){this.options.riseOnHover&&this.off({mouseover:this._bringToFront,mouseout:this._resetZIndex}),Qt(this._icon),this.removeInteractiveTarget(this._icon),this._icon=null},_removeShadow:function(){this._shadow&&Qt(this._shadow),this._shadow=null},_setPos:function(e){this._icon&&ne(this._icon,e),this._shadow&&ne(this._shadow,e),this._zIndex=e.y+this.options.zIndexOffset,this._resetZIndex()},_updateZIndex:function(e){this._icon&&(this._icon.style.zIndex=this._zIndex+e)},_animateZoom:function(e){var a=this._map._latLngToNewLayerPoint(this._latlng,e.zoom,e.center).round();this._setPos(a)},_initInteraction:function(){if(!!this.options.interactive&&(Ct(this._icon,"leaflet-interactive"),this.addInteractiveTarget(this._icon),V)){var e=this.options.draggable;this.dragging&&(e=this.dragging.enabled(),this.dragging.disable()),this.dragging=new V(this),e&&this.dragging.enable()}},setOpacity:function(e){return this.options.opacity=e,this._map&&this._updateOpacity(),this},_updateOpacity:function(){var e=this.options.opacity;this._icon&&Te(this._icon,e),this._shadow&&Te(this._shadow,e)},_bringToFront:function(){this._updateZIndex(this.options.riseOffset)},_resetZIndex:function(){this._updateZIndex(0)},_getPopupAnchor:function(){return this.options.icon.options.popupAnchor},_getTooltipAnchor:function(){return this.options.icon.options.tooltipAnchor}});function ut(e,a){return new tt(e,a)}var ct=g.extend({options:{stroke:!0,color:"#3388ff",weight:3,opacity:1,lineCap:"round",lineJoin:"round",dashArray:null,dashOffset:null,fill:!1,fillColor:null,fillOpacity:.2,fillRule:"evenodd",interactive:!0,bubblingMouseEvents:!0},beforeAdd:function(e){this._renderer=e.getRenderer(this)},onAdd:function(){this._renderer._initPath(this),this._reset(),this._renderer._addPath(this)},onRemove:function(){this._renderer._removePath(this)},redraw:function(){return this._map&&this._renderer._updatePath(this),this},setStyle:function(e){return I(this,e),this._renderer&&(this._renderer._updateStyle(this),this.options.stroke&&e&&Object.prototype.hasOwnProperty.call(e,"weight")&&this._updateBounds()),this},bringToFront:function(){return this._renderer&&this._renderer._bringToFront(this),this},bringToBack:function(){return this._renderer&&this._renderer._bringToBack(this),this},getElement:function(){return this._path},_reset:function(){this._project(),this._update()},_clickTolerance:function(){return(this.options.stroke?this.options.weight/2:0)+this._renderer.options.tolerance}}),yt=ct.extend({options:{fill:!0,radius:10},initialize:function(e,a){I(this,a),this._latlng=Ut(e),this._radius=this.options.radius},setLatLng:function(e){var a=this._latlng;return this._latlng=Ut(e),this.redraw(),this.fire("move",{oldLatLng:a,latlng:this._latlng})},getLatLng:function(){return this._latlng},setRadius:function(e){return this.options.radius=this._radius=e,this.redraw()},getRadius:function(){return this._radius},setStyle:function(e){var a=e&&e.radius||this._radius;return ct.prototype.setStyle.call(this,e),this.setRadius(a),this},_project:function(){this._point=this._map.latLngToLayerPoint(this._latlng),this._updateBounds()},_updateBounds:function(){var e=this._radius,a=this._radiusY||e,f=this._clickTolerance(),m=[e+f,a+f];this._pxBounds=new Rt(this._point.subtract(m),this._point.add(m))},_update:function(){this._map&&this._updatePath()},_updatePath:function(){this._renderer._updateCircle(this)},_empty:function(){return this._radius&&!this._renderer._bounds.intersects(this._pxBounds)},_containsPoint:function(e){return e.distanceTo(this._point)<=this._radius+this._clickTolerance()}});function mt(e,a){return new yt(e,a)}var xt=yt.extend({initialize:function(e,a,f){if(typeof a=="number"&&(a=o({},f,{radius:a})),I(this,a),this._latlng=Ut(e),isNaN(this.options.radius))throw new Error("Circle radius cannot be NaN");this._mRadius=this.options.radius},setRadius:function(e){return this._mRadius=e,this.redraw()},getRadius:function(){return this._mRadius},getBounds:function(){var e=[this._radius,this._radiusY||this._radius];return new Kt(this._map.layerPointToLatLng(this._point.subtract(e)),this._map.layerPointToLatLng(this._point.add(e)))},setStyle:ct.prototype.setStyle,_project:function(){var e=this._latlng.lng,a=this._latlng.lat,f=this._map,m=f.options.crs;if(m.distance===_e.distance){var b=Math.PI/180,O=this._mRadius/_e.R/b,G=f.project([a+O,e]),X=f.project([a-O,e]),W=G.add(X).divideBy(2),at=f.unproject(W).lat,pt=Math.acos((Math.cos(O*b)-Math.sin(a*b)*Math.sin(at*b))/(Math.cos(a*b)*Math.cos(at*b)))/b;(isNaN(pt)||pt===0)&&(pt=O/Math.cos(Math.PI/180*a)),this._point=W.subtract(f.getPixelOrigin()),this._radius=isNaN(pt)?0:W.x-f.project([at,e-pt]).x,this._radiusY=W.y-G.y}else{var wt=m.unproject(m.project(this._latlng).subtract([this._mRadius,0]));this._point=f.latLngToLayerPoint(this._latlng),this._radius=this._point.x-f.latLngToLayerPoint(wt).x}this._updateBounds()}});function Lt(e,a,f){return new xt(e,a,f)}var _t=ct.extend({options:{smoothFactor:1,noClip:!1},initialize:function(e,a){I(this,a),this._setLatLngs(e)},getLatLngs:function(){return this._latlngs},setLatLngs:function(e){return this._setLatLngs(e),this.redraw()},isEmpty:function(){return!this._latlngs.length},closestLayerPoint:function(e){for(var a=1/0,f=null,m=si,b,O,G=0,X=this._parts.length;G<X;G++)for(var W=this._parts[G],at=1,pt=W.length;at<pt;at++){b=W[at-1],O=W[at];var wt=m(e,b,O,!0);wt<a&&(a=wt,f=m(e,b,O))}return f&&(f.distance=Math.sqrt(a)),f},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");var e,a,f,m,b,O,G,X=this._rings[0],W=X.length;if(!W)return null;for(e=0,a=0;e<W-1;e++)a+=X[e].distanceTo(X[e+1])/2;if(a===0)return this._map.layerPointToLatLng(X[0]);for(e=0,m=0;e<W-1;e++)if(b=X[e],O=X[e+1],f=b.distanceTo(O),m+=f,m>a)return G=(m-a)/f,this._map.layerPointToLatLng([O.x-G*(O.x-b.x),O.y-G*(O.y-b.y)])},getBounds:function(){return this._bounds},addLatLng:function(e,a){return a=a||this._defaultShape(),e=Ut(e),a.push(e),this._bounds.extend(e),this.redraw()},_setLatLngs:function(e){this._bounds=new Kt,this._latlngs=this._convertLatLngs(e)},_defaultShape:function(){return ze(this._latlngs)?this._latlngs:this._latlngs[0]},_convertLatLngs:function(e){for(var a=[],f=ze(e),m=0,b=e.length;m<b;m++)f?(a[m]=Ut(e[m]),this._bounds.extend(a[m])):a[m]=this._convertLatLngs(e[m]);return a},_project:function(){var e=new Rt;this._rings=[],this._projectLatlngs(this._latlngs,this._rings,e),this._bounds.isValid()&&e.isValid()&&(this._rawPxBounds=e,this._updateBounds())},_updateBounds:function(){var e=this._clickTolerance(),a=new ot(e,e);this._pxBounds=new Rt([this._rawPxBounds.min.subtract(a),this._rawPxBounds.max.add(a)])},_projectLatlngs:function(e,a,f){var m=e[0]instanceof Bt,b=e.length,O,G;if(m){for(G=[],O=0;O<b;O++)G[O]=this._map.latLngToLayerPoint(e[O]),f.extend(G[O]);a.push(G)}else for(O=0;O<b;O++)this._projectLatlngs(e[O],a,f)},_clipPoints:function(){var e=this._renderer._bounds;if(this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(e))){if(this.options.noClip){this._parts=this._rings;return}var a=this._parts,f,m,b,O,G,X,W;for(f=0,b=0,O=this._rings.length;f<O;f++)for(W=this._rings[f],m=0,G=W.length;m<G-1;m++)X=yi(W[m],W[m+1],e,m,!0),!!X&&(a[b]=a[b]||[],a[b].push(X[0]),(X[1]!==W[m+1]||m===G-2)&&(a[b].push(X[1]),b++))}},_simplifyPoints:function(){for(var e=this._parts,a=this.options.smoothFactor,f=0,m=e.length;f<m;f++)e[f]=tr(e[f],a)},_update:function(){!this._map||(this._clipPoints(),this._simplifyPoints(),this._updatePath())},_updatePath:function(){this._renderer._updatePoly(this)},_containsPoint:function(e,a){var f,m,b,O,G,X,W=this._clickTolerance();if(!this._pxBounds||!this._pxBounds.contains(e))return!1;for(f=0,O=this._parts.length;f<O;f++)for(X=this._parts[f],m=0,G=X.length,b=G-1;m<G;b=m++)if(!(!a&&m===0)&&er(e,X[b],X[m])<=W)return!0;return!1}});function Gt(e,a){return new _t(e,a)}_t._flat=Br;var Me=_t.extend({options:{fill:!0},isEmpty:function(){return!this._latlngs.length||!this._latlngs[0].length},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");var e,a,f,m,b,O,G,X,W,at=this._rings[0],pt=at.length;if(!pt)return null;for(O=G=X=0,e=0,a=pt-1;e<pt;a=e++)f=at[e],m=at[a],b=f.y*m.x-m.y*f.x,G+=(f.x+m.x)*b,X+=(f.y+m.y)*b,O+=b*3;return O===0?W=at[0]:W=[G/O,X/O],this._map.layerPointToLatLng(W)},_convertLatLngs:function(e){var a=_t.prototype._convertLatLngs.call(this,e),f=a.length;return f>=2&&a[0]instanceof Bt&&a[0].equals(a[f-1])&&a.pop(),a},_setLatLngs:function(e){_t.prototype._setLatLngs.call(this,e),ze(this._latlngs)&&(this._latlngs=[this._latlngs])},_defaultShape:function(){return ze(this._latlngs[0])?this._latlngs[0]:this._latlngs[0][0]},_clipPoints:function(){var e=this._renderer._bounds,a=this.options.weight,f=new ot(a,a);if(e=new Rt(e.min.subtract(f),e.max.add(f)),this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(e))){if(this.options.noClip){this._parts=this._rings;return}for(var m=0,b=this._rings.length,O;m<b;m++)O=nr(this._rings[m],e,!0),O.length&&this._parts.push(O)}},_updatePath:function(){this._renderer._updatePoly(this,!0)},_containsPoint:function(e){var a=!1,f,m,b,O,G,X,W,at;if(!this._pxBounds||!this._pxBounds.contains(e))return!1;for(O=0,W=this._parts.length;O<W;O++)for(f=this._parts[O],G=0,at=f.length,X=at-1;G<at;X=G++)m=f[G],b=f[X],m.y>e.y!=b.y>e.y&&e.x<(b.x-m.x)*(e.y-m.y)/(b.y-m.y)+m.x&&(a=!a);return a||_t.prototype._containsPoint.call(this,e,!0)}});function Dr(e,a){return new Me(e,a)}var Ne=D.extend({initialize:function(e,a){I(this,a),this._layers={},e&&this.addData(e)},addData:function(e){var a=z(e)?e:e.features,f,m,b;if(a){for(f=0,m=a.length;f<m;f++)b=a[f],(b.geometries||b.geometry||b.features||b.coordinates)&&this.addData(b);return this}var O=this.options;if(O.filter&&!O.filter(e))return this;var G=Qe(e,O);return G?(G.feature=Rr(e),G.defaultOptions=G.options,this.resetStyle(G),O.onEachFeature&&O.onEachFeature(e,G),this.addLayer(G)):this},resetStyle:function(e){return e===void 0?this.eachLayer(this.resetStyle,this):(e.options=o({},e.defaultOptions),this._setLayerStyle(e,this.options.style),this)},setStyle:function(e){return this.eachLayer(function(a){this._setLayerStyle(a,e)},this)},_setLayerStyle:function(e,a){e.setStyle&&(typeof a=="function"&&(a=a(e.feature)),e.setStyle(a))}});function Qe(e,a){var f=e.type==="Feature"?e.geometry:e,m=f?f.coordinates:null,b=[],O=a&&a.pointToLayer,G=a&&a.coordsToLatLng||Ln,X,W,at,pt;if(!m&&!f)return null;switch(f.type){case"Point":return X=G(m),ar(O,e,X,a);case"MultiPoint":for(at=0,pt=m.length;at<pt;at++)X=G(m[at]),b.push(ar(O,e,X,a));return new D(b);case"LineString":case"MultiLineString":return W=wn(m,f.type==="LineString"?0:1,G),new _t(W,a);case"Polygon":case"MultiPolygon":return W=wn(m,f.type==="Polygon"?1:2,G),new Me(W,a);case"GeometryCollection":for(at=0,pt=f.geometries.length;at<pt;at++){var wt=Qe({geometry:f.geometries[at],type:"Feature",properties:e.properties},a);wt&&b.push(wt)}return new D(b);default:throw new Error("Invalid GeoJSON object.")}}function ar(e,a,f,m){return e?e(a,f):new tt(f,m&&m.markersInheritOptions&&m)}function Ln(e){return new Bt(e[1],e[0],e[2])}function wn(e,a,f){for(var m=[],b=0,O=e.length,G;b<O;b++)G=a?wn(e[b],a-1,f):(f||Ln)(e[b]),m.push(G);return m}function Yi(e,a){return a=typeof a=="number"?a:6,e.alt!==void 0?[w(e.lng,a),w(e.lat,a),w(e.alt,a)]:[w(e.lng,a),w(e.lat,a)]}function kn(e,a,f,m){for(var b=[],O=0,G=e.length;O<G;O++)b.push(a?kn(e[O],a-1,f,m):Yi(e[O],m));return!a&&f&&b.push(b[0]),b}function Bi(e,a){return e.feature?o({},e.feature,{geometry:a}):Rr(a)}function Rr(e){return e.type==="Feature"||e.type==="FeatureCollection"?e:{type:"Feature",properties:{},geometry:e}}var Ps={toGeoJSON:function(e){return Bi(this,{type:"Point",coordinates:Yi(this.getLatLng(),e)})}};tt.include(Ps),xt.include(Ps),yt.include(Ps),_t.include({toGeoJSON:function(e){var a=!ze(this._latlngs),f=kn(this._latlngs,a?1:0,!1,e);return Bi(this,{type:(a?"Multi":"")+"LineString",coordinates:f})}}),Me.include({toGeoJSON:function(e){var a=!ze(this._latlngs),f=a&&!ze(this._latlngs[0]),m=kn(this._latlngs,f?2:a?1:0,!0,e);return a||(m=[m]),Bi(this,{type:(f?"Multi":"")+"Polygon",coordinates:m})}}),M.include({toMultiPoint:function(e){var a=[];return this.eachLayer(function(f){a.push(f.toGeoJSON(e).geometry.coordinates)}),Bi(this,{type:"MultiPoint",coordinates:a})},toGeoJSON:function(e){var a=this.feature&&this.feature.geometry&&this.feature.geometry.type;if(a==="MultiPoint")return this.toMultiPoint(e);var f=a==="GeometryCollection",m=[];return this.eachLayer(function(b){if(b.toGeoJSON){var O=b.toGeoJSON(e);if(f)m.push(O.geometry);else{var G=Rr(O);G.type==="FeatureCollection"?m.push.apply(m,G.features):m.push(G)}}}),f?Bi(this,{geometries:m,type:"GeometryCollection"}):{type:"FeatureCollection",features:m}}});function yo(e,a){return new Ne(e,a)}var hl=yo,zr=g.extend({options:{opacity:1,alt:"",interactive:!1,crossOrigin:!1,errorOverlayUrl:"",zIndex:1,className:""},initialize:function(e,a,f){this._url=e,this._bounds=$t(a),I(this,f)},onAdd:function(){this._image||(this._initImage(),this.options.opacity<1&&this._updateOpacity()),this.options.interactive&&(Ct(this._image,"leaflet-interactive"),this.addInteractiveTarget(this._image)),this.getPane().appendChild(this._image),this._reset()},onRemove:function(){Qt(this._image),this.options.interactive&&this.removeInteractiveTarget(this._image)},setOpacity:function(e){return this.options.opacity=e,this._image&&this._updateOpacity(),this},setStyle:function(e){return e.opacity&&this.setOpacity(e.opacity),this},bringToFront:function(){return this._map&&Xe(this._image),this},bringToBack:function(){return this._map&&Ci(this._image),this},setUrl:function(e){return this._url=e,this._image&&(this._image.src=e),this},setBounds:function(e){return this._bounds=$t(e),this._map&&this._reset(),this},getEvents:function(){var e={zoom:this._reset,viewreset:this._reset};return this._zoomAnimated&&(e.zoomanim=this._animateZoom),e},setZIndex:function(e){return this.options.zIndex=e,this._updateZIndex(),this},getBounds:function(){return this._bounds},getElement:function(){return this._image},_initImage:function(){var e=this._url.tagName==="IMG",a=this._image=e?this._url:Nt("img");if(Ct(a,"leaflet-image-layer"),this._zoomAnimated&&Ct(a,"leaflet-zoom-animated"),this.options.className&&Ct(a,this.options.className),a.onselectstart=x,a.onmousemove=x,a.onload=c(this.fire,this,"load"),a.onerror=c(this._overlayOnError,this,"error"),(this.options.crossOrigin||this.options.crossOrigin==="")&&(a.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),this.options.zIndex&&this._updateZIndex(),e){this._url=a.src;return}a.src=this._url,a.alt=this.options.alt},_animateZoom:function(e){var a=this._map.getZoomScale(e.zoom),f=this._map._latLngBoundsToNewLayerBounds(this._bounds,e.zoom,e.center).min;Ye(this._image,f,a)},_reset:function(){var e=this._image,a=new Rt(this._map.latLngToLayerPoint(this._bounds.getNorthWest()),this._map.latLngToLayerPoint(this._bounds.getSouthEast())),f=a.getSize();ne(e,a.min),e.style.width=f.x+"px",e.style.height=f.y+"px"},_updateOpacity:function(){Te(this._image,this.options.opacity)},_updateZIndex:function(){this._image&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._image.style.zIndex=this.options.zIndex)},_overlayOnError:function(){this.fire("error");var e=this.options.errorOverlayUrl;e&&this._url!==e&&(this._url=e,this._image.src=e)}}),ul=function(e,a,f){return new zr(e,a,f)},vo=zr.extend({options:{autoplay:!0,loop:!0,keepAspectRatio:!0,muted:!1},_initImage:function(){var e=this._url.tagName==="VIDEO",a=this._image=e?this._url:Nt("video");if(Ct(a,"leaflet-image-layer"),this._zoomAnimated&&Ct(a,"leaflet-zoom-animated"),this.options.className&&Ct(a,this.options.className),a.onselectstart=x,a.onmousemove=x,a.onloadeddata=c(this.fire,this,"load"),e){for(var f=a.getElementsByTagName("source"),m=[],b=0;b<f.length;b++)m.push(f[b].src);this._url=f.length>0?m:[a.src];return}z(this._url)||(this._url=[this._url]),!this.options.keepAspectRatio&&Object.prototype.hasOwnProperty.call(a.style,"objectFit")&&(a.style.objectFit="fill"),a.autoplay=!!this.options.autoplay,a.loop=!!this.options.loop,a.muted=!!this.options.muted;for(var O=0;O<this._url.length;O++){var G=Nt("source");G.src=this._url[O],a.appendChild(G)}}});function cl(e,a,f){return new vo(e,a,f)}var bo=zr.extend({_initImage:function(){var e=this._image=this._url;Ct(e,"leaflet-image-layer"),this._zoomAnimated&&Ct(e,"leaflet-zoom-animated"),this.options.className&&Ct(e,this.options.className),e.onselectstart=x,e.onmousemove=x}});function fl(e,a,f){return new bo(e,a,f)}var xi=g.extend({options:{offset:[0,7],className:"",pane:"popupPane"},initialize:function(e,a){I(this,e),this._source=a},onAdd:function(e){this._zoomAnimated=e._zoomAnimated,this._container||this._initLayout(),e._fadeAnimated&&Te(this._container,0),clearTimeout(this._removeTimeout),this.getPane().appendChild(this._container),this.update(),e._fadeAnimated&&Te(this._container,1),this.bringToFront()},onRemove:function(e){e._fadeAnimated?(Te(this._container,0),this._removeTimeout=setTimeout(c(Qt,void 0,this._container),200)):Qt(this._container)},getLatLng:function(){return this._latlng},setLatLng:function(e){return this._latlng=Ut(e),this._map&&(this._updatePosition(),this._adjustPan()),this},getContent:function(){return this._content},setContent:function(e){return this._content=e,this.update(),this},getElement:function(){return this._container},update:function(){!this._map||(this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan())},getEvents:function(){var e={zoom:this._updatePosition,viewreset:this._updatePosition};return this._zoomAnimated&&(e.zoomanim=this._animateZoom),e},isOpen:function(){return!!this._map&&this._map.hasLayer(this)},bringToFront:function(){return this._map&&Xe(this._container),this},bringToBack:function(){return this._map&&Ci(this._container),this},_prepareOpen:function(e,a,f){if(a instanceof g||(f=a,a=e),a instanceof D)for(var m in e._layers){a=e._layers[m];break}if(!f)if(a.getCenter)f=a.getCenter();else if(a.getLatLng)f=a.getLatLng();else throw new Error("Unable to get source layer LatLng.");return this._source=a,this.update(),f},_updateContent:function(){if(!!this._content){var e=this._contentNode,a=typeof this._content=="function"?this._content(this._source||this):this._content;if(typeof a=="string")e.innerHTML=a;else{for(;e.hasChildNodes();)e.removeChild(e.firstChild);e.appendChild(a)}this.fire("contentupdate")}},_updatePosition:function(){if(!!this._map){var e=this._map.latLngToLayerPoint(this._latlng),a=kt(this.options.offset),f=this._getAnchor();this._zoomAnimated?ne(this._container,e.add(f)):a=a.add(e).add(f);var m=this._containerBottom=-a.y,b=this._containerLeft=-Math.round(this._containerWidth/2)+a.x;this._container.style.bottom=m+"px",this._container.style.left=b+"px"}},_getAnchor:function(){return[0,0]}}),Mn=xi.extend({options:{maxWidth:300,minWidth:50,maxHeight:null,autoPan:!0,autoPanPaddingTopLeft:null,autoPanPaddingBottomRight:null,autoPanPadding:[5,5],keepInView:!1,closeButton:!0,autoClose:!0,closeOnEscapeKey:!0,className:""},openOn:function(e){return e.openPopup(this),this},onAdd:function(e){xi.prototype.onAdd.call(this,e),e.fire("popupopen",{popup:this}),this._source&&(this._source.fire("popupopen",{popup:this},!0),this._source instanceof ct||this._source.on("preclick",Ie))},onRemove:function(e){xi.prototype.onRemove.call(this,e),e.fire("popupclose",{popup:this}),this._source&&(this._source.fire("popupclose",{popup:this},!0),this._source instanceof ct||this._source.off("preclick",Ie))},getEvents:function(){var e=xi.prototype.getEvents.call(this);return(this.options.closeOnClick!==void 0?this.options.closeOnClick:this._map.options.closePopupOnClick)&&(e.preclick=this._close),this.options.keepInView&&(e.moveend=this._adjustPan),e},_close:function(){this._map&&this._map.closePopup(this)},_initLayout:function(){var e="leaflet-popup",a=this._container=Nt("div",e+" "+(this.options.className||"")+" leaflet-zoom-animated"),f=this._wrapper=Nt("div",e+"-content-wrapper",a);if(this._contentNode=Nt("div",e+"-content",f),_i(a),Ti(this._contentNode),Tt(a,"contextmenu",Ie),this._tipContainer=Nt("div",e+"-tip-container",a),this._tip=Nt("div",e+"-tip",this._tipContainer),this.options.closeButton){var m=this._closeButton=Nt("a",e+"-close-button",a);m.href="#close",m.innerHTML="&#215;",Tt(m,"click",this._onCloseButtonClick,this)}},_updateLayout:function(){var e=this._contentNode,a=e.style;a.width="",a.whiteSpace="nowrap";var f=e.offsetWidth;f=Math.min(f,this.options.maxWidth),f=Math.max(f,this.options.minWidth),a.width=f+1+"px",a.whiteSpace="",a.height="";var m=e.offsetHeight,b=this.options.maxHeight,O="leaflet-popup-scrolled";b&&m>b?(a.height=b+"px",Ct(e,O)):ie(e,O),this._containerWidth=this._container.offsetWidth},_animateZoom:function(e){var a=this._map._latLngToNewLayerPoint(this._latlng,e.zoom,e.center),f=this._getAnchor();ne(this._container,a.add(f))},_adjustPan:function(){if(!!this.options.autoPan){this._map._panAnim&&this._map._panAnim.stop();var e=this._map,a=parseInt(mi(this._container,"marginBottom"),10)||0,f=this._container.offsetHeight+a,m=this._containerWidth,b=new ot(this._containerLeft,-f-this._containerBottom);b._add(Je(this._container));var O=e.layerPointToContainerPoint(b),G=kt(this.options.autoPanPadding),X=kt(this.options.autoPanPaddingTopLeft||G),W=kt(this.options.autoPanPaddingBottomRight||G),at=e.getSize(),pt=0,wt=0;O.x+m+W.x>at.x&&(pt=O.x+m-at.x+W.x),O.x-pt-X.x<0&&(pt=O.x-X.x),O.y+f+W.y>at.y&&(wt=O.y+f-at.y+W.y),O.y-wt-X.y<0&&(wt=O.y-X.y),(pt||wt)&&e.fire("autopanstart").panBy([pt,wt])}},_onCloseButtonClick:function(e){this._close(),ke(e)},_getAnchor:function(){return kt(this._source&&this._source._getPopupAnchor?this._source._getPopupAnchor():[0,0])}}),dl=function(e,a){return new Mn(e,a)};Ft.mergeOptions({closePopupOnClick:!0}),Ft.include({openPopup:function(e,a,f){return e instanceof Mn||(e=new Mn(f).setContent(e)),a&&e.setLatLng(a),this.hasLayer(e)?this:(this._popup&&this._popup.options.autoClose&&this.closePopup(),this._popup=e,this.addLayer(e))},closePopup:function(e){return(!e||e===this._popup)&&(e=this._popup,this._popup=null),e&&this.removeLayer(e),this}}),g.include({bindPopup:function(e,a){return e instanceof Mn?(I(e,a),this._popup=e,e._source=this):((!this._popup||a)&&(this._popup=new Mn(a,this)),this._popup.setContent(e)),this._popupHandlersAdded||(this.on({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!0),this},unbindPopup:function(){return this._popup&&(this.off({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!1,this._popup=null),this},openPopup:function(e,a){return this._popup&&this._map&&(a=this._popup._prepareOpen(this,e,a),this._map.openPopup(this._popup,a)),this},closePopup:function(){return this._popup&&this._popup._close(),this},togglePopup:function(e){return this._popup&&(this._popup._map?this.closePopup():this.openPopup(e)),this},isPopupOpen:function(){return this._popup?this._popup.isOpen():!1},setPopupContent:function(e){return this._popup&&this._popup.setContent(e),this},getPopup:function(){return this._popup},_openPopup:function(e){var a=e.layer||e.target;if(!!this._popup&&!!this._map){if(ke(e),a instanceof ct){this.openPopup(e.layer||e.target,e.latlng);return}this._map.hasLayer(this._popup)&&this._popup._source===a?this.closePopup():this.openPopup(a,e.latlng)}},_movePopup:function(e){this._popup.setLatLng(e.latlng)},_onKeyPress:function(e){e.originalEvent.keyCode===13&&this._openPopup(e)}});var Pn=xi.extend({options:{pane:"tooltipPane",offset:[0,0],direction:"auto",permanent:!1,sticky:!1,interactive:!1,opacity:.9},onAdd:function(e){xi.prototype.onAdd.call(this,e),this.setOpacity(this.options.opacity),e.fire("tooltipopen",{tooltip:this}),this._source&&this._source.fire("tooltipopen",{tooltip:this},!0)},onRemove:function(e){xi.prototype.onRemove.call(this,e),e.fire("tooltipclose",{tooltip:this}),this._source&&this._source.fire("tooltipclose",{tooltip:this},!0)},getEvents:function(){var e=xi.prototype.getEvents.call(this);return Ee&&!this.options.permanent&&(e.preclick=this._close),e},_close:function(){this._map&&this._map.closeTooltip(this)},_initLayout:function(){var e="leaflet-tooltip",a=e+" "+(this.options.className||"")+" leaflet-zoom-"+(this._zoomAnimated?"animated":"hide");this._contentNode=this._container=Nt("div",a)},_updateLayout:function(){},_adjustPan:function(){},_setPosition:function(e){var a,f,m=this._map,b=this._container,O=m.latLngToContainerPoint(m.getCenter()),G=m.layerPointToContainerPoint(e),X=this.options.direction,W=b.offsetWidth,at=b.offsetHeight,pt=kt(this.options.offset),wt=this._getAnchor();X==="top"?(a=W/2,f=at):X==="bottom"?(a=W/2,f=0):X==="center"?(a=W/2,f=at/2):X==="right"?(a=0,f=at/2):X==="left"?(a=W,f=at/2):G.x<O.x?(X="right",a=0,f=at/2):(X="left",a=W+(pt.x+wt.x)*2,f=at/2),e=e.subtract(kt(a,f,!0)).add(pt).add(wt),ie(b,"leaflet-tooltip-right"),ie(b,"leaflet-tooltip-left"),ie(b,"leaflet-tooltip-top"),ie(b,"leaflet-tooltip-bottom"),Ct(b,"leaflet-tooltip-"+X),ne(b,e)},_updatePosition:function(){var e=this._map.latLngToLayerPoint(this._latlng);this._setPosition(e)},setOpacity:function(e){this.options.opacity=e,this._container&&Te(this._container,e)},_animateZoom:function(e){var a=this._map._latLngToNewLayerPoint(this._latlng,e.zoom,e.center);this._setPosition(a)},_getAnchor:function(){return kt(this._source&&this._source._getTooltipAnchor&&!this.options.sticky?this._source._getTooltipAnchor():[0,0])}}),pl=function(e,a){return new Pn(e,a)};Ft.include({openTooltip:function(e,a,f){return e instanceof Pn||(e=new Pn(f).setContent(e)),a&&e.setLatLng(a),this.hasLayer(e)?this:this.addLayer(e)},closeTooltip:function(e){return e&&this.removeLayer(e),this}}),g.include({bindTooltip:function(e,a){return e instanceof Pn?(I(e,a),this._tooltip=e,e._source=this):((!this._tooltip||a)&&(this._tooltip=new Pn(a,this)),this._tooltip.setContent(e)),this._initTooltipInteractions(),this._tooltip.options.permanent&&this._map&&this._map.hasLayer(this)&&this.openTooltip(),this},unbindTooltip:function(){return this._tooltip&&(this._initTooltipInteractions(!0),this.closeTooltip(),this._tooltip=null),this},_initTooltipInteractions:function(e){if(!(!e&&this._tooltipHandlersAdded)){var a=e?"off":"on",f={remove:this.closeTooltip,move:this._moveTooltip};this._tooltip.options.permanent?f.add=this._openTooltip:(f.mouseover=this._openTooltip,f.mouseout=this.closeTooltip,this._tooltip.options.sticky&&(f.mousemove=this._moveTooltip),Ee&&(f.click=this._openTooltip)),this[a](f),this._tooltipHandlersAdded=!e}},openTooltip:function(e,a){return this._tooltip&&this._map&&(a=this._tooltip._prepareOpen(this,e,a),this._map.openTooltip(this._tooltip,a),this._tooltip.options.interactive&&this._tooltip._container&&(Ct(this._tooltip._container,"leaflet-clickable"),this.addInteractiveTarget(this._tooltip._container))),this},closeTooltip:function(){return this._tooltip&&(this._tooltip._close(),this._tooltip.options.interactive&&this._tooltip._container&&(ie(this._tooltip._container,"leaflet-clickable"),this.removeInteractiveTarget(this._tooltip._container))),this},toggleTooltip:function(e){return this._tooltip&&(this._tooltip._map?this.closeTooltip():this.openTooltip(e)),this},isTooltipOpen:function(){return this._tooltip.isOpen()},setTooltipContent:function(e){return this._tooltip&&this._tooltip.setContent(e),this},getTooltip:function(){return this._tooltip},_openTooltip:function(e){var a=e.layer||e.target;!this._tooltip||!this._map||this.openTooltip(a,this._tooltip.options.sticky?e.latlng:void 0)},_moveTooltip:function(e){var a=e.latlng,f,m;this._tooltip.options.sticky&&e.originalEvent&&(f=this._map.mouseEventToContainerPoint(e.originalEvent),m=this._map.containerPointToLayerPoint(f),a=this._map.layerPointToLatLng(m)),this._tooltip.setLatLng(a)}});var xo=N.extend({options:{iconSize:[12,12],html:!1,bgPos:null,className:"leaflet-div-icon"},createIcon:function(e){var a=e&&e.tagName==="DIV"?e:document.createElement("div"),f=this.options;if(f.html instanceof Element?(dn(a),a.appendChild(f.html)):a.innerHTML=f.html!==!1?f.html:"",f.bgPos){var m=kt(f.bgPos);a.style.backgroundPosition=-m.x+"px "+-m.y+"px"}return this._setIconStyles(a,"icon"),a},createShadow:function(){return null}});function ml(e){return new xo(e)}N.Default=Y;var lr=g.extend({options:{tileSize:256,opacity:1,updateWhenIdle:fe,updateWhenZooming:!0,updateInterval:200,zIndex:1,bounds:null,minZoom:0,maxZoom:void 0,maxNativeZoom:void 0,minNativeZoom:void 0,noWrap:!1,pane:"tilePane",className:"",keepBuffer:2},initialize:function(e){I(this,e)},onAdd:function(){this._initContainer(),this._levels={},this._tiles={},this._resetView(),this._update()},beforeAdd:function(e){e._addZoomLimit(this)},onRemove:function(e){this._removeAllTiles(),Qt(this._container),e._removeZoomLimit(this),this._container=null,this._tileZoom=void 0},bringToFront:function(){return this._map&&(Xe(this._container),this._setAutoZIndex(Math.max)),this},bringToBack:function(){return this._map&&(Ci(this._container),this._setAutoZIndex(Math.min)),this},getContainer:function(){return this._container},setOpacity:function(e){return this.options.opacity=e,this._updateOpacity(),this},setZIndex:function(e){return this.options.zIndex=e,this._updateZIndex(),this},isLoading:function(){return this._loading},redraw:function(){return this._map&&(this._removeAllTiles(),this._update()),this},getEvents:function(){var e={viewprereset:this._invalidateAll,viewreset:this._resetView,zoom:this._resetView,moveend:this._onMoveEnd};return this.options.updateWhenIdle||(this._onMove||(this._onMove=_(this._onMoveEnd,this.options.updateInterval,this)),e.move=this._onMove),this._zoomAnimated&&(e.zoomanim=this._animateZoom),e},createTile:function(){return document.createElement("div")},getTileSize:function(){var e=this.options.tileSize;return e instanceof ot?e:new ot(e,e)},_updateZIndex:function(){this._container&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._container.style.zIndex=this.options.zIndex)},_setAutoZIndex:function(e){for(var a=this.getPane().children,f=-e(-1/0,1/0),m=0,b=a.length,O;m<b;m++)O=a[m].style.zIndex,a[m]!==this._container&&O&&(f=e(f,+O));isFinite(f)&&(this.options.zIndex=f+e(-1,1),this._updateZIndex())},_updateOpacity:function(){if(!!this._map&&!nt){Te(this._container,this.options.opacity);var e=+new Date,a=!1,f=!1;for(var m in this._tiles){var b=this._tiles[m];if(!(!b.current||!b.loaded)){var O=Math.min(1,(e-b.loaded)/200);Te(b.el,O),O<1?a=!0:(b.active?f=!0:this._onOpaqueTile(b),b.active=!0)}}f&&!this._noPrune&&this._pruneTiles(),a&&(vt(this._fadeFrame),this._fadeFrame=gt(this._updateOpacity,this))}},_onOpaqueTile:x,_initContainer:function(){this._container||(this._container=Nt("div","leaflet-layer "+(this.options.className||"")),this._updateZIndex(),this.options.opacity<1&&this._updateOpacity(),this.getPane().appendChild(this._container))},_updateLevels:function(){var e=this._tileZoom,a=this.options.maxZoom;if(e!==void 0){for(var f in this._levels)f=Number(f),this._levels[f].el.children.length||f===e?(this._levels[f].el.style.zIndex=a-Math.abs(e-f),this._onUpdateLevel(f)):(Qt(this._levels[f].el),this._removeTilesAtZoom(f),this._onRemoveLevel(f),delete this._levels[f]);var m=this._levels[e],b=this._map;return m||(m=this._levels[e]={},m.el=Nt("div","leaflet-tile-container leaflet-zoom-animated",this._container),m.el.style.zIndex=a,m.origin=b.project(b.unproject(b.getPixelOrigin()),e).round(),m.zoom=e,this._setZoomTransform(m,b.getCenter(),b.getZoom()),x(m.el.offsetWidth),this._onCreateLevel(m)),this._level=m,m}},_onUpdateLevel:x,_onRemoveLevel:x,_onCreateLevel:x,_pruneTiles:function(){if(!!this._map){var e,a,f=this._map.getZoom();if(f>this.options.maxZoom||f<this.options.minZoom){this._removeAllTiles();return}for(e in this._tiles)a=this._tiles[e],a.retain=a.current;for(e in this._tiles)if(a=this._tiles[e],a.current&&!a.active){var m=a.coords;this._retainParent(m.x,m.y,m.z,m.z-5)||this._retainChildren(m.x,m.y,m.z,m.z+2)}for(e in this._tiles)this._tiles[e].retain||this._removeTile(e)}},_removeTilesAtZoom:function(e){for(var a in this._tiles)this._tiles[a].coords.z===e&&this._removeTile(a)},_removeAllTiles:function(){for(var e in this._tiles)this._removeTile(e)},_invalidateAll:function(){for(var e in this._levels)Qt(this._levels[e].el),this._onRemoveLevel(Number(e)),delete this._levels[e];this._removeAllTiles(),this._tileZoom=void 0},_retainParent:function(e,a,f,m){var b=Math.floor(e/2),O=Math.floor(a/2),G=f-1,X=new ot(+b,+O);X.z=+G;var W=this._tileCoordsToKey(X),at=this._tiles[W];return at&&at.active?(at.retain=!0,!0):(at&&at.loaded&&(at.retain=!0),G>m?this._retainParent(b,O,G,m):!1)},_retainChildren:function(e,a,f,m){for(var b=2*e;b<2*e+2;b++)for(var O=2*a;O<2*a+2;O++){var G=new ot(b,O);G.z=f+1;var X=this._tileCoordsToKey(G),W=this._tiles[X];if(W&&W.active){W.retain=!0;continue}else W&&W.loaded&&(W.retain=!0);f+1<m&&this._retainChildren(b,O,f+1,m)}},_resetView:function(e){var a=e&&(e.pinch||e.flyTo);this._setView(this._map.getCenter(),this._map.getZoom(),a,a)},_animateZoom:function(e){this._setView(e.center,e.zoom,!0,e.noUpdate)},_clampZoom:function(e){var a=this.options;return a.minNativeZoom!==void 0&&e<a.minNativeZoom?a.minNativeZoom:a.maxNativeZoom!==void 0&&a.maxNativeZoom<e?a.maxNativeZoom:e},_setView:function(e,a,f,m){var b=Math.round(a);this.options.maxZoom!==void 0&&b>this.options.maxZoom||this.options.minZoom!==void 0&&b<this.options.minZoom?b=void 0:b=this._clampZoom(b);var O=this.options.updateWhenZooming&&b!==this._tileZoom;(!m||O)&&(this._tileZoom=b,this._abortLoading&&this._abortLoading(),this._updateLevels(),this._resetGrid(),b!==void 0&&this._update(e),f||this._pruneTiles(),this._noPrune=!!f),this._setZoomTransforms(e,a)},_setZoomTransforms:function(e,a){for(var f in this._levels)this._setZoomTransform(this._levels[f],e,a)},_setZoomTransform:function(e,a,f){var m=this._map.getZoomScale(f,e.zoom),b=e.origin.multiplyBy(m).subtract(this._map._getNewPixelOrigin(a,f)).round();Wt?Ye(e.el,b,m):ne(e.el,b)},_resetGrid:function(){var e=this._map,a=e.options.crs,f=this._tileSize=this.getTileSize(),m=this._tileZoom,b=this._map.getPixelWorldBounds(this._tileZoom);b&&(this._globalTileRange=this._pxBoundsToTileRange(b)),this._wrapX=a.wrapLng&&!this.options.noWrap&&[Math.floor(e.project([0,a.wrapLng[0]],m).x/f.x),Math.ceil(e.project([0,a.wrapLng[1]],m).x/f.y)],this._wrapY=a.wrapLat&&!this.options.noWrap&&[Math.floor(e.project([a.wrapLat[0],0],m).y/f.x),Math.ceil(e.project([a.wrapLat[1],0],m).y/f.y)]},_onMoveEnd:function(){!this._map||this._map._animatingZoom||this._update()},_getTiledPixelBounds:function(e){var a=this._map,f=a._animatingZoom?Math.max(a._animateToZoom,a.getZoom()):a.getZoom(),m=a.getZoomScale(f,this._tileZoom),b=a.project(e,this._tileZoom).floor(),O=a.getSize().divideBy(m*2);return new Rt(b.subtract(O),b.add(O))},_update:function(e){var a=this._map;if(!!a){var f=this._clampZoom(a.getZoom());if(e===void 0&&(e=a.getCenter()),this._tileZoom!==void 0){var m=this._getTiledPixelBounds(e),b=this._pxBoundsToTileRange(m),O=b.getCenter(),G=[],X=this.options.keepBuffer,W=new Rt(b.getBottomLeft().subtract([X,-X]),b.getTopRight().add([X,-X]));if(!(isFinite(b.min.x)&&isFinite(b.min.y)&&isFinite(b.max.x)&&isFinite(b.max.y)))throw new Error("Attempted to load an infinite number of tiles");for(var at in this._tiles){var pt=this._tiles[at].coords;(pt.z!==this._tileZoom||!W.contains(new ot(pt.x,pt.y)))&&(this._tiles[at].current=!1)}if(Math.abs(f-this._tileZoom)>1){this._setView(e,f);return}for(var wt=b.min.y;wt<=b.max.y;wt++)for(var Zt=b.min.x;Zt<=b.max.x;Zt++){var Li=new ot(Zt,wt);if(Li.z=this._tileZoom,!!this._isValidTile(Li)){var Ji=this._tiles[this._tileCoordsToKey(Li)];Ji?Ji.current=!0:G.push(Li)}}if(G.sort(function(Di,Ss){return Di.distanceTo(O)-Ss.distanceTo(O)}),G.length!==0){this._loading||(this._loading=!0,this.fire("loading"));var Fr=document.createDocumentFragment();for(Zt=0;Zt<G.length;Zt++)this._addTile(G[Zt],Fr);this._level.el.appendChild(Fr)}}}},_isValidTile:function(e){var a=this._map.options.crs;if(!a.infinite){var f=this._globalTileRange;if(!a.wrapLng&&(e.x<f.min.x||e.x>f.max.x)||!a.wrapLat&&(e.y<f.min.y||e.y>f.max.y))return!1}if(!this.options.bounds)return!0;var m=this._tileCoordsToBounds(e);return $t(this.options.bounds).overlaps(m)},_keyToBounds:function(e){return this._tileCoordsToBounds(this._keyToTileCoords(e))},_tileCoordsToNwSe:function(e){var a=this._map,f=this.getTileSize(),m=e.scaleBy(f),b=m.add(f),O=a.unproject(m,e.z),G=a.unproject(b,e.z);return[O,G]},_tileCoordsToBounds:function(e){var a=this._tileCoordsToNwSe(e),f=new Kt(a[0],a[1]);return this.options.noWrap||(f=this._map.wrapLatLngBounds(f)),f},_tileCoordsToKey:function(e){return e.x+":"+e.y+":"+e.z},_keyToTileCoords:function(e){var a=e.split(":"),f=new ot(+a[0],+a[1]);return f.z=+a[2],f},_removeTile:function(e){var a=this._tiles[e];!a||(Qt(a.el),delete this._tiles[e],this.fire("tileunload",{tile:a.el,coords:this._keyToTileCoords(e)}))},_initTile:function(e){Ct(e,"leaflet-tile");var a=this.getTileSize();e.style.width=a.x+"px",e.style.height=a.y+"px",e.onselectstart=x,e.onmousemove=x,nt&&this.options.opacity<1&&Te(e,this.options.opacity),St&&!Pt&&(e.style.WebkitBackfaceVisibility="hidden")},_addTile:function(e,a){var f=this._getTilePos(e),m=this._tileCoordsToKey(e),b=this.createTile(this._wrapCoords(e),c(this._tileReady,this,e));this._initTile(b),this.createTile.length<2&&gt(c(this._tileReady,this,e,null,b)),ne(b,f),this._tiles[m]={el:b,coords:e,current:!0},a.appendChild(b),this.fire("tileloadstart",{tile:b,coords:e})},_tileReady:function(e,a,f){a&&this.fire("tileerror",{error:a,tile:f,coords:e});var m=this._tileCoordsToKey(e);f=this._tiles[m],!!f&&(f.loaded=+new Date,this._map._fadeAnimated?(Te(f.el,0),vt(this._fadeFrame),this._fadeFrame=gt(this._updateOpacity,this)):(f.active=!0,this._pruneTiles()),a||(Ct(f.el,"leaflet-tile-loaded"),this.fire("tileload",{tile:f.el,coords:e})),this._noTilesToLoad()&&(this._loading=!1,this.fire("load"),nt||!this._map._fadeAnimated?gt(this._pruneTiles,this):setTimeout(c(this._pruneTiles,this),250)))},_getTilePos:function(e){return e.scaleBy(this.getTileSize()).subtract(this._level.origin)},_wrapCoords:function(e){var a=new ot(this._wrapX?v(e.x,this._wrapX):e.x,this._wrapY?v(e.y,this._wrapY):e.y);return a.z=e.z,a},_pxBoundsToTileRange:function(e){var a=this.getTileSize();return new Rt(e.min.unscaleBy(a).floor(),e.max.unscaleBy(a).ceil().subtract([1,1]))},_noTilesToLoad:function(){for(var e in this._tiles)if(!this._tiles[e].loaded)return!1;return!0}});function gl(e){return new lr(e)}var Sn=lr.extend({options:{minZoom:0,maxZoom:18,subdomains:"abc",errorTileUrl:"",zoomOffset:0,tms:!1,zoomReverse:!1,detectRetina:!1,crossOrigin:!1},initialize:function(e,a){this._url=e,a=I(this,a),a.detectRetina&&$e&&a.maxZoom>0&&(a.tileSize=Math.floor(a.tileSize/2),a.zoomReverse?(a.zoomOffset--,a.minZoom++):(a.zoomOffset++,a.maxZoom--),a.minZoom=Math.max(0,a.minZoom)),typeof a.subdomains=="string"&&(a.subdomains=a.subdomains.split("")),St||this.on("tileunload",this._onTileRemove)},setUrl:function(e,a){return this._url===e&&a===void 0&&(a=!0),this._url=e,a||this.redraw(),this},createTile:function(e,a){var f=document.createElement("img");return Tt(f,"load",c(this._tileOnLoad,this,a,f)),Tt(f,"error",c(this._tileOnError,this,a,f)),(this.options.crossOrigin||this.options.crossOrigin==="")&&(f.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),f.alt="",f.setAttribute("role","presentation"),f.src=this.getTileUrl(e),f},getTileUrl:function(e){var a={r:$e?"@2x":"",s:this._getSubdomain(e),x:e.x,y:e.y,z:this._getZoomForUrl()};if(this._map&&!this._map.options.crs.infinite){var f=this._globalTileRange.max.y-e.y;this.options.tms&&(a.y=f),a["-y"]=f}return E(this._url,o(a,this.options))},_tileOnLoad:function(e,a){nt?setTimeout(c(e,this,null,a),0):e(null,a)},_tileOnError:function(e,a,f){var m=this.options.errorTileUrl;m&&a.getAttribute("src")!==m&&(a.src=m),e(f,a)},_onTileRemove:function(e){e.tile.onload=null},_getZoomForUrl:function(){var e=this._tileZoom,a=this.options.maxZoom,f=this.options.zoomReverse,m=this.options.zoomOffset;return f&&(e=a-e),e+m},_getSubdomain:function(e){var a=Math.abs(e.x+e.y)%this.options.subdomains.length;return this.options.subdomains[a]},_abortLoading:function(){var e,a;for(e in this._tiles)this._tiles[e].coords.z!==this._tileZoom&&(a=this._tiles[e].el,a.onload=x,a.onerror=x,a.complete||(a.src=q,Qt(a),delete this._tiles[e]))},_removeTile:function(e){var a=this._tiles[e];if(!!a)return Et||a.el.setAttribute("src",q),lr.prototype._removeTile.call(this,e)},_tileReady:function(e,a,f){if(!(!this._map||f&&f.getAttribute("src")===q))return lr.prototype._tileReady.call(this,e,a,f)}});function Lo(e,a){return new Sn(e,a)}var wo=Sn.extend({defaultWmsParams:{service:"WMS",request:"GetMap",layers:"",styles:"",format:"image/jpeg",transparent:!1,version:"1.1.1"},options:{crs:null,uppercase:!1},initialize:function(e,a){this._url=e;var f=o({},this.defaultWmsParams);for(var m in a)m in this.options||(f[m]=a[m]);a=I(this,a);var b=a.detectRetina&&$e?2:1,O=this.getTileSize();f.width=O.x*b,f.height=O.y*b,this.wmsParams=f},onAdd:function(e){this._crs=this.options.crs||e.options.crs,this._wmsVersion=parseFloat(this.wmsParams.version);var a=this._wmsVersion>=1.3?"crs":"srs";this.wmsParams[a]=this._crs.code,Sn.prototype.onAdd.call(this,e)},getTileUrl:function(e){var a=this._tileCoordsToNwSe(e),f=this._crs,m=se(f.project(a[0]),f.project(a[1])),b=m.min,O=m.max,G=(this._wmsVersion>=1.3&&this._crs===u?[b.y,b.x,O.y,O.x]:[b.x,b.y,O.x,O.y]).join(","),X=Sn.prototype.getTileUrl.call(this,e);return X+R(this.wmsParams,X,this.options.uppercase)+(this.options.uppercase?"&BBOX=":"&bbox=")+G},setParams:function(e,a){return o(this.wmsParams,e),a||this.redraw(),this}});function _l(e,a){return new wo(e,a)}Sn.WMS=wo,Lo.wms=_l;var oi=g.extend({options:{padding:.1,tolerance:0},initialize:function(e){I(this,e),y(this),this._layers=this._layers||{}},onAdd:function(){this._container||(this._initContainer(),this._zoomAnimated&&Ct(this._container,"leaflet-zoom-animated")),this.getPane().appendChild(this._container),this._update(),this.on("update",this._updatePaths,this)},onRemove:function(){this.off("update",this._updatePaths,this),this._destroyContainer()},getEvents:function(){var e={viewreset:this._reset,zoom:this._onZoom,moveend:this._update,zoomend:this._onZoomEnd};return this._zoomAnimated&&(e.zoomanim=this._onAnimZoom),e},_onAnimZoom:function(e){this._updateTransform(e.center,e.zoom)},_onZoom:function(){this._updateTransform(this._map.getCenter(),this._map.getZoom())},_updateTransform:function(e,a){var f=this._map.getZoomScale(a,this._zoom),m=Je(this._container),b=this._map.getSize().multiplyBy(.5+this.options.padding),O=this._map.project(this._center,a),G=this._map.project(e,a),X=G.subtract(O),W=b.multiplyBy(-f).add(m).add(b).subtract(X);Wt?Ye(this._container,W,f):ne(this._container,W)},_reset:function(){this._update(),this._updateTransform(this._center,this._zoom);for(var e in this._layers)this._layers[e]._reset()},_onZoomEnd:function(){for(var e in this._layers)this._layers[e]._project()},_updatePaths:function(){for(var e in this._layers)this._layers[e]._update()},_update:function(){var e=this.options.padding,a=this._map.getSize(),f=this._map.containerPointToLayerPoint(a.multiplyBy(-e)).round();this._bounds=new Rt(f,f.add(a.multiplyBy(1+e*2)).round()),this._center=this._map.getCenter(),this._zoom=this._map.getZoom()}}),ko=oi.extend({getEvents:function(){var e=oi.prototype.getEvents.call(this);return e.viewprereset=this._onViewPreReset,e},_onViewPreReset:function(){this._postponeUpdatePaths=!0},onAdd:function(){oi.prototype.onAdd.call(this),this._draw()},_initContainer:function(){var e=this._container=document.createElement("canvas");Tt(e,"mousemove",this._onMouseMove,this),Tt(e,"click dblclick mousedown mouseup contextmenu",this._onClick,this),Tt(e,"mouseout",this._handleMouseOut,this),this._ctx=e.getContext("2d")},_destroyContainer:function(){vt(this._redrawRequest),delete this._ctx,Qt(this._container),te(this._container),delete this._container},_updatePaths:function(){if(!this._postponeUpdatePaths){var e;this._redrawBounds=null;for(var a in this._layers)e=this._layers[a],e._update();this._redraw()}},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){oi.prototype._update.call(this);var e=this._bounds,a=this._container,f=e.getSize(),m=$e?2:1;ne(a,e.min),a.width=m*f.x,a.height=m*f.y,a.style.width=f.x+"px",a.style.height=f.y+"px",$e&&this._ctx.scale(2,2),this._ctx.translate(-e.min.x,-e.min.y),this.fire("update")}},_reset:function(){oi.prototype._reset.call(this),this._postponeUpdatePaths&&(this._postponeUpdatePaths=!1,this._updatePaths())},_initPath:function(e){this._updateDashArray(e),this._layers[y(e)]=e;var a=e._order={layer:e,prev:this._drawLast,next:null};this._drawLast&&(this._drawLast.next=a),this._drawLast=a,this._drawFirst=this._drawFirst||this._drawLast},_addPath:function(e){this._requestRedraw(e)},_removePath:function(e){var a=e._order,f=a.next,m=a.prev;f?f.prev=m:this._drawLast=m,m?m.next=f:this._drawFirst=f,delete e._order,delete this._layers[y(e)],this._requestRedraw(e)},_updatePath:function(e){this._extendRedrawBounds(e),e._project(),e._update(),this._requestRedraw(e)},_updateStyle:function(e){this._updateDashArray(e),this._requestRedraw(e)},_updateDashArray:function(e){if(typeof e.options.dashArray=="string"){var a=e.options.dashArray.split(/[, ]+/),f=[],m,b;for(b=0;b<a.length;b++){if(m=Number(a[b]),isNaN(m))return;f.push(m)}e.options._dashArray=f}else e.options._dashArray=e.options.dashArray},_requestRedraw:function(e){!this._map||(this._extendRedrawBounds(e),this._redrawRequest=this._redrawRequest||gt(this._redraw,this))},_extendRedrawBounds:function(e){if(e._pxBounds){var a=(e.options.weight||0)+1;this._redrawBounds=this._redrawBounds||new Rt,this._redrawBounds.extend(e._pxBounds.min.subtract([a,a])),this._redrawBounds.extend(e._pxBounds.max.add([a,a]))}},_redraw:function(){this._redrawRequest=null,this._redrawBounds&&(this._redrawBounds.min._floor(),this._redrawBounds.max._ceil()),this._clear(),this._draw(),this._redrawBounds=null},_clear:function(){var e=this._redrawBounds;if(e){var a=e.getSize();this._ctx.clearRect(e.min.x,e.min.y,a.x,a.y)}else this._ctx.save(),this._ctx.setTransform(1,0,0,1,0,0),this._ctx.clearRect(0,0,this._container.width,this._container.height),this._ctx.restore()},_draw:function(){var e,a=this._redrawBounds;if(this._ctx.save(),a){var f=a.getSize();this._ctx.beginPath(),this._ctx.rect(a.min.x,a.min.y,f.x,f.y),this._ctx.clip()}this._drawing=!0;for(var m=this._drawFirst;m;m=m.next)e=m.layer,(!a||e._pxBounds&&e._pxBounds.intersects(a))&&e._updatePath();this._drawing=!1,this._ctx.restore()},_updatePoly:function(e,a){if(!!this._drawing){var f,m,b,O,G=e._parts,X=G.length,W=this._ctx;if(!!X){for(W.beginPath(),f=0;f<X;f++){for(m=0,b=G[f].length;m<b;m++)O=G[f][m],W[m?"lineTo":"moveTo"](O.x,O.y);a&&W.closePath()}this._fillStroke(W,e)}}},_updateCircle:function(e){if(!(!this._drawing||e._empty())){var a=e._point,f=this._ctx,m=Math.max(Math.round(e._radius),1),b=(Math.max(Math.round(e._radiusY),1)||m)/m;b!==1&&(f.save(),f.scale(1,b)),f.beginPath(),f.arc(a.x,a.y/b,m,0,Math.PI*2,!1),b!==1&&f.restore(),this._fillStroke(f,e)}},_fillStroke:function(e,a){var f=a.options;f.fill&&(e.globalAlpha=f.fillOpacity,e.fillStyle=f.fillColor||f.color,e.fill(f.fillRule||"evenodd")),f.stroke&&f.weight!==0&&(e.setLineDash&&e.setLineDash(a.options&&a.options._dashArray||[]),e.globalAlpha=f.opacity,e.lineWidth=f.weight,e.strokeStyle=f.color,e.lineCap=f.lineCap,e.lineJoin=f.lineJoin,e.stroke())},_onClick:function(e){for(var a=this._map.mouseEventToLayerPoint(e),f,m,b=this._drawFirst;b;b=b.next)f=b.layer,f.options.interactive&&f._containsPoint(a)&&(!(e.type==="click"||e.type!=="preclick")||!this._map._draggableMoved(f))&&(m=f);m&&($i(e),this._fireEvent([m],e))},_onMouseMove:function(e){if(!(!this._map||this._map.dragging.moving()||this._map._animatingZoom)){var a=this._map.mouseEventToLayerPoint(e);this._handleMouseHover(e,a)}},_handleMouseOut:function(e){var a=this._hoveredLayer;a&&(ie(this._container,"leaflet-interactive"),this._fireEvent([a],e,"mouseout"),this._hoveredLayer=null,this._mouseHoverThrottled=!1)},_handleMouseHover:function(e,a){if(!this._mouseHoverThrottled){for(var f,m,b=this._drawFirst;b;b=b.next)f=b.layer,f.options.interactive&&f._containsPoint(a)&&(m=f);m!==this._hoveredLayer&&(this._handleMouseOut(e),m&&(Ct(this._container,"leaflet-interactive"),this._fireEvent([m],e,"mouseover"),this._hoveredLayer=m)),this._hoveredLayer&&this._fireEvent([this._hoveredLayer],e),this._mouseHoverThrottled=!0,setTimeout(c(function(){this._mouseHoverThrottled=!1},this),32)}},_fireEvent:function(e,a,f){this._map._fireDOMEvent(a,f||a.type,e)},_bringToFront:function(e){var a=e._order;if(!!a){var f=a.next,m=a.prev;if(f)f.prev=m;else return;m?m.next=f:f&&(this._drawFirst=f),a.prev=this._drawLast,this._drawLast.next=a,a.next=null,this._drawLast=a,this._requestRedraw(e)}},_bringToBack:function(e){var a=e._order;if(!!a){var f=a.next,m=a.prev;if(m)m.next=f;else return;f?f.prev=m:m&&(this._drawLast=m),a.prev=null,a.next=this._drawFirst,this._drawFirst.prev=a,this._drawFirst=a,this._requestRedraw(e)}}});function Mo(e){return di?new ko(e):null}var hr=function(){try{return document.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(e){return document.createElement("<lvml:"+e+' class="lvml">')}}catch{return function(a){return document.createElement("<"+a+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')}}}(),yl={_initContainer:function(){this._container=Nt("div","leaflet-vml-container")},_update:function(){this._map._animatingZoom||(oi.prototype._update.call(this),this.fire("update"))},_initPath:function(e){var a=e._container=hr("shape");Ct(a,"leaflet-vml-shape "+(this.options.className||"")),a.coordsize="1 1",e._path=hr("path"),a.appendChild(e._path),this._updateStyle(e),this._layers[y(e)]=e},_addPath:function(e){var a=e._container;this._container.appendChild(a),e.options.interactive&&e.addInteractiveTarget(a)},_removePath:function(e){var a=e._container;Qt(a),e.removeInteractiveTarget(a),delete this._layers[y(e)]},_updateStyle:function(e){var a=e._stroke,f=e._fill,m=e.options,b=e._container;b.stroked=!!m.stroke,b.filled=!!m.fill,m.stroke?(a||(a=e._stroke=hr("stroke")),b.appendChild(a),a.weight=m.weight+"px",a.color=m.color,a.opacity=m.opacity,m.dashArray?a.dashStyle=z(m.dashArray)?m.dashArray.join(" "):m.dashArray.replace(/( *, *)/g," "):a.dashStyle="",a.endcap=m.lineCap.replace("butt","flat"),a.joinstyle=m.lineJoin):a&&(b.removeChild(a),e._stroke=null),m.fill?(f||(f=e._fill=hr("fill")),b.appendChild(f),f.color=m.fillColor||m.color,f.opacity=m.fillOpacity):f&&(b.removeChild(f),e._fill=null)},_updateCircle:function(e){var a=e._point.round(),f=Math.round(e._radius),m=Math.round(e._radiusY||f);this._setPath(e,e._empty()?"M0 0":"AL "+a.x+","+a.y+" "+f+","+m+" 0,"+65535*360)},_setPath:function(e,a){e._path.v=a},_bringToFront:function(e){Xe(e._container)},_bringToBack:function(e){Ci(e._container)}},Nr=Mi?hr:U,ur=oi.extend({getEvents:function(){var e=oi.prototype.getEvents.call(this);return e.zoomstart=this._onZoomStart,e},_initContainer:function(){this._container=Nr("svg"),this._container.setAttribute("pointer-events","none"),this._rootGroup=Nr("g"),this._container.appendChild(this._rootGroup)},_destroyContainer:function(){Qt(this._container),te(this._container),delete this._container,delete this._rootGroup,delete this._svgSize},_onZoomStart:function(){this._update()},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){oi.prototype._update.call(this);var e=this._bounds,a=e.getSize(),f=this._container;(!this._svgSize||!this._svgSize.equals(a))&&(this._svgSize=a,f.setAttribute("width",a.x),f.setAttribute("height",a.y)),ne(f,e.min),f.setAttribute("viewBox",[e.min.x,e.min.y,a.x,a.y].join(" ")),this.fire("update")}},_initPath:function(e){var a=e._path=Nr("path");e.options.className&&Ct(a,e.options.className),e.options.interactive&&Ct(a,"leaflet-interactive"),this._updateStyle(e),this._layers[y(e)]=e},_addPath:function(e){this._rootGroup||this._initContainer(),this._rootGroup.appendChild(e._path),e.addInteractiveTarget(e._path)},_removePath:function(e){Qt(e._path),e.removeInteractiveTarget(e._path),delete this._layers[y(e)]},_updatePath:function(e){e._project(),e._update()},_updateStyle:function(e){var a=e._path,f=e.options;!a||(f.stroke?(a.setAttribute("stroke",f.color),a.setAttribute("stroke-opacity",f.opacity),a.setAttribute("stroke-width",f.weight),a.setAttribute("stroke-linecap",f.lineCap),a.setAttribute("stroke-linejoin",f.lineJoin),f.dashArray?a.setAttribute("stroke-dasharray",f.dashArray):a.removeAttribute("stroke-dasharray"),f.dashOffset?a.setAttribute("stroke-dashoffset",f.dashOffset):a.removeAttribute("stroke-dashoffset")):a.setAttribute("stroke","none"),f.fill?(a.setAttribute("fill",f.fillColor||f.color),a.setAttribute("fill-opacity",f.fillOpacity),a.setAttribute("fill-rule",f.fillRule||"evenodd")):a.setAttribute("fill","none"))},_updatePoly:function(e,a){this._setPath(e,Z(e._parts,a))},_updateCircle:function(e){var a=e._point,f=Math.max(Math.round(e._radius),1),m=Math.max(Math.round(e._radiusY),1)||f,b="a"+f+","+m+" 0 1,0 ",O=e._empty()?"M0 0":"M"+(a.x-f)+","+a.y+b+f*2+",0 "+b+-f*2+",0 ";this._setPath(e,O)},_setPath:function(e,a){e._path.setAttribute("d",a)},_bringToFront:function(e){Xe(e._path)},_bringToBack:function(e){Ci(e._path)}});Mi&&ur.include(yl);function Po(e){return ln||Mi?new ur(e):null}Ft.include({getRenderer:function(e){var a=e.options.renderer||this._getPaneRenderer(e.options.pane)||this.options.renderer||this._renderer;return a||(a=this._renderer=this._createRenderer()),this.hasLayer(a)||this.addLayer(a),a},_getPaneRenderer:function(e){if(e==="overlayPane"||e===void 0)return!1;var a=this._paneRenderers[e];return a===void 0&&(a=this._createRenderer({pane:e}),this._paneRenderers[e]=a),a},_createRenderer:function(e){return this.options.preferCanvas&&Mo(e)||Po(e)}});var So=Me.extend({initialize:function(e,a){Me.prototype.initialize.call(this,this._boundsToLatLngs(e),a)},setBounds:function(e){return this.setLatLngs(this._boundsToLatLngs(e))},_boundsToLatLngs:function(e){return e=$t(e),[e.getSouthWest(),e.getNorthWest(),e.getNorthEast(),e.getSouthEast()]}});function vl(e,a){return new So(e,a)}ur.create=Nr,ur.pointsToPath=Z,Ne.geometryToLayer=Qe,Ne.coordsToLatLng=Ln,Ne.coordsToLatLngs=wn,Ne.latLngToCoords=Yi,Ne.latLngsToCoords=kn,Ne.getFeature=Bi,Ne.asFeature=Rr,Ft.mergeOptions({boxZoom:!0});var Co=Ze.extend({initialize:function(e){this._map=e,this._container=e._container,this._pane=e._panes.overlayPane,this._resetStateTimeout=0,e.on("unload",this._destroy,this)},addHooks:function(){Tt(this._container,"mousedown",this._onMouseDown,this)},removeHooks:function(){te(this._container,"mousedown",this._onMouseDown,this)},moved:function(){return this._moved},_destroy:function(){Qt(this._pane),delete this._pane},_resetState:function(){this._resetStateTimeout=0,this._moved=!1},_clearDeferredResetState:function(){this._resetStateTimeout!==0&&(clearTimeout(this._resetStateTimeout),this._resetStateTimeout=0)},_onMouseDown:function(e){if(!e.shiftKey||e.which!==1&&e.button!==1)return!1;this._clearDeferredResetState(),this._resetState(),Zi(),Zn(),this._startPoint=this._map.mouseEventToContainerPoint(e),Tt(document,{contextmenu:ke,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseMove:function(e){this._moved||(this._moved=!0,this._box=Nt("div","leaflet-zoom-box",this._container),Ct(this._container,"leaflet-crosshair"),this._map.fire("boxzoomstart")),this._point=this._map.mouseEventToContainerPoint(e);var a=new Rt(this._point,this._startPoint),f=a.getSize();ne(this._box,a.min),this._box.style.width=f.x+"px",this._box.style.height=f.y+"px"},_finish:function(){this._moved&&(Qt(this._box),ie(this._container,"leaflet-crosshair")),qi(),qn(),te(document,{contextmenu:ke,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseUp:function(e){if(!(e.which!==1&&e.button!==1)&&(this._finish(),!!this._moved)){this._clearDeferredResetState(),this._resetStateTimeout=setTimeout(c(this._resetState,this),0);var a=new Kt(this._map.containerPointToLatLng(this._startPoint),this._map.containerPointToLatLng(this._point));this._map.fitBounds(a).fire("boxzoomend",{boxZoomBounds:a})}},_onKeyDown:function(e){e.keyCode===27&&this._finish()}});Ft.addInitHook("addHandler","boxZoom",Co),Ft.mergeOptions({doubleClickZoom:!0});var Eo=Ze.extend({addHooks:function(){this._map.on("dblclick",this._onDoubleClick,this)},removeHooks:function(){this._map.off("dblclick",this._onDoubleClick,this)},_onDoubleClick:function(e){var a=this._map,f=a.getZoom(),m=a.options.zoomDelta,b=e.originalEvent.shiftKey?f-m:f+m;a.options.doubleClickZoom==="center"?a.setZoom(b):a.setZoomAround(e.containerPoint,b)}});Ft.addInitHook("addHandler","doubleClickZoom",Eo),Ft.mergeOptions({dragging:!0,inertia:!Pt,inertiaDeceleration:3400,inertiaMaxSpeed:1/0,easeLinearity:.2,worldCopyJump:!1,maxBoundsViscosity:0});var To=Ze.extend({addHooks:function(){if(!this._draggable){var e=this._map;this._draggable=new ri(e._mapPane,e._container),this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this),this._draggable.on("predrag",this._onPreDragLimit,this),e.options.worldCopyJump&&(this._draggable.on("predrag",this._onPreDragWrap,this),e.on("zoomend",this._onZoomEnd,this),e.whenReady(this._onZoomEnd,this))}Ct(this._map._container,"leaflet-grab leaflet-touch-drag"),this._draggable.enable(),this._positions=[],this._times=[]},removeHooks:function(){ie(this._map._container,"leaflet-grab"),ie(this._map._container,"leaflet-touch-drag"),this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},moving:function(){return this._draggable&&this._draggable._moving},_onDragStart:function(){var e=this._map;if(e._stop(),this._map.options.maxBounds&&this._map.options.maxBoundsViscosity){var a=$t(this._map.options.maxBounds);this._offsetLimit=se(this._map.latLngToContainerPoint(a.getNorthWest()).multiplyBy(-1),this._map.latLngToContainerPoint(a.getSouthEast()).multiplyBy(-1).add(this._map.getSize())),this._viscosity=Math.min(1,Math.max(0,this._map.options.maxBoundsViscosity))}else this._offsetLimit=null;e.fire("movestart").fire("dragstart"),e.options.inertia&&(this._positions=[],this._times=[])},_onDrag:function(e){if(this._map.options.inertia){var a=this._lastTime=+new Date,f=this._lastPos=this._draggable._absPos||this._draggable._newPos;this._positions.push(f),this._times.push(a),this._prunePositions(a)}this._map.fire("move",e).fire("drag",e)},_prunePositions:function(e){for(;this._positions.length>1&&e-this._times[0]>50;)this._positions.shift(),this._times.shift()},_onZoomEnd:function(){var e=this._map.getSize().divideBy(2),a=this._map.latLngToLayerPoint([0,0]);this._initialWorldOffset=a.subtract(e).x,this._worldWidth=this._map.getPixelWorldBounds().getSize().x},_viscousLimit:function(e,a){return e-(e-a)*this._viscosity},_onPreDragLimit:function(){if(!(!this._viscosity||!this._offsetLimit)){var e=this._draggable._newPos.subtract(this._draggable._startPos),a=this._offsetLimit;e.x<a.min.x&&(e.x=this._viscousLimit(e.x,a.min.x)),e.y<a.min.y&&(e.y=this._viscousLimit(e.y,a.min.y)),e.x>a.max.x&&(e.x=this._viscousLimit(e.x,a.max.x)),e.y>a.max.y&&(e.y=this._viscousLimit(e.y,a.max.y)),this._draggable._newPos=this._draggable._startPos.add(e)}},_onPreDragWrap:function(){var e=this._worldWidth,a=Math.round(e/2),f=this._initialWorldOffset,m=this._draggable._newPos.x,b=(m-a+f)%e+a-f,O=(m+a+f)%e-a-f,G=Math.abs(b+f)<Math.abs(O+f)?b:O;this._draggable._absPos=this._draggable._newPos.clone(),this._draggable._newPos.x=G},_onDragEnd:function(e){var a=this._map,f=a.options,m=!f.inertia||this._times.length<2;if(a.fire("dragend",e),m)a.fire("moveend");else{this._prunePositions(+new Date);var b=this._lastPos.subtract(this._positions[0]),O=(this._lastTime-this._times[0])/1e3,G=f.easeLinearity,X=b.multiplyBy(G/O),W=X.distanceTo([0,0]),at=Math.min(f.inertiaMaxSpeed,W),pt=X.multiplyBy(at/W),wt=at/(f.inertiaDeceleration*G),Zt=pt.multiplyBy(-wt/2).round();!Zt.x&&!Zt.y?a.fire("moveend"):(Zt=a._limitOffset(Zt,a.options.maxBounds),gt(function(){a.panBy(Zt,{duration:wt,easeLinearity:G,noMoveStart:!0,animate:!0})}))}}});Ft.addInitHook("addHandler","dragging",To),Ft.mergeOptions({keyboard:!0,keyboardPanDelta:80});var Oo=Ze.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],zoomIn:[187,107,61,171],zoomOut:[189,109,54,173]},initialize:function(e){this._map=e,this._setPanDelta(e.options.keyboardPanDelta),this._setZoomDelta(e.options.zoomDelta)},addHooks:function(){var e=this._map._container;e.tabIndex<=0&&(e.tabIndex="0"),Tt(e,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.on({focus:this._addHooks,blur:this._removeHooks},this)},removeHooks:function(){this._removeHooks(),te(this._map._container,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.off({focus:this._addHooks,blur:this._removeHooks},this)},_onMouseDown:function(){if(!this._focused){var e=document.body,a=document.documentElement,f=e.scrollTop||a.scrollTop,m=e.scrollLeft||a.scrollLeft;this._map._container.focus(),window.scrollTo(m,f)}},_onFocus:function(){this._focused=!0,this._map.fire("focus")},_onBlur:function(){this._focused=!1,this._map.fire("blur")},_setPanDelta:function(e){var a=this._panKeys={},f=this.keyCodes,m,b;for(m=0,b=f.left.length;m<b;m++)a[f.left[m]]=[-1*e,0];for(m=0,b=f.right.length;m<b;m++)a[f.right[m]]=[e,0];for(m=0,b=f.down.length;m<b;m++)a[f.down[m]]=[0,e];for(m=0,b=f.up.length;m<b;m++)a[f.up[m]]=[0,-1*e]},_setZoomDelta:function(e){var a=this._zoomKeys={},f=this.keyCodes,m,b;for(m=0,b=f.zoomIn.length;m<b;m++)a[f.zoomIn[m]]=e;for(m=0,b=f.zoomOut.length;m<b;m++)a[f.zoomOut[m]]=-e},_addHooks:function(){Tt(document,"keydown",this._onKeyDown,this)},_removeHooks:function(){te(document,"keydown",this._onKeyDown,this)},_onKeyDown:function(e){if(!(e.altKey||e.ctrlKey||e.metaKey)){var a=e.keyCode,f=this._map,m;if(a in this._panKeys)(!f._panAnim||!f._panAnim._inProgress)&&(m=this._panKeys[a],e.shiftKey&&(m=kt(m).multiplyBy(3)),f.panBy(m),f.options.maxBounds&&f.panInsideBounds(f.options.maxBounds));else if(a in this._zoomKeys)f.setZoom(f.getZoom()+(e.shiftKey?3:1)*this._zoomKeys[a]);else if(a===27&&f._popup&&f._popup.options.closeOnEscapeKey)f.closePopup();else return;ke(e)}}});Ft.addInitHook("addHandler","keyboard",Oo),Ft.mergeOptions({scrollWheelZoom:!0,wheelDebounceTime:40,wheelPxPerZoomLevel:60});var Io=Ze.extend({addHooks:function(){Tt(this._map._container,"wheel",this._onWheelScroll,this),this._delta=0},removeHooks:function(){te(this._map._container,"wheel",this._onWheelScroll,this)},_onWheelScroll:function(e){var a=Hn(e),f=this._map.options.wheelDebounceTime;this._delta+=a,this._lastMousePos=this._map.mouseEventToContainerPoint(e),this._startTime||(this._startTime=+new Date);var m=Math.max(f-(+new Date-this._startTime),0);clearTimeout(this._timer),this._timer=setTimeout(c(this._performZoom,this),m),ke(e)},_performZoom:function(){var e=this._map,a=e.getZoom(),f=this._map.options.zoomSnap||0;e._stop();var m=this._delta/(this._map.options.wheelPxPerZoomLevel*4),b=4*Math.log(2/(1+Math.exp(-Math.abs(m))))/Math.LN2,O=f?Math.ceil(b/f)*f:b,G=e._limitZoom(a+(this._delta>0?O:-O))-a;this._delta=0,this._startTime=null,!!G&&(e.options.scrollWheelZoom==="center"?e.setZoom(a+G):e.setZoomAround(this._lastMousePos,a+G))}});Ft.addInitHook("addHandler","scrollWheelZoom",Io),Ft.mergeOptions({tap:!0,tapTolerance:15});var Ao=Ze.extend({addHooks:function(){Tt(this._map._container,"touchstart",this._onDown,this)},removeHooks:function(){te(this._map._container,"touchstart",this._onDown,this)},_onDown:function(e){if(!!e.touches){if(be(e),this._fireClick=!0,e.touches.length>1){this._fireClick=!1,clearTimeout(this._holdTimeout);return}var a=e.touches[0],f=a.target;this._startPos=this._newPos=new ot(a.clientX,a.clientY),f.tagName&&f.tagName.toLowerCase()==="a"&&Ct(f,"leaflet-active"),this._holdTimeout=setTimeout(c(function(){this._isTapValid()&&(this._fireClick=!1,this._onUp(),this._simulateEvent("contextmenu",a))},this),1e3),this._simulateEvent("mousedown",a),Tt(document,{touchmove:this._onMove,touchend:this._onUp},this)}},_onUp:function(e){if(clearTimeout(this._holdTimeout),te(document,{touchmove:this._onMove,touchend:this._onUp},this),this._fireClick&&e&&e.changedTouches){var a=e.changedTouches[0],f=a.target;f&&f.tagName&&f.tagName.toLowerCase()==="a"&&ie(f,"leaflet-active"),this._simulateEvent("mouseup",a),this._isTapValid()&&this._simulateEvent("click",a)}},_isTapValid:function(){return this._newPos.distanceTo(this._startPos)<=this._map.options.tapTolerance},_onMove:function(e){var a=e.touches[0];this._newPos=new ot(a.clientX,a.clientY),this._simulateEvent("mousemove",a)},_simulateEvent:function(e,a){var f=document.createEvent("MouseEvents");f._simulated=!0,a.target._simulatedClick=!0,f.initMouseEvent(e,!0,!0,window,1,a.screenX,a.screenY,a.clientX,a.clientY,!1,!1,!1,!1,0,null),a.target.dispatchEvent(f)}});Ee&&(!we||Xt)&&Ft.addInitHook("addHandler","tap",Ao),Ft.mergeOptions({touchZoom:Ee&&!Pt,bounceAtZoomLimits:!0});var Bo=Ze.extend({addHooks:function(){Ct(this._map._container,"leaflet-touch-zoom"),Tt(this._map._container,"touchstart",this._onTouchStart,this)},removeHooks:function(){ie(this._map._container,"leaflet-touch-zoom"),te(this._map._container,"touchstart",this._onTouchStart,this)},_onTouchStart:function(e){var a=this._map;if(!(!e.touches||e.touches.length!==2||a._animatingZoom||this._zooming)){var f=a.mouseEventToContainerPoint(e.touches[0]),m=a.mouseEventToContainerPoint(e.touches[1]);this._centerPoint=a.getSize()._divideBy(2),this._startLatLng=a.containerPointToLatLng(this._centerPoint),a.options.touchZoom!=="center"&&(this._pinchStartLatLng=a.containerPointToLatLng(f.add(m)._divideBy(2))),this._startDist=f.distanceTo(m),this._startZoom=a.getZoom(),this._moved=!1,this._zooming=!0,a._stop(),Tt(document,"touchmove",this._onTouchMove,this),Tt(document,"touchend",this._onTouchEnd,this),be(e)}},_onTouchMove:function(e){if(!(!e.touches||e.touches.length!==2||!this._zooming)){var a=this._map,f=a.mouseEventToContainerPoint(e.touches[0]),m=a.mouseEventToContainerPoint(e.touches[1]),b=f.distanceTo(m)/this._startDist;if(this._zoom=a.getScaleZoom(b,this._startZoom),!a.options.bounceAtZoomLimits&&(this._zoom<a.getMinZoom()&&b<1||this._zoom>a.getMaxZoom()&&b>1)&&(this._zoom=a._limitZoom(this._zoom)),a.options.touchZoom==="center"){if(this._center=this._startLatLng,b===1)return}else{var O=f._add(m)._divideBy(2)._subtract(this._centerPoint);if(b===1&&O.x===0&&O.y===0)return;this._center=a.unproject(a.project(this._pinchStartLatLng,this._zoom).subtract(O),this._zoom)}this._moved||(a._moveStart(!0,!1),this._moved=!0),vt(this._animRequest);var G=c(a._move,a,this._center,this._zoom,{pinch:!0,round:!1});this._animRequest=gt(G,this,!0),be(e)}},_onTouchEnd:function(){if(!this._moved||!this._zooming){this._zooming=!1;return}this._zooming=!1,vt(this._animRequest),te(document,"touchmove",this._onTouchMove,this),te(document,"touchend",this._onTouchEnd,this),this._map.options.zoomAnimation?this._map._animateZoom(this._center,this._map._limitZoom(this._zoom),!0,this._map.options.zoomSnap):this._map._resetView(this._center,this._map._limitZoom(this._zoom))}});Ft.addInitHook("addHandler","touchZoom",Bo),Ft.BoxZoom=Co,Ft.DoubleClickZoom=Eo,Ft.Drag=To,Ft.Keyboard=Oo,Ft.ScrollWheelZoom=Io,Ft.Tap=Ao,Ft.TouchZoom=Bo,t.version=s,t.Control=Ae,t.control=Ii,t.Browser=Gi,t.Evented=zt,t.Mixin=Ls,t.Util=At,t.Class=K,t.Handler=Ze,t.extend=o,t.bind=c,t.stamp=y,t.setOptions=I,t.DomEvent=Kn,t.DomUtil=Er,t.PosAnimation=bn,t.Draggable=ri,t.LineUtil=Ms,t.PolyUtil=rr,t.Point=ot,t.point=kt,t.Bounds=Rt,t.bounds=se,t.Transformation=$,t.transformation=k,t.Projection=r,t.LatLng=Bt,t.latLng=Ut,t.LatLngBounds=Kt,t.latLngBounds=$t,t.CRS=ge,t.GeoJSON=Ne,t.geoJSON=yo,t.geoJson=hl,t.Layer=g,t.LayerGroup=M,t.layerGroup=S,t.FeatureGroup=D,t.featureGroup=B,t.ImageOverlay=zr,t.imageOverlay=ul,t.VideoOverlay=vo,t.videoOverlay=cl,t.SVGOverlay=bo,t.svgOverlay=fl,t.DivOverlay=xi,t.Popup=Mn,t.popup=dl,t.Tooltip=Pn,t.tooltip=pl,t.Icon=N,t.icon=H,t.DivIcon=xo,t.divIcon=ml,t.Marker=tt,t.marker=ut,t.TileLayer=Sn,t.tileLayer=Lo,t.GridLayer=lr,t.gridLayer=gl,t.SVG=ur,t.svg=Po,t.Renderer=oi,t.Canvas=ko,t.canvas=Mo,t.Path=ct,t.CircleMarker=yt,t.circleMarker=mt,t.Circle=xt,t.circle=Lt,t.Polyline=_t,t.polyline=Gt,t.Polygon=Me,t.polygon=Dr,t.Rectangle=So,t.rectangle=vl,t.Map=Ft,t.map=Oi;var bl=window.L;t.noConflict=function(){return window.L=bl,this},window.L=t})})(Q,Q.exports);var Lf=Q.exports;function qt(n){return n&&n.normalize&&n.normalize(),n&&n.textContent||""}const cr=[["speed","speeds"],["course","courses"],["hAcc","hAccs"],["vAcc","vAccs"],["heartRate","heartRates"]];function Zo(n){const i={};if(n){const t=Fe(n,"line");if(t){const s=qt(Fe(t,"color")),o=parseFloat(qt(Fe(t,"opacity"))),h=parseFloat(qt(Fe(t,"width")));s&&(i.stroke=s),isNaN(o)||(i["stroke-opacity"]=o),isNaN(h)||(i["stroke-width"]=h*96/25.4)}}return i}function Es(n,i){const t={};let s,o;for(o=0;o<i.length;o++)s=Fe(n,i[o]),s&&(t[i[o]]=qt(s));return t}function Ts(n){const i=Es(n,["name","cmt","desc","type","time","keywords"]),t=n.getElementsByTagNameNS("http://www.garmin.com/xmlschemas/GpxExtensions/v3","*");for(let o=0;o<t.length;o++){const h=t[o];h.parentNode.parentNode===n&&(i[h.tagName.replace(":","_")]=qt(h))}const s=n.getElementsByTagName("link");s.length&&(i.links=[]);for(let o=0;o<s.length;o++)i.links.push(Object.assign({href:s[o].getAttribute("href")},Es(s[o],["text","type"])));return i}function Fe(n,i){const t=n.getElementsByTagName(i);return t.length?t[0]:null}function qo(n){const i=[parseFloat(n.getAttribute("lon")),parseFloat(n.getAttribute("lat"))],t=Fe(n,"ele"),s=Fe(n,"gpxtpx:hr")||Fe(n,"hr"),o=Fe(n,"time");let h;t&&(h=parseFloat(qt(t)),isNaN(h)||i.push(h));const c={coordinates:i,time:o?qt(o):null,heartRate:s?parseFloat(qt(s)):null},d=Fe(n,"extensions");return d!==null&&cr.map(y=>y[0]).filter(y=>y!=="heartrate").forEach(y=>{const _=Fe(d,y);if(_!==null){const v=parseFloat(qt(_));isNaN(v)||(c[y]=v)}}),c}function Dl(n){const i=Vo(n,"rtept");if(!!i.line)return{type:"Feature",properties:Object.assign(Ts(n),Zo(Fe(n,"extensions"))),geometry:{type:"LineString",coordinates:i.line}}}function Vo(n,i){const t=n.getElementsByTagName(i),s=[],o=[],h=t.length,c={};if(h<2)return{};for(let y=0;y<h;y++){const _=qo(t[y]);s.push(_.coordinates),_.time&&o.push(_.time),cr.map(v=>v[0]).forEach(v=>{(_[v]||c[v])&&(c[v]||(c[v]=Array(y).fill(null)),c[v].push(_[v]||null))})}const d={line:s,times:o};return cr.forEach(y=>{c[y[0]]&&(d[y[1]]=c[y[0]]||[])}),d}function Rl(n){const i=n.getElementsByTagName("trkseg"),t=[],s=[],o={};let h;for(let d=0;d<i.length;d++)h=Vo(i[d],"trkpt"),h&&(h.line&&t.push(h.line),h.times&&h.times.length&&s.push(h.times),cr.map(y=>y[1]).forEach(y=>{if(o[y]&&o[y].length||h[y]&&h[y].length){if(o[y]||(o[y]=[]),!o[y].length)for(let _=0;_<d;_++)o[y].push(Array(t[_].length).fill(null));h[y]&&h[y].length?o[y].push(h[y]):o[y].push(Array(h.line.length||0).fill(null))}}));if(t.length===0)return;const c=Object.assign(Ts(n),Zo(Fe(n,"extensions")));return s.length&&(c.coordTimes=t.length===1?s[0]:s),cr.forEach(d=>{o[d[1]]&&o[d[1]].length&&(c[d[1]]=t.length===1?o[d[1]][0]:o[d[1]])}),{type:"Feature",properties:c,geometry:{type:t.length===1?"LineString":"MultiLineString",coordinates:t.length===1?t[0]:t}}}function zl(n){return{type:"Feature",properties:Object.assign(Ts(n),Es(n,["sym"])),geometry:{type:"Point",coordinates:qo(n).coordinates}}}function*Nl(n){const i=n.getElementsByTagName("trk"),t=n.getElementsByTagName("rte"),s=n.getElementsByTagName("wpt");for(let o=0;o<i.length;o++){const h=Rl(i[o]);h&&(yield h)}for(let o=0;o<t.length;o++){const h=Dl(t[o]);h&&(yield h)}for(let o=0;o<s.length;o++)yield zl(s[o])}function wf(n){return{type:"FeatureCollection",features:Array.from(Nl(n))}}const Fl=/\s*/g,Gl=/^\s*|\s*$/g,jl=/\s+/;function Ho(n){if(!n||!n.length)return 0;let i=0;for(let t=0;t<n.length;t++)i=(i<<5)-i+n.charCodeAt(t)|0;return i}function jt(n,i){const t=n.getElementsByTagName(i);return t.length?t[0]:null}function $o(n){return n.replace(Fl,"").split(",").map(parseFloat)}function Ko(n){return n.replace(Gl,"").split(jl).map($o)}function Os(n){if(n.xml!==void 0)return n.xml;if(n.tagName){let i=n.tagName;for(let t=0;t<n.attributes.length;t++)i+=n.attributes[t].name+n.attributes[t].value;for(let t=0;t<n.childNodes.length;t++)i+=Os(n.childNodes[t]);return i}return n.nodeName==="#text"?(n.nodeValue||n.value||"").trim():n.nodeName==="#cdata-section"?n.nodeValue:""}const Wi=["Polygon","LineString","Point","Track","gx:Track"];function Xo(n){let i,t;return n=n||"",n.substr(0,1)==="#"&&(n=n.substr(1)),(n.length===6||n.length===3)&&(i=n),n.length===8&&(t=parseInt(n.substr(0,2),16)/255,i="#"+n.substr(6,2)+n.substr(4,2)+n.substr(2,2)),[i,isNaN(t)?void 0:t]}function Ul(n){let i=n.getElementsByTagName("coord");const t=[],s=[];i.length===0&&(i=n.getElementsByTagName("gx:coord"));for(let h=0;h<i.length;h++)t.push(qt(i[h]).split(" ").map(parseFloat));const o=n.getElementsByTagName("when");for(let h=0;h<o.length;h++)s.push(qt(o[h]));return{coords:t,times:s}}function jr(n){let i,t,s,o,h;const c=[],d=[];if(jt(n,"MultiGeometry"))return jr(jt(n,"MultiGeometry"));if(jt(n,"MultiTrack"))return jr(jt(n,"MultiTrack"));if(jt(n,"gx:MultiTrack"))return jr(jt(n,"gx:MultiTrack"));for(s=0;s<Wi.length;s++)if(t=n.getElementsByTagName(Wi[s]),t){for(o=0;o<t.length;o++)if(i=t[o],Wi[s]==="Point")c.push({type:"Point",coordinates:$o(qt(jt(i,"coordinates")))});else if(Wi[s]==="LineString")c.push({type:"LineString",coordinates:Ko(qt(jt(i,"coordinates")))});else if(Wi[s]==="Polygon"){const y=i.getElementsByTagName("LinearRing"),_=[];for(h=0;h<y.length;h++)_.push(Ko(qt(jt(y[h],"coordinates"))));c.push({type:"Polygon",coordinates:_})}else if(Wi[s]==="Track"||Wi[s]==="gx:Track"){const y=Ul(i);c.push({type:"LineString",coordinates:y.coords}),y.times.length&&d.push(y.times)}}return{geoms:c,coordTimes:d}}function Zl(n,i,t,s){const o=jr(n);let h;const c={},d=qt(jt(n,"name")),y=qt(jt(n,"address"));let _=qt(jt(n,"styleUrl"));const v=qt(jt(n,"description")),x=jt(n,"TimeSpan"),w=jt(n,"TimeStamp"),C=jt(n,"ExtendedData");let A=jt(n,"LineStyle"),I=jt(n,"PolyStyle");const R=jt(n,"visibility");if(!o.geoms.length)return;if(d&&(c.name=d),y&&(c.address=y),_){_[0]!=="#"&&(_="#"+_),c.styleUrl=_,i[_]&&(c.styleHash=i[_]),t[_]&&(c.styleMapHash=t[_],c.styleHash=i[t[_].normal]);const E=s[c.styleHash];if(E){A||(A=jt(E,"LineStyle")),I||(I=jt(E,"PolyStyle"));const z=jt(E,"IconStyle");if(z){const j=jt(z,"Icon");if(j){const q=qt(jt(j,"href"));q&&(c.icon=q)}}}}if(v&&(c.description=v),x){const E=qt(jt(x,"begin")),z=qt(jt(x,"end"));c.timespan={begin:E,end:z}}if(w&&(c.timestamp=qt(jt(w,"when"))),A){const E=Xo(qt(jt(A,"color"))),z=E[0],j=E[1],q=parseFloat(qt(jt(A,"width")));z&&(c.stroke=z),isNaN(j)||(c["stroke-opacity"]=j),isNaN(q)||(c["stroke-width"]=q)}if(I){const E=Xo(qt(jt(I,"color"))),z=E[0],j=E[1],q=qt(jt(I,"fill")),et=qt(jt(I,"outline"));z&&(c.fill=z),isNaN(j)||(c["fill-opacity"]=j),q&&(c["fill-opacity"]=q==="1"?c["fill-opacity"]||1:0),et&&(c["stroke-opacity"]=et==="1"?c["stroke-opacity"]||1:0)}if(C){const E=C.getElementsByTagName("Data"),z=C.getElementsByTagName("SimpleData");for(h=0;h<E.length;h++)c[E[h].getAttribute("name")]=qt(jt(E[h],"value"));for(h=0;h<z.length;h++)c[z[h].getAttribute("name")]=qt(z[h])}R&&(c.visibility=qt(R)),o.coordTimes.length&&(c.coordTimes=o.coordTimes.length===1?o.coordTimes[0]:o.coordTimes);const P={type:"Feature",geometry:o.geoms.length===1?o.geoms[0]:{type:"GeometryCollection",geometries:o.geoms},properties:c};return n.getAttribute("id")&&(P.id=n.getAttribute("id")),P}function*ql(n){const i={},t={},s={},o=n.getElementsByTagName("Placemark"),h=n.getElementsByTagName("Style"),c=n.getElementsByTagName("StyleMap");for(let d=0;d<h.length;d++){const y=Ho(Os(h[d])).toString(16);i["#"+h[d].getAttribute("id")]=y,t[y]=h[d]}for(let d=0;d<c.length;d++){i["#"+c[d].getAttribute("id")]=Ho(Os(c[d])).toString(16);const y=c[d].getElementsByTagName("Pair"),_={};for(let v=0;v<y.length;v++)_[qt(jt(y[v],"key"))]=qt(jt(y[v],"styleUrl"));s["#"+c[d].getAttribute("id")]=_}for(let d=0;d<o.length;d++){const y=Zl(o[d],i,s,t);y&&(yield y)}}function kf(n){return{type:"FeatureCollection",features:Array.from(ql(n))}}/*! Version: 0.6.1
Date: 2018-04-30 */L.Control.GroupedLayers=L.Control.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0,exclusiveGroups:[],groupCheckboxes:!1},initialize:function(n,i,t){var s,o;L.Util.setOptions(this,t),this._layers=[],this._lastZIndex=0,this._handlingClick=!1,this._groupList=[],this._domGroups=[];for(s in n)this._addLayer(n[s],s);for(s in i)for(o in i[s])this._addLayer(i[s][o],o,s,!0)},onAdd:function(n){return this._initLayout(),this._update(),n.on("layeradd",this._onLayerChange,this).on("layerremove",this._onLayerChange,this),this._container},onRemove:function(n){n.off("layeradd",this._onLayerChange,this).off("layerremove",this._onLayerChange,this)},addBaseLayer:function(n,i){return this._addLayer(n,i),this._update(),this},addOverlay:function(n,i,t){return this._addLayer(n,i,t,!0),this._update(),this},removeLayer:function(n){var i=L.Util.stamp(n),t=this._getLayer(i);return t&&delete this._layers[this._layers.indexOf(t)],this._update(),this},_getLayer:function(n){for(var i=0;i<this._layers.length;i++)if(this._layers[i]&&L.stamp(this._layers[i].layer)===n)return this._layers[i]},_initLayout:function(){var n="leaflet-control-layers",i=this._container=L.DomUtil.create("div",n);i.setAttribute("aria-haspopup",!0),L.Browser.touch?L.DomEvent.on(i,"click",L.DomEvent.stopPropagation):(L.DomEvent.disableClickPropagation(i),L.DomEvent.on(i,"wheel",L.DomEvent.stopPropagation));var t=this._form=L.DomUtil.create("form",n+"-list");if(this.options.collapsed){L.Browser.android||L.DomEvent.on(i,"mouseover",this._expand,this).on(i,"mouseout",this._collapse,this);var s=this._layersLink=L.DomUtil.create("a",n+"-toggle",i);s.href="#",s.title="Layers",L.Browser.touch?L.DomEvent.on(s,"click",L.DomEvent.stop).on(s,"click",this._expand,this):L.DomEvent.on(s,"focus",this._expand,this),this._map.on("click",this._collapse,this)}else this._expand();this._baseLayersList=L.DomUtil.create("div",n+"-base",t),this._separator=L.DomUtil.create("div",n+"-separator",t),this._overlaysList=L.DomUtil.create("div",n+"-overlays",t),i.appendChild(t)},_addLayer:function(n,i,t,s){var o=(L.Util.stamp(n),{layer:n,name:i,overlay:s});this._layers.push(o),t=t||"";var h=this._indexOf(this._groupList,t);h===-1&&(h=this._groupList.push(t)-1);var c=this._indexOf(this.options.exclusiveGroups,t)!==-1;o.group={name:t,id:h,exclusive:c},this.options.autoZIndex&&n.setZIndex&&(this._lastZIndex++,n.setZIndex(this._lastZIndex))},_update:function(){if(this._container){this._baseLayersList.innerHTML="",this._overlaysList.innerHTML="",this._domGroups.length=0;for(var n,i,t=!1,s=!1,n=0;n<this._layers.length;n++)i=this._layers[n],this._addItem(i),s=s||i.overlay,t=t||!i.overlay;this._separator.style.display=s&&t?"":"none"}},_onLayerChange:function(n){var i,t=this._getLayer(L.Util.stamp(n.layer));t&&(this._handlingClick||this._update(),i=t.overlay?n.type==="layeradd"?"overlayadd":"overlayremove":n.type==="layeradd"?"baselayerchange":null,i&&this._map.fire(i,t))},_createRadioElement:function(n,i){var t='<input type="radio" class="leaflet-control-layers-selector" name="'+n+'"';i&&(t+=' checked="checked"'),t+="/>";var s=document.createElement("div");return s.innerHTML=t,s.firstChild},_addItem:function(n){var i,t,s,o=document.createElement("label"),h=this._map.hasLayer(n.layer);n.overlay?n.group.exclusive?(s="leaflet-exclusive-group-layer-"+n.group.id,i=this._createRadioElement(s,h)):(i=document.createElement("input"),i.type="checkbox",i.className="leaflet-control-layers-selector",i.defaultChecked=h):i=this._createRadioElement("leaflet-base-layers",h),i.layerId=L.Util.stamp(n.layer),i.groupID=n.group.id,L.DomEvent.on(i,"click",this._onInputClick,this);var c=document.createElement("span");if(c.innerHTML=" "+n.name,o.appendChild(i),o.appendChild(c),n.overlay){t=this._overlaysList;var d=this._domGroups[n.group.id];if(!d){d=document.createElement("div"),d.className="leaflet-control-layers-group",d.id="leaflet-control-layers-group-"+n.group.id;var y=document.createElement("label");if(y.className="leaflet-control-layers-group-label",n.group.name!==""&&!n.group.exclusive&&this.options.groupCheckboxes){var _=document.createElement("input");_.type="checkbox",_.className="leaflet-control-layers-group-selector",_.groupID=n.group.id,_.legend=this,L.DomEvent.on(_,"click",this._onGroupInputClick,_),y.appendChild(_)}var v=document.createElement("span");v.className="leaflet-control-layers-group-name",v.innerHTML=n.group.name,y.appendChild(v),d.appendChild(y),t.appendChild(d),this._domGroups[n.group.id]=d}t=d}else t=this._baseLayersList;return t.appendChild(o),o},_onGroupInputClick:function(){var n,i,t,s=this.legend;s._handlingClick=!0;var o=s._form.getElementsByTagName("input"),h=o.length;for(n=0;h>n;n++)i=o[n],i.groupID===this.groupID&&i.className==="leaflet-control-layers-selector"&&(i.checked=this.checked,t=s._getLayer(i.layerId),i.checked&&!s._map.hasLayer(t.layer)?s._map.addLayer(t.layer):!i.checked&&s._map.hasLayer(t.layer)&&s._map.removeLayer(t.layer));s._handlingClick=!1},_onInputClick:function(){var n,i,t,s=this._form.getElementsByTagName("input"),o=s.length;for(this._handlingClick=!0,n=0;o>n;n++)i=s[n],i.className==="leaflet-control-layers-selector"&&(t=this._getLayer(i.layerId),i.checked&&!this._map.hasLayer(t.layer)?this._map.addLayer(t.layer):!i.checked&&this._map.hasLayer(t.layer)&&this._map.removeLayer(t.layer));this._handlingClick=!1},_expand:function(){L.DomUtil.addClass(this._container,"leaflet-control-layers-expanded");var n=this._map._size.y-4*this._container.offsetTop;n<this._form.clientHeight&&(L.DomUtil.addClass(this._form,"leaflet-control-layers-scrollbar"),this._form.style.height=n+"px")},_collapse:function(){this._container.className=this._container.className.replace(" leaflet-control-layers-expanded","")},_indexOf:function(n,i){for(var t=0,s=n.length;s>t;t++)if(n[t]===i)return t;return-1}}),L.control.groupedLayers=function(n,i,t){return new L.Control.GroupedLayers(n,i,t)};var Vl={exports:{}};/*!
Copyright (c) 2016 Dominik Moritz

This file is part of the leaflet locate control. It is licensed under the MIT license.
You can find the project at: https://github.com/domoritz/leaflet-locatecontrol
*/(function(n,i){(function(t,s){typeof s!="undefined"&&s.L?n.exports=t(L):n.exports=t(Q.exports),typeof s!="undefined"&&s.L&&(s.L.Control.Locate=t(L))})(function(t){var s=function(_,v,x){x=x.split(" "),x.forEach(function(w){t.DomUtil[_].call(this,v,w)})},o=function(_,v){s("addClass",_,v)},h=function(_,v){s("removeClass",_,v)},c=t.Marker.extend({initialize:function(_,v){t.Util.setOptions(this,v),this._latlng=_,this.createIcon()},createIcon:function(){var _=this.options,v="";_.color!==void 0&&(v+="stroke:"+_.color+";"),_.weight!==void 0&&(v+="stroke-width:"+_.weight+";"),_.fillColor!==void 0&&(v+="fill:"+_.fillColor+";"),_.fillOpacity!==void 0&&(v+="fill-opacity:"+_.fillOpacity+";"),_.opacity!==void 0&&(v+="opacity:"+_.opacity+";");var x=this._getIconSVG(_,v);this._locationIcon=t.divIcon({className:x.className,html:x.svg,iconSize:[x.w,x.h]}),this.setIcon(this._locationIcon)},_getIconSVG:function(_,v){var x=_.radius,w=_.weight,C=x+w,A=C*2,I='<svg xmlns="http://www.w3.org/2000/svg" width="'+A+'" height="'+A+'" version="1.1" viewBox="-'+C+" -"+C+" "+A+" "+A+'"><circle r="'+x+'" style="'+v+'" /></svg>';return{className:"leaflet-control-locate-location",svg:I,w:A,h:A}},setStyle:function(_){t.Util.setOptions(this,_),this.createIcon()}}),d=c.extend({initialize:function(_,v,x){t.Util.setOptions(this,x),this._latlng=_,this._heading=v,this.createIcon()},setHeading:function(_){this._heading=_},_getIconSVG:function(_,v){var x=_.radius,w=_.width+_.weight,C=(x+_.depth+_.weight)*2,A="M0,0 l"+_.width/2+","+_.depth+" l-"+w+",0 z",I="transform: rotate("+this._heading+"deg)",R='<svg xmlns="http://www.w3.org/2000/svg" width="'+w+'" height="'+C+'" version="1.1" viewBox="-'+w/2+" 0 "+w+" "+C+'" style="'+I+'"><path d="'+A+'" style="'+v+'" /></svg>';return{className:"leaflet-control-locate-heading",svg:R,w,h:C}}}),y=t.Control.extend({options:{position:"topleft",layer:void 0,setView:"untilPanOrZoom",keepCurrentZoomLevel:!1,initialZoomLevel:!1,getLocationBounds:function(_){return _.bounds},flyTo:!1,clickBehavior:{inView:"stop",outOfView:"setView",inViewNotFollowing:"inView"},returnToPrevBounds:!1,cacheLocation:!0,drawCircle:!0,drawMarker:!0,showCompass:!0,markerClass:c,compassClass:d,circleStyle:{className:"leaflet-control-locate-circle",color:"#136AEC",fillColor:"#136AEC",fillOpacity:.15,weight:0},markerStyle:{className:"leaflet-control-locate-marker",color:"#fff",fillColor:"#2A93EE",fillOpacity:1,weight:3,opacity:1,radius:9},compassStyle:{fillColor:"#2A93EE",fillOpacity:1,weight:0,color:"#fff",opacity:1,radius:9,width:9,depth:6},followCircleStyle:{},followMarkerStyle:{},followCompassStyle:{},icon:"fa fa-map-marker",iconLoading:"fa fa-spinner fa-spin",iconElementTag:"span",textElementTag:"small",circlePadding:[0,0],metric:!0,createButtonCallback:function(_,v){var x=t.DomUtil.create("a","leaflet-bar-part leaflet-bar-part-single",_);x.title=v.strings.title,x.role="button",x.href="#";var w=t.DomUtil.create(v.iconElementTag,v.icon,x);if(v.strings.text!==void 0){var C=t.DomUtil.create(v.textElementTag,"leaflet-locate-text",x);C.textContent=v.strings.text,x.classList.add("leaflet-locate-text-active"),x.parentNode.style.display="flex",v.icon.length>0&&w.classList.add("leaflet-locate-icon")}return{link:x,icon:w}},onLocationError:function(_,v){alert(_.message)},onLocationOutsideMapBounds:function(_){_.stop(),alert(_.options.strings.outsideMapBoundsMsg)},showPopup:!0,strings:{title:"Show me where I am",metersUnit:"meters",feetUnit:"feet",popup:"You are within {distance} {unit} from this point",outsideMapBoundsMsg:"You seem located outside the boundaries of the map"},locateOptions:{maxZoom:1/0,watch:!0,setView:!1}},initialize:function(_){for(var v in _)typeof this.options[v]=="object"?t.extend(this.options[v],_[v]):this.options[v]=_[v];this.options.followMarkerStyle=t.extend({},this.options.markerStyle,this.options.followMarkerStyle),this.options.followCircleStyle=t.extend({},this.options.circleStyle,this.options.followCircleStyle),this.options.followCompassStyle=t.extend({},this.options.compassStyle,this.options.followCompassStyle)},onAdd:function(_){var v=t.DomUtil.create("div","leaflet-control-locate leaflet-bar leaflet-control");this._container=v,this._map=_,this._layer=this.options.layer||new t.LayerGroup,this._layer.addTo(_),this._event=void 0,this._compassHeading=null,this._prevBounds=null;var x=this.options.createButtonCallback(v,this.options);return this._link=x.link,this._icon=x.icon,t.DomEvent.on(this._link,"click",function(w){t.DomEvent.stopPropagation(w),t.DomEvent.preventDefault(w),this._onClick()},this).on(this._link,"dblclick",t.DomEvent.stopPropagation),this._resetVariables(),this._map.on("unload",this._unload,this),v},_onClick:function(){this._justClicked=!0;var _=this._isFollowing();if(this._userPanned=!1,this._userZoomed=!1,this._active&&!this._event)this.stop();else if(this._active){var v=this.options.clickBehavior,x=v.outOfView;switch(this._map.getBounds().contains(this._event.latlng)&&(x=_?v.inView:v.inViewNotFollowing),v[x]&&(x=v[x]),x){case"setView":this.setView();break;case"stop":if(this.stop(),this.options.returnToPrevBounds){var w=this.options.flyTo?this._map.flyToBounds:this._map.fitBounds;w.bind(this._map)(this._prevBounds)}break}}else this.options.returnToPrevBounds&&(this._prevBounds=this._map.getBounds()),this.start();this._updateContainerStyle()},start:function(){this._activate(),this._event&&(this._drawMarker(this._map),this.options.setView&&this.setView()),this._updateContainerStyle()},stop:function(){this._deactivate(),this._cleanClasses(),this._resetVariables(),this._removeMarker()},stopFollowing:function(){this._userPanned=!0,this._updateContainerStyle(),this._drawMarker()},_activate:function(){if(!this._active&&(this._map.locate(this.options.locateOptions),this._map.fire("locateactivate",this),this._active=!0,this._map.on("locationfound",this._onLocationFound,this),this._map.on("locationerror",this._onLocationError,this),this._map.on("dragstart",this._onDrag,this),this._map.on("zoomstart",this._onZoom,this),this._map.on("zoomend",this._onZoomEnd,this),this.options.showCompass)){var _="ondeviceorientationabsolute"in window;if(_||"ondeviceorientation"in window){var v=this,x=function(){t.DomEvent.on(window,_?"deviceorientationabsolute":"deviceorientation",v._onDeviceOrientation,v)};DeviceOrientationEvent&&typeof DeviceOrientationEvent.requestPermission=="function"?DeviceOrientationEvent.requestPermission().then(function(w){w==="granted"&&x()}):x()}}},_deactivate:function(){this._map.stopLocate(),this._map.fire("locatedeactivate",this),this._active=!1,this.options.cacheLocation||(this._event=void 0),this._map.off("locationfound",this._onLocationFound,this),this._map.off("locationerror",this._onLocationError,this),this._map.off("dragstart",this._onDrag,this),this._map.off("zoomstart",this._onZoom,this),this._map.off("zoomend",this._onZoomEnd,this),this.options.showCompass&&(this._compassHeading=null,"ondeviceorientationabsolute"in window?t.DomEvent.off(window,"deviceorientationabsolute",this._onDeviceOrientation,this):"ondeviceorientation"in window&&t.DomEvent.off(window,"deviceorientation",this._onDeviceOrientation,this))},setView:function(){if(this._drawMarker(),this._isOutsideMapBounds())this._event=void 0,this.options.onLocationOutsideMapBounds(this);else if(this._justClicked&&this.options.initialZoomLevel!==!1){var _=this.options.flyTo?this._map.flyTo:this._map.setView;_.bind(this._map)([this._event.latitude,this._event.longitude],this.options.initialZoomLevel)}else if(this.options.keepCurrentZoomLevel){var _=this.options.flyTo?this._map.flyTo:this._map.panTo;_.bind(this._map)([this._event.latitude,this._event.longitude])}else{var _=this.options.flyTo?this._map.flyToBounds:this._map.fitBounds;this._ignoreEvent=!0,_.bind(this._map)(this.options.getLocationBounds(this._event),{padding:this.options.circlePadding,maxZoom:this.options.initialZoomLevel||this.options.locateOptions.maxZoom}),t.Util.requestAnimFrame(function(){this._ignoreEvent=!1},this)}},_drawCompass:function(){if(!!this._event){var _=this._event.latlng;if(this.options.showCompass&&_&&this._compassHeading!==null){var v=this._isFollowing()?this.options.followCompassStyle:this.options.compassStyle;this._compass?(this._compass.setLatLng(_),this._compass.setHeading(this._compassHeading),this._compass.setStyle&&this._compass.setStyle(v)):this._compass=new this.options.compassClass(_,this._compassHeading,v).addTo(this._layer)}this._compass&&(!this.options.showCompass||this._compassHeading===null)&&(this._compass.removeFrom(this._layer),this._compass=null)}},_drawMarker:function(){this._event.accuracy===void 0&&(this._event.accuracy=0);var _=this._event.accuracy,v=this._event.latlng;if(this.options.drawCircle){var x=this._isFollowing()?this.options.followCircleStyle:this.options.circleStyle;this._circle?this._circle.setLatLng(v).setRadius(_).setStyle(x):this._circle=t.circle(v,_,x).addTo(this._layer)}var w,C;if(this.options.metric?(w=_.toFixed(0),C=this.options.strings.metersUnit):(w=(_*3.2808399).toFixed(0),C=this.options.strings.feetUnit),this.options.drawMarker){var A=this._isFollowing()?this.options.followMarkerStyle:this.options.markerStyle;this._marker?(this._marker.setLatLng(v),this._marker.setStyle&&this._marker.setStyle(A)):this._marker=new this.options.markerClass(v,A).addTo(this._layer)}this._drawCompass();var I=this.options.strings.popup;function R(){return typeof I=="string"?t.Util.template(I,{distance:w,unit:C}):typeof I=="function"?I({distance:w,unit:C}):I}this.options.showPopup&&I&&this._marker&&this._marker.bindPopup(R())._popup.setLatLng(v),this.options.showPopup&&I&&this._compass&&this._compass.bindPopup(R())._popup.setLatLng(v)},_removeMarker:function(){this._layer.clearLayers(),this._marker=void 0,this._circle=void 0},_unload:function(){this.stop(),this._map.off("unload",this._unload,this)},_setCompassHeading:function(_){!isNaN(parseFloat(_))&&isFinite(_)?(_=Math.round(_),this._compassHeading=_,t.Util.requestAnimFrame(this._drawCompass,this)):this._compassHeading=null},_onCompassNeedsCalibration:function(){this._setCompassHeading()},_onDeviceOrientation:function(_){!this._active||(_.webkitCompassHeading?this._setCompassHeading(_.webkitCompassHeading):_.absolute&&_.alpha&&this._setCompassHeading(360-_.alpha))},_onLocationError:function(_){_.code==3&&this.options.locateOptions.watch||(this.stop(),this.options.onLocationError(_,this))},_onLocationFound:function(_){if(!(this._event&&this._event.latlng.lat===_.latlng.lat&&this._event.latlng.lng===_.latlng.lng&&this._event.accuracy===_.accuracy)&&!!this._active){switch(this._event=_,this._drawMarker(),this._updateContainerStyle(),this.options.setView){case"once":this._justClicked&&this.setView();break;case"untilPan":this._userPanned||this.setView();break;case"untilPanOrZoom":!this._userPanned&&!this._userZoomed&&this.setView();break;case"always":this.setView();break}this._justClicked=!1}},_onDrag:function(){this._event&&!this._ignoreEvent&&(this._userPanned=!0,this._updateContainerStyle(),this._drawMarker())},_onZoom:function(){this._event&&!this._ignoreEvent&&(this._userZoomed=!0,this._updateContainerStyle(),this._drawMarker())},_onZoomEnd:function(){this._event&&this._drawCompass(),this._event&&!this._ignoreEvent&&this._marker&&!this._map.getBounds().pad(-.3).contains(this._marker.getLatLng())&&(this._userPanned=!0,this._updateContainerStyle(),this._drawMarker())},_isFollowing:function(){if(!this._active)return!1;if(this.options.setView==="always")return!0;if(this.options.setView==="untilPan")return!this._userPanned;if(this.options.setView==="untilPanOrZoom")return!this._userPanned&&!this._userZoomed},_isOutsideMapBounds:function(){return this._event===void 0?!1:this._map.options.maxBounds&&!this._map.options.maxBounds.contains(this._event.latlng)},_updateContainerStyle:function(){!this._container||(this._active&&!this._event?this._setClasses("requesting"):this._isFollowing()?this._setClasses("following"):this._active?this._setClasses("active"):this._cleanClasses())},_setClasses:function(_){_=="requesting"?(h(this._container,"active following"),o(this._container,"requesting"),h(this._icon,this.options.icon),o(this._icon,this.options.iconLoading)):_=="active"?(h(this._container,"requesting following"),o(this._container,"active"),h(this._icon,this.options.iconLoading),o(this._icon,this.options.icon)):_=="following"&&(h(this._container,"requesting"),o(this._container,"active following"),h(this._icon,this.options.iconLoading),o(this._icon,this.options.icon))},_cleanClasses:function(){t.DomUtil.removeClass(this._container,"requesting"),t.DomUtil.removeClass(this._container,"active"),t.DomUtil.removeClass(this._container,"following"),h(this._icon,this.options.iconLoading),o(this._icon,this.options.icon)},_resetVariables:function(){this._active=!1,this._justClicked=!1,this._userPanned=!1,this._userZoomed=!1}});return t.control.locate=function(_){return new t.Control.Locate(_)},y},window)})(Vl);var Ur=window.XMLHttpRequest&&"withCredentials"in new window.XMLHttpRequest,Ri=document.documentElement.style.pointerEvents==="",Qi={cors:Ur,pointerEvents:Ri},Hl={attributionWidthOffset:55},Yo=0;function Zr(n){var i="";n.f=n.f||"json";for(var t in n)if(n.hasOwnProperty(t)){var s=n[t],o=Object.prototype.toString.call(s),h;i.length&&(i+="&"),o==="[object Array]"?h=Object.prototype.toString.call(s[0])==="[object Object]"?JSON.stringify(s):s.join(","):o==="[object Object]"?h=JSON.stringify(s):o==="[object Date]"?h=s.valueOf():h=s,i+=encodeURIComponent(t)+"="+encodeURIComponent(h)}return i}function Is(n,i){var t=new window.XMLHttpRequest;return t.onerror=function(s){t.onreadystatechange=Q.exports.Util.falseFn,n.call(i,{error:{code:500,message:"XMLHttpRequest error"}},null)},t.onreadystatechange=function(){var s,o;if(t.readyState===4){try{s=JSON.parse(t.responseText)}catch{s=null,o={code:500,message:"Could not parse response as JSON. This could also be caused by a CORS or XMLHttpRequest error."}}!o&&s.error&&(o=s.error,s=null),t.onerror=Q.exports.Util.falseFn,n.call(i,o,s)}},t.ontimeout=function(){this.onerror()},t}function $l(n,i,t,s){var o=Is(t,s);return o.open("POST",n),typeof s!="undefined"&&s!==null&&typeof s.options!="undefined"&&(o.timeout=s.options.timeout),o.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=UTF-8"),o.send(Zr(i)),o}function Jo(n,i,t,s){var o=Is(t,s);return o.open("GET",n+"?"+Zr(i),!0),typeof s!="undefined"&&s!==null&&typeof s.options!="undefined"&&(o.timeout=s.options.timeout,s.options.withCredentials&&(o.withCredentials=!0)),o.send(null),o}function Wo(n,i,t,s){var o=Zr(i),h=Is(t,s),c=(n+"?"+o).length;if(c<=2e3&&Qi.cors?h.open("GET",n+"?"+o):c>2e3&&Qi.cors&&(h.open("POST",n),h.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=UTF-8")),typeof s!="undefined"&&s!==null&&typeof s.options!="undefined"&&(h.timeout=s.options.timeout,s.options.withCredentials&&(h.withCredentials=!0)),c<=2e3&&Qi.cors)h.send(null);else if(c>2e3&&Qi.cors)h.send(o);else{if(c<=2e3&&!Qi.cors)return As(n,i,t,s);tn("a request to "+n+" was longer then 2000 characters and this browser cannot make a cross-domain post request. Please use a proxy http://esri.github.io/esri-leaflet/api-reference/request.html");return}return h}function As(n,i,t,s){window._EsriLeafletCallbacks=window._EsriLeafletCallbacks||{};var o="c"+Yo;i.callback="window._EsriLeafletCallbacks."+o,window._EsriLeafletCallbacks[o]=function(c){if(window._EsriLeafletCallbacks[o]!==!0){var d,y=Object.prototype.toString.call(c);y==="[object Object]"||y==="[object Array]"||(d={error:{code:500,message:"Expected array or object as JSONP response"}},c=null),!d&&c.error&&(d=c,c=null),t.call(s,d,c),window._EsriLeafletCallbacks[o]=!0}};var h=Q.exports.DomUtil.create("script",null,document.body);return h.type="text/javascript",h.src=n+"?"+Zr(i),h.id=o,h.onerror=function(c){if(c&&window._EsriLeafletCallbacks[o]!==!0){var d={error:{code:500,message:"An unknown error occurred"}};t.call(s,d),window._EsriLeafletCallbacks[o]=!0}},Q.exports.DomUtil.addClass(h,"esri-leaflet-jsonp"),Yo++,{id:o,url:h.src,abort:function(){window._EsriLeafletCallbacks._callback[o]({code:0,message:"Request aborted."})}}}var Bs=Qi.cors?Jo:As;Bs.CORS=Jo;Bs.JSONP=As;function tn(){console&&console.warn&&console.warn.apply(console,arguments)}var qr={request:Wo,get:Bs,post:$l};/* @preserve
* @terraformer/arcgis - v2.0.7 - MIT
* Copyright (c) 2012-2021 Environmental Systems Research Institute, Inc.
* Thu Jul 22 2021 13:58:30 GMT-0700 (Pacific Daylight Time)
*/var Kl=function(i,t,s,o){var h=(o[0]-s[0])*(i[1]-s[1])-(o[1]-s[1])*(i[0]-s[0]),c=(t[0]-i[0])*(i[1]-s[1])-(t[1]-i[1])*(i[0]-s[0]),d=(o[1]-s[1])*(t[0]-i[0])-(o[0]-s[0])*(t[1]-i[1]);if(d!==0){var y=h/d,_=c/d;if(y>=0&&y<=1&&_>=0&&_<=1)return!0}return!1},Xl=function(i,t){for(var s=!1,o=-1,h=i.length,c=h-1;++o<h;c=o)(i[o][1]<=t[1]&&t[1]<i[c][1]||i[c][1]<=t[1]&&t[1]<i[o][1])&&t[0]<(i[c][0]-i[o][0])*(t[1]-i[o][1])/(i[c][1]-i[o][1])+i[o][0]&&(s=!s);return s},Yl=function(i,t){for(var s=0;s<i.length;s++)if(i[s]!==t[s])return!1;return!0},Qo=function(i,t){for(var s=0;s<i.length-1;s++)for(var o=0;o<t.length-1;o++)if(Kl(i[s],i[s+1],t[o],t[o+1]))return!0;return!1},Ds=function(i){return Yl(i[0],i[i.length-1])||i.push(i[0]),i},Rs=function(i){var t=0,s=0,o=i.length,h=i[s],c;for(s;s<o-1;s++)c=i[s+1],t+=(c[0]-h[0])*(c[1]+h[1]),h=c;return t>=0},ta=function(i){var t={};for(var s in i)i.hasOwnProperty(s)&&(t[s]=i[s]);return t},Jl=function(i,t){var s=Qo(i,t),o=Xl(i,t[0]);return!!(!s&&o)},Wl=function(i){for(var t=[],s=[],o,h,c,d=0;d<i.length;d++){var y=Ds(i[d].slice(0));if(!(y.length<4))if(Rs(y)){var _=[y.slice().reverse()];t.push(_)}else s.push(y.slice().reverse())}for(var v=[];s.length;){c=s.pop();var x=!1;for(o=t.length-1;o>=0;o--)if(h=t[o][0],Jl(h,c)){t[o].push(c),x=!0;break}x||v.push(c)}for(;v.length;){c=v.pop();var w=!1;for(o=t.length-1;o>=0;o--)if(h=t[o][0],Qo(h,c)){t[o].push(c),w=!0;break}w||t.push([c.reverse()])}return t.length===1?{type:"Polygon",coordinates:t[0]}:{type:"MultiPolygon",coordinates:t}},Ql=function(i,t){for(var s=t?[t,"OBJECTID","FID"]:["OBJECTID","FID"],o=0;o<s.length;o++){var h=s[o];if(h in i&&(typeof i[h]=="string"||typeof i[h]=="number"))return i[h]}throw Error("No valid id attribute found")},th=function n(i,t){var s={};if(i.features){s.type="FeatureCollection",s.features=[];for(var o=0;o<i.features.length;o++)s.features.push(n(i.features[o],t))}if(typeof i.x=="number"&&typeof i.y=="number"&&(s.type="Point",s.coordinates=[i.x,i.y],typeof i.z=="number"&&s.coordinates.push(i.z)),i.points&&(s.type="MultiPoint",s.coordinates=i.points.slice(0)),i.paths&&(i.paths.length===1?(s.type="LineString",s.coordinates=i.paths[0].slice(0)):(s.type="MultiLineString",s.coordinates=i.paths.slice(0))),i.rings&&(s=Wl(i.rings.slice(0))),typeof i.xmin=="number"&&typeof i.ymin=="number"&&typeof i.xmax=="number"&&typeof i.ymax=="number"&&(s.type="Polygon",s.coordinates=[[[i.xmax,i.ymax],[i.xmin,i.ymax],[i.xmin,i.ymin],[i.xmax,i.ymin],[i.xmax,i.ymax]]]),(i.geometry||i.attributes)&&(s.type="Feature",s.geometry=i.geometry?n(i.geometry):null,s.properties=i.attributes?ta(i.attributes):null,i.attributes))try{s.id=Ql(i.attributes,t)}catch{}return JSON.stringify(s.geometry)===JSON.stringify({})&&(s.geometry=null),i.spatialReference&&i.spatialReference.wkid&&i.spatialReference.wkid!==4326&&console.warn("Object converted in non-standard crs - "+JSON.stringify(i.spatialReference)),s},ea=function(i){var t=[],s=i.slice(0),o=Ds(s.shift().slice(0));if(o.length>=4){Rs(o)||o.reverse(),t.push(o);for(var h=0;h<s.length;h++){var c=Ds(s[h].slice(0));c.length>=4&&(Rs(c)&&c.reverse(),t.push(c))}}return t},eh=function(i){for(var t=[],s=0;s<i.length;s++)for(var o=ea(i[s]),h=o.length-1;h>=0;h--){var c=o[h].slice(0);t.push(c)}return t},ih=function n(i,t){t=t||"OBJECTID";var s={wkid:4326},o={},h;switch(i.type){case"Point":o.x=i.coordinates[0],o.y=i.coordinates[1],i.coordinates[2]&&(o.z=i.coordinates[2]),o.spatialReference=s;break;case"MultiPoint":o.points=i.coordinates.slice(0),i.coordinates[0][2]&&(o.hasZ=!0),o.spatialReference=s;break;case"LineString":o.paths=[i.coordinates.slice(0)],i.coordinates[0][2]&&(o.hasZ=!0),o.spatialReference=s;break;case"MultiLineString":o.paths=i.coordinates.slice(0),i.coordinates[0][0][2]&&(o.hasZ=!0),o.spatialReference=s;break;case"Polygon":o.rings=ea(i.coordinates.slice(0)),i.coordinates[0][0][2]&&(o.hasZ=!0),o.spatialReference=s;break;case"MultiPolygon":o.rings=eh(i.coordinates.slice(0)),i.coordinates[0][0][0][2]&&(o.hasZ=!0),o.spatialReference=s;break;case"Feature":i.geometry&&(o.geometry=n(i.geometry,t)),o.attributes=i.properties?ta(i.properties):{},i.id&&(o.attributes[t]=i.id);break;case"FeatureCollection":for(o=[],h=0;h<i.features.length;h++)o.push(n(i.features[h],t));break;case"GeometryCollection":for(o=[],h=0;h<i.geometries.length;h++)o.push(n(i.geometries[h],t));break}return o},ia='<a href="http://leafletjs.com" title="A JS library for interactive maps">Leaflet</a>',nh='Powered by <a href="https://www.esri.com">Esri</a>';function Vr(n,i){return ih(n,i)}function rh(n,i){return th(n,i)}function na(n){if(n.xmin!=="NaN"&&n.ymin!=="NaN"&&n.xmax!=="NaN"&&n.ymax!=="NaN"){var i=Q.exports.latLng(n.ymin,n.xmin),t=Q.exports.latLng(n.ymax,n.xmax);return Q.exports.latLngBounds(i,t)}else return null}function ra(n){return n=Q.exports.latLngBounds(n),{xmin:n.getSouthWest().lng,ymin:n.getSouthWest().lat,xmax:n.getNorthEast().lng,ymax:n.getNorthEast().lat,spatialReference:{wkid:4326}}}var sa=/^(OBJECTID|FID|OID|ID)$/i;function sh(n){var i;if(n.objectIdFieldName)i=n.objectIdFieldName;else if(n.fields){for(var t=0;t<=n.fields.length-1;t++)if(n.fields[t].type==="esriFieldTypeOID"){i=n.fields[t].name;break}if(!i){for(t=0;t<=n.fields.length-1;t++)if(n.fields[t].name.match(sa)){i=n.fields[t].name;break}}}return i}function oh(n){for(var i in n.attributes)if(i.match(sa))return i}function Hr(n,i){var t,s=n.features||n.results,o=s&&s.length;i?t=i:t=sh(n);var h={type:"FeatureCollection",features:[]};if(o)for(var c=s.length-1;c>=0;c--){var d=rh(s[c],t||oh(s[c]));h.features.push(d)}return h}function zs(n){return n=Q.exports.Util.trim(n),n[n.length-1]!=="/"&&(n+="/"),n}function $r(n){if(n.url.indexOf("?")!==-1){n.requestParams=n.requestParams||{};var i=n.url.substring(n.url.indexOf("?")+1);n.url=n.url.split("?")[0],n.requestParams=JSON.parse('{"'+decodeURI(i).replace(/"/g,'\\"').replace(/&/g,'","').replace(/=/g,'":"')+'"}')}return n.url=zs(n.url.split("?")[0]),n}function ah(n){return/^(?!.*utility\.arcgis\.com).*\.arcgis\.com.*FeatureServer/i.test(n)}function oa(n){var i;switch(n){case"Point":i="esriGeometryPoint";break;case"MultiPoint":i="esriGeometryMultipoint";break;case"LineString":i="esriGeometryPolyline";break;case"MultiLineString":i="esriGeometryPolyline";break;case"Polygon":i="esriGeometryPolygon";break;case"MultiPolygon":i="esriGeometryPolygon";break}return i}function Ns(n){return n.getSize().x-Hl.attributionWidthOffset+"px"}function Kr(n){if(!!n.attributionControl){if(n.attributionControl._esriAttributionLayerCount||(n.attributionControl._esriAttributionLayerCount=0),n.attributionControl._esriAttributionLayerCount===0){if(!n.attributionControl._esriAttributionAddedOnce){var i=document.createElement("style");i.type="text/css",i.innerHTML=".esri-truncated-attribution:hover {white-space: normal;}",document.getElementsByTagName("head")[0].appendChild(i);var t=document.createElement("style");t.type="text/css",t.innerHTML=".esri-truncated-attribution {vertical-align: -3px;white-space: nowrap;overflow: hidden;text-overflow: ellipsis;display: inline-block;transition: 0s white-space;transition-delay: 1s;max-width: "+Ns(n)+";}",document.getElementsByTagName("head")[0].appendChild(t),n.on("resize",function(s){n.attributionControl&&(n.attributionControl._container.style.maxWidth=Ns(s.target))}),n.attributionControl._esriAttributionAddedOnce=!0}n.attributionControl.setPrefix(ia+" | "+nh),Q.exports.DomUtil.addClass(n.attributionControl._container,"esri-truncated-attribution:hover"),Q.exports.DomUtil.addClass(n.attributionControl._container,"esri-truncated-attribution")}n.attributionControl._esriAttributionLayerCount=n.attributionControl._esriAttributionLayerCount+1}}function Xr(n){!n.attributionControl||(n.attributionControl._esriAttributionLayerCount&&n.attributionControl._esriAttributionLayerCount===1&&(n.attributionControl.setPrefix(ia),Q.exports.DomUtil.removeClass(n.attributionControl._container,"esri-truncated-attribution:hover"),Q.exports.DomUtil.removeClass(n.attributionControl._container,"esri-truncated-attribution")),n.attributionControl._esriAttributionLayerCount=n.attributionControl._esriAttributionLayerCount-1)}function aa(n){var i={geometry:null,geometryType:null};if(n instanceof Q.exports.LatLngBounds)return i.geometry=ra(n),i.geometryType="esriGeometryEnvelope",i;if(n.getLatLng&&(n=n.getLatLng()),n instanceof Q.exports.LatLng&&(n={type:"Point",coordinates:[n.lng,n.lat]}),n instanceof Q.exports.GeoJSON&&(n=n.getLayers()[0].feature.geometry,i.geometry=Vr(n),i.geometryType=oa(n.type)),n.toGeoJSON&&(n=n.toGeoJSON()),n.type==="Feature"&&(n=n.geometry),n.type==="Point"||n.type==="LineString"||n.type==="Polygon"||n.type==="MultiPolygon")return i.geometry=Vr(n),i.geometryType=oa(n.type),i;tn("invalid geometry passed to spatial query. Should be L.LatLng, L.LatLngBounds, L.Marker or a GeoJSON Point, Line, Polygon or MultiPolygon object")}function lh(n,i){Qi.cors&&Wo(n,{},Q.exports.Util.bind(function(t,s){if(!t){i._esriAttributions=[];for(var o=0;o<s.contributors.length;o++)for(var h=s.contributors[o],c=0;c<h.coverageAreas.length;c++){var d=h.coverageAreas[c],y=Q.exports.latLng(d.bbox[0],d.bbox[1]),_=Q.exports.latLng(d.bbox[2],d.bbox[3]);i._esriAttributions.push({attribution:h.attribution,score:d.score,bounds:Q.exports.latLngBounds(y,_),minZoom:d.zoomMin,maxZoom:d.zoomMax})}i._esriAttributions.sort(function(x,w){return w.score-x.score});var v={target:i};Fs(v)}},this))}function Fs(n){var i=n.target,t=i._esriAttributions;if(!(!i||!i.attributionControl)){var s=i.attributionControl._container.querySelector(".esri-dynamic-attribution");if(s&&t){for(var o="",h=i.getBounds(),c=Q.exports.latLngBounds(h.getSouthWest().wrap(),h.getNorthEast().wrap()),d=i.getZoom(),y=0;y<t.length;y++){var _=t[y],v=_.attribution;!o.match(v)&&_.bounds.intersects(c)&&d>=_.minZoom&&d<=_.maxZoom&&(o+=", "+v)}o=o.substr(2),s.innerHTML=o,s.style.maxWidth=Ns(i),i.fire("attributionupdated",{attribution:o})}}}var Gs=Q.exports.Class.extend({options:{proxy:!1,useCors:Ur},generateSetter:function(n,i){return Q.exports.Util.bind(function(t){return this.params[n]=t,this},i)},initialize:function(n){if(n.request&&n.options?(this._service=n,Q.exports.Util.setOptions(this,n.options)):(Q.exports.Util.setOptions(this,n),this.options.url=zs(n.url)),this.params=Q.exports.Util.extend({},this.params||{}),this.setters)for(var i in this.setters){var t=this.setters[i];this[i]=this.generateSetter(t,this)}},token:function(n){return this._service?this._service.authenticate(n):this.params.token=n,this},apikey:function(n){return this.token(n)},format:function(n){return this.params.returnUnformattedValues=!n,this},request:function(n,i){return this.options.requestParams&&Q.exports.Util.extend(this.params,this.options.requestParams),this._service?this._service.request(this.path,this.params,n,i):this._request("request",this.path,this.params,n,i)},_request:function(n,i,t,s,o){var h=this.options.proxy?this.options.proxy+"?"+this.options.url+i:this.options.url+i;return(n==="get"||n==="request")&&!this.options.useCors?qr.get.JSONP(h,t,s,o):qr[n](h,t,s,o)}}),hh=Gs.extend({setters:{offset:"resultOffset",limit:"resultRecordCount",fields:"outFields",precision:"geometryPrecision",featureIds:"objectIds",returnGeometry:"returnGeometry",returnM:"returnM",transform:"datumTransformation",token:"token"},path:"query",params:{returnGeometry:!0,where:"1=1",outSR:4326,outFields:"*"},within:function(n){return this._setGeometryParams(n),this.params.spatialRel="esriSpatialRelContains",this},intersects:function(n){return this._setGeometryParams(n),this.params.spatialRel="esriSpatialRelIntersects",this},contains:function(n){return this._setGeometryParams(n),this.params.spatialRel="esriSpatialRelWithin",this},crosses:function(n){return this._setGeometryParams(n),this.params.spatialRel="esriSpatialRelCrosses",this},touches:function(n){return this._setGeometryParams(n),this.params.spatialRel="esriSpatialRelTouches",this},overlaps:function(n){return this._setGeometryParams(n),this.params.spatialRel="esriSpatialRelOverlaps",this},bboxIntersects:function(n){return this._setGeometryParams(n),this.params.spatialRel="esriSpatialRelEnvelopeIntersects",this},indexIntersects:function(n){return this._setGeometryParams(n),this.params.spatialRel="esriSpatialRelIndexIntersects",this},nearby:function(n,i){return n=Q.exports.latLng(n),this.params.geometry=[n.lng,n.lat],this.params.geometryType="esriGeometryPoint",this.params.spatialRel="esriSpatialRelIntersects",this.params.units="esriSRUnit_Meter",this.params.distance=i,this.params.inSR=4326,this},where:function(n){return this.params.where=n,this},between:function(n,i){return this.params.time=[n.valueOf(),i.valueOf()],this},simplify:function(n,i){var t=Math.abs(n.getBounds().getWest()-n.getBounds().getEast());return this.params.maxAllowableOffset=t/n.getSize().y*i,this},orderBy:function(n,i){return i=i||"ASC",this.params.orderByFields=this.params.orderByFields?this.params.orderByFields+",":"",this.params.orderByFields+=[n,i].join(" "),this},run:function(n,i){return this._cleanParams(),this.options.isModern||ah(this.options.url)&&this.options.isModern===void 0?(this.params.f="geojson",this.request(function(t,s){this._trapSQLerrors(t),n.call(i,t,s,s)},this)):this.request(function(t,s){this._trapSQLerrors(t),n.call(i,t,s&&Hr(s),s)},this)},count:function(n,i){return this._cleanParams(),this.params.returnCountOnly=!0,this.request(function(t,s){n.call(this,t,s&&s.count,s)},i)},ids:function(n,i){return this._cleanParams(),this.params.returnIdsOnly=!0,this.request(function(t,s){n.call(this,t,s&&s.objectIds,s)},i)},bounds:function(n,i){return this._cleanParams(),this.params.returnExtentOnly=!0,this.request(function(t,s){s&&s.extent&&na(s.extent)?n.call(i,t,na(s.extent),s):(t={message:"Invalid Bounds"},n.call(i,t,null,s))},i)},distinct:function(){return this.params.returnGeometry=!1,this.params.returnDistinctValues=!0,this},pixelSize:function(n){var i=Q.exports.point(n);return this.params.pixelSize=[i.x,i.y],this},layer:function(n){return this.path=n+"/query",this},_trapSQLerrors:function(n){n&&n.code==="400"&&tn("one common syntax error in query requests is encasing string values in double quotes instead of single quotes")},_cleanParams:function(){delete this.params.returnIdsOnly,delete this.params.returnExtentOnly,delete this.params.returnCountOnly},_setGeometryParams:function(n){this.params.inSR=4326;var i=aa(n);this.params.geometry=i.geometry,this.params.geometryType=i.geometryType}});function js(n){return new hh(n)}var uh=Gs.extend({setters:{contains:"contains",text:"searchText",fields:"searchFields",spatialReference:"sr",sr:"sr",layers:"layers",returnGeometry:"returnGeometry",maxAllowableOffset:"maxAllowableOffset",precision:"geometryPrecision",dynamicLayers:"dynamicLayers",returnZ:"returnZ",returnM:"returnM",gdbVersion:"gdbVersion",token:"token"},path:"find",params:{sr:4326,contains:!0,returnGeometry:!0,returnZ:!0,returnM:!1},layerDefs:function(n,i){return this.params.layerDefs=this.params.layerDefs?this.params.layerDefs+";":"",this.params.layerDefs+=[n,i].join(":"),this},simplify:function(n,i){var t=Math.abs(n.getBounds().getWest()-n.getBounds().getEast());return this.params.maxAllowableOffset=t/n.getSize().y*i,this},run:function(n,i){return this.request(function(t,s){n.call(i,t,s&&Hr(s),s)},i)}});function ch(n){return new uh(n)}var la=Gs.extend({path:"identify",between:function(n,i){return this.params.time=[n.valueOf(),i.valueOf()],this}}),fh=la.extend({setters:{layers:"layers",precision:"geometryPrecision",tolerance:"tolerance",returnGeometry:"returnGeometry"},params:{sr:4326,layers:"all",tolerance:3,returnGeometry:!0},on:function(n){var i=ra(n.getBounds()),t=n.getSize();return this.params.imageDisplay=[t.x,t.y,96],this.params.mapExtent=[i.xmin,i.ymin,i.xmax,i.ymax],this},at:function(n){return n.length===2&&(n=Q.exports.latLng(n)),this._setGeometryParams(n),this},layerDef:function(n,i){return this.params.layerDefs=this.params.layerDefs?this.params.layerDefs+";":"",this.params.layerDefs+=[n,i].join(":"),this},simplify:function(n,i){var t=Math.abs(n.getBounds().getWest()-n.getBounds().getEast());return this.params.maxAllowableOffset=t/n.getSize().y*i,this},run:function(n,i){return this.request(function(t,s){if(t){n.call(i,t,void 0,s);return}else{var o=Hr(s);s.results=s.results.reverse();for(var h=0;h<o.features.length;h++){var c=o.features[h];c.layerId=s.results[h].layerId}n.call(i,void 0,o,s)}})},_setGeometryParams:function(n){var i=aa(n);this.params.geometry=i.geometry,this.params.geometryType=i.geometryType}});function dh(n){return new fh(n)}var ph=la.extend({setters:{setMosaicRule:"mosaicRule",setRenderingRule:"renderingRule",setPixelSize:"pixelSize",returnCatalogItems:"returnCatalogItems",returnGeometry:"returnGeometry"},params:{returnGeometry:!1},at:function(n){return n=Q.exports.latLng(n),this.params.geometry=JSON.stringify({x:n.lng,y:n.lat,spatialReference:{wkid:4326}}),this.params.geometryType="esriGeometryPoint",this},getMosaicRule:function(){return this.params.mosaicRule},getRenderingRule:function(){return this.params.renderingRule},getPixelSize:function(){return this.params.pixelSize},run:function(n,i){return this.request(function(t,s){n.call(i,t,s&&this._responseToGeoJSON(s),s)},this)},_responseToGeoJSON:function(n){var i=n.location,t=n.catalogItems,s=n.catalogItemVisibilities,o={pixel:{type:"Feature",geometry:{type:"Point",coordinates:[i.x,i.y]},crs:{type:"EPSG",properties:{code:i.spatialReference.wkid}},properties:{OBJECTID:n.objectId,name:n.name,value:n.value},id:n.objectId}};if(n.properties&&n.properties.Values&&(o.pixel.properties.values=n.properties.Values),t&&t.features&&(o.catalogItems=Hr(t),s&&s.length===o.catalogItems.features.length))for(var h=s.length-1;h>=0;h--)o.catalogItems.features[h].properties.catalogItemVisibility=s[h];return o}});function mh(n){return new ph(n)}var Us=Q.exports.Evented.extend({options:{proxy:!1,useCors:Ur,timeout:0},initialize:function(n){n=n||{},this._requestQueue=[],this._authenticating=!1,Q.exports.Util.setOptions(this,n),this.options.url=zs(this.options.url)},get:function(n,i,t,s){return this._request("get",n,i,t,s)},post:function(n,i,t,s){return this._request("post",n,i,t,s)},request:function(n,i,t,s){return this._request("request",n,i,t,s)},metadata:function(n,i){return this._request("get","",{},n,i)},authenticate:function(n){return this._authenticating=!1,this.options.token=n,this._runQueue(),this},getTimeout:function(){return this.options.timeout},setTimeout:function(n){this.options.timeout=n},_request:function(n,i,t,s,o){this.fire("requeststart",{url:this.options.url+i,params:t,method:n},!0);var h=this._createServiceCallback(n,i,t,s,o);if(this.options.token&&(t.token=this.options.token),this.options.requestParams&&Q.exports.Util.extend(t,this.options.requestParams),this._authenticating){this._requestQueue.push([n,i,t,s,o]);return}else{var c=this.options.proxy?this.options.proxy+"?"+this.options.url+i:this.options.url+i;return(n==="get"||n==="request")&&!this.options.useCors?qr.get.JSONP(c,t,h,o):qr[n](c,t,h,o)}},_createServiceCallback:function(n,i,t,s,o){return Q.exports.Util.bind(function(h,c){h&&(h.code===499||h.code===498)&&(this._authenticating=!0,this._requestQueue.push([n,i,t,s,o]),this.fire("authenticationrequired",{authenticate:Q.exports.Util.bind(this.authenticate,this)},!0),h.authenticate=Q.exports.Util.bind(this.authenticate,this)),s.call(o,h,c),h?this.fire("requesterror",{url:this.options.url+i,params:t,message:h.message,code:h.code,method:n},!0):this.fire("requestsuccess",{url:this.options.url+i,params:t,response:c,method:n},!0),this.fire("requestend",{url:this.options.url+i,params:t,method:n},!0)},this)},_runQueue:function(){for(var n=this._requestQueue.length-1;n>=0;n--){var i=this._requestQueue[n],t=i.shift();this[t].apply(this,i)}this._requestQueue=[]}}),gh=Us.extend({identify:function(){return dh(this)},find:function(){return ch(this)},query:function(){return js(this)}});function ha(n){return new gh(n)}var _h=Us.extend({query:function(){return js(this)},identify:function(){return mh(this)}});function yh(n){return new _h(n)}var vh=Us.extend({options:{idAttribute:"OBJECTID"},query:function(){return js(this)},addFeature:function(n,i,t){this.addFeatures(n,i,t)},addFeatures:function(n,i,t){for(var s=n.features?n.features:[n],o=s.length-1;o>=0;o--)delete s[o].id;return n=Vr(n),n=s.length>1?n:[n],this.post("addFeatures",{features:n},function(h,c){var d=c&&c.addResults?c.addResults.length>1?c.addResults:c.addResults[0]:void 0;i&&i.call(t,h||c.addResults[0].error,d)},t)},updateFeature:function(n,i,t){this.updateFeatures(n,i,t)},updateFeatures:function(n,i,t){var s=n.features?n.features:[n];return n=Vr(n,this.options.idAttribute),n=s.length>1?n:[n],this.post("updateFeatures",{features:n},function(o,h){var c=h&&h.updateResults?h.updateResults.length>1?h.updateResults:h.updateResults[0]:void 0;i&&i.call(t,o||h.updateResults[0].error,c)},t)},deleteFeature:function(n,i,t){this.deleteFeatures(n,i,t)},deleteFeatures:function(n,i,t){return this.post("deleteFeatures",{objectIds:n},function(s,o){var h=o&&o.deleteResults?o.deleteResults.length>1?o.deleteResults:o.deleteResults[0]:void 0;i&&i.call(t,s||o.deleteResults[0].error,h)},t)}});function bh(n){return new vh(n)}var le=window.location.protocol!=="https:"?"http:":"https:",ua=Q.exports.TileLayer.extend({statics:{TILES:{Streets:{urlTemplate:le+"//{s}.arcgisonline.com/ArcGIS/rest/services/World_Street_Map/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:19,subdomains:["server","services"],attribution:"USGS, NOAA",attributionUrl:"https://static.arcgis.com/attribution/World_Street_Map"}},Topographic:{urlTemplate:le+"//{s}.arcgisonline.com/ArcGIS/rest/services/World_Topo_Map/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:19,subdomains:["server","services"],attribution:"USGS, NOAA",attributionUrl:"https://static.arcgis.com/attribution/World_Topo_Map"}},Oceans:{urlTemplate:le+"//{s}.arcgisonline.com/arcgis/rest/services/Ocean/World_Ocean_Base/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:16,subdomains:["server","services"],attribution:"USGS, NOAA",attributionUrl:"https://static.arcgis.com/attribution/Ocean_Basemap"}},OceansLabels:{urlTemplate:le+"//{s}.arcgisonline.com/arcgis/rest/services/Ocean/World_Ocean_Reference/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:16,subdomains:["server","services"],pane:Ri?"esri-labels":"tilePane",attribution:""}},NationalGeographic:{urlTemplate:le+"//{s}.arcgisonline.com/ArcGIS/rest/services/NatGeo_World_Map/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:16,subdomains:["server","services"],attribution:"National Geographic, DeLorme, HERE, UNEP-WCMC, USGS, NASA, ESA, METI, NRCAN, GEBCO, NOAA, increment P Corp."}},DarkGray:{urlTemplate:le+"//{s}.arcgisonline.com/ArcGIS/rest/services/Canvas/World_Dark_Gray_Base/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:16,subdomains:["server","services"],attribution:"HERE, DeLorme, MapmyIndia, &copy; OpenStreetMap contributors"}},DarkGrayLabels:{urlTemplate:le+"//{s}.arcgisonline.com/ArcGIS/rest/services/Canvas/World_Dark_Gray_Reference/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:16,subdomains:["server","services"],pane:Ri?"esri-labels":"tilePane",attribution:""}},Gray:{urlTemplate:le+"//{s}.arcgisonline.com/ArcGIS/rest/services/Canvas/World_Light_Gray_Base/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:16,subdomains:["server","services"],attribution:"HERE, DeLorme, MapmyIndia, &copy; OpenStreetMap contributors"}},GrayLabels:{urlTemplate:le+"//{s}.arcgisonline.com/ArcGIS/rest/services/Canvas/World_Light_Gray_Reference/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:16,subdomains:["server","services"],pane:Ri?"esri-labels":"tilePane",attribution:""}},Imagery:{urlTemplate:le+"//{s}.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:19,subdomains:["server","services"],attribution:"DigitalGlobe, GeoEye, i-cubed, USDA, USGS, AEX, Getmapping, Aerogrid, IGN, IGP, swisstopo, and the GIS User Community",attributionUrl:"https://static.arcgis.com/attribution/World_Imagery"}},ImageryLabels:{urlTemplate:le+"//{s}.arcgisonline.com/ArcGIS/rest/services/Reference/World_Boundaries_and_Places/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:19,subdomains:["server","services"],pane:Ri?"esri-labels":"tilePane",attribution:""}},ImageryTransportation:{urlTemplate:le+"//{s}.arcgisonline.com/ArcGIS/rest/services/Reference/World_Transportation/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:19,subdomains:["server","services"],pane:Ri?"esri-labels":"tilePane",attribution:""}},ShadedRelief:{urlTemplate:le+"//{s}.arcgisonline.com/ArcGIS/rest/services/World_Shaded_Relief/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:13,subdomains:["server","services"],attribution:"USGS"}},ShadedReliefLabels:{urlTemplate:le+"//{s}.arcgisonline.com/ArcGIS/rest/services/Reference/World_Boundaries_and_Places_Alternate/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:12,subdomains:["server","services"],pane:Ri?"esri-labels":"tilePane",attribution:""}},Terrain:{urlTemplate:le+"//{s}.arcgisonline.com/ArcGIS/rest/services/World_Terrain_Base/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:13,subdomains:["server","services"],attribution:"USGS, NOAA"}},TerrainLabels:{urlTemplate:le+"//{s}.arcgisonline.com/ArcGIS/rest/services/Reference/World_Reference_Overlay/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:13,subdomains:["server","services"],pane:Ri?"esri-labels":"tilePane",attribution:""}},USATopo:{urlTemplate:le+"//{s}.arcgisonline.com/ArcGIS/rest/services/USA_Topo_Maps/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:15,subdomains:["server","services"],attribution:"USGS, National Geographic Society, i-cubed"}},ImageryClarity:{urlTemplate:le+"//clarity.maptiles.arcgis.com/arcgis/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:19,attribution:"Esri, DigitalGlobe, GeoEye, Earthstar Geographics, CNES/Airbus DS, USDA, USGS, AeroGRID, IGN, and the GIS User Community"}},Physical:{urlTemplate:le+"//{s}.arcgisonline.com/arcgis/rest/services/World_Physical_Map/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:8,subdomains:["server","services"],attribution:"U.S. National Park Service"}},ImageryFirefly:{urlTemplate:le+"//fly.maptiles.arcgis.com/arcgis/rest/services/World_Imagery_Firefly/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:19,attribution:"Esri, DigitalGlobe, GeoEye, Earthstar Geographics, CNES/Airbus DS, USDA, USGS, AeroGRID, IGN, and the GIS User Community",attributionUrl:"https://static.arcgis.com/attribution/World_Imagery"}}}},initialize:function(n,i){var t;if(typeof n=="object"&&n.urlTemplate&&n.options)t=n;else if(typeof n=="string"&&ua.TILES[n])t=ua.TILES[n];else throw new Error('L.esri.BasemapLayer: Invalid parameter. Use one of "Streets", "Topographic", "Oceans", "OceansLabels", "NationalGeographic", "Physical", "Gray", "GrayLabels", "DarkGray", "DarkGrayLabels", "Imagery", "ImageryLabels", "ImageryTransportation", "ImageryClarity", "ImageryFirefly", ShadedRelief", "ShadedReliefLabels", "Terrain", "TerrainLabels" or "USATopo"');var s=Q.exports.Util.extend(t.options,i);Q.exports.Util.setOptions(this,s),this.options.ignoreDeprecationWarning||console.warn("WARNING: L.esri.BasemapLayer uses data services that are in mature support and are not being updated. Please use L.esri.Vector.vectorBasemapLayer instead. More info: https://esriurl.com/esri-leaflet-basemap"),this.options.token&&t.urlTemplate.indexOf("token=")===-1&&(t.urlTemplate+="?token="+this.options.token),this.options.proxy&&(t.urlTemplate=this.options.proxy+"?"+t.urlTemplate),Q.exports.TileLayer.prototype.initialize.call(this,t.urlTemplate,s)},onAdd:function(n){Kr(n),this.options.pane==="esri-labels"&&this._initPane(),this.options.attributionUrl&&lh((this.options.proxy?this.options.proxy+"?":"")+this.options.attributionUrl,n),n.on("moveend",Fs),Q.exports.TileLayer.prototype.onAdd.call(this,n)},onRemove:function(n){Xr(n),n.off("moveend",Fs),Q.exports.TileLayer.prototype.onRemove.call(this,n)},_initPane:function(){if(!this._map.getPane(this.options.pane)){var n=this._map.createPane(this.options.pane);n.style.pointerEvents="none",n.style.zIndex=500}},getAttribution:function(){if(this.options.attribution)var n='<span class="esri-dynamic-attribution">'+this.options.attribution+"</span>";return n}}),xh=Q.exports.TileLayer.extend({options:{zoomOffsetAllowance:.1,errorTileUrl:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAQAAAAEABAMAAACuXLVVAAAAA1BMVEUzNDVszlHHAAAAAXRSTlMAQObYZgAAAAlwSFlzAAAAAAAAAAAB6mUWpAAAADZJREFUeJztwQEBAAAAgiD/r25IQAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA7waBAAABw08RwAAAAABJRU5ErkJggg=="},statics:{MercatorZoomLevels:{"0":156543.033928,"1":78271.5169639999,"2":39135.7584820001,"3":19567.8792409999,"4":9783.93962049996,"5":4891.96981024998,"6":2445.98490512499,"7":1222.99245256249,"8":611.49622628138,"9":305.748113140558,"10":152.874056570411,"11":76.4370282850732,"12":38.2185141425366,"13":19.1092570712683,"14":9.55462853563415,"15":4.77731426794937,"16":2.38865713397468,"17":1.19432856685505,"18":.597164283559817,"19":.298582141647617,"20":.14929107082381,"21":.07464553541191,"22":.0373227677059525,"23":.0186613838529763}},initialize:function(n){n=Q.exports.Util.setOptions(this,n),n=$r(n),this.tileUrl=(n.proxy?n.proxy+"?":"")+n.url+"tile/{z}/{y}/{x}"+(n.requestParams&&Object.keys(n.requestParams).length>0?Q.exports.Util.getParamString(n.requestParams):""),n.url.indexOf("{s}")!==-1&&n.subdomains&&(n.url=n.url.replace("{s}",n.subdomains[0])),this.service=ha(n),this.service.addEventParent(this);var i=new RegExp(/tiles.arcgis(online)?\.com/g);i.test(n.url)&&(this.tileUrl=this.tileUrl.replace("://tiles","://tiles{s}"),n.subdomains=["1","2","3","4"]),this.options.token&&(this.tileUrl+="?token="+this.options.token),Q.exports.TileLayer.prototype.initialize.call(this,this.tileUrl,n)},getTileUrl:function(n){var i=this._getZoomForUrl();return Q.exports.Util.template(this.tileUrl,Q.exports.Util.extend({s:this._getSubdomain(n),x:n.x,y:n.y,z:this._lodMap&&this._lodMap[i]?this._lodMap[i]:i},this.options))},createTile:function(n,i){var t=document.createElement("img");return Q.exports.DomEvent.on(t,"load",Q.exports.Util.bind(this._tileOnLoad,this,i,t)),Q.exports.DomEvent.on(t,"error",Q.exports.Util.bind(this._tileOnError,this,i,t)),this.options.crossOrigin&&(t.crossOrigin=""),t.alt="",!this._lodMap||this._lodMap&&this._lodMap[this._getZoomForUrl()]?t.src=this.getTileUrl(n):this.once("lodmap",function(){t.src=this.getTileUrl(n)},this),t},onAdd:function(n){Kr(n),this._lodMap||this.metadata(function(i,t){if(!i&&t.spatialReference){var s=t.spatialReference.latestWkid||t.spatialReference.wkid;if(!this.options.attribution&&n.attributionControl&&t.copyrightText&&(this.options.attribution=t.copyrightText,n.attributionControl.addAttribution(this.getAttribution())),n.options.crs===Q.exports.CRS.EPSG3857&&(s===102100||s===3857)){this._lodMap={};for(var o=t.tileInfo.lods,h=xh.MercatorZoomLevels,c=0;c<o.length;c++){var d=o[c];for(var y in h){var _=h[y];if(this._withinPercentage(d.resolution,_,this.options.zoomOffsetAllowance)){this._lodMap[y]=d.level;break}}}this.fire("lodmap")}else n.options.crs&&n.options.crs.code&&n.options.crs.code.indexOf(s)>-1||tn("L.esri.TiledMapLayer is using a non-mercator spatial reference. Support may be available through Proj4Leaflet http://esri.github.io/esri-leaflet/examples/non-mercator-projection.html")}},this),Q.exports.TileLayer.prototype.onAdd.call(this,n)},onRemove:function(n){Xr(n),Q.exports.TileLayer.prototype.onRemove.call(this,n)},metadata:function(n,i){return this.service.metadata(n,i),this},identify:function(){return this.service.identify()},find:function(){return this.service.find()},query:function(){return this.service.query()},authenticate:function(n){var i="?token="+n;return this.tileUrl=this.options.token?this.tileUrl.replace(/\?token=(.+)/g,i):this.tileUrl+i,this.options.token=n,this.service.authenticate(n),this},_withinPercentage:function(n,i,t){var s=Math.abs(n/i-1);return s<t}}),Lh=Q.exports.ImageOverlay.extend({onAdd:function(n){this._topLeft=n.getPixelBounds().min,Q.exports.ImageOverlay.prototype.onAdd.call(this,n)},_reset:function(){this._map.options.crs===Q.exports.CRS.EPSG3857?Q.exports.ImageOverlay.prototype._reset.call(this):Q.exports.DomUtil.setPosition(this._image,this._topLeft.subtract(this._map.getPixelOrigin()))}}),ca=Q.exports.Layer.extend({options:{opacity:1,position:"front",f:"image",useCors:Ur,attribution:null,interactive:!1,alt:""},onAdd:function(n){Kr(n),this.options.zIndex&&(this.options.position=null),this._update=Q.exports.Util.throttle(this._update,this.options.updateInterval,this),n.on("moveend",this._update,this),this._currentImage&&this._currentImage._bounds.equals(this._map.getBounds())?n.addLayer(this._currentImage):this._currentImage&&(this._map.removeLayer(this._currentImage),this._currentImage=null),this._update(),this._popup&&(this._map.on("click",this._getPopupData,this),this._map.on("dblclick",this._resetPopupState,this)),this.metadata(function(i,t){!i&&!this.options.attribution&&n.attributionControl&&t.copyrightText&&(this.options.attribution=t.copyrightText,n.attributionControl.addAttribution(this.getAttribution()))},this)},onRemove:function(n){Xr(n),this._currentImage&&this._map.removeLayer(this._currentImage),this._popup&&(this._map.off("click",this._getPopupData,this),this._map.off("dblclick",this._resetPopupState,this)),this._map.off("moveend",this._update,this)},bindPopup:function(n,i){return this._shouldRenderPopup=!1,this._lastClick=!1,this._popup=Q.exports.popup(i),this._popupFunction=n,this._map&&(this._map.on("click",this._getPopupData,this),this._map.on("dblclick",this._resetPopupState,this)),this},unbindPopup:function(){return this._map&&(this._map.closePopup(this._popup),this._map.off("click",this._getPopupData,this),this._map.off("dblclick",this._resetPopupState,this)),this._popup=!1,this},bringToFront:function(){return this.options.position="front",this._currentImage&&(this._currentImage.bringToFront(),this._setAutoZIndex(Math.max)),this},bringToBack:function(){return this.options.position="back",this._currentImage&&(this._currentImage.bringToBack(),this._setAutoZIndex(Math.min)),this},setZIndex:function(n){return this.options.zIndex=n,this._currentImage&&this._currentImage.setZIndex(n),this},_setAutoZIndex:function(n){if(!!this._currentImage){for(var i=this._currentImage.getPane().children,t=-n(-1/0,1/0),s=0,o=i.length,h;s<o;s++)h=i[s].style.zIndex,i[s]!==this._currentImage._image&&h&&(t=n(t,+h));isFinite(t)&&(this.options.zIndex=t+n(-1,1),this.setZIndex(this.options.zIndex))}},getAttribution:function(){return this.options.attribution},getOpacity:function(){return this.options.opacity},setOpacity:function(n){return this.options.opacity=n,this._currentImage&&this._currentImage.setOpacity(n),this},getTimeRange:function(){return[this.options.from,this.options.to]},setTimeRange:function(n,i){return this.options.from=n,this.options.to=i,this._update(),this},metadata:function(n,i){return this.service.metadata(n,i),this},authenticate:function(n){return this.service.authenticate(n),this},redraw:function(){this._update()},_renderImage:function(n,i,t){if(this._map){if(t&&(n="data:"+t+";base64,"+n),!n)return;var s=new Lh(n,i,{opacity:0,crossOrigin:this.options.withCredentials?"use-credentials":this.options.useCors,alt:this.options.alt,pane:this.options.pane||this.getPane(),interactive:this.options.interactive}).addTo(this._map),o=function(){this._map.removeLayer(s),this.fire("error"),s.off("load",h,this)},h=function(c){if(s.off("error",h,this),this._map){var d=c.target,y=this._currentImage;d._bounds.equals(i)&&d._bounds.equals(this._map.getBounds())?(this._currentImage=d,this.options.position==="front"?this.bringToFront():this.options.position==="back"&&this.bringToBack(),this.options.zIndex&&this.setZIndex(this.options.zIndex),this._map&&this._currentImage._map?this._currentImage.setOpacity(this.options.opacity):this._currentImage._map.removeLayer(this._currentImage),y&&this._map&&this._map.removeLayer(y),y&&y._map&&y._map.removeLayer(y)):this._map.removeLayer(d)}this.fire("load",{bounds:i})};s.once("error",o,this),s.once("load",h,this)}},_update:function(){if(!!this._map){var n=this._map.getZoom(),i=this._map.getBounds();if(!this._animatingZoom&&!(this._map._panTransition&&this._map._panTransition._inProgress)){if(n>this.options.maxZoom||n<this.options.minZoom){this._currentImage&&(this._currentImage._map.removeLayer(this._currentImage),this._currentImage=null);return}var t=this._buildExportParams();Q.exports.Util.extend(t,this.options.requestParams),t?(this._requestExport(t,i),this.fire("loading",{bounds:i})):this._currentImage&&(this._currentImage._map.removeLayer(this._currentImage),this._currentImage=null)}}},_renderPopup:function(n,i,t,s){if(n=Q.exports.latLng(n),this._shouldRenderPopup&&this._lastClick.equals(n)){var o=this._popupFunction(i,t,s);o&&this._popup.setLatLng(n).setContent(o).openOn(this._map)}},_resetPopupState:function(n){this._shouldRenderPopup=!1,this._lastClick=n.latlng},_calculateBbox:function(){var n=this._map.getPixelBounds(),i=this._map.unproject(n.getBottomLeft()),t=this._map.unproject(n.getTopRight()),s=this._map.options.crs.project(t),o=this._map.options.crs.project(i),h=Q.exports.bounds(s,o);return[h.getBottomLeft().x,h.getBottomLeft().y,h.getTopRight().x,h.getTopRight().y].join(",")},_calculateImageSize:function(){var n=this._map.getPixelBounds(),i=this._map.getSize(),t=this._map.unproject(n.getBottomLeft()),s=this._map.unproject(n.getTopRight()),o=this._map.latLngToLayerPoint(s).y,h=this._map.latLngToLayerPoint(t).y;return(o>0||h<i.y)&&(i.y=h-o),i.x+","+i.y}});ca.extend({options:{updateInterval:150,format:"jpgpng",transparent:!0,f:"image"},query:function(){return this.service.query()},identify:function(){return this.service.identify()},initialize:function(n){n=$r(n),this.service=yh(n),this.service.addEventParent(this),Q.exports.Util.setOptions(this,n)},setPixelType:function(n){return this.options.pixelType=n,this._update(),this},getPixelType:function(){return this.options.pixelType},setBandIds:function(n){return Q.exports.Util.isArray(n)?this.options.bandIds=n.join(","):this.options.bandIds=n.toString(),this._update(),this},getBandIds:function(){return this.options.bandIds},setNoData:function(n,i){return Q.exports.Util.isArray(n)?this.options.noData=n.join(","):this.options.noData=n.toString(),i&&(this.options.noDataInterpretation=i),this._update(),this},getNoData:function(){return this.options.noData},getNoDataInterpretation:function(){return this.options.noDataInterpretation},setRenderingRule:function(n){this.options.renderingRule=n,this._update()},getRenderingRule:function(){return this.options.renderingRule},setMosaicRule:function(n){this.options.mosaicRule=n,this._update()},getMosaicRule:function(){return this.options.mosaicRule},_getPopupData:function(n){var i=Q.exports.Util.bind(function(s,o,h){s||setTimeout(Q.exports.Util.bind(function(){this._renderPopup(n.latlng,s,o,h)},this),300)},this),t=this.identify().at(n.latlng);this.options.mosaicRule&&t.setMosaicRule(this.options.mosaicRule),t.run(i),this._shouldRenderPopup=!0,this._lastClick=n.latlng},_buildExportParams:function(){var n=parseInt(this._map.options.crs.code.split(":")[1],10),i={bbox:this._calculateBbox(),size:this._calculateImageSize(),format:this.options.format,transparent:this.options.transparent,bboxSR:n,imageSR:n};return this.options.from&&this.options.to&&(i.time=this.options.from.valueOf()+","+this.options.to.valueOf()),this.options.pixelType&&(i.pixelType=this.options.pixelType),this.options.interpolation&&(i.interpolation=this.options.interpolation),this.options.compressionQuality&&(i.compressionQuality=this.options.compressionQuality),this.options.bandIds&&(i.bandIds=this.options.bandIds),(this.options.noData===0||this.options.noData)&&(i.noData=this.options.noData),this.options.noDataInterpretation&&(i.noDataInterpretation=this.options.noDataInterpretation),this.service.options.token&&(i.token=this.service.options.token),this.options.renderingRule&&(i.renderingRule=JSON.stringify(this.options.renderingRule)),this.options.mosaicRule&&(i.mosaicRule=JSON.stringify(this.options.mosaicRule)),i},_requestExport:function(n,i){if(this.options.f==="json")this.service.request("exportImage",n,function(s,o){s||(this.options.token&&(o.href+="?token="+this.options.token),this.options.proxy&&(o.href=this.options.proxy+"?"+o.href),this._renderImage(o.href,i))},this);else{n.f="image";var t=this.options.url+"exportImage"+Q.exports.Util.getParamString(n);this.options.proxy&&(t=this.options.proxy+"?"+t),this._renderImage(t,i)}}});var wh=ca.extend({options:{updateInterval:150,layers:!1,layerDefs:!1,timeOptions:!1,format:"png32",transparent:!0,f:"json"},initialize:function(n){n=$r(n),this.service=ha(n),this.service.addEventParent(this),Q.exports.Util.setOptions(this,n)},getDynamicLayers:function(){return this.options.dynamicLayers},setDynamicLayers:function(n){return this.options.dynamicLayers=n,this._update(),this},getLayers:function(){return this.options.layers},setLayers:function(n){return this.options.layers=n,this._update(),this},getLayerDefs:function(){return this.options.layerDefs},setLayerDefs:function(n){return this.options.layerDefs=n,this._update(),this},getTimeOptions:function(){return this.options.timeOptions},setTimeOptions:function(n){return this.options.timeOptions=n,this._update(),this},query:function(){return this.service.query()},identify:function(){return this.service.identify()},find:function(){return this.service.find()},_getPopupData:function(n){var i=Q.exports.Util.bind(function(o,h,c){o||setTimeout(Q.exports.Util.bind(function(){this._renderPopup(n.latlng,o,h,c)},this),300)},this),t;if(this.options.popup?t=this.options.popup.on(this._map).at(n.latlng):t=this.identify().on(this._map).at(n.latlng),t.params.maxAllowableOffset||t.simplify(this._map,.5),this.options.popup&&this.options.popup.params&&this.options.popup.params.layers||(this.options.layers?t.layers("visible:"+this.options.layers.join(",")):t.layers("visible")),this.options.layerDefs&&typeof this.options.layerDefs!="string"&&!t.params.layerDefs)for(var s in this.options.layerDefs)this.options.layerDefs.hasOwnProperty(s)&&t.layerDef(s,this.options.layerDefs[s]);t.run(i),this._shouldRenderPopup=!0,this._lastClick=n.latlng},_buildExportParams:function(){var n=parseInt(this._map.options.crs.code.split(":")[1],10),i={bbox:this._calculateBbox(),size:this._calculateImageSize(),dpi:96,format:this.options.format,transparent:this.options.transparent,bboxSR:n,imageSR:n};if(this.options.dynamicLayers&&(i.dynamicLayers=this.options.dynamicLayers),this.options.layers){if(this.options.layers.length===0)return;i.layers="show:"+this.options.layers.join(",")}return this.options.layerDefs&&(i.layerDefs=typeof this.options.layerDefs=="string"?this.options.layerDefs:JSON.stringify(this.options.layerDefs)),this.options.timeOptions&&(i.timeOptions=JSON.stringify(this.options.timeOptions)),this.options.from&&this.options.to&&(i.time=this.options.from.valueOf()+","+this.options.to.valueOf()),this.service.options.token&&(i.token=this.service.options.token),this.options.proxy&&(i.proxy=this.options.proxy),this.options.disableCache&&(i._ts=Date.now()),i},_requestExport:function(n,i){if(this.options.f==="json")this.service.request("export",n,function(s,o){s||(this.options.token&&o.href&&(o.href+="?token="+this.options.token),this.options.proxy&&o.href&&(o.href=this.options.proxy+"?"+o.href),o.href?this._renderImage(o.href,i):this._renderImage(o.imageData,i,o.contentType))},this);else{n.f="image";var t=this.options.url+"export"+Q.exports.Util.getParamString(n);this.options.proxy&&(t=this.options.proxy+"?"+t),this._renderImage(t,i)}}});function Mf(n,i){return new wh(n,i)}var Yr=Q.exports.Layer.extend({options:{cellSize:512,updateWhenIdle:Q.exports.Browser.mobile,updateInterval:150,noWrap:!1,keepBuffer:1.5},initialize:function(n){Q.exports.Util.setOptions(this,n)},onAdd:function(n){this._cells={},this._activeCells={},this._resetView(),this._update()},onRemove:function(n){this._removeAllCells(),this._cellZoom=void 0},isLoading:function(){return this._loading},redraw:function(){return this._map&&(this._removeAllCells(),this._update()),this},getEvents:function(){var n={viewprereset:this._invalidateAll,viewreset:this._resetView,zoom:this._resetView,moveend:this._onMoveEnd};return this.options.updateWhenIdle||(this._onMove||(this._onMove=Q.exports.Util.throttle(this._onMoveEnd,this.options.updateInterval,this)),n.move=this._onMove),n},createCell:function(){return document.createElement("div")},removeCell:function(){},reuseCell:function(){},cellLeave:function(){},cellEnter:function(){},getCellSize:function(){var n=this.options.cellSize;return n instanceof Q.exports.Point?n:new Q.exports.Point(n,n)},_pruneCells:function(){if(!!this._map){var n,i;for(n in this._cells)i=this._cells[n],i.retain=i.current;for(n in this._cells)if(i=this._cells[n],i.current&&!i.active){var t=i.coords;this._retainParent(t.x,t.y,t.z,t.z-5)||this._retainChildren(t.x,t.y,t.z,t.z+2)}for(n in this._cells)this._cells[n].retain||this._removeCell(n)}},_removeAllCells:function(){for(var n in this._cells)this._removeCell(n)},_invalidateAll:function(){this._removeAllCells(),this._cellZoom=void 0},_retainParent:function(n,i,t,s){var o=Math.floor(n/2),h=Math.floor(i/2),c=t-1,d=new Q.exports.Point(+o,+h);d.z=+c;var y=this._cellCoordsToKey(d),_=this._cells[y];return _&&_.active?(_.retain=!0,!0):(_&&_.loaded&&(_.retain=!0),c>s?this._retainParent(o,h,c,s):!1)},_retainChildren:function(n,i,t,s){for(var o=2*n;o<2*n+2;o++)for(var h=2*i;h<2*i+2;h++){var c=new Q.exports.Point(o,h);c.z=t+1;var d=this._cellCoordsToKey(c),y=this._cells[d];if(y&&y.active){y.retain=!0;continue}else y&&y.loaded&&(y.retain=!0);t+1<s&&this._retainChildren(o,h,t+1,s)}},_resetView:function(n){var i=n&&(n.pinch||n.flyTo);i||this._setView(this._map.getCenter(),this._map.getZoom(),i,i)},_setView:function(n,i,t,s){var o=Math.round(i);s||(this._cellZoom=o,this._abortLoading&&this._abortLoading(),this._resetGrid(),o!==void 0&&this._update(n),t||this._pruneCells(),this._noPrune=!!t)},_resetGrid:function(){var n=this._map,i=n.options.crs,t=this._cellSize=this.getCellSize(),s=this._cellZoom,o=this._map.getPixelWorldBounds(this._cellZoom);o&&(this._globalCellRange=this._pxBoundsToCellRange(o)),this._wrapX=i.wrapLng&&!this.options.noWrap&&[Math.floor(n.project([0,i.wrapLng[0]],s).x/t.x),Math.ceil(n.project([0,i.wrapLng[1]],s).x/t.y)],this._wrapY=i.wrapLat&&!this.options.noWrap&&[Math.floor(n.project([i.wrapLat[0],0],s).y/t.x),Math.ceil(n.project([i.wrapLat[1],0],s).y/t.y)]},_onMoveEnd:function(n){var i=n&&(n.pinch||n.flyTo);i||!this._map||this._map._animatingZoom||this._update()},_getCelldPixelBounds:function(n){var i=this._map,t=i._animatingZoom?Math.max(i._animateToZoom,i.getZoom()):i.getZoom(),s=i.getZoomScale(t,this._cellZoom),o=i.project(n,this._cellZoom).floor(),h=i.getSize().divideBy(s*2);return new Q.exports.Bounds(o.subtract(h),o.add(h))},_update:function(n){var i=this._map;if(!!i){var t=Math.round(i.getZoom());n===void 0&&(n=i.getCenter());var s=this._getCelldPixelBounds(n),o=this._pxBoundsToCellRange(s),h=o.getCenter(),c=[],d=this.options.keepBuffer,y=new Q.exports.Bounds(o.getBottomLeft().subtract([d,-d]),o.getTopRight().add([d,-d]));if(!(isFinite(o.min.x)&&isFinite(o.min.y)&&isFinite(o.max.x)&&isFinite(o.max.y)))throw new Error("Attempted to load an infinite number of cells");for(var _ in this._cells){var v=this._cells[_].coords;(v.z!==this._cellZoom||!y.contains(new Q.exports.Point(v.x,v.y)))&&(this._cells[_].current=!1)}if(Math.abs(t-this._cellZoom)>1){this._setView(n,t);return}for(var x=o.min.y;x<=o.max.y;x++)for(var w=o.min.x;w<=o.max.x;w++){var C=new Q.exports.Point(w,x);if(C.z=this._cellZoom,!!this._isValidCell(C)){var A=this._cells[this._cellCoordsToKey(C)];A?A.current=!0:c.push(C)}}if(c.sort(function(P,E){return P.distanceTo(h)-E.distanceTo(h)}),c.length!==0)for(this._loading||(this._loading=!0),w=0;w<c.length;w++){var I=this._cellCoordsToKey(c[w]),R=this._keyToCellCoords(I);this._activeCells[R]?this._reuseCell(c[w]):this._createCell(c[w])}}},_isValidCell:function(n){var i=this._map.options.crs;if(!i.infinite){var t=this._globalCellRange;if(!i.wrapLng&&(n.x<t.min.x||n.x>t.max.x)||!i.wrapLat&&(n.y<t.min.y||n.y>t.max.y))return!1}if(!this.options.bounds)return!0;var s=this._cellCoordsToBounds(n);return Q.exports.toLatLngBounds(this.options.bounds).overlaps(s)},_keyToBounds:function(n){return this._cellCoordsToBounds(this._keyToCellCoords(n))},_cellCoordsToNwSe:function(n){var i=this._map,t=this.getCellSize(),s=n.scaleBy(t),o=s.add(t),h=i.unproject(s,n.z),c=i.unproject(o,n.z);return[h,c]},_cellCoordsToBounds:function(n){var i=this._cellCoordsToNwSe(n),t=new Q.exports.LatLngBounds(i[0],i[1]);return this.options.noWrap||(t=this._map.wrapLatLngBounds(t)),t},_cellCoordsToKey:function(n){return n.x+":"+n.y+":"+n.z},_keyToCellCoords:function(n){var i=n.split(":"),t=new Q.exports.Point(+i[0],+i[1]);return t.z=+i[2],t},_removeCell:function(n){var i=this._cells[n];if(!!i){var t=this._keyToCellCoords(n),s=this._wrapCoords(t),o=this._cellCoordsToBounds(this._wrapCoords(t));i.current=!1,delete this._cells[n],this._activeCells[n]=i,this.cellLeave(o,s,n),this.fire("cellleave",{key:n,coords:s,bounds:o})}},_reuseCell:function(n){var i=this._cellCoordsToKey(n);this._cells[i]=this._activeCells[i],this._cells[i].current=!0;var t=this._wrapCoords(n),s=this._cellCoordsToBounds(this._wrapCoords(n));this.cellEnter(s,t,i),this.fire("cellenter",{key:i,coords:t,bounds:s})},_createCell:function(n){var i=this._cellCoordsToKey(n),t=this._wrapCoords(n),s=this._cellCoordsToBounds(this._wrapCoords(n));this.createCell(s,t,i),this.fire("cellcreate",{key:i,coords:t,bounds:s}),this._cells[i]={coords:n,current:!0},Q.exports.Util.requestAnimFrame(this._pruneCells,this)},_cellReady:function(n,i,t){var s=this._cellCoordsToKey(n);t=this._cells[s],!!t&&(t.loaded=+new Date,t.active=!0)},_getCellPos:function(n){return n.scaleBy(this.getCellSize())},_wrapCoords:function(n){var i=new Q.exports.Point(this._wrapX?Q.exports.Util.wrapNum(n.x,this._wrapX):n.x,this._wrapY?Q.exports.Util.wrapNum(n.y,this._wrapY):n.y);return i.z=n.z,i},_pxBoundsToCellRange:function(n){var i=this.getCellSize();return new Q.exports.Bounds(n.min.unscaleBy(i).floor(),n.max.unscaleBy(i).ceil().subtract([1,1]))}});function wi(n){this.values=[].concat(n||[])}wi.prototype.query=function(n){var i=this.getIndex(n);return this.values[i]};wi.prototype.getIndex=function(i){this.dirty&&this.sort();for(var t=0,s=this.values.length-1,o,h;t<=s;)if(o=(t+s)/2|0,h=this.values[Math.round(o)],+h.value<+i)t=o+1;else if(+h.value>+i)s=o-1;else return o;return Math.abs(~s)};wi.prototype.between=function(i,t){var s=this.getIndex(i),o=this.getIndex(t);if(s===0&&o===0)return[];for(;this.values[s-1]&&this.values[s-1].value===i;)s--;for(;this.values[o+1]&&this.values[o+1].value===t;)o++;return this.values[o]&&this.values[o].value===t&&this.values[o+1]&&o++,this.values.slice(s,o)};wi.prototype.insert=function(i){return this.values.splice(this.getIndex(i.value),0,i),this};wi.prototype.bulkAdd=function(i,t){return this.values=this.values.concat([].concat(i||[])),t?this.sort():this.dirty=!0,this};wi.prototype.sort=function(){return this.values.sort(function(i,t){return+t.value-+i.value}).reverse(),this.dirty=!1,this};var Zs=Yr.extend({options:{attribution:null,where:"1=1",fields:["*"],from:!1,to:!1,timeField:!1,timeFilterMode:"server",simplifyFactor:0,precision:6,fetchAllFeatures:!1},initialize:function(n){if(Yr.prototype.initialize.call(this,n),n=$r(n),n=Q.exports.Util.setOptions(this,n),this.service=bh(n),this.service.addEventParent(this),this.options.fields[0]!=="*"){for(var i=!1,t=0;t<this.options.fields.length;t++)this.options.fields[t].match(/^(OBJECTID|FID|OID|ID)$/i)&&(i=!0);i===!1&&tn("no known esriFieldTypeOID field detected in fields Array.  Please add an attribute field containing unique IDs to ensure the layer can be drawn correctly.")}this.options.timeField.start&&this.options.timeField.end?(this._startTimeIndex=new wi,this._endTimeIndex=new wi):this.options.timeField&&(this._timeIndex=new wi),this._cache={},this._currentSnapshot=[],this._activeRequests=0},onAdd:function(n){return Kr(n),this.service.metadata(function(i,t){if(!i){var s=t.supportedQueryFormats,o=!1;(this.service.options.isModern===!1||this.options.fetchAllFeatures)&&(o=!0),!o&&s&&s.indexOf("geoJSON")!==-1&&(this.service.options.isModern=!0),t.objectIdField&&(this.service.options.idAttribute=t.objectIdField),!this.options.attribution&&n.attributionControl&&t.copyrightText&&(this.options.attribution=t.copyrightText,n.attributionControl.addAttribution(this.getAttribution()))}},this),n.on("zoomend",this._handleZoomChange,this),Yr.prototype.onAdd.call(this,n)},onRemove:function(n){return Xr(n),n.off("zoomend",this._handleZoomChange,this),Yr.prototype.onRemove.call(this,n)},getAttribution:function(){return this.options.attribution},createCell:function(n,i){this._visibleZoom()&&this._requestFeatures(n,i)},_requestFeatures:function(n,i,t,s){this._activeRequests++,s=s||0;var o=this.options.where;return this._activeRequests===1&&this.fire("loading",{bounds:n},!0),this._buildQuery(n,s).run(function(h,c,d){d&&d.exceededTransferLimit&&this.fire("drawlimitexceeded"),this.options.where===o&&(!h&&c&&c.features.length&&Q.exports.Util.requestAnimFrame(Q.exports.Util.bind(function(){this._addFeatures(c.features,i),this._postProcessFeatures(n)},this)),!h&&c&&!c.features.length&&this._postProcessFeatures(n),h&&this._postProcessFeatures(n),t&&t.call(this,h,c),d&&(d.exceededTransferLimit||d.properties&&d.properties.exceededTransferLimit)&&this.options.fetchAllFeatures&&this._requestFeatures(n,i,t,s+c.features.length))},this)},_postProcessFeatures:function(n){this._activeRequests--,this._activeRequests<=0&&this.fire("load",{bounds:n})},_cacheKey:function(n){return n.z+":"+n.x+":"+n.y},_addFeatures:function(n,i){if(i){var t=this._cacheKey(i);this._cache[t]=this._cache[t]||[]}for(var s=n.length-1;s>=0;s--){var o=n[s].id;this._currentSnapshot.indexOf(o)===-1&&this._currentSnapshot.push(o),typeof t!="undefined"&&this._cache[t].indexOf(o)===-1&&this._cache[t].push(o)}this.options.timeField&&this._buildTimeIndexes(n),this.createLayers(n)},_buildQuery:function(n,i){var t=this.service.query().intersects(n).where(this.options.where).fields(this.options.fields).precision(this.options.precision);return this.options.fetchAllFeatures&&!isNaN(parseInt(i))&&(t=t.offset(i)),t.params.resultType="tile",this.options.requestParams&&Q.exports.Util.extend(t.params,this.options.requestParams),this.options.simplifyFactor&&t.simplify(this._map,this.options.simplifyFactor),this.options.timeFilterMode==="server"&&this.options.from&&this.options.to&&t.between(this.options.from,this.options.to),t},setWhere:function(n,i,t){this.options.where=n&&n.length?n:"1=1";for(var s=[],o=[],h=0,c=null,d=Q.exports.Util.bind(function(w,C){if(w&&(c=w),C)for(var A=C.features.length-1;A>=0;A--)o.push(C.features[A].id);h--,h<=0&&this._visibleZoom()&&n===this.options.where&&(this._currentSnapshot=o,Q.exports.Util.requestAnimFrame(Q.exports.Util.bind(function(){this.removeLayers(s),this.addLayers(o),i&&i.call(t,c)},this)))},this),y=this._currentSnapshot.length-1;y>=0;y--)s.push(this._currentSnapshot[y]);this._cache={};for(var _ in this._cells){h++;var v=this._keyToCellCoords(_),x=this._cellCoordsToBounds(v);this._requestFeatures(x,v,d)}return this},getWhere:function(){return this.options.where},getTimeRange:function(){return[this.options.from,this.options.to]},setTimeRange:function(n,i,t,s){var o=this.options.from,h=this.options.to,c=0,d=null,y=Q.exports.Util.bind(function(w){w&&(d=w),this._filterExistingFeatures(o,h,n,i),c--,t&&c<=0&&t.call(s,d)},this);if(this.options.from=n,this.options.to=i,this._filterExistingFeatures(o,h,n,i),this.options.timeFilterMode==="server")for(var _ in this._cells){c++;var v=this._keyToCellCoords(_),x=this._cellCoordsToBounds(v);this._requestFeatures(x,v,y)}return this},refresh:function(){this.setWhere(this.options.where)},_filterExistingFeatures:function(n,i,t,s){var o=n&&i?this._getFeaturesInTimeRange(n,i):this._currentSnapshot,h=this._getFeaturesInTimeRange(t,s);if(h.indexOf)for(var c=0;c<h.length;c++){var d=o.indexOf(h[c]);d>=0&&o.splice(d,1)}Q.exports.Util.requestAnimFrame(Q.exports.Util.bind(function(){this.removeLayers(o),this.addLayers(h)},this))},_getFeaturesInTimeRange:function(n,i){var t=[],s;if(this.options.timeField.start&&this.options.timeField.end){var o=this._startTimeIndex.between(n,i),h=this._endTimeIndex.between(n,i);s=o.concat(h)}else if(this._timeIndex)s=this._timeIndex.between(n,i);else return tn("You must set timeField in the layer constructor in order to manipulate the start and end time filter."),[];for(var c=s.length-1;c>=0;c--)t.push(s[c].id);return t},_buildTimeIndexes:function(n){var i,t;if(this.options.timeField.start&&this.options.timeField.end){var s=[],o=[];for(i=n.length-1;i>=0;i--)t=n[i],s.push({id:t.id,value:new Date(t.properties[this.options.timeField.start])}),o.push({id:t.id,value:new Date(t.properties[this.options.timeField.end])});this._startTimeIndex.bulkAdd(s),this._endTimeIndex.bulkAdd(o)}else{var h=[];for(i=n.length-1;i>=0;i--)t=n[i],h.push({id:t.id,value:new Date(t.properties[this.options.timeField])});this._timeIndex.bulkAdd(h)}},_featureWithinTimeRange:function(n){if(!this.options.from||!this.options.to)return!0;var i=+this.options.from.valueOf(),t=+this.options.to.valueOf();if(typeof this.options.timeField=="string"){var s=+n.properties[this.options.timeField];return s>=i&&s<=t}if(this.options.timeField.start&&this.options.timeField.end){var o=+n.properties[this.options.timeField.start],h=+n.properties[this.options.timeField.end];return o>=i&&o<=t||h>=i&&h<=t||o<=i&&h>=t}},_visibleZoom:function(){if(!this._map)return!1;var n=this._map.getZoom();return!(n>this.options.maxZoom||n<this.options.minZoom)},_handleZoomChange:function(){if(!this._visibleZoom())this.removeLayers(this._currentSnapshot);else for(var n in this._cells){var i=this._cells[n].coords,t=this._cacheKey(i);this._cache[t]&&this.addLayers(this._cache[t])}},authenticate:function(n){return this.service.authenticate(n),this},metadata:function(n,i){return this.service.metadata(n,i),this},query:function(){return this.service.query()},_getMetadata:function(n){if(this._metadata){var i;n(i,this._metadata)}else this.metadata(Q.exports.Util.bind(function(t,s){this._metadata=s,n(t,this._metadata)},this))},addFeature:function(n,i,t){this.addFeatures(n,i,t)},addFeatures:function(n,i,t){this._getMetadata(Q.exports.Util.bind(function(s,o){if(s){i&&i.call(this,s,null);return}var h=n.features?n.features:[n];this.service.addFeatures(n,Q.exports.Util.bind(function(c,d){if(!c){for(var y=h.length-1;y>=0;y--)h[y].properties[o.objectIdField]=h.length>1?d[y].objectId:d.objectId,h[y].id=h.length>1?d[y].objectId:d.objectId;this._addFeatures(h)}i&&i.call(t,c,d)},this))},this))},updateFeature:function(n,i,t){this.updateFeatures(n,i,t)},updateFeatures:function(n,i,t){var s=n.features?n.features:[n];this.service.updateFeatures(n,function(o,h){if(!o){for(var c=s.length-1;c>=0;c--)this.removeLayers([s[c].id],!0);this._addFeatures(s)}i&&i.call(t,o,h)},this)},deleteFeature:function(n,i,t){this.deleteFeatures(n,i,t)},deleteFeatures:function(n,i,t){return this.service.deleteFeatures(n,function(s,o){var h=o.length?o:[o];if(!s&&h.length>0)for(var c=h.length-1;c>=0;c--)this.removeLayers([h[c].objectId],!0);i&&i.call(t,s,o)},this)}});Zs.extend({options:{cacheLayers:!0},initialize:function(n){n.apikey&&(n.token=n.apikey),Zs.prototype.initialize.call(this,n),this._originalStyle=this.options.style,this._layers={}},onRemove:function(n){for(var i in this._layers)n.removeLayer(this._layers[i]),this.fire("removefeature",{feature:this._layers[i].feature,permanent:!1},!0);return Zs.prototype.onRemove.call(this,n)},createNewLayer:function(n){var i=Q.exports.GeoJSON.geometryToLayer(n,this.options);return i&&(i.defaultOptions=i.options),i},_updateLayer:function(n,i){var t=[],s=this.options.coordsToLatLng||Q.exports.GeoJSON.coordsToLatLng;switch(i.properties&&(n.feature.properties=i.properties),i.geometry.type){case"Point":t=Q.exports.GeoJSON.coordsToLatLng(i.geometry.coordinates),n.setLatLng(t);break;case"LineString":t=Q.exports.GeoJSON.coordsToLatLngs(i.geometry.coordinates,0,s),n.setLatLngs(t);break;case"MultiLineString":t=Q.exports.GeoJSON.coordsToLatLngs(i.geometry.coordinates,1,s),n.setLatLngs(t);break;case"Polygon":t=Q.exports.GeoJSON.coordsToLatLngs(i.geometry.coordinates,1,s),n.setLatLngs(t);break;case"MultiPolygon":t=Q.exports.GeoJSON.coordsToLatLngs(i.geometry.coordinates,2,s),n.setLatLngs(t);break}},createLayers:function(n){for(var i=n.length-1;i>=0;i--){var t=n[i],s=this._layers[t.id],o;this._visibleZoom()&&s&&!this._map.hasLayer(s)&&(!this.options.timeField||this._featureWithinTimeRange(t))&&(this._map.addLayer(s),this.fire("addfeature",{feature:s.feature},!0)),s&&this.options.simplifyFactor>0&&(s.setLatLngs||s.setLatLng)&&this._updateLayer(s,t),s||(o=this.createNewLayer(t),o?(o.feature=t,o.addEventParent(this),this.options.onEachFeature&&this.options.onEachFeature(o.feature,o),this._layers[o.feature.id]=o,this.setFeatureStyle(o.feature.id,this.options.style),this.fire("createfeature",{feature:o.feature},!0),this._visibleZoom()&&(!this.options.timeField||this.options.timeField&&this._featureWithinTimeRange(t))&&this._map.addLayer(o)):tn("invalid GeoJSON encountered"))}},addLayers:function(n){for(var i=n.length-1;i>=0;i--){var t=this._layers[n[i]];t&&(!this.options.timeField||this._featureWithinTimeRange(t.feature))&&this._map.addLayer(t)}},removeLayers:function(n,i){for(var t=n.length-1;t>=0;t--){var s=n[t],o=this._layers[s];o&&(this.fire("removefeature",{feature:o.feature,permanent:i},!0),this._map.removeLayer(o)),o&&i&&delete this._layers[s]}},cellEnter:function(n,i){this._visibleZoom()&&!this._zooming&&this._map&&Q.exports.Util.requestAnimFrame(Q.exports.Util.bind(function(){var t=this._cacheKey(i),s=this._cellCoordsToKey(i),o=this._cache[t];this._activeCells[s]&&o&&this.addLayers(o)},this))},cellLeave:function(n,i){this._zooming||Q.exports.Util.requestAnimFrame(Q.exports.Util.bind(function(){if(this._map){var t=this._cacheKey(i),s=this._cellCoordsToKey(i),o=this._cache[t],h=this._map.getBounds();if(!this._activeCells[s]&&o){for(var c=!0,d=0;d<o.length;d++){var y=this._layers[o[d]];y&&y.getBounds&&h.intersects(y.getBounds())&&(c=!1)}c&&this.removeLayers(o,!this.options.cacheLayers),!this.options.cacheLayers&&c&&(delete this._cache[t],delete this._cells[s],delete this._activeCells[s])}}},this))},resetStyle:function(){return this.options.style=this._originalStyle,this.eachFeature(function(n){this.resetFeatureStyle(n.feature.id)},this),this},setStyle:function(n){return this.options.style=n,this.eachFeature(function(i){this.setFeatureStyle(i.feature.id,n)},this),this},resetFeatureStyle:function(n){var i=this._layers[n],t=this._originalStyle||Q.exports.Path.prototype.options;return i&&(Q.exports.Util.extend(i.options,i.defaultOptions),this.setFeatureStyle(n,t)),this},setFeatureStyle:function(n,i){var t=this._layers[n];return typeof i=="function"&&(i=i(t.feature)),t.setStyle&&t.setStyle(i),this},eachActiveFeature:function(n,i){if(this._map){var t=this._map.getBounds();for(var s in this._layers)this._currentSnapshot.indexOf(this._layers[s].feature.id)!==-1&&(typeof this._layers[s].getLatLng=="function"&&t.contains(this._layers[s].getLatLng())?n.call(i,this._layers[s]):typeof this._layers[s].getBounds=="function"&&t.intersects(this._layers[s].getBounds())&&n.call(i,this._layers[s]))}return this},eachFeature:function(n,i){for(var t in this._layers)n.call(i,this._layers[t]);return this},getFeature:function(n){return this._layers[n]},bringToBack:function(){this.eachFeature(function(n){n.bringToBack&&n.bringToBack()})},bringToFront:function(){this.eachFeature(function(n){n.bringToFront&&n.bringToFront()})},redraw:function(n){return n&&this._redraw(n),this},_redraw:function(n){var i=this._layers[n],t=i.feature;if(i&&i.setIcon&&this.options.pointToLayer&&this.options.pointToLayer){var s=this.options.pointToLayer(t,Q.exports.latLng(t.geometry.coordinates[1],t.geometry.coordinates[0])),o=s.options.icon;i.setIcon(o)}if(i&&i.setStyle&&this.options.pointToLayer){var h=this.options.pointToLayer(t,Q.exports.latLng(t.geometry.coordinates[1],t.geometry.coordinates[0])),c=h.options;this.setFeatureStyle(t.id,c)}i&&i.setStyle&&this.options.style&&this.resetStyle(t.id)}});(function(n){var i={};function t(s){if(i[s])return i[s].exports;var o=i[s]={i:s,l:!1,exports:{}};return n[s].call(o.exports,o,o.exports,t),o.l=!0,o.exports}t.m=n,t.c=i,t.d=function(s,o,h){t.o(s,o)||Object.defineProperty(s,o,{enumerable:!0,get:h})},t.r=function(s){typeof Symbol!="undefined"&&Symbol.toStringTag&&Object.defineProperty(s,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(s,"__esModule",{value:!0})},t.t=function(s,o){if(1&o&&(s=t(s)),8&o||4&o&&typeof s=="object"&&s&&s.__esModule)return s;var h=Object.create(null);if(t.r(h),Object.defineProperty(h,"default",{enumerable:!0,value:s}),2&o&&typeof s!="string")for(var c in s)t.d(h,c,function(d){return s[d]}.bind(null,c));return h},t.n=function(s){var o=s&&s.__esModule?function(){return s.default}:function(){return s};return t.d(o,"a",o),o},t.o=function(s,o){return Object.prototype.hasOwnProperty.call(s,o)},t.p="",t(t.s=68)})([function(n,i,t){var s=t(136);n.exports=function(o,h,c){var d=o==null?void 0:s(o,h);return d===void 0?c:d}},function(n,i,t){var s=this&&this.__importDefault||function(v){return v&&v.__esModule?v:{default:v}};Object.defineProperty(i,"__esModule",{value:!0});var o=t(7),h=t(10),c=s(t(146)),d=t(16),y=s(t(147));function _(v,x){var w=h.getCoords(v),C=h.getCoords(x);if(w.length!==2)throw new Error("<intersects> line1 must only contain 2 coordinates");if(C.length!==2)throw new Error("<intersects> line2 must only contain 2 coordinates");var A=w[0][0],I=w[0][1],R=w[1][0],P=w[1][1],E=C[0][0],z=C[0][1],j=C[1][0],q=C[1][1],et=(q-z)*(R-A)-(j-E)*(P-I),J=(j-E)*(I-z)-(q-z)*(A-E),ht=(R-A)*(I-z)-(P-I)*(A-E);if(et===0)return null;var lt=J/et,dt=ht/et;if(lt>=0&&lt<=1&&dt>=0&&dt<=1){var gt=A+lt*(R-A),vt=I+lt*(P-I);return o.point([gt,vt])}return null}i.default=function(v,x){var w={},C=[];if(v.type==="LineString"&&(v=o.feature(v)),x.type==="LineString"&&(x=o.feature(x)),v.type==="Feature"&&x.type==="Feature"&&v.geometry!==null&&x.geometry!==null&&v.geometry.type==="LineString"&&x.geometry.type==="LineString"&&v.geometry.coordinates.length===2&&x.geometry.coordinates.length===2){var A=_(v,x);return A&&C.push(A),o.featureCollection(C)}var I=y.default();return I.load(c.default(x)),d.featureEach(c.default(v),function(R){d.featureEach(I.search(R),function(P){var E=_(R,P);if(E){var z=h.getCoords(E).join(",");w[z]||(w[z]=!0,C.push(E))}})}),o.featureCollection(C)}},function(n,i){n.exports=function(t){var s=typeof t;return t!=null&&(s=="object"||s=="function")}},function(n,i,t){var s=t(70),o=t(127)(function(h,c,d){s(h,c,d)});n.exports=o},function(n,i,t){var s=t(29),o=typeof self=="object"&&self&&self.Object===Object&&self,h=s||o||Function("return this")();n.exports=h},function(n,i){n.exports=function(t){return t!=null&&typeof t=="object"}},function(n,i){var t=Array.isArray;n.exports=t},function(n,i,t){function s(I,R,P){P===void 0&&(P={});var E={type:"Feature"};return(P.id===0||P.id)&&(E.id=P.id),P.bbox&&(E.bbox=P.bbox),E.properties=R||{},E.geometry=I,E}function o(I,R,P){return P===void 0&&(P={}),s({type:"Point",coordinates:I},R,P)}function h(I,R,P){P===void 0&&(P={});for(var E=0,z=I;E<z.length;E++){var j=z[E];if(j.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var q=0;q<j[j.length-1].length;q++)if(j[j.length-1][q]!==j[0][q])throw new Error("First and last Position are not equivalent.")}return s({type:"Polygon",coordinates:I},R,P)}function c(I,R,P){if(P===void 0&&(P={}),I.length<2)throw new Error("coordinates must be an array of two or more positions");return s({type:"LineString",coordinates:I},R,P)}function d(I,R){R===void 0&&(R={});var P={type:"FeatureCollection"};return R.id&&(P.id=R.id),R.bbox&&(P.bbox=R.bbox),P.features=I,P}function y(I,R,P){return P===void 0&&(P={}),s({type:"MultiLineString",coordinates:I},R,P)}function _(I,R,P){return P===void 0&&(P={}),s({type:"MultiPoint",coordinates:I},R,P)}function v(I,R,P){return P===void 0&&(P={}),s({type:"MultiPolygon",coordinates:I},R,P)}function x(I,R){R===void 0&&(R="kilometers");var P=i.factors[R];if(!P)throw new Error(R+" units is invalid");return I*P}function w(I,R){R===void 0&&(R="kilometers");var P=i.factors[R];if(!P)throw new Error(R+" units is invalid");return I/P}function C(I){return 180*(I%(2*Math.PI))/Math.PI}function A(I){return!isNaN(I)&&I!==null&&!Array.isArray(I)&&!/^\s*$/.test(I)}Object.defineProperty(i,"__esModule",{value:!0}),i.earthRadius=63710088e-1,i.factors={centimeters:100*i.earthRadius,centimetres:100*i.earthRadius,degrees:i.earthRadius/111325,feet:3.28084*i.earthRadius,inches:39.37*i.earthRadius,kilometers:i.earthRadius/1e3,kilometres:i.earthRadius/1e3,meters:i.earthRadius,metres:i.earthRadius,miles:i.earthRadius/1609.344,millimeters:1e3*i.earthRadius,millimetres:1e3*i.earthRadius,nauticalmiles:i.earthRadius/1852,radians:1,yards:i.earthRadius/1.0936},i.unitsFactors={centimeters:100,centimetres:100,degrees:1/111325,feet:3.28084,inches:39.37,kilometers:.001,kilometres:.001,meters:1,metres:1,miles:1/1609.344,millimeters:1e3,millimetres:1e3,nauticalmiles:1/1852,radians:1/i.earthRadius,yards:1/1.0936},i.areaFactors={acres:247105e-9,centimeters:1e4,centimetres:1e4,feet:10.763910417,inches:1550.003100006,kilometers:1e-6,kilometres:1e-6,meters:1,metres:1,miles:386e-9,millimeters:1e6,millimetres:1e6,yards:1.195990046},i.feature=s,i.geometry=function(I,R,P){switch(I){case"Point":return o(R).geometry;case"LineString":return c(R).geometry;case"Polygon":return h(R).geometry;case"MultiPoint":return _(R).geometry;case"MultiLineString":return y(R).geometry;case"MultiPolygon":return v(R).geometry;default:throw new Error(I+" is invalid")}},i.point=o,i.points=function(I,R,P){return P===void 0&&(P={}),d(I.map(function(E){return o(E,R)}),P)},i.polygon=h,i.polygons=function(I,R,P){return P===void 0&&(P={}),d(I.map(function(E){return h(E,R)}),P)},i.lineString=c,i.lineStrings=function(I,R,P){return P===void 0&&(P={}),d(I.map(function(E){return c(E,R)}),P)},i.featureCollection=d,i.multiLineString=y,i.multiPoint=_,i.multiPolygon=v,i.geometryCollection=function(I,R,P){return P===void 0&&(P={}),s({type:"GeometryCollection",geometries:I},R,P)},i.round=function(I,R){if(R===void 0&&(R=0),R&&!(R>=0))throw new Error("precision must be a positive number");var P=Math.pow(10,R||0);return Math.round(I*P)/P},i.radiansToLength=x,i.lengthToRadians=w,i.lengthToDegrees=function(I,R){return C(w(I,R))},i.bearingToAzimuth=function(I){var R=I%360;return R<0&&(R+=360),R},i.radiansToDegrees=C,i.degreesToRadians=function(I){return I%360*Math.PI/180},i.convertLength=function(I,R,P){if(R===void 0&&(R="kilometers"),P===void 0&&(P="kilometers"),!(I>=0))throw new Error("length must be a positive number");return x(w(I,R),P)},i.convertArea=function(I,R,P){if(R===void 0&&(R="meters"),P===void 0&&(P="kilometers"),!(I>=0))throw new Error("area must be a positive number");var E=i.areaFactors[R];if(!E)throw new Error("invalid original units");var z=i.areaFactors[P];if(!z)throw new Error("invalid final units");return I/E*z},i.isNumber=A,i.isObject=function(I){return!!I&&I.constructor===Object},i.validateBBox=function(I){if(!I)throw new Error("bbox is required");if(!Array.isArray(I))throw new Error("bbox must be an Array");if(I.length!==4&&I.length!==6)throw new Error("bbox must be an Array of 4 or 6 numbers");I.forEach(function(R){if(!A(R))throw new Error("bbox must only contain numbers")})},i.validateId=function(I){if(!I)throw new Error("id is required");if(["string","number"].indexOf(typeof I)===-1)throw new Error("id must be a number or a string")},i.radians2degrees=function(){throw new Error("method has been renamed to `radiansToDegrees`")},i.degrees2radians=function(){throw new Error("method has been renamed to `degreesToRadians`")},i.distanceToDegrees=function(){throw new Error("method has been renamed to `lengthToDegrees`")},i.distanceToRadians=function(){throw new Error("method has been renamed to `lengthToRadians`")},i.radiansToDistance=function(){throw new Error("method has been renamed to `radiansToLength`")},i.bearingToAngle=function(){throw new Error("method has been renamed to `bearingToAzimuth`")},i.convertDistance=function(){throw new Error("method has been renamed to `convertLength`")}},function(n,i,t){Object.defineProperty(i,"__esModule",{value:!0});var s=t(7);function o(h,c,d,y,_,v,x,w){var C,A,I,R,P={x:null,y:null,onLine1:!1,onLine2:!1};return(C=(w-v)*(d-h)-(x-_)*(y-c))==0?P.x!==null&&P.y!==null&&P:(R=(d-h)*(A=c-v)-(y-c)*(I=h-_),A=((x-_)*A-(w-v)*I)/C,I=R/C,P.x=h+A*(d-h),P.y=c+A*(y-c),A>=0&&A<=1&&(P.onLine1=!0),I>=0&&I<=1&&(P.onLine2=!0),!(!P.onLine1||!P.onLine2)&&[P.x,P.y])}i.default=function(h){var c,d,y={type:"FeatureCollection",features:[]};if((d=h.type==="Feature"?h.geometry:h).type==="LineString")c=[d.coordinates];else if(d.type==="MultiLineString")c=d.coordinates;else if(d.type==="MultiPolygon")c=[].concat.apply([],d.coordinates);else{if(d.type!=="Polygon")throw new Error("Input must be a LineString, MultiLineString, Polygon, or MultiPolygon Feature or Geometry");c=d.coordinates}return c.forEach(function(_){c.forEach(function(v){for(var x=0;x<_.length-1;x++)for(var w=x;w<v.length-1;w++)if(!(_===v&&(Math.abs(x-w)===1||x===0&&w===_.length-2&&_[x][0]===_[_.length-1][0]&&_[x][1]===_[_.length-1][1]))){var C=o(_[x][0],_[x][1],_[x+1][0],_[x+1][1],v[w][0],v[w][1],v[w+1][0],v[w+1][1]);C&&y.features.push(s.point([C[0],C[1]]))}})}),y}},function(n,i,t){var s=t(19),o=t(84),h=t(85),c=s?s.toStringTag:void 0;n.exports=function(d){return d==null?d===void 0?"[object Undefined]":"[object Null]":c&&c in Object(d)?o(d):h(d)}},function(n,i,t){Object.defineProperty(i,"__esModule",{value:!0});var s=t(7);i.getCoord=function(o){if(!o)throw new Error("coord is required");if(!Array.isArray(o)){if(o.type==="Feature"&&o.geometry!==null&&o.geometry.type==="Point")return o.geometry.coordinates;if(o.type==="Point")return o.coordinates}if(Array.isArray(o)&&o.length>=2&&!Array.isArray(o[0])&&!Array.isArray(o[1]))return o;throw new Error("coord must be GeoJSON Point or an Array of numbers")},i.getCoords=function(o){if(Array.isArray(o))return o;if(o.type==="Feature"){if(o.geometry!==null)return o.geometry.coordinates}else if(o.coordinates)return o.coordinates;throw new Error("coords must be GeoJSON Feature, Geometry Object or an Array")},i.containsNumber=function o(h){if(h.length>1&&s.isNumber(h[0])&&s.isNumber(h[1]))return!0;if(Array.isArray(h[0])&&h[0].length)return o(h[0]);throw new Error("coordinates must only contain numbers")},i.geojsonType=function(o,h,c){if(!h||!c)throw new Error("type and name required");if(!o||o.type!==h)throw new Error("Invalid input to "+c+": must be a "+h+", given "+o.type)},i.featureOf=function(o,h,c){if(!o)throw new Error("No feature passed");if(!c)throw new Error(".featureOf() requires a name");if(!o||o.type!=="Feature"||!o.geometry)throw new Error("Invalid input to "+c+", Feature with geometry required");if(!o.geometry||o.geometry.type!==h)throw new Error("Invalid input to "+c+": must be a "+h+", given "+o.geometry.type)},i.collectionOf=function(o,h,c){if(!o)throw new Error("No featureCollection passed");if(!c)throw new Error(".collectionOf() requires a name");if(!o||o.type!=="FeatureCollection")throw new Error("Invalid input to "+c+", FeatureCollection required");for(var d=0,y=o.features;d<y.length;d++){var _=y[d];if(!_||_.type!=="Feature"||!_.geometry)throw new Error("Invalid input to "+c+", Feature with geometry required");if(!_.geometry||_.geometry.type!==h)throw new Error("Invalid input to "+c+": must be a "+h+", given "+_.geometry.type)}},i.getGeom=function(o){return o.type==="Feature"?o.geometry:o},i.getType=function(o,h){return o.type==="FeatureCollection"?"FeatureCollection":o.type==="GeometryCollection"?"GeometryCollection":o.type==="Feature"&&o.geometry!==null?o.geometry.type:o.type}},function(n,i,t){var s=t(72),o=t(73),h=t(74),c=t(75),d=t(76);function y(_){var v=-1,x=_==null?0:_.length;for(this.clear();++v<x;){var w=_[v];this.set(w[0],w[1])}}y.prototype.clear=s,y.prototype.delete=o,y.prototype.get=h,y.prototype.has=c,y.prototype.set=d,n.exports=y},function(n,i,t){var s=t(13);n.exports=function(o,h){for(var c=o.length;c--;)if(s(o[c][0],h))return c;return-1}},function(n,i){n.exports=function(t,s){return t===s||t!=t&&s!=s}},function(n,i,t){var s=t(17)(Object,"create");n.exports=s},function(n,i,t){var s=t(98);n.exports=function(o,h){var c=o.__data__;return s(h)?c[typeof h=="string"?"string":"hash"]:c.map}},function(n,i,t){Object.defineProperty(i,"__esModule",{value:!0});var s=t(7);function o(x,w,C){if(x!==null)for(var A,I,R,P,E,z,j,q,et=0,J=0,ht=x.type,lt=ht==="FeatureCollection",dt=ht==="Feature",gt=lt?x.features.length:1,vt=0;vt<gt;vt++){E=(q=!!(j=lt?x.features[vt].geometry:dt?x.geometry:x)&&j.type==="GeometryCollection")?j.geometries.length:1;for(var At=0;At<E;At++){var K=0,rt=0;if((P=q?j.geometries[At]:j)!==null){z=P.coordinates;var ft=P.type;switch(et=!C||ft!=="Polygon"&&ft!=="MultiPolygon"?0:1,ft){case null:break;case"Point":if(w(z,J,vt,K,rt)===!1)return!1;J++,K++;break;case"LineString":case"MultiPoint":for(A=0;A<z.length;A++){if(w(z[A],J,vt,K,rt)===!1)return!1;J++,ft==="MultiPoint"&&K++}ft==="LineString"&&K++;break;case"Polygon":case"MultiLineString":for(A=0;A<z.length;A++){for(I=0;I<z[A].length-et;I++){if(w(z[A][I],J,vt,K,rt)===!1)return!1;J++}ft==="MultiLineString"&&K++,ft==="Polygon"&&rt++}ft==="Polygon"&&K++;break;case"MultiPolygon":for(A=0;A<z.length;A++){for(rt=0,I=0;I<z[A].length;I++){for(R=0;R<z[A][I].length-et;R++){if(w(z[A][I][R],J,vt,K,rt)===!1)return!1;J++}rt++}K++}break;case"GeometryCollection":for(A=0;A<P.geometries.length;A++)if(o(P.geometries[A],w,C)===!1)return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function h(x,w){var C;switch(x.type){case"FeatureCollection":for(C=0;C<x.features.length&&w(x.features[C].properties,C)!==!1;C++);break;case"Feature":w(x.properties,0)}}function c(x,w){if(x.type==="Feature")w(x,0);else if(x.type==="FeatureCollection")for(var C=0;C<x.features.length&&w(x.features[C],C)!==!1;C++);}function d(x,w){var C,A,I,R,P,E,z,j,q,et,J=0,ht=x.type==="FeatureCollection",lt=x.type==="Feature",dt=ht?x.features.length:1;for(C=0;C<dt;C++){for(E=ht?x.features[C].geometry:lt?x.geometry:x,j=ht?x.features[C].properties:lt?x.properties:{},q=ht?x.features[C].bbox:lt?x.bbox:void 0,et=ht?x.features[C].id:lt?x.id:void 0,P=(z=!!E&&E.type==="GeometryCollection")?E.geometries.length:1,I=0;I<P;I++)if((R=z?E.geometries[I]:E)!==null)switch(R.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":if(w(R,J,j,q,et)===!1)return!1;break;case"GeometryCollection":for(A=0;A<R.geometries.length;A++)if(w(R.geometries[A],J,j,q,et)===!1)return!1;break;default:throw new Error("Unknown Geometry Type")}else if(w(null,J,j,q,et)===!1)return!1;J++}}function y(x,w){d(x,function(C,A,I,R,P){var E,z=C===null?null:C.type;switch(z){case null:case"Point":case"LineString":case"Polygon":return w(s.feature(C,I,{bbox:R,id:P}),A,0)!==!1&&void 0}switch(z){case"MultiPoint":E="Point";break;case"MultiLineString":E="LineString";break;case"MultiPolygon":E="Polygon"}for(var j=0;j<C.coordinates.length;j++){var q={type:E,coordinates:C.coordinates[j]};if(w(s.feature(q,I),A,j)===!1)return!1}})}function _(x,w){y(x,function(C,A,I){var R=0;if(C.geometry){var P=C.geometry.type;if(P!=="Point"&&P!=="MultiPoint"){var E,z=0,j=0,q=0;return o(C,function(et,J,ht,lt,dt){if(E===void 0||A>z||lt>j||dt>q)return E=et,z=A,j=lt,q=dt,void(R=0);var gt=s.lineString([E,et],C.properties);if(w(gt,A,I,dt,R)===!1)return!1;R++,E=et})!==!1&&void 0}}})}function v(x,w){if(!x)throw new Error("geojson is required");y(x,function(C,A,I){if(C.geometry!==null){var R=C.geometry.type,P=C.geometry.coordinates;switch(R){case"LineString":if(w(C,A,I,0,0)===!1)return!1;break;case"Polygon":for(var E=0;E<P.length;E++)if(w(s.lineString(P[E],C.properties),A,I,E)===!1)return!1}}})}i.coordEach=o,i.coordReduce=function(x,w,C,A){var I=C;return o(x,function(R,P,E,z,j){I=P===0&&C===void 0?R:w(I,R,P,E,z,j)},A),I},i.propEach=h,i.propReduce=function(x,w,C){var A=C;return h(x,function(I,R){A=R===0&&C===void 0?I:w(A,I,R)}),A},i.featureEach=c,i.featureReduce=function(x,w,C){var A=C;return c(x,function(I,R){A=R===0&&C===void 0?I:w(A,I,R)}),A},i.coordAll=function(x){var w=[];return o(x,function(C){w.push(C)}),w},i.geomEach=d,i.geomReduce=function(x,w,C){var A=C;return d(x,function(I,R,P,E,z){A=R===0&&C===void 0?I:w(A,I,R,P,E,z)}),A},i.flattenEach=y,i.flattenReduce=function(x,w,C){var A=C;return y(x,function(I,R,P){A=R===0&&P===0&&C===void 0?I:w(A,I,R,P)}),A},i.segmentEach=_,i.segmentReduce=function(x,w,C){var A=C,I=!1;return _(x,function(R,P,E,z,j){A=I===!1&&C===void 0?R:w(A,R,P,E,z,j),I=!0}),A},i.lineEach=v,i.lineReduce=function(x,w,C){var A=C;return v(x,function(I,R,P,E){A=R===0&&C===void 0?I:w(A,I,R,P,E)}),A},i.findSegment=function(x,w){if(w=w||{},!s.isObject(w))throw new Error("options is invalid");var C,A=w.featureIndex||0,I=w.multiFeatureIndex||0,R=w.geometryIndex||0,P=w.segmentIndex||0,E=w.properties;switch(x.type){case"FeatureCollection":A<0&&(A=x.features.length+A),E=E||x.features[A].properties,C=x.features[A].geometry;break;case"Feature":E=E||x.properties,C=x.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":C=x;break;default:throw new Error("geojson is invalid")}if(C===null)return null;var z=C.coordinates;switch(C.type){case"Point":case"MultiPoint":return null;case"LineString":return P<0&&(P=z.length+P-1),s.lineString([z[P],z[P+1]],E,w);case"Polygon":return R<0&&(R=z.length+R),P<0&&(P=z[R].length+P-1),s.lineString([z[R][P],z[R][P+1]],E,w);case"MultiLineString":return I<0&&(I=z.length+I),P<0&&(P=z[I].length+P-1),s.lineString([z[I][P],z[I][P+1]],E,w);case"MultiPolygon":return I<0&&(I=z.length+I),R<0&&(R=z[I].length+R),P<0&&(P=z[I][R].length-P-1),s.lineString([z[I][R][P],z[I][R][P+1]],E,w)}throw new Error("geojson is invalid")},i.findPoint=function(x,w){if(w=w||{},!s.isObject(w))throw new Error("options is invalid");var C,A=w.featureIndex||0,I=w.multiFeatureIndex||0,R=w.geometryIndex||0,P=w.coordIndex||0,E=w.properties;switch(x.type){case"FeatureCollection":A<0&&(A=x.features.length+A),E=E||x.features[A].properties,C=x.features[A].geometry;break;case"Feature":E=E||x.properties,C=x.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":C=x;break;default:throw new Error("geojson is invalid")}if(C===null)return null;var z=C.coordinates;switch(C.type){case"Point":return s.point(z,E,w);case"MultiPoint":return I<0&&(I=z.length+I),s.point(z[I],E,w);case"LineString":return P<0&&(P=z.length+P),s.point(z[P],E,w);case"Polygon":return R<0&&(R=z.length+R),P<0&&(P=z[R].length+P),s.point(z[R][P],E,w);case"MultiLineString":return I<0&&(I=z.length+I),P<0&&(P=z[I].length+P),s.point(z[I][P],E,w);case"MultiPolygon":return I<0&&(I=z.length+I),R<0&&(R=z[I].length+R),P<0&&(P=z[I][R].length-P),s.point(z[I][R][P],E,w)}throw new Error("geojson is invalid")}},function(n,i,t){var s=t(82),o=t(89);n.exports=function(h,c){var d=o(h,c);return s(d)?d:void 0}},function(n,i,t){var s=t(9),o=t(2);n.exports=function(h){if(!o(h))return!1;var c=s(h);return c=="[object Function]"||c=="[object GeneratorFunction]"||c=="[object AsyncFunction]"||c=="[object Proxy]"}},function(n,i,t){var s=t(4).Symbol;n.exports=s},function(n,i,t){var s=t(32);n.exports=function(o,h,c){h=="__proto__"&&s?s(o,h,{configurable:!0,enumerable:!0,value:c,writable:!0}):o[h]=c}},function(n,i){n.exports=function(t){return t.webpackPolyfill||(t.deprecate=function(){},t.paths=[],t.children||(t.children=[]),Object.defineProperty(t,"loaded",{enumerable:!0,get:function(){return t.l}}),Object.defineProperty(t,"id",{enumerable:!0,get:function(){return t.i}}),t.webpackPolyfill=1),t}},function(n,i,t){var s=t(113),o=t(5),h=Object.prototype,c=h.hasOwnProperty,d=h.propertyIsEnumerable,y=s(function(){return arguments}())?s:function(_){return o(_)&&c.call(_,"callee")&&!d.call(_,"callee")};n.exports=y},function(n,i,t){var s=t(18),o=t(24);n.exports=function(h){return h!=null&&o(h.length)&&!s(h)}},function(n,i){n.exports=function(t){return typeof t=="number"&&t>-1&&t%1==0&&t<=9007199254740991}},function(n,i){var t=/^(?:0|[1-9]\d*)$/;n.exports=function(s,o){var h=typeof s;return!!(o=o==null?9007199254740991:o)&&(h=="number"||h!="symbol"&&t.test(s))&&s>-1&&s%1==0&&s<o}},function(n,i,t){var s=t(9),o=t(5);n.exports=function(h){return typeof h=="symbol"||o(h)&&s(h)=="[object Symbol]"}},function(n,i,t){(function(s){n.exports=function(){function o($,k){if(!($ instanceof k))throw new TypeError("Cannot call a class as a function")}function h($,k){for(var T=0;T<k.length;T++){var F=k[T];F.enumerable=F.enumerable||!1,F.configurable=!0,"value"in F&&(F.writable=!0),Object.defineProperty($,F.key,F)}}function c($,k,T){return k&&h($.prototype,k),T&&h($,T),$}/**
   * splaytree v3.0.1
   * Fast Splay tree for Node and browser
   *
   * @author Alexander Milevski <info@w8r.name>
   * @license MIT
   * @preserve
   */var d=function $(k,T){o(this,$),this.next=null,this.key=k,this.data=T,this.left=null,this.right=null};function y($,k){return $>k?1:$<k?-1:0}function _($,k,T){for(var F=new d(null,null),U=F,Z=F;;){var it=T($,k.key);if(it<0){if(k.left===null)break;if(T($,k.left.key)<0){var st=k.left;if(k.left=st.right,st.right=k,(k=st).left===null)break}Z.left=k,Z=k,k=k.left}else{if(!(it>0)||k.right===null)break;if(T($,k.right.key)>0){var nt=k.right;if(k.right=nt.left,nt.left=k,(k=nt).right===null)break}U.right=k,U=k,k=k.right}}return U.right=k.left,Z.left=k.right,k.left=F.right,k.right=F.left,k}function v($,k,T,F){var U=new d($,k);if(T===null)return U.left=U.right=null,U;var Z=F($,(T=_($,T,F)).key);return Z<0?(U.left=T.left,U.right=T,T.left=null):Z>=0&&(U.right=T.right,U.left=T,T.right=null),U}function x($,k,T){var F=null,U=null;if(k){var Z=T((k=_($,k,T)).key,$);Z===0?(F=k.left,U=k.right):Z<0?(U=k.right,k.right=null,F=k):(F=k.left,k.left=null,U=k)}return{left:F,right:U}}function w($,k,T,F,U){if($){F("".concat(k).concat(T?"\u2514\u2500\u2500 ":"\u251C\u2500\u2500 ").concat(U($),`
`));var Z=k+(T?"    ":"\u2502   ");$.left&&w($.left,Z,!1,F,U),$.right&&w($.right,Z,!0,F,U)}}var C=function(){function $(){var k=arguments.length>0&&arguments[0]!==void 0?arguments[0]:y;o(this,$),this._root=null,this._size=0,this._comparator=k}return c($,[{key:"insert",value:function(k,T){return this._size++,this._root=v(k,T,this._root,this._comparator)}},{key:"add",value:function(k,T){var F=new d(k,T);this._root===null&&(F.left=F.right=null,this._size++,this._root=F);var U=this._comparator,Z=_(k,this._root,U),it=U(k,Z.key);return it===0?this._root=Z:(it<0?(F.left=Z.left,F.right=Z,Z.left=null):it>0&&(F.right=Z.right,F.left=Z,Z.right=null),this._size++,this._root=F),this._root}},{key:"remove",value:function(k){this._root=this._remove(k,this._root,this._comparator)}},{key:"_remove",value:function(k,T,F){var U;return T===null?null:F(k,(T=_(k,T,F)).key)===0?(T.left===null?U=T.right:(U=_(k,T.left,F)).right=T.right,this._size--,U):T}},{key:"pop",value:function(){var k=this._root;if(k){for(;k.left;)k=k.left;return this._root=_(k.key,this._root,this._comparator),this._root=this._remove(k.key,this._root,this._comparator),{key:k.key,data:k.data}}return null}},{key:"findStatic",value:function(k){for(var T=this._root,F=this._comparator;T;){var U=F(k,T.key);if(U===0)return T;T=U<0?T.left:T.right}return null}},{key:"find",value:function(k){return this._root&&(this._root=_(k,this._root,this._comparator),this._comparator(k,this._root.key)!==0)?null:this._root}},{key:"contains",value:function(k){for(var T=this._root,F=this._comparator;T;){var U=F(k,T.key);if(U===0)return!0;T=U<0?T.left:T.right}return!1}},{key:"forEach",value:function(k,T){for(var F=this._root,U=[],Z=!1;!Z;)F!==null?(U.push(F),F=F.left):U.length!==0?(F=U.pop(),k.call(T,F),F=F.right):Z=!0;return this}},{key:"range",value:function(k,T,F,U){for(var Z=[],it=this._comparator,st=this._root;Z.length!==0||st;)if(st)Z.push(st),st=st.left;else{if(it((st=Z.pop()).key,T)>0)break;if(it(st.key,k)>=0&&F.call(U,st))return this;st=st.right}return this}},{key:"keys",value:function(){var k=[];return this.forEach(function(T){var F=T.key;return k.push(F)}),k}},{key:"values",value:function(){var k=[];return this.forEach(function(T){var F=T.data;return k.push(F)}),k}},{key:"min",value:function(){return this._root?this.minNode(this._root).key:null}},{key:"max",value:function(){return this._root?this.maxNode(this._root).key:null}},{key:"minNode",value:function(){var k=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this._root;if(k)for(;k.left;)k=k.left;return k}},{key:"maxNode",value:function(){var k=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this._root;if(k)for(;k.right;)k=k.right;return k}},{key:"at",value:function(k){for(var T=this._root,F=!1,U=0,Z=[];!F;)if(T)Z.push(T),T=T.left;else if(Z.length>0){if(T=Z.pop(),U===k)return T;U++,T=T.right}else F=!0;return null}},{key:"next",value:function(k){var T=this._root,F=null;if(k.right){for(F=k.right;F.left;)F=F.left;return F}for(var U=this._comparator;T;){var Z=U(k.key,T.key);if(Z===0)break;Z<0?(F=T,T=T.left):T=T.right}return F}},{key:"prev",value:function(k){var T=this._root,F=null;if(k.left!==null){for(F=k.left;F.right;)F=F.right;return F}for(var U=this._comparator;T;){var Z=U(k.key,T.key);if(Z===0)break;Z<0?T=T.left:(F=T,T=T.right)}return F}},{key:"clear",value:function(){return this._root=null,this._size=0,this}},{key:"toList",value:function(){return function(k){for(var T=k,F=[],U=!1,Z=new d(null,null),it=Z;!U;)T?(F.push(T),T=T.left):F.length>0?T=(T=it=it.next=F.pop()).right:U=!0;return it.next=null,Z.next}(this._root)}},{key:"load",value:function(k){var T=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],F=arguments.length>2&&arguments[2]!==void 0&&arguments[2],U=k.length,Z=this._comparator;if(F&&E(k,T,0,U-1,Z),this._root===null)this._root=A(k,T,0,U),this._size=U;else{var it=P(this.toList(),I(k,T),Z);U=this._size+U,this._root=R({head:it},0,U)}return this}},{key:"isEmpty",value:function(){return this._root===null}},{key:"toString",value:function(){var k=arguments.length>0&&arguments[0]!==void 0?arguments[0]:function(F){return String(F.key)},T=[];return w(this._root,"",!0,function(F){return T.push(F)},k),T.join("")}},{key:"update",value:function(k,T,F){var U=this._comparator,Z=x(k,this._root,U),it=Z.left,st=Z.right;U(k,T)<0?st=v(T,F,st,U):it=v(T,F,it,U),this._root=function(nt,bt,Mt){return bt===null?nt:(nt===null||((bt=_(nt.key,bt,Mt)).left=nt),bt)}(it,st,U)}},{key:"split",value:function(k){return x(k,this._root,this._comparator)}},{key:"size",get:function(){return this._size}},{key:"root",get:function(){return this._root}}]),$}();function A($,k,T,F){var U=F-T;if(U>0){var Z=T+Math.floor(U/2),it=$[Z],st=k[Z],nt=new d(it,st);return nt.left=A($,k,T,Z),nt.right=A($,k,Z+1,F),nt}return null}function I($,k){for(var T=new d(null,null),F=T,U=0;U<$.length;U++)F=F.next=new d($[U],k[U]);return F.next=null,T.next}function R($,k,T){var F=T-k;if(F>0){var U=k+Math.floor(F/2),Z=R($,k,U),it=$.head;return it.left=Z,$.head=$.head.next,it.right=R($,U+1,T),it}return null}function P($,k,T){for(var F=new d(null,null),U=F,Z=$,it=k;Z!==null&&it!==null;)T(Z.key,it.key)<0?(U.next=Z,Z=Z.next):(U.next=it,it=it.next),U=U.next;return Z!==null?U.next=Z:it!==null&&(U.next=it),F.next}function E($,k,T,F,U){if(!(T>=F)){for(var Z=$[T+F>>1],it=T-1,st=F+1;;){do it++;while(U($[it],Z)<0);do st--;while(U($[st],Z)>0);if(it>=st)break;var nt=$[it];$[it]=$[st],$[st]=nt,nt=k[it],k[it]=k[st],k[st]=nt}E($,k,T,st,U),E($,k,st+1,F,U)}}var z=function($,k){return $.ll.x<=k.x&&k.x<=$.ur.x&&$.ll.y<=k.y&&k.y<=$.ur.y},j=function($,k){if(k.ur.x<$.ll.x||$.ur.x<k.ll.x||k.ur.y<$.ll.y||$.ur.y<k.ll.y)return null;var T=$.ll.x<k.ll.x?k.ll.x:$.ll.x,F=$.ur.x<k.ur.x?$.ur.x:k.ur.x;return{ll:{x:T,y:$.ll.y<k.ll.y?k.ll.y:$.ll.y},ur:{x:F,y:$.ur.y<k.ur.y?$.ur.y:k.ur.y}}},q=Number.EPSILON;q===void 0&&(q=Math.pow(2,-52));var et=q*q,J=function($,k){if(-q<$&&$<q&&-q<k&&k<q)return 0;var T=$-k;return T*T<et*$*k?0:$<k?-1:1},ht=function(){function $(){o(this,$),this.reset()}return c($,[{key:"reset",value:function(){this.xRounder=new lt,this.yRounder=new lt}},{key:"round",value:function(k,T){return{x:this.xRounder.round(k),y:this.yRounder.round(T)}}}]),$}(),lt=function(){function $(){o(this,$),this.tree=new C,this.round(0)}return c($,[{key:"round",value:function(k){var T=this.tree.add(k),F=this.tree.prev(T);if(F!==null&&J(T.key,F.key)===0)return this.tree.remove(k),F.key;var U=this.tree.next(T);return U!==null&&J(T.key,U.key)===0?(this.tree.remove(k),U.key):k}}]),$}(),dt=new ht,gt=function($,k){return $.x*k.y-$.y*k.x},vt=function($,k){return $.x*k.x+$.y*k.y},At=function($,k,T){var F={x:k.x-$.x,y:k.y-$.y},U={x:T.x-$.x,y:T.y-$.y},Z=gt(F,U);return J(Z,0)},K=function($){return Math.sqrt(vt($,$))},rt=function($,k,T){var F={x:k.x-$.x,y:k.y-$.y},U={x:T.x-$.x,y:T.y-$.y};return vt(U,F)/K(U)/K(F)},ft=function($,k,T){return k.y===0?null:{x:$.x+k.x/k.y*(T-$.y),y:T}},zt=function($,k,T){return k.x===0?null:{x:T,y:$.y+k.y/k.x*(T-$.x)}},ot=function(){function $(k,T){o(this,$),k.events===void 0?k.events=[this]:k.events.push(this),this.point=k,this.isLeft=T}return c($,null,[{key:"compare",value:function(k,T){var F=$.comparePoints(k.point,T.point);return F!==0?F:(k.point!==T.point&&k.link(T),k.isLeft!==T.isLeft?k.isLeft?1:-1:kt.compare(k.segment,T.segment))}},{key:"comparePoints",value:function(k,T){return k.x<T.x?-1:k.x>T.x?1:k.y<T.y?-1:k.y>T.y?1:0}}]),c($,[{key:"link",value:function(k){if(k.point===this.point)throw new Error("Tried to link already linked events");for(var T=k.point.events,F=0,U=T.length;F<U;F++){var Z=T[F];this.point.events.push(Z),Z.point=this.point}this.checkForConsuming()}},{key:"checkForConsuming",value:function(){for(var k=this.point.events.length,T=0;T<k;T++){var F=this.point.events[T];if(F.segment.consumedBy===void 0)for(var U=T+1;U<k;U++){var Z=this.point.events[U];Z.consumedBy===void 0&&F.otherSE.point.events===Z.otherSE.point.events&&F.segment.consume(Z.segment)}}}},{key:"getAvailableLinkedEvents",value:function(){for(var k=[],T=0,F=this.point.events.length;T<F;T++){var U=this.point.events[T];U!==this&&!U.segment.ringOut&&U.segment.isInResult()&&k.push(U)}return k}},{key:"getLeftmostComparator",value:function(k){var T=this,F=new Map,U=function(Z){var it,st,nt,bt,Mt,St=Z.otherSE;F.set(Z,{sine:(it=T.point,st=k.point,nt=St.point,bt={x:st.x-it.x,y:st.y-it.y},Mt={x:nt.x-it.x,y:nt.y-it.y},gt(Mt,bt)/K(Mt)/K(bt)),cosine:rt(T.point,k.point,St.point)})};return function(Z,it){F.has(Z)||U(Z),F.has(it)||U(it);var st=F.get(Z),nt=st.sine,bt=st.cosine,Mt=F.get(it),St=Mt.sine,Pt=Mt.cosine;return nt>=0&&St>=0?bt<Pt?1:bt>Pt?-1:0:nt<0&&St<0?bt<Pt?-1:bt>Pt?1:0:St<nt?-1:St>nt?1:0}}}]),$}(),It=0,kt=function(){function $(k,T,F,U){o(this,$),this.id=++It,this.leftSE=k,k.segment=this,k.otherSE=T,this.rightSE=T,T.segment=this,T.otherSE=k,this.rings=F,this.windings=U}return c($,null,[{key:"compare",value:function(k,T){var F=k.leftSE.point.x,U=T.leftSE.point.x,Z=k.rightSE.point.x,it=T.rightSE.point.x;if(it<F)return 1;if(Z<U)return-1;var st=k.leftSE.point.y,nt=T.leftSE.point.y,bt=k.rightSE.point.y,Mt=T.rightSE.point.y;if(F<U){if(nt<st&&nt<bt)return 1;if(nt>st&&nt>bt)return-1;var St=k.comparePoint(T.leftSE.point);if(St<0)return 1;if(St>0)return-1;var Pt=T.comparePoint(k.rightSE.point);return Pt!==0?Pt:-1}if(F>U){if(st<nt&&st<Mt)return-1;if(st>nt&&st>Mt)return 1;var Jt=T.comparePoint(k.leftSE.point);if(Jt!==0)return Jt;var Et=k.comparePoint(T.rightSE.point);return Et<0?1:Et>0?-1:1}if(st<nt)return-1;if(st>nt)return 1;if(Z<it){var Dt=T.comparePoint(k.rightSE.point);if(Dt!==0)return Dt}if(Z>it){var Vt=k.comparePoint(T.rightSE.point);if(Vt<0)return 1;if(Vt>0)return-1}if(Z!==it){var Ht=bt-st,Xt=Z-F,ee=Mt-nt,oe=it-U;if(Ht>Xt&&ee<oe)return 1;if(Ht<Xt&&ee>oe)return-1}return Z>it?1:Z<it||bt<Mt?-1:bt>Mt?1:k.id<T.id?-1:k.id>T.id?1:0}}]),c($,[{key:"replaceRightSE",value:function(k){this.rightSE=k,this.rightSE.segment=this,this.rightSE.otherSE=this.leftSE,this.leftSE.otherSE=this.rightSE}},{key:"bbox",value:function(){var k=this.leftSE.point.y,T=this.rightSE.point.y;return{ll:{x:this.leftSE.point.x,y:k<T?k:T},ur:{x:this.rightSE.point.x,y:k>T?k:T}}}},{key:"vector",value:function(){return{x:this.rightSE.point.x-this.leftSE.point.x,y:this.rightSE.point.y-this.leftSE.point.y}}},{key:"isAnEndpoint",value:function(k){return k.x===this.leftSE.point.x&&k.y===this.leftSE.point.y||k.x===this.rightSE.point.x&&k.y===this.rightSE.point.y}},{key:"comparePoint",value:function(k){if(this.isAnEndpoint(k))return 0;var T=this.leftSE.point,F=this.rightSE.point,U=this.vector();if(T.x===F.x)return k.x===T.x?0:k.x<T.x?1:-1;var Z=(k.y-T.y)/U.y,it=T.x+Z*U.x;if(k.x===it)return 0;var st=(k.x-T.x)/U.x,nt=T.y+st*U.y;return k.y===nt?0:k.y<nt?-1:1}},{key:"getIntersection",value:function(k){var T=this.bbox(),F=k.bbox(),U=j(T,F);if(U===null)return null;var Z=this.leftSE.point,it=this.rightSE.point,st=k.leftSE.point,nt=k.rightSE.point,bt=z(T,st)&&this.comparePoint(st)===0,Mt=z(F,Z)&&k.comparePoint(Z)===0,St=z(T,nt)&&this.comparePoint(nt)===0,Pt=z(F,it)&&k.comparePoint(it)===0;if(Mt&&bt)return Pt&&!St?it:!Pt&&St?nt:null;if(Mt)return St&&Z.x===nt.x&&Z.y===nt.y?null:Z;if(bt)return Pt&&it.x===st.x&&it.y===st.y?null:st;if(Pt&&St)return null;if(Pt)return it;if(St)return nt;var Jt=function(Et,Dt,Vt,Ht){if(Dt.x===0)return zt(Vt,Ht,Et.x);if(Ht.x===0)return zt(Et,Dt,Vt.x);if(Dt.y===0)return ft(Vt,Ht,Et.y);if(Ht.y===0)return ft(Et,Dt,Vt.y);var Xt=gt(Dt,Ht);if(Xt==0)return null;var ee={x:Vt.x-Et.x,y:Vt.y-Et.y},oe=gt(ee,Dt)/Xt,Se=gt(ee,Ht)/Xt;return{x:(Et.x+Se*Dt.x+(Vt.x+oe*Ht.x))/2,y:(Et.y+Se*Dt.y+(Vt.y+oe*Ht.y))/2}}(Z,this.vector(),st,k.vector());return Jt===null?null:z(U,Jt)?dt.round(Jt.x,Jt.y):null}},{key:"split",value:function(k){var T=[],F=k.events!==void 0,U=new ot(k,!0),Z=new ot(k,!1),it=this.rightSE;this.replaceRightSE(Z),T.push(Z),T.push(U);var st=new $(U,it,this.rings.slice(),this.windings.slice());return ot.comparePoints(st.leftSE.point,st.rightSE.point)>0&&st.swapEvents(),ot.comparePoints(this.leftSE.point,this.rightSE.point)>0&&this.swapEvents(),F&&(U.checkForConsuming(),Z.checkForConsuming()),T}},{key:"swapEvents",value:function(){var k=this.rightSE;this.rightSE=this.leftSE,this.leftSE=k,this.leftSE.isLeft=!0,this.rightSE.isLeft=!1;for(var T=0,F=this.windings.length;T<F;T++)this.windings[T]*=-1}},{key:"consume",value:function(k){for(var T=this,F=k;T.consumedBy;)T=T.consumedBy;for(;F.consumedBy;)F=F.consumedBy;var U=$.compare(T,F);if(U!==0){if(U>0){var Z=T;T=F,F=Z}if(T.prev===F){var it=T;T=F,F=it}for(var st=0,nt=F.rings.length;st<nt;st++){var bt=F.rings[st],Mt=F.windings[st],St=T.rings.indexOf(bt);St===-1?(T.rings.push(bt),T.windings.push(Mt)):T.windings[St]+=Mt}F.rings=null,F.windings=null,F.consumedBy=T,F.leftSE.consumedBy=T.leftSE,F.rightSE.consumedBy=T.rightSE}}},{key:"prevInResult",value:function(){return this._prevInResult!==void 0||(this.prev?this.prev.isInResult()?this._prevInResult=this.prev:this._prevInResult=this.prev.prevInResult():this._prevInResult=null),this._prevInResult}},{key:"beforeState",value:function(){if(this._beforeState!==void 0)return this._beforeState;if(this.prev){var k=this.prev.consumedBy||this.prev;this._beforeState=k.afterState()}else this._beforeState={rings:[],windings:[],multiPolys:[]};return this._beforeState}},{key:"afterState",value:function(){if(this._afterState!==void 0)return this._afterState;var k=this.beforeState();this._afterState={rings:k.rings.slice(0),windings:k.windings.slice(0),multiPolys:[]};for(var T=this._afterState.rings,F=this._afterState.windings,U=this._afterState.multiPolys,Z=0,it=this.rings.length;Z<it;Z++){var st=this.rings[Z],nt=this.windings[Z],bt=T.indexOf(st);bt===-1?(T.push(st),F.push(nt)):F[bt]+=nt}for(var Mt=[],St=[],Pt=0,Jt=T.length;Pt<Jt;Pt++)if(F[Pt]!==0){var Et=T[Pt],Dt=Et.poly;if(St.indexOf(Dt)===-1)if(Et.isExterior)Mt.push(Dt);else{St.indexOf(Dt)===-1&&St.push(Dt);var Vt=Mt.indexOf(Et.poly);Vt!==-1&&Mt.splice(Vt,1)}}for(var Ht=0,Xt=Mt.length;Ht<Xt;Ht++){var ee=Mt[Ht].multiPoly;U.indexOf(ee)===-1&&U.push(ee)}return this._afterState}},{key:"isInResult",value:function(){if(this.consumedBy)return!1;if(this._isInResult!==void 0)return this._isInResult;var k=this.beforeState().multiPolys,T=this.afterState().multiPolys;switch(ue.type){case"union":var F=k.length===0,U=T.length===0;this._isInResult=F!==U;break;case"intersection":var Z,it;k.length<T.length?(Z=k.length,it=T.length):(Z=T.length,it=k.length),this._isInResult=it===ue.numMultiPolys&&Z<it;break;case"xor":var st=Math.abs(k.length-T.length);this._isInResult=st%2==1;break;case"difference":var nt=function(bt){return bt.length===1&&bt[0].isSubject};this._isInResult=nt(k)!==nt(T);break;default:throw new Error("Unrecognized operation type found ".concat(ue.type))}return this._isInResult}}],[{key:"fromRing",value:function(k,T,F){var U,Z,it,st=ot.comparePoints(k,T);if(st<0)U=k,Z=T,it=1;else{if(!(st>0))throw new Error("Tried to create degenerate segment at [".concat(k.x,", ").concat(k.y,"]"));U=T,Z=k,it=-1}return new $(new ot(U,!0),new ot(Z,!1),[F],[it])}}]),$}(),Rt=function(){function $(k,T,F){if(o(this,$),!Array.isArray(k)||k.length===0)throw new Error("Input geometry is not a valid Polygon or MultiPolygon");if(this.poly=T,this.isExterior=F,this.segments=[],typeof k[0][0]!="number"||typeof k[0][1]!="number")throw new Error("Input geometry is not a valid Polygon or MultiPolygon");var U=dt.round(k[0][0],k[0][1]);this.bbox={ll:{x:U.x,y:U.y},ur:{x:U.x,y:U.y}};for(var Z=U,it=1,st=k.length;it<st;it++){if(typeof k[it][0]!="number"||typeof k[it][1]!="number")throw new Error("Input geometry is not a valid Polygon or MultiPolygon");var nt=dt.round(k[it][0],k[it][1]);nt.x===Z.x&&nt.y===Z.y||(this.segments.push(kt.fromRing(Z,nt,this)),nt.x<this.bbox.ll.x&&(this.bbox.ll.x=nt.x),nt.y<this.bbox.ll.y&&(this.bbox.ll.y=nt.y),nt.x>this.bbox.ur.x&&(this.bbox.ur.x=nt.x),nt.y>this.bbox.ur.y&&(this.bbox.ur.y=nt.y),Z=nt)}U.x===Z.x&&U.y===Z.y||this.segments.push(kt.fromRing(Z,U,this))}return c($,[{key:"getSweepEvents",value:function(){for(var k=[],T=0,F=this.segments.length;T<F;T++){var U=this.segments[T];k.push(U.leftSE),k.push(U.rightSE)}return k}}]),$}(),se=function(){function $(k,T){if(o(this,$),!Array.isArray(k))throw new Error("Input geometry is not a valid Polygon or MultiPolygon");this.exteriorRing=new Rt(k[0],this,!0),this.bbox={ll:{x:this.exteriorRing.bbox.ll.x,y:this.exteriorRing.bbox.ll.y},ur:{x:this.exteriorRing.bbox.ur.x,y:this.exteriorRing.bbox.ur.y}},this.interiorRings=[];for(var F=1,U=k.length;F<U;F++){var Z=new Rt(k[F],this,!1);Z.bbox.ll.x<this.bbox.ll.x&&(this.bbox.ll.x=Z.bbox.ll.x),Z.bbox.ll.y<this.bbox.ll.y&&(this.bbox.ll.y=Z.bbox.ll.y),Z.bbox.ur.x>this.bbox.ur.x&&(this.bbox.ur.x=Z.bbox.ur.x),Z.bbox.ur.y>this.bbox.ur.y&&(this.bbox.ur.y=Z.bbox.ur.y),this.interiorRings.push(Z)}this.multiPoly=T}return c($,[{key:"getSweepEvents",value:function(){for(var k=this.exteriorRing.getSweepEvents(),T=0,F=this.interiorRings.length;T<F;T++)for(var U=this.interiorRings[T].getSweepEvents(),Z=0,it=U.length;Z<it;Z++)k.push(U[Z]);return k}}]),$}(),Kt=function(){function $(k,T){if(o(this,$),!Array.isArray(k))throw new Error("Input geometry is not a valid Polygon or MultiPolygon");try{typeof k[0][0][0]=="number"&&(k=[k])}catch{}this.polys=[],this.bbox={ll:{x:Number.POSITIVE_INFINITY,y:Number.POSITIVE_INFINITY},ur:{x:Number.NEGATIVE_INFINITY,y:Number.NEGATIVE_INFINITY}};for(var F=0,U=k.length;F<U;F++){var Z=new se(k[F],this);Z.bbox.ll.x<this.bbox.ll.x&&(this.bbox.ll.x=Z.bbox.ll.x),Z.bbox.ll.y<this.bbox.ll.y&&(this.bbox.ll.y=Z.bbox.ll.y),Z.bbox.ur.x>this.bbox.ur.x&&(this.bbox.ur.x=Z.bbox.ur.x),Z.bbox.ur.y>this.bbox.ur.y&&(this.bbox.ur.y=Z.bbox.ur.y),this.polys.push(Z)}this.isSubject=T}return c($,[{key:"getSweepEvents",value:function(){for(var k=[],T=0,F=this.polys.length;T<F;T++)for(var U=this.polys[T].getSweepEvents(),Z=0,it=U.length;Z<it;Z++)k.push(U[Z]);return k}}]),$}(),$t=function(){function $(k){o(this,$),this.events=k;for(var T=0,F=k.length;T<F;T++)k[T].segment.ringOut=this;this.poly=null}return c($,null,[{key:"factory",value:function(k){for(var T=[],F=0,U=k.length;F<U;F++){var Z=k[F];if(Z.isInResult()&&!Z.ringOut){for(var it=null,st=Z.leftSE,nt=Z.rightSE,bt=[st],Mt=st.point,St=[];it=st,st=nt,bt.push(st),st.point!==Mt;)for(;;){var Pt=st.getAvailableLinkedEvents();if(Pt.length===0){var Jt=bt[0].point,Et=bt[bt.length-1].point;throw new Error("Unable to complete output ring starting at [".concat(Jt.x,",")+" ".concat(Jt.y,"]. Last matching segment found ends at")+" [".concat(Et.x,", ").concat(Et.y,"]."))}if(Pt.length===1){nt=Pt[0].otherSE;break}for(var Dt=null,Vt=0,Ht=St.length;Vt<Ht;Vt++)if(St[Vt].point===st.point){Dt=Vt;break}if(Dt===null){St.push({index:bt.length,point:st.point});var Xt=st.getLeftmostComparator(it);nt=Pt.sort(Xt)[0].otherSE;break}var ee=St.splice(Dt)[0],oe=bt.splice(ee.index);oe.unshift(oe[0].otherSE),T.push(new $(oe.reverse()))}T.push(new $(bt))}}return T}}]),c($,[{key:"getGeom",value:function(){for(var k=this.events[0].point,T=[k],F=1,U=this.events.length-1;F<U;F++){var Z=this.events[F].point,it=this.events[F+1].point;At(Z,k,it)!==0&&(T.push(Z),k=Z)}if(T.length===1)return null;var st=T[0],nt=T[1];At(st,k,nt)===0&&T.shift(),T.push(T[0]);for(var bt=this.isExteriorRing()?1:-1,Mt=this.isExteriorRing()?0:T.length-1,St=this.isExteriorRing()?T.length:-1,Pt=[],Jt=Mt;Jt!=St;Jt+=bt)Pt.push([T[Jt].x,T[Jt].y]);return Pt}},{key:"isExteriorRing",value:function(){if(this._isExteriorRing===void 0){var k=this.enclosingRing();this._isExteriorRing=!k||!k.isExteriorRing()}return this._isExteriorRing}},{key:"enclosingRing",value:function(){return this._enclosingRing===void 0&&(this._enclosingRing=this._calcEnclosingRing()),this._enclosingRing}},{key:"_calcEnclosingRing",value:function(){for(var k=this.events[0],T=1,F=this.events.length;T<F;T++){var U=this.events[T];ot.compare(k,U)>0&&(k=U)}for(var Z=k.segment.prevInResult(),it=Z?Z.prevInResult():null;;){if(!Z)return null;if(!it)return Z.ringOut;if(it.ringOut!==Z.ringOut)return it.ringOut.enclosingRing()!==Z.ringOut?Z.ringOut:Z.ringOut.enclosingRing();Z=it.prevInResult(),it=Z?Z.prevInResult():null}}}]),$}(),Bt=function(){function $(k){o(this,$),this.exteriorRing=k,k.poly=this,this.interiorRings=[]}return c($,[{key:"addInterior",value:function(k){this.interiorRings.push(k),k.poly=this}},{key:"getGeom",value:function(){var k=[this.exteriorRing.getGeom()];if(k[0]===null)return null;for(var T=0,F=this.interiorRings.length;T<F;T++){var U=this.interiorRings[T].getGeom();U!==null&&k.push(U)}return k}}]),$}(),Ut=function(){function $(k){o(this,$),this.rings=k,this.polys=this._composePolys(k)}return c($,[{key:"getGeom",value:function(){for(var k=[],T=0,F=this.polys.length;T<F;T++){var U=this.polys[T].getGeom();U!==null&&k.push(U)}return k}},{key:"_composePolys",value:function(k){for(var T=[],F=0,U=k.length;F<U;F++){var Z=k[F];if(!Z.poly)if(Z.isExteriorRing())T.push(new Bt(Z));else{var it=Z.enclosingRing();it.poly||T.push(new Bt(it)),it.poly.addInterior(Z)}}return T}}]),$}(),ge=function(){function $(k){var T=arguments.length>1&&arguments[1]!==void 0?arguments[1]:kt.compare;o(this,$),this.queue=k,this.tree=new C(T),this.segments=[]}return c($,[{key:"process",value:function(k){var T=k.segment,F=[];if(k.consumedBy)return k.isLeft?this.queue.remove(k.otherSE):this.tree.remove(T),F;var U=k.isLeft?this.tree.insert(T):this.tree.find(T);if(!U)throw new Error("Unable to find segment #".concat(T.id," ")+"[".concat(T.leftSE.point.x,", ").concat(T.leftSE.point.y,"] -> ")+"[".concat(T.rightSE.point.x,", ").concat(T.rightSE.point.y,"] ")+"in SweepLine tree. Please submit a bug report.");for(var Z=U,it=U,st=void 0,nt=void 0;st===void 0;)(Z=this.tree.prev(Z))===null?st=null:Z.key.consumedBy===void 0&&(st=Z.key);for(;nt===void 0;)(it=this.tree.next(it))===null?nt=null:it.key.consumedBy===void 0&&(nt=it.key);if(k.isLeft){var bt=null;if(st){var Mt=st.getIntersection(T);if(Mt!==null&&(T.isAnEndpoint(Mt)||(bt=Mt),!st.isAnEndpoint(Mt)))for(var St=this._splitSafely(st,Mt),Pt=0,Jt=St.length;Pt<Jt;Pt++)F.push(St[Pt])}var Et=null;if(nt){var Dt=nt.getIntersection(T);if(Dt!==null&&(T.isAnEndpoint(Dt)||(Et=Dt),!nt.isAnEndpoint(Dt)))for(var Vt=this._splitSafely(nt,Dt),Ht=0,Xt=Vt.length;Ht<Xt;Ht++)F.push(Vt[Ht])}if(bt!==null||Et!==null){var ee=null;ee=bt===null?Et:Et===null||ot.comparePoints(bt,Et)<=0?bt:Et,this.queue.remove(T.rightSE),F.push(T.rightSE);for(var oe=T.split(ee),Se=0,Ce=oe.length;Se<Ce;Se++)F.push(oe[Se])}F.length>0?(this.tree.remove(T),F.push(k)):(this.segments.push(T),T.prev=st)}else{if(st&&nt){var pe=st.getIntersection(nt);if(pe!==null){if(!st.isAnEndpoint(pe))for(var ce=this._splitSafely(st,pe),Wt=0,fe=ce.length;Wt<fe;Wt++)F.push(ce[Wt]);if(!nt.isAnEndpoint(pe))for(var fi=this._splitSafely(nt,pe),He=0,ye=fi.length;He<ye;He++)F.push(fi[He])}}this.tree.remove(T)}return F}},{key:"_splitSafely",value:function(k,T){this.tree.remove(k);var F=k.rightSE;this.queue.remove(F);var U=k.split(T);return U.push(F),k.consumedBy===void 0&&this.tree.insert(k),U}}]),$}(),_e=s!==void 0&&s.env.POLYGON_CLIPPING_MAX_QUEUE_SIZE||1e6,Ve=s!==void 0&&s.env.POLYGON_CLIPPING_MAX_SWEEPLINE_SEGMENTS||1e6,ue=new(function(){function $(){o(this,$)}return c($,[{key:"run",value:function(k,T,F){ue.type=k,dt.reset();for(var U=[new Kt(T,!0)],Z=0,it=F.length;Z<it;Z++)U.push(new Kt(F[Z],!1));if(ue.numMultiPolys=U.length,ue.type==="difference")for(var st=U[0],nt=1;nt<U.length;)j(U[nt].bbox,st.bbox)!==null?nt++:U.splice(nt,1);if(ue.type==="intersection"){for(var bt=0,Mt=U.length;bt<Mt;bt++)for(var St=U[bt],Pt=bt+1,Jt=U.length;Pt<Jt;Pt++)if(j(St.bbox,U[Pt].bbox)===null)return[]}for(var Et=new C(ot.compare),Dt=0,Vt=U.length;Dt<Vt;Dt++)for(var Ht=U[Dt].getSweepEvents(),Xt=0,ee=Ht.length;Xt<ee;Xt++)if(Et.insert(Ht[Xt]),Et.size>_e)throw new Error("Infinite loop when putting segment endpoints in a priority queue (queue size too big). Please file a bug report.");for(var oe=new ge(Et),Se=Et.size,Ce=Et.pop();Ce;){var pe=Ce.key;if(Et.size===Se){var ce=pe.segment;throw new Error("Unable to pop() ".concat(pe.isLeft?"left":"right"," SweepEvent ")+"[".concat(pe.point.x,", ").concat(pe.point.y,"] from segment #").concat(ce.id," ")+"[".concat(ce.leftSE.point.x,", ").concat(ce.leftSE.point.y,"] -> ")+"[".concat(ce.rightSE.point.x,", ").concat(ce.rightSE.point.y,"] from queue. ")+"Please file a bug report.")}if(Et.size>_e)throw new Error("Infinite loop when passing sweep line over endpoints (queue size too big). Please file a bug report.");if(oe.segments.length>Ve)throw new Error("Infinite loop when passing sweep line over endpoints (too many sweep line segments). Please file a bug report.");for(var Wt=oe.process(pe),fe=0,fi=Wt.length;fe<fi;fe++){var He=Wt[fe];He.consumedBy===void 0&&Et.insert(He)}Se=Et.size,Ce=Et.pop()}dt.reset();var ye=$t.factory(oe.segments);return new Ut(ye).getGeom()}}]),$}());return{union:function($){for(var k=arguments.length,T=new Array(k>1?k-1:0),F=1;F<k;F++)T[F-1]=arguments[F];return ue.run("union",$,T)},intersection:function($){for(var k=arguments.length,T=new Array(k>1?k-1:0),F=1;F<k;F++)T[F-1]=arguments[F];return ue.run("intersection",$,T)},xor:function($){for(var k=arguments.length,T=new Array(k>1?k-1:0),F=1;F<k;F++)T[F-1]=arguments[F];return ue.run("xor",$,T)},difference:function($){for(var k=arguments.length,T=new Array(k>1?k-1:0),F=1;F<k;F++)T[F-1]=arguments[F];return ue.run("difference",$,T)}}}()}).call(this,t(152))},function(n,i,t){var s=t(17)(t(4),"Map");n.exports=s},function(n,i,t){(function(s){var o=typeof s=="object"&&s&&s.Object===Object&&s;n.exports=o}).call(this,t(83))},function(n,i,t){var s=t(90),o=t(97),h=t(99),c=t(100),d=t(101);function y(_){var v=-1,x=_==null?0:_.length;for(this.clear();++v<x;){var w=_[v];this.set(w[0],w[1])}}y.prototype.clear=s,y.prototype.delete=o,y.prototype.get=h,y.prototype.has=c,y.prototype.set=d,n.exports=y},function(n,i,t){var s=t(20),o=t(13);n.exports=function(h,c,d){(d!==void 0&&!o(h[c],d)||d===void 0&&!(c in h))&&s(h,c,d)}},function(n,i,t){var s=t(17),o=function(){try{var h=s(Object,"defineProperty");return h({},"",{}),h}catch{}}();n.exports=o},function(n,i,t){var s=t(112)(Object.getPrototypeOf,Object);n.exports=s},function(n,i){var t=Object.prototype;n.exports=function(s){var o=s&&s.constructor;return s===(typeof o=="function"&&o.prototype||t)}},function(n,i,t){(function(s){var o=t(4),h=t(115),c=i&&!i.nodeType&&i,d=c&&typeof s=="object"&&s&&!s.nodeType&&s,y=d&&d.exports===c?o.Buffer:void 0,_=(y?y.isBuffer:void 0)||h;s.exports=_}).call(this,t(21)(n))},function(n,i,t){var s=t(117),o=t(118),h=t(119),c=h&&h.isTypedArray,d=c?o(c):s;n.exports=d},function(n,i){n.exports=function(t,s){if((s!=="constructor"||typeof t[s]!="function")&&s!="__proto__")return t[s]}},function(n,i,t){var s=t(123),o=t(125),h=t(23);n.exports=function(c){return h(c)?s(c,!0):o(c)}},function(n,i){n.exports=function(t){return t}},function(n,i,t){var s=t(6),o=t(137),h=t(138),c=t(141);n.exports=function(d,y){return s(d)?d:o(d,y)?[d]:h(c(d))}},function(n,i,t){var s=t(26);n.exports=function(o){if(typeof o=="string"||s(o))return o;var h=o+"";return h=="0"&&1/o==-1/0?"-0":h}},function(n,i,t){Object.defineProperty(i,"__esModule",{value:!0});var s=t(16);i.default=function(o){var h=[1/0,1/0,-1/0,-1/0];return s.coordEach(o,function(c){h[0]>c[0]&&(h[0]=c[0]),h[1]>c[1]&&(h[1]=c[1]),h[2]<c[0]&&(h[2]=c[0]),h[3]<c[1]&&(h[3]=c[1])}),h}},function(n){n.exports=JSON.parse(`{"name":"@geoman-io/leaflet-geoman-free","version":"2.11.3","description":"A Leaflet Plugin For Editing Geometry Layers in Leaflet 1.0","keywords":["leaflet","geoman","polygon management","geometry editing","map data","map overlay","polygon","geojson","leaflet-draw","data-field-geojson","ui-leaflet-draw"],"files":["dist"],"main":"dist/leaflet-geoman.min.js","types":"dist/leaflet-geoman.d.ts","dependencies":{"@turf/boolean-contains":"6.3.0","@turf/kinks":"6.3.0","@turf/line-intersect":"6.3.0","@turf/line-split":"6.3.0","lodash":"4.17.21","polygon-clipping":"0.15.3"},"devDependencies":{"@babel/core":"7.14.0","@babel/preset-env":"7.14.1","@types/leaflet":"^1.7.0","babel-loader":"8.2.2","copy-webpack-plugin":"8.1.1","css-loader":"5.2.4","cypress":"6.9.1","cypress-wait-until":"1.7.1","eslint":"7.26.0","eslint-config-airbnb-base":"14.2.1","eslint-config-prettier":"8.3.0","eslint-plugin-cypress":"2.11.3","eslint-plugin-import":"2.22.1","file-loader":"6.2.0","leaflet":"1.7.1","mini-css-extract-plugin":"1.6.0","prettier":"2.2.1","prosthetic-hand":"1.3.1","terser-webpack-plugin":"^5.1.2","url-loader":"4.1.1","webpack":"5.36.2","webpack-cli":"4.7.0"},"peerDependencies":{"leaflet":"^1.2.0"},"scripts":{"start":"npm run dev","dev":"./node_modules/.bin/webpack --config=webpack.dev.js","test":"./node_modules/.bin/cypress run","cypress":"./node_modules/.bin/cypress open","build":"./node_modules/.bin/webpack --config=webpack.build.js","prepare":"npm run build","eslint-check":"eslint --print-config . | eslint-config-prettier-check","eslint":"eslint src/ --fix","prettier":"prettier --write '{src,cypress}/**/*.{js,css}'","lint":"npm run eslint && npm run prettier"},"repository":{"type":"git","url":"git://github.com/geoman-io/leaflet-geoman.git"},"author":{"name":"Sumit Kumar","email":"sumit@geoman.io","url":"http://geoman.io/leaflet-geoman"},"license":"MIT","bugs":{"url":"https://github.com/geoman-io/leaflet-geoman/issues"},"homepage":"https://geoman.io/leaflet-geoman","prettier":{"trailingComma":"es5","tabWidth":2,"semi":true,"singleQuote":true}}`)},function(n){n.exports=JSON.parse('{"tooltips":{"placeMarker":"Click to place marker","firstVertex":"Click to place first vertex","continueLine":"Click to continue drawing","finishLine":"Click any existing marker to finish","finishPoly":"Click first marker to finish","finishRect":"Click to finish","startCircle":"Click to place circle center","finishCircle":"Click to finish circle","placeCircleMarker":"Click to place circle marker"},"actions":{"finish":"Finish","cancel":"Cancel","removeLastVertex":"Remove Last Vertex"},"buttonTitles":{"drawMarkerButton":"Draw Marker","drawPolyButton":"Draw Polygons","drawLineButton":"Draw Polyline","drawCircleButton":"Draw Circle","drawRectButton":"Draw Rectangle","editButton":"Edit Layers","dragButton":"Drag Layers","cutButton":"Cut Layers","deleteButton":"Remove Layers","drawCircleMarkerButton":"Draw Circle Marker","snappingButton":"Snap dragged marker to other layers and vertices","pinningButton":"Pin shared vertices together","rotateButton":"Rotate Layers"}}')},function(n){n.exports=JSON.parse('{"tooltips":{"placeMarker":"Platziere den Marker mit Klick","firstVertex":"Platziere den ersten Marker mit Klick","continueLine":"Klicke, um weiter zu zeichnen","finishLine":"Beende mit Klick auf existierenden Marker","finishPoly":"Beende mit Klick auf ersten Marker","finishRect":"Beende mit Klick","startCircle":"Platziere das Kreiszentrum mit Klick","finishCircle":"Beende den Kreis mit Klick","placeCircleMarker":"Platziere den Kreismarker mit Klick"},"actions":{"finish":"Beenden","cancel":"Abbrechen","removeLastVertex":"Letzten Vertex l\xF6schen"},"buttonTitles":{"drawMarkerButton":"Marker zeichnen","drawPolyButton":"Polygon zeichnen","drawLineButton":"Polyline zeichnen","drawCircleButton":"Kreis zeichnen","drawRectButton":"Rechteck zeichnen","editButton":"Layer editieren","dragButton":"Layer bewegen","cutButton":"Layer schneiden","deleteButton":"Layer l\xF6schen","drawCircleMarkerButton":"Kreismarker zeichnen","snappingButton":"Bewegter Layer an andere Layer oder Vertexe einhacken","pinningButton":"Vertexe an der gleichen Position verkn\xFCpfen","rotateButton":"Layer drehen"}}')},function(n){n.exports=JSON.parse(`{"tooltips":{"placeMarker":"Clicca per posizionare un Marker","firstVertex":"Clicca per posizionare il primo vertice","continueLine":"Clicca per continuare a disegnare","finishLine":"Clicca qualsiasi marker esistente per terminare","finishPoly":"Clicca il primo marker per terminare","finishRect":"Clicca per terminare","startCircle":"Clicca per posizionare il punto centrale del cerchio","finishCircle":"Clicca per terminare il cerchio","placeCircleMarker":"Clicca per posizionare un Marker del cherchio"},"actions":{"finish":"Termina","cancel":"Annulla","removeLastVertex":"Rimuovi l'ultimo vertice"},"buttonTitles":{"drawMarkerButton":"Disegna Marker","drawPolyButton":"Disegna Poligoni","drawLineButton":"Disegna Polilinea","drawCircleButton":"Disegna Cerchio","drawRectButton":"Disegna Rettangolo","editButton":"Modifica Livelli","dragButton":"Sposta Livelli","cutButton":"Ritaglia Livelli","deleteButton":"Elimina Livelli","drawCircleMarkerButton":"Disegna Marker del Cerchio","snappingButton":"Snap ha trascinato il pennarello su altri strati e vertici","pinningButton":"Pin condiviso vertici insieme"}}`)},function(n){n.exports=JSON.parse('{"tooltips":{"placeMarker":"Klik untuk menempatkan marker","firstVertex":"Klik untuk menempatkan vertex pertama","continueLine":"Klik untuk meneruskan digitasi","finishLine":"Klik pada sembarang marker yang ada untuk mengakhiri","finishPoly":"Klik marker pertama untuk mengakhiri","finishRect":"Klik untuk mengakhiri","startCircle":"Klik untuk menempatkan titik pusat lingkaran","finishCircle":"Klik untuk mengakhiri lingkaran","placeCircleMarker":"Klik untuk menempatkan penanda lingkarann"},"actions":{"finish":"Selesai","cancel":"Batal","removeLastVertex":"Hilangkan Vertex Terakhir"},"buttonTitles":{"drawMarkerButton":"Digitasi Marker","drawPolyButton":"Digitasi Polygon","drawLineButton":"Digitasi Polyline","drawCircleButton":"Digitasi Lingkaran","drawRectButton":"Digitasi Segi Empat","editButton":"Edit Layer","dragButton":"Geser Layer","cutButton":"Potong Layer","deleteButton":"Hilangkan Layer","drawCircleMarkerButton":"Digitasi Penanda Lingkaran","snappingButton":"Jepretkan penanda yang ditarik ke lapisan dan simpul lain","pinningButton":"Sematkan simpul bersama bersama"}}')},function(n){n.exports=JSON.parse('{"tooltips":{"placeMarker":"Adaug\u0103 un punct","firstVertex":"Apas\u0103 aici pentru a ad\u0103uga primul Vertex","continueLine":"Apas\u0103 aici pentru a continua desenul","finishLine":"Apas\u0103 pe orice obiect pentru a finisa desenul","finishPoly":"Apas\u0103 pe primul obiect pentru a finisa","finishRect":"Apas\u0103 pentru a finisa","startCircle":"Apas\u0103 pentru a desena un cerc","finishCircle":"Apas\u0103 pentru a finisa un cerc","placeCircleMarker":"Adaug\u0103 un punct"},"actions":{"finish":"Termin\u0103","cancel":"Anuleaz\u0103","removeLastVertex":"\u0218terge ultimul Vertex"},"buttonTitles":{"drawMarkerButton":"Adaug\u0103 o bulin\u0103","drawPolyButton":"Deseneaz\u0103 un poligon","drawLineButton":"Deseneaz\u0103 o linie","drawCircleButton":"Deseneaz\u0103 un cerc","drawRectButton":"Deseneaz\u0103 un dreptunghi","editButton":"Editeaz\u0103 straturile","dragButton":"Mut\u0103 straturile","cutButton":"Taie straturile","deleteButton":"\u0218terge straturile","drawCircleMarkerButton":"Deseneaz\u0103 marcatorul cercului","snappingButton":"Fixa\u021Bi marcatorul glisat pe alte straturi \u0219i v\xE2rfuri","pinningButton":"Fixa\u021Bi v\xE2rfurile partajate \xEEmpreun\u0103"}}')},function(n){n.exports=JSON.parse('{"tooltips":{"placeMarker":"\u041D\u0430\u0436\u043C\u0438\u0442\u0435, \u0447\u0442\u043E\u0431\u044B \u043D\u0430\u043D\u0435\u0441\u0442\u0438 \u043C\u0430\u0440\u043A\u0435\u0440","firstVertex":"\u041D\u0430\u0436\u043C\u0438\u0442\u0435, \u0447\u0442\u043E\u0431\u044B \u043D\u0430\u043D\u0435\u0441\u0442\u0438 \u043F\u0435\u0440\u0432\u044B\u0439 \u043E\u0431\u044A\u0435\u043A\u0442","continueLine":"\u041D\u0430\u0436\u043C\u0438\u0442\u0435, \u0447\u0442\u043E\u0431\u044B \u043F\u0440\u043E\u0434\u043E\u043B\u0436\u0438\u0442\u044C \u0440\u0438\u0441\u043E\u0432\u0430\u043D\u0438\u0435","finishLine":"\u041D\u0430\u0436\u043C\u0438\u0442\u0435 \u043B\u044E\u0431\u043E\u0439 \u0441\u0443\u0449\u0435\u0441\u0442\u0432\u0443\u044E\u0449\u0438\u0439 \u043C\u0430\u0440\u043A\u0435\u0440 \u0434\u043B\u044F \u0437\u0430\u0432\u0435\u0440\u0448\u0435\u043D\u0438\u044F","finishPoly":"\u0412\u044B\u0431\u0435\u0440\u0438\u0442\u0435 \u043F\u0435\u0440\u0432\u0443\u044E \u0442\u043E\u0447\u043A\u0443, \u0447\u0442\u043E\u0431\u044B \u0437\u0430\u043A\u043E\u043D\u0447\u0438\u0442\u044C","finishRect":"\u041D\u0430\u0436\u043C\u0438\u0442\u0435, \u0447\u0442\u043E\u0431\u044B \u0437\u0430\u043A\u043E\u043D\u0447\u0438\u0442\u044C","startCircle":"\u041D\u0430\u0436\u043C\u0438\u0442\u0435, \u0447\u0442\u043E\u0431\u044B \u0434\u043E\u0431\u0430\u0432\u0438\u0442\u044C \u0446\u0435\u043D\u0442\u0440 \u043A\u0440\u0443\u0433\u0430","finishCircle":"\u041D\u0430\u0436\u043C\u0438\u0442\u0435, \u0447\u0442\u043E\u0431\u044B \u0437\u0430\u0434\u0430\u0442\u044C \u0440\u0430\u0434\u0438\u0443\u0441","placeCircleMarker":"\u041D\u0430\u0436\u043C\u0438\u0442\u0435, \u0447\u0442\u043E\u0431\u044B \u043D\u0430\u043D\u0435\u0441\u0442\u0438 \u043A\u0440\u0443\u0433\u043E\u0432\u043E\u0439 \u043C\u0430\u0440\u043A\u0435\u0440"},"actions":{"finish":"\u0417\u0430\u0432\u0435\u0440\u0448\u0438\u0442\u044C","cancel":"\u041E\u0442\u043C\u0435\u043D\u0438\u0442\u044C","removeLastVertex":"\u041E\u0442\u043C\u0435\u043D\u0438\u0442\u044C \u043F\u043E\u0441\u043B\u0435\u0434\u043D\u0435\u0435 \u0434\u0435\u0439\u0441\u0442\u0432\u0438\u0435"},"buttonTitles":{"drawMarkerButton":"\u0414\u043E\u0431\u0430\u0432\u0438\u0442\u044C \u043C\u0430\u0440\u043A\u0435\u0440","drawPolyButton":"\u0420\u0438\u0441\u043E\u0432\u0430\u0442\u044C \u043F\u043E\u043B\u0438\u0433\u043E\u043D","drawLineButton":"\u0420\u0438\u0441\u043E\u0432\u0430\u0442\u044C \u043A\u0440\u0438\u0432\u0443\u044E","drawCircleButton":"\u0420\u0438\u0441\u043E\u0432\u0430\u0442\u044C \u043A\u0440\u0443\u0433","drawRectButton":"\u0420\u0438\u0441\u043E\u0432\u0430\u0442\u044C \u043F\u0440\u044F\u043C\u043E\u0443\u0433\u043E\u043B\u044C\u043D\u0438\u043A","editButton":"\u0420\u0435\u0434\u0430\u043A\u0442\u0438\u0440\u043E\u0432\u0430\u0442\u044C \u0441\u043B\u043E\u0439","dragButton":"\u041F\u0435\u0440\u0435\u043D\u0435\u0441\u0442\u0438 \u0441\u043B\u043E\u0439","cutButton":"\u0412\u044B\u0440\u0435\u0437\u0430\u0442\u044C \u0441\u043B\u043E\u0439","deleteButton":"\u0423\u0434\u0430\u043B\u0438\u0442\u044C \u0441\u043B\u043E\u0439","drawCircleMarkerButton":"\u0414\u043E\u0431\u0430\u0432\u0438\u0442\u044C \u043A\u0440\u0443\u0433\u043E\u0432\u043E\u0439 \u043C\u0430\u0440\u043A\u0435\u0440","snappingButton":"\u041F\u0440\u0438\u0432\u044F\u0437\u0430\u0442\u044C \u043F\u0435\u0440\u0435\u0442\u0430\u0441\u043A\u0438\u0432\u0430\u0435\u043C\u044B\u0439 \u043C\u0430\u0440\u043A\u0435\u0440 \u043A \u0434\u0440\u0443\u0433\u0438\u043C \u0441\u043B\u043E\u044F\u043C \u0438 \u0432\u0435\u0440\u0448\u0438\u043D\u0430\u043C","pinningButton":"\u0421\u0432\u044F\u0437\u0430\u0442\u044C \u043E\u0431\u0449\u0438\u0435 \u0442\u043E\u0447\u043A\u0438 \u0432\u043C\u0435\u0441\u0442\u0435"}}')},function(n){n.exports=JSON.parse('{"tooltips":{"placeMarker":"Presiona para colocar un marcador","firstVertex":"Presiona para colocar el primer v\xE9rtice","continueLine":"Presiona para continuar dibujando","finishLine":"Presiona cualquier marcador existente para finalizar","finishPoly":"Presiona el primer marcador para finalizar","finishRect":"Presiona para finalizar","startCircle":"Presiona para colocar el centro del circulo","finishCircle":"Presiona para finalizar el circulo","placeCircleMarker":"Presiona para colocar un marcador de circulo"},"actions":{"finish":"Finalizar","cancel":"Cancelar","removeLastVertex":"Remover ultimo v\xE9rtice"},"buttonTitles":{"drawMarkerButton":"Dibujar Marcador","drawPolyButton":"Dibujar Pol\xEDgono","drawLineButton":"Dibujar L\xEDnea","drawCircleButton":"Dibujar Circulo","drawRectButton":"Dibujar Rect\xE1ngulo","editButton":"Editar Capas","dragButton":"Arrastrar Capas","cutButton":"Cortar Capas","deleteButton":"Remover Capas","drawCircleMarkerButton":"Dibujar Marcador de Circulo","snappingButton":"El marcador de Snap arrastrado a otras capas y v\xE9rtices","pinningButton":"Fijar juntos los v\xE9rtices compartidos"}}')},function(n){n.exports=JSON.parse('{"tooltips":{"placeMarker":"Klik om een marker te plaatsen","firstVertex":"Klik om het eerste punt te plaatsen","continueLine":"Klik om te blijven tekenen","finishLine":"Klik op een bestaand punt om te be\xEBindigen","finishPoly":"Klik op het eerst punt om te be\xEBindigen","finishRect":"Klik om te be\xEBindigen","startCircle":"Klik om het middelpunt te plaatsen","finishCircle":"Klik om de cirkel te be\xEBindigen","placeCircleMarker":"Klik om een marker te plaatsen"},"actions":{"finish":"Bewaar","cancel":"Annuleer","removeLastVertex":"Verwijder laatste punt"},"buttonTitles":{"drawMarkerButton":"Plaats Marker","drawPolyButton":"Teken een vlak","drawLineButton":"Teken een lijn","drawCircleButton":"Teken een cirkel","drawRectButton":"Teken een vierkant","editButton":"Bewerk","dragButton":"Verplaats","cutButton":"Knip","deleteButton":"Verwijder","drawCircleMarkerButton":"Plaats Marker","snappingButton":"Snap gesleepte marker naar andere lagen en hoekpunten","pinningButton":"Speld gedeelde hoekpunten samen"}}')},function(n){n.exports=JSON.parse(`{"tooltips":{"placeMarker":"Cliquez pour placer un marqueur","firstVertex":"Cliquez pour placer le premier sommet","continueLine":"Cliquez pour continuer \xE0 dessiner","finishLine":"Cliquez sur n'importe quel marqueur pour terminer","finishPoly":"Cliquez sur le premier marqueur pour terminer","finishRect":"Cliquez pour terminer","startCircle":"Cliquez pour placer le centre du cercle","finishCircle":"Cliquez pour finir le cercle","placeCircleMarker":"Cliquez pour placer le marqueur circulaire"},"actions":{"finish":"Terminer","cancel":"Annuler","removeLastVertex":"Retirer le dernier sommet"},"buttonTitles":{"drawMarkerButton":"Placer des marqueurs","drawPolyButton":"Dessiner des polygones","drawLineButton":"Dessiner des polylignes","drawCircleButton":"Dessiner un cercle","drawRectButton":"Dessiner un rectangle","editButton":"\xC9diter des calques","dragButton":"D\xE9placer des calques","cutButton":"Couper des calques","deleteButton":"Supprimer des calques","drawCircleMarkerButton":"Dessiner un marqueur circulaire","snappingButton":"Glisser le marqueur vers d'autres couches et sommets","pinningButton":"\xC9pingler ensemble les sommets partag\xE9s","rotateButton":"Tourner des calques"}}`)},function(n){n.exports=JSON.parse('{"tooltips":{"placeMarker":"\u5355\u51FB\u653E\u7F6E\u6807\u8BB0","firstVertex":"\u5355\u51FB\u653E\u7F6E\u9996\u4E2A\u9876\u70B9","continueLine":"\u5355\u51FB\u7EE7\u7EED\u7ED8\u5236","finishLine":"\u5355\u51FB\u4EFB\u4F55\u5B58\u5728\u7684\u6807\u8BB0\u4EE5\u5B8C\u6210","finishPoly":"\u5355\u51FB\u7B2C\u4E00\u4E2A\u6807\u8BB0\u4EE5\u5B8C\u6210","finishRect":"\u5355\u51FB\u5B8C\u6210","startCircle":"\u5355\u51FB\u653E\u7F6E\u5706\u5FC3","finishCircle":"\u5355\u51FB\u5B8C\u6210\u5706\u5F62","placeCircleMarker":"\u70B9\u51FB\u653E\u7F6E\u5706\u5F62\u6807\u8BB0"},"actions":{"finish":"\u5B8C\u6210","cancel":"\u53D6\u6D88","removeLastVertex":"\u79FB\u9664\u6700\u540E\u7684\u9876\u70B9"},"buttonTitles":{"drawMarkerButton":"\u7ED8\u5236\u6807\u8BB0","drawPolyButton":"\u7ED8\u5236\u591A\u8FB9\u5F62","drawLineButton":"\u7ED8\u5236\u7EBF\u6BB5","drawCircleButton":"\u7ED8\u5236\u5706\u5F62","drawRectButton":"\u7ED8\u5236\u957F\u65B9\u5F62","editButton":"\u7F16\u8F91\u56FE\u5C42","dragButton":"\u62D6\u62FD\u56FE\u5C42","cutButton":"\u526A\u5207\u56FE\u5C42","deleteButton":"\u5220\u9664\u56FE\u5C42","drawCircleMarkerButton":"\u753B\u5706\u5708\u6807\u8BB0","snappingButton":"\u5C06\u62D6\u52A8\u7684\u6807\u8BB0\u6355\u6349\u5230\u5176\u4ED6\u56FE\u5C42\u548C\u9876\u70B9","pinningButton":"\u5C06\u5171\u4EAB\u9876\u70B9\u56FA\u5B9A\u5728\u4E00\u8D77"}}')},function(n){n.exports=JSON.parse('{"tooltips":{"placeMarker":"\u55AE\u64CA\u653E\u7F6E\u6A19\u8A18","firstVertex":"\u55AE\u64CA\u653E\u7F6E\u7B2C\u4E00\u500B\u9802\u9EDE","continueLine":"\u55AE\u64CA\u7E7C\u7E8C\u7E6A\u88FD","finishLine":"\u55AE\u64CA\u4EFB\u4F55\u5B58\u5728\u7684\u6A19\u8A18\u4EE5\u5B8C\u6210","finishPoly":"\u55AE\u64CA\u7B2C\u4E00\u500B\u6A19\u8A18\u4EE5\u5B8C\u6210","finishRect":"\u55AE\u64CA\u5B8C\u6210","startCircle":"\u55AE\u64CA\u653E\u7F6E\u5713\u5FC3","finishCircle":"\u55AE\u64CA\u5B8C\u6210\u5713\u5F62","placeCircleMarker":"\u9EDE\u64CA\u653E\u7F6E\u5713\u5F62\u6A19\u8A18"},"actions":{"finish":"\u5B8C\u6210","cancel":"\u53D6\u6D88","removeLastVertex":"\u79FB\u9664\u6700\u5F8C\u4E00\u500B\u9802\u9EDE"},"buttonTitles":{"drawMarkerButton":"\u653E\u7F6E\u6A19\u8A18","drawPolyButton":"\u7E6A\u88FD\u591A\u908A\u5F62","drawLineButton":"\u7E6A\u88FD\u7DDA\u6BB5","drawCircleButton":"\u7E6A\u88FD\u5713\u5F62","drawRectButton":"\u7E6A\u88FD\u65B9\u5F62","editButton":"\u7DE8\u8F2F\u5716\u5F62","dragButton":"\u79FB\u52D5\u5716\u5F62","cutButton":"\u88C1\u5207\u5716\u5F62","deleteButton":"\u522A\u9664\u5716\u5F62","drawCircleMarkerButton":"\u756B\u5713\u5708\u6A19\u8A18","snappingButton":"\u5C07\u62D6\u52D5\u7684\u6A19\u8A18\u5C0D\u9F4A\u5230\u5176\u4ED6\u5716\u5C64\u548C\u9802\u9EDE","pinningButton":"\u5C07\u5171\u4EAB\u9802\u9EDE\u56FA\u5B9A\u5728\u4E00\u8D77"}}')},function(n){n.exports=JSON.parse('{"tooltips":{"placeMarker":"Clique para posicionar o marcador","firstVertex":"Clique para posicionar o primeiro v\xE9rtice","continueLine":"Clique para continuar desenhando","finishLine":"Clique em qualquer marcador existente para finalizar","finishPoly":"Clique no primeiro ponto para fechar o pol\xEDgono","finishRect":"Clique para finalizar","startCircle":"Clique para posicionar o centro do c\xEDrculo","finishCircle":"Clique para fechar o c\xEDrculo","placeCircleMarker":"Clique para posicionar o marcador circular"},"actions":{"finish":"Finalizar","cancel":"Cancelar","removeLastVertex":"Remover \xFAltimo v\xE9rtice"},"buttonTitles":{"drawMarkerButton":"Desenhar um marcador","drawPolyButton":"Desenhar um pol\xEDgono","drawLineButton":"Desenhar uma polilinha","drawCircleButton":"Desenhar um c\xEDrculo","drawRectButton":"Desenhar um ret\xE2ngulo","editButton":"Editar camada(s)","dragButton":"Mover camada(s)","cutButton":"Recortar camada(s)","deleteButton":"Remover camada(s)","drawCircleMarkerButton":"Marcador de c\xEDrculos de desenho","snappingButton":"Marcador arrastado para outras camadas e v\xE9rtices","pinningButton":"V\xE9rtices compartilhados de pinos juntos"}}')},function(n){n.exports=JSON.parse('{"tooltips":{"placeMarker":"Kliknij, aby ustawi\u0107 znacznik","firstVertex":"Kliknij, aby ustawi\u0107 pierwszy punkt","continueLine":"Kliknij, aby kontynuowa\u0107 rysowanie","finishLine":"Kliknij dowolny punkt, aby zako\u0144czy\u0107","finishPoly":"Kliknij pierwszy punkt, aby zako\u0144czy\u0107","finishRect":"Kliknij, aby zako\u0144czy\u0107","startCircle":"Kliknij, aby ustawi\u0107 \u015Brodek ko\u0142a","finishCircle":"Kliknij, aby zako\u0144czy\u0107 rysowanie ko\u0142a","placeCircleMarker":"Kliknij, aby ustawi\u0107 okr\u0105g\u0142y znacznik"},"actions":{"finish":"Zako\u0144cz","cancel":"Anuluj","removeLastVertex":"Usu\u0144 ostatni punkt"},"buttonTitles":{"drawMarkerButton":"Narysuj znacznik","drawPolyButton":"Narysuj wielok\u0105t","drawLineButton":"Narysuj \u015Bcie\u017Ck\u0119","drawCircleButton":"Narysuj ko\u0142o","drawRectButton":"Narysuj prostok\u0105t","editButton":"Edytuj","dragButton":"Przesu\u0144","cutButton":"Wytnij","deleteButton":"Usu\u0144","drawCircleMarkerButton":"Narysuj okr\u0105g\u0142y znacznik","snappingButton":"Snap przeci\u0105gni\u0119ty marker na inne warstwy i wierzcho\u0142ki","pinningButton":"Sworze\u0144 wsp\xF3lne wierzcho\u0142ki razem"}}')},function(n){n.exports=JSON.parse('{"tooltips":{"placeMarker":"Klicka f\xF6r att placera mark\xF6r","firstVertex":"Klicka f\xF6r att placera f\xF6rsta h\xF6rnet","continueLine":"Klicka f\xF6r att forts\xE4tta rita","finishLine":"Klicka p\xE5 en existerande punkt f\xF6r att slutf\xF6ra","finishPoly":"Klicka p\xE5 den f\xF6rsta punkten f\xF6r att slutf\xF6ra","finishRect":"Klicka f\xF6r att slutf\xF6ra","startCircle":"Klicka f\xF6r att placera cirkelns centrum","finishCircle":"Klicka f\xF6r att slutf\xF6ra cirkeln","placeCircleMarker":"Klicka f\xF6r att placera cirkelmark\xF6r"},"actions":{"finish":"Slutf\xF6r","cancel":"Avbryt","removeLastVertex":"Ta bort sista h\xF6rnet"},"buttonTitles":{"drawMarkerButton":"Rita Mark\xF6r","drawPolyButton":"Rita Polygoner","drawLineButton":"Rita Linje","drawCircleButton":"Rita Cirkel","drawRectButton":"Rita Rektangel","editButton":"Redigera Lager","dragButton":"Dra Lager","cutButton":"Klipp i Lager","deleteButton":"Ta bort Lager","drawCircleMarkerButton":"Rita Cirkelmark\xF6r","snappingButton":"Sn\xE4pp dra mark\xF6ren till andra lager och h\xF6rn","pinningButton":"F\xE4st delade h\xF6rn tillsammans"}}')},function(n){n.exports=JSON.parse('{"tooltips":{"placeMarker":"\u039A\u03AC\u03BD\u03C4\u03B5 \u03BA\u03BB\u03B9\u03BA \u03B3\u03B9\u03B1 \u03BD\u03B1 \u03C4\u03BF\u03C0\u03BF\u03B8\u03B5\u03C4\u03AE\u03C3\u03B5\u03C4\u03B5 \u0394\u03B5\u03AF\u03BA\u03C4\u03B7","firstVertex":"\u039A\u03AC\u03BD\u03C4\u03B5 \u03BA\u03BB\u03B9\u03BA \u03B3\u03B9\u03B1 \u03BD\u03B1 \u03C4\u03BF\u03C0\u03BF\u03B8\u03B5\u03C4\u03AE\u03C3\u03B5\u03C4\u03B5 \u03C4\u03BF \u03C0\u03C1\u03CE\u03C4\u03BF \u03C3\u03B7\u03BC\u03B5\u03AF\u03BF","continueLine":"\u039A\u03AC\u03BD\u03C4\u03B5 \u03BA\u03BB\u03B9\u03BA \u03B3\u03B9\u03B1 \u03BD\u03B1 \u03C3\u03C5\u03BD\u03B5\u03C7\u03AF\u03C3\u03B5\u03C4\u03B5 \u03BD\u03B1 \u03C3\u03C7\u03B5\u03B4\u03B9\u03AC\u03B6\u03B5\u03C4\u03B5","finishLine":"\u039A\u03AC\u03BD\u03C4\u03B5 \u03BA\u03BB\u03B9\u03BA \u03C3\u03B5 \u03BF\u03C0\u03BF\u03B9\u03BF\u03BD\u03B4\u03AE\u03C0\u03BF\u03C4\u03B5 \u03C5\u03C0\u03AC\u03C1\u03C7\u03BF\u03BD \u03C3\u03B7\u03BC\u03B5\u03AF\u03BF \u03B3\u03B9\u03B1 \u03BD\u03B1 \u03BF\u03BB\u03BF\u03BA\u03BB\u03B7\u03C1\u03C9\u03B8\u03B5\u03AF","finishPoly":"\u039A\u03AC\u03BD\u03C4\u03B5 \u03BA\u03BB\u03B9\u03BA \u03C3\u03C4\u03BF \u03C0\u03C1\u03CE\u03C4\u03BF \u03C3\u03B7\u03BC\u03B5\u03AF\u03BF \u03B3\u03B9\u03B1 \u03BD\u03B1 \u03C4\u03B5\u03BB\u03B5\u03B9\u03CE\u03C3\u03B5\u03C4\u03B5","finishRect":"\u039A\u03AC\u03BD\u03C4\u03B5 \u03BA\u03BB\u03B9\u03BA \u03B3\u03B9\u03B1 \u03BD\u03B1 \u03C4\u03B5\u03BB\u03B5\u03B9\u03CE\u03C3\u03B5\u03C4\u03B5","startCircle":"\u039A\u03AC\u03BD\u03C4\u03B5 \u03BA\u03BB\u03B9\u03BA \u03B3\u03B9\u03B1 \u03BD\u03B1 \u03C4\u03BF\u03C0\u03BF\u03B8\u03B5\u03C4\u03AE\u03C3\u03B5\u03C4\u03B5 \u03BA\u03AD\u03BD\u03C4\u03C1\u03BF \u039A\u03CD\u03BA\u03BB\u03BF\u03C5","finishCircle":"\u039A\u03AC\u03BD\u03C4\u03B5 \u03BA\u03BB\u03B9\u03BA \u03B3\u03B9\u03B1 \u03BD\u03B1 \u03BF\u03BB\u03BF\u03BA\u03BB\u03B7\u03C1\u03CE\u03C3\u03B5\u03C4\u03B5 \u03C4\u03BF\u03BD \u039A\u03CD\u03BA\u03BB\u03BF","placeCircleMarker":"\u039A\u03AC\u03BD\u03C4\u03B5 \u03BA\u03BB\u03B9\u03BA \u03B3\u03B9\u03B1 \u03BD\u03B1 \u03C4\u03BF\u03C0\u03BF\u03B8\u03B5\u03C4\u03AE\u03C3\u03B5\u03C4\u03B5 \u039A\u03C5\u03BA\u03BB\u03B9\u03BA\u03CC \u0394\u03B5\u03AF\u03BA\u03C4\u03B7"},"actions":{"finish":"\u03A4\u03AD\u03BB\u03BF\u03C2","cancel":"\u0391\u03BA\u03CD\u03C1\u03C9\u03C3\u03B7","removeLastVertex":"\u039A\u03B1\u03C4\u03AC\u03C1\u03B3\u03B7\u03C3\u03B7 \u03C4\u03B5\u03BB\u03B5\u03C5\u03C4\u03B1\u03AF\u03BF\u03C5 \u03C3\u03B7\u03BC\u03B5\u03AF\u03BF\u03C5"},"buttonTitles":{"drawMarkerButton":"\u03A3\u03C7\u03B5\u03B4\u03AF\u03B1\u03C3\u03B7 \u0394\u03B5\u03AF\u03BA\u03C4\u03B7","drawPolyButton":"\u03A3\u03C7\u03B5\u03B4\u03AF\u03B1\u03C3\u03B7 \u03A0\u03BF\u03BB\u03C5\u03B3\u03CE\u03BD\u03BF\u03C5","drawLineButton":"\u03A3\u03C7\u03B5\u03B4\u03AF\u03B1\u03C3\u03B7 \u0393\u03C1\u03B1\u03BC\u03BC\u03AE\u03C2","drawCircleButton":"\u03A3\u03C7\u03B5\u03B4\u03AF\u03B1\u03C3\u03B7 \u039A\u03CD\u03BA\u03BB\u03BF\u03C5","drawRectButton":"\u03A3\u03C7\u03B5\u03B4\u03AF\u03B1\u03C3\u03B7 \u039F\u03C1\u03B8\u03BF\u03B3\u03C9\u03BD\u03AF\u03BF\u03C5","editButton":"\u0395\u03C0\u03B5\u03BE\u03B5\u03C1\u03B3\u03B1\u03C3\u03AF\u03B1 \u0395\u03C0\u03B9\u03C0\u03AD\u03B4\u03C9\u03BD","dragButton":"\u039C\u03B5\u03C4\u03B1\u03C6\u03BF\u03C1\u03AC \u0395\u03C0\u03B9\u03C0\u03AD\u03B4\u03C9\u03BD","cutButton":"\u0391\u03C0\u03BF\u03BA\u03BF\u03C0\u03AE \u0395\u03C0\u03B9\u03C0\u03AD\u03B4\u03C9\u03BD","deleteButton":"\u039A\u03B1\u03C4\u03AC\u03C1\u03B3\u03B7\u03C3\u03B7 \u0395\u03C0\u03B9\u03C0\u03AD\u03B4\u03C9\u03BD","drawCircleMarkerButton":"\u03A3\u03C7\u03B5\u03B4\u03AF\u03B1\u03C3\u03B7 \u039A\u03C5\u03BA\u03BB\u03B9\u03BA\u03BF\u03CD \u0394\u03B5\u03AF\u03BA\u03C4\u03B7","snappingButton":"\u03A0\u03C1\u03BF\u03C3\u03BA\u03CC\u03BB\u03BB\u03B7\u03C3\u03B7 \u03C4\u03BF\u03C5 \u0394\u03B5\u03AF\u03BA\u03C4\u03B7 \u03BC\u03B5\u03C4\u03B1\u03C6\u03BF\u03C1\u03AC\u03C2 \u03C3\u03B5 \u03AC\u03BB\u03BB\u03B1 \u0395\u03C0\u03AF\u03C0\u03B5\u03B4\u03B1 \u03BA\u03B1\u03B9 \u039A\u03BF\u03C1\u03C5\u03C6\u03AD\u03C2","pinningButton":"\u03A0\u03B5\u03C1\u03B9\u03BA\u03BF\u03C0\u03AE \u03BA\u03BF\u03B9\u03BD\u03CE\u03BD \u03BA\u03BF\u03C1\u03C5\u03C6\u03CE\u03BD \u03BC\u03B1\u03B6\u03AF"}}')},function(n){n.exports=JSON.parse('{"tooltips":{"placeMarker":"Kattintson a jel\xF6l\u0151 elhelyez\xE9s\xE9hez","firstVertex":"Kattintson az els\u0151 pont elhelyez\xE9s\xE9hez","continueLine":"Kattintson a k\xF6vetkez\u0151 pont elhelyez\xE9s\xE9hez","finishLine":"A befejez\xE9shez kattintson egy megl\xE9v\u0151 pontra","finishPoly":"A befejez\xE9shez kattintson az els\u0151 pontra","finishRect":"Kattintson a befejez\xE9shez","startCircle":"Kattintson a k\xF6r k\xF6z\xE9ppontj\xE1nak elhelyez\xE9s\xE9hez","finishCircle":"Kattintson a k\xF6r befejez\xE9s\xE9hez","placeCircleMarker":"Kattintson a k\xF6rjel\xF6l\u0151 elhelyez\xE9s\xE9hez"},"actions":{"finish":"Befejez\xE9s","cancel":"M\xE9gse","removeLastVertex":"Utols\xF3 pont elt\xE1vol\xEDt\xE1sa"},"buttonTitles":{"drawMarkerButton":"Jel\xF6l\u0151 rajzol\xE1sa","drawPolyButton":"Poligon rajzol\xE1sa","drawLineButton":"Vonal rajzol\xE1sa","drawCircleButton":"K\xF6r rajzol\xE1sa","drawRectButton":"N\xE9gyzet rajzol\xE1sa","editButton":"Elemek szerkeszt\xE9se","dragButton":"Elemek mozgat\xE1sa","cutButton":"Elemek v\xE1g\xE1sa","deleteButton":"Elemek t\xF6rl\xE9se","drawCircleMarkerButton":"K\xF6r jel\xF6l\u0151 rajzol\xE1sa","snappingButton":"Kapcsolja a jel\xF6lt\u0151t m\xE1sik elemhez vagy ponthoz","pinningButton":"K\xF6z\xF6s pontok \xF6sszek\xF6t\xE9se"}}')},function(n){n.exports=JSON.parse('{"tooltips":{"placeMarker":"Tryk for at placere en mark\xF8r","firstVertex":"Tryk for at placere det f\xF8rste punkt","continueLine":"Tryk for at forts\xE6tte linjen","finishLine":"Tryk p\xE5 et eksisterende punkt for at afslutte","finishPoly":"Tryk p\xE5 det f\xF8rste punkt for at afslutte","finishRect":"Tryk for at afslutte","startCircle":"Tryk for at placere cirklens center","finishCircle":"Tryk for at afslutte cirklen","placeCircleMarker":"Tryk for at placere en cirkelmark\xF8r"},"actions":{"finish":"Afslut","cancel":"Afbryd","removeLastVertex":"Fjern sidste punkt"},"buttonTitles":{"drawMarkerButton":"Placer mark\xF8r","drawPolyButton":"Tegn polygon","drawLineButton":"Tegn linje","drawCircleButton":"Tegn cirkel","drawRectButton":"Tegn firkant","editButton":"Rediger","dragButton":"Tr\xE6k","cutButton":"Klip","deleteButton":"Fjern","drawCircleMarkerButton":"Tegn cirkelmark\xF8r","snappingButton":"Fastg\xF8r trukket mark\xF8r til andre elementer","pinningButton":"Sammenl\xE6g delte elementer"}}')},function(n){n.exports=JSON.parse('{"tooltips":{"placeMarker":"Klikk for \xE5 plassere punkt","firstVertex":"Klikk for \xE5 plassere f\xF8rste punkt","continueLine":"Klikk for \xE5 tegne videre","finishLine":"Klikk p\xE5 et eksisterende punkt for \xE5 fullf\xF8re","finishPoly":"Klikk f\xF8rste punkt for \xE5 fullf\xF8re","finishRect":"Klikk for \xE5 fullf\xF8re","startCircle":"Klikk for \xE5 sette sirkel midtpunkt","finishCircle":"Klikk for \xE5 fullf\xF8re sirkel","placeCircleMarker":"Klikk for \xE5 plassere sirkel"},"actions":{"finish":"Fullf\xF8r","cancel":"Kanseller","removeLastVertex":"Fjern forrige punkt"},"buttonTitles":{"drawMarkerButton":"Tegn Punkt","drawPolyButton":"Tegn Flate","drawLineButton":"Tegn Linje","drawCircleButton":"Tegn Sirkel","drawRectButton":"Tegn rektangel","editButton":"Rediger Objekter","dragButton":"Dra Objekter","cutButton":"Kutt Objekter","deleteButton":"Fjern Objekter","drawCircleMarkerButton":"Tegn sirkel-punkt","snappingButton":"Fest dratt punkt til andre objekter og punkt","pinningButton":"Pin delte punkt sammen"}}')},function(n){n.exports=JSON.parse('{"tooltips":{"placeMarker":"\u06A9\u0644\u06CC\u06A9 \u0628\u0631\u0627\u06CC \u062C\u0627\u0646\u0645\u0627\u06CC\u06CC \u0646\u0634\u0627\u0646","firstVertex":"\u06A9\u0644\u06CC\u06A9 \u0628\u0631\u0627\u06CC \u0631\u0633\u0645 \u0627\u0648\u0644\u06CC\u0646 \u0631\u0623\u0633","continueLine":"\u06A9\u0644\u06CC\u06A9 \u0628\u0631\u0627\u06CC \u0627\u062F\u0627\u0645\u0647 \u0631\u0633\u0645","finishLine":"\u06A9\u0644\u06CC\u06A9 \u0631\u0648\u06CC \u0647\u0631 \u0646\u0634\u0627\u0646 \u0645\u0648\u062C\u0648\u062F \u0628\u0631\u0627\u06CC \u067E\u0627\u06CC\u0627\u0646","finishPoly":"\u06A9\u0644\u06CC\u06A9 \u0631\u0648\u06CC \u0627\u0648\u0644\u06CC\u0646 \u0646\u0634\u0627\u0646 \u0628\u0631\u0627\u06CC \u067E\u0627\u06CC\u0627\u0646","finishRect":"\u06A9\u0644\u06CC\u06A9 \u0628\u0631\u0627\u06CC \u067E\u0627\u06CC\u0627\u0646","startCircle":"\u06A9\u0644\u06CC\u06A9 \u0628\u0631\u0627\u06CC \u0631\u0633\u0645 \u0645\u0631\u06A9\u0632 \u062F\u0627\u06CC\u0631\u0647","finishCircle":"\u06A9\u0644\u06CC\u06A9 \u0628\u0631\u0627\u06CC \u067E\u0627\u06CC\u0627\u0646 \u0631\u0633\u0645 \u062F\u0627\u06CC\u0631\u0647","placeCircleMarker":"\u06A9\u0644\u06CC\u06A9 \u0628\u0631\u0627\u06CC \u0631\u0633\u0645 \u0646\u0634\u0627\u0646 \u062F\u0627\u06CC\u0631\u0647"},"actions":{"finish":"\u067E\u0627\u06CC\u0627\u0646","cancel":"\u0644\u0641\u0648","removeLastVertex":"\u062D\u0630\u0641 \u0622\u062E\u0631\u06CC\u0646 \u0631\u0623\u0633"},"buttonTitles":{"drawMarkerButton":"\u062F\u0631\u062C \u0646\u0634\u0627\u0646","drawPolyButton":"\u0631\u0633\u0645 \u0686\u0646\u062F\u0636\u0644\u0639\u06CC","drawLineButton":"\u0631\u0633\u0645 \u062E\u0637","drawCircleButton":"\u0631\u0633\u0645 \u062F\u0627\u06CC\u0631\u0647","drawRectButton":"\u0631\u0633\u0645 \u0686\u0647\u0627\u0631\u0636\u0644\u0639\u06CC","editButton":"\u0648\u06CC\u0631\u0627\u06CC\u0634 \u0644\u0627\u06CC\u0647\u200C\u0647\u0627","dragButton":"\u062C\u0627\u0628\u062C\u0627\u06CC\u06CC \u0644\u0627\u06CC\u0647\u200C\u0647\u0627","cutButton":"\u0628\u0631\u0634 \u0644\u0627\u06CC\u0647\u200C\u0647\u0627","deleteButton":"\u062D\u0630\u0641 \u0644\u0627\u06CC\u0647\u200C\u0647\u0627","drawCircleMarkerButton":"\u0631\u0633\u0645 \u0646\u0634\u0627\u0646 \u062F\u0627\u06CC\u0631\u0647","snappingButton":"\u0646\u0634\u0627\u0646\u06AF\u0631 \u0631\u0627 \u0628\u0647 \u0644\u0627\u06CC\u0647\u200C\u0647\u0627 \u0648 \u0631\u0626\u0648\u0633 \u062F\u06CC\u06AF\u0631 \u0628\u06A9\u0634\u06CC\u062F","pinningButton":"\u0631\u0626\u0648\u0633 \u0645\u0634\u062A\u0631\u06A9 \u0631\u0627 \u0628\u0627 \u0647\u0645 \u067E\u06CC\u0646 \u06A9\u0646\u06CC\u062F","rotateButton":"\u0686\u0631\u062E\u0634 \u0644\u0627\u06CC\u0647"}}')},function(n){n.exports=JSON.parse(`{"tooltips":{"placeMarker":"\u041D\u0430\u0442\u0438\u0441\u043D\u0456\u0442\u044C, \u0449\u043E\u0431 \u043D\u0430\u043D\u0435\u0441\u0442\u0438 \u043C\u0430\u0440\u043A\u0435\u0440","firstVertex":"\u041D\u0430\u0442\u0438\u0441\u043D\u0456\u0442\u044C, \u0449\u043E\u0431 \u043D\u0430\u043D\u0435\u0441\u0442\u0438 \u043F\u0435\u0440\u0448\u0443 \u0432\u0435\u0440\u0448\u0438\u043D\u0443","continueLine":"\u041D\u0430\u0442\u0438\u0441\u043D\u0456\u0442\u044C, \u0449\u043E\u0431 \u043F\u0440\u043E\u0434\u043E\u0432\u0436\u0438\u0442\u0438 \u043C\u0430\u043B\u044E\u0432\u0430\u0442\u0438","finishLine":"\u041D\u0430\u0442\u0438\u0441\u043D\u0456\u0442\u044C \u0431\u0443\u0434\u044C-\u044F\u043A\u0438\u0439 \u0456\u0441\u043D\u0443\u044E\u0447\u0438\u0439 \u043C\u0430\u0440\u043A\u0435\u0440 \u0434\u043B\u044F \u0437\u0430\u0432\u0435\u0440\u0448\u0435\u043D\u043D\u044F","finishPoly":"\u0412\u0438\u0431\u0435\u0440\u0456\u0442\u044C \u043F\u0435\u0440\u0448\u0438\u0439 \u043C\u0430\u0440\u043A\u0435\u0440, \u0449\u043E\u0431 \u0437\u0430\u0432\u0435\u0440\u0448\u0438\u0442\u0438","finishRect":"\u041D\u0430\u0442\u0438\u0441\u043D\u0456\u0442\u044C, \u0449\u043E\u0431 \u0437\u0430\u0432\u0435\u0440\u0448\u0438\u0442\u0438","startCircle":"\u041D\u0430\u0442\u0438\u0441\u043D\u0456\u0442\u044C, \u0449\u043E\u0431 \u0434\u043E\u0434\u0430\u0442\u0438 \u0446\u0435\u043D\u0442\u0440 \u043A\u043E\u043B\u0430","finishCircle":"\u041D\u0430\u0442\u0438\u0441\u043D\u0456\u0442\u044C, \u0449\u043E\u0431 \u0437\u0430\u0432\u0435\u0440\u0448\u0438\u0442\u0438 \u043A\u043E\u043B\u043E","placeCircleMarker":"\u041D\u0430\u0442\u0438\u0441\u043D\u0456\u0442\u044C, \u0449\u043E\u0431 \u043D\u0430\u043D\u0435\u0441\u0442\u0438 \u043A\u0440\u0443\u0433\u043E\u0432\u0438\u0439 \u043C\u0430\u0440\u043A\u0435\u0440"},"actions":{"finish":"\u0417\u0430\u0432\u0435\u0440\u0448\u0438\u0442\u0438","cancel":"\u0412\u0456\u0434\u043C\u0456\u043D\u0438\u0442\u0438","removeLastVertex":"\u0412\u0438\u0434\u0430\u043B\u0438\u0442\u0438 \u043F\u043E\u043F\u0435\u0440\u0435\u0434\u043D\u044E \u0432\u0435\u0440\u0448\u0438\u043D\u0443"},"buttonTitles":{"drawMarkerButton":"\u041C\u0430\u043B\u044E\u0432\u0430\u0442\u0438 \u043C\u0430\u0440\u043A\u0435\u0440","drawPolyButton":"\u041C\u0430\u043B\u044E\u0432\u0430\u0442\u0438 \u043F\u043E\u043B\u0456\u0433\u043E\u043D","drawLineButton":"\u041C\u0430\u043B\u044E\u0432\u0430\u0442\u0438 \u043A\u0440\u0438\u0432\u0443","drawCircleButton":"\u041C\u0430\u043B\u044E\u0432\u0430\u0442\u0438 \u043A\u043E\u043B\u043E","drawRectButton":"\u041C\u0430\u043B\u044E\u0432\u0430\u0442\u0438 \u043F\u0440\u044F\u043C\u043E\u043A\u0443\u0442\u043D\u0438\u043A","editButton":"\u0420\u0435\u0434\u0430\u0433\u0443\u0432\u0430\u0442\u0438 \u0448\u0430\u0440\u0438","dragButton":"\u041F\u0435\u0440\u0435\u043D\u0435\u0441\u0442\u0438 \u0448\u0430\u0440\u0438","cutButton":"\u0412\u0438\u0440\u0456\u0437\u0430\u0442\u0438 \u0448\u0430\u0440\u0438","deleteButton":"\u0412\u0438\u0434\u0430\u043B\u0438\u0442\u0438 \u0448\u0430\u0440\u0438","drawCircleMarkerButton":"\u041C\u0430\u043B\u044E\u0432\u0430\u0442\u0438 \u043A\u0440\u0443\u0433\u043E\u0432\u0438\u0439 \u043C\u0430\u0440\u043A\u0435\u0440","snappingButton":"\u041F\u0440\u0438\u0432\u2019\u044F\u0437\u0430\u0442\u0438 \u043F\u0435\u0440\u0435\u0442\u044F\u0433\u043D\u0443\u0442\u0438\u0439 \u043C\u0430\u0440\u043A\u0435\u0440 \u0434\u043E \u0456\u043D\u0448\u0438\u0445 \u0448\u0430\u0440\u0456\u0432 \u0442\u0430 \u0432\u0435\u0440\u0448\u0438\u043D","pinningButton":"\u0417\u0432'\u044F\u0437\u0430\u0442\u0438 \u0441\u043F\u0456\u043B\u044C\u043D\u0456 \u0432\u0435\u0440\u0448\u0438\u043D\u0438 \u0440\u0430\u0437\u043E\u043C"}}`)},function(n){n.exports=JSON.parse('{"tooltips":{"placeMarker":"\u0130\u015Faret\xE7i yerle\u015Ftirmek i\xE7in t\u0131klay\u0131n","firstVertex":"\u0130lk tepe noktas\u0131n\u0131 yerle\u015Ftirmek i\xE7in t\u0131klay\u0131n","continueLine":"\xC7izime devam etmek i\xE7in t\u0131klay\u0131n","finishLine":"Bitirmek i\xE7in mevcut herhangi bir i\u015Faret\xE7iyi t\u0131klay\u0131n","finishPoly":"Bitirmek i\xE7in ilk i\u015Faret\xE7iyi t\u0131klay\u0131n","finishRect":"Bitirmek i\xE7in t\u0131klay\u0131n","startCircle":"Daire merkezine yerle\u015Ftirmek i\xE7in t\u0131klay\u0131n","finishCircle":"Daireyi bitirmek i\xE7in t\u0131klay\u0131n","placeCircleMarker":"Daire i\u015Faret\xE7isi yerle\u015Ftirmek i\xE7in t\u0131klay\u0131n"},"actions":{"finish":"Bitir","cancel":"\u0130ptal","removeLastVertex":"Son k\xF6\u015Feyi kald\u0131r"},"buttonTitles":{"drawMarkerButton":"\xC7izim \u0130\u015Faret\xE7isi","drawPolyButton":"\xC7okgenler \xE7iz","drawLineButton":"\xC7oklu \xE7izgi \xE7iz","drawCircleButton":"\xC7ember \xE7iz","drawRectButton":"Dikd\xF6rtgen \xE7iz","editButton":"Katmanlar\u0131 d\xFCzenle","dragButton":"Katmanlar\u0131 s\xFCr\xFCkle","cutButton":"Katmanlar\u0131 kes","deleteButton":"Katmanlar\u0131 kald\u0131r","drawCircleMarkerButton":"Daire i\u015Faret\xE7isi \xE7iz","snappingButton":"S\xFCr\xFCklenen i\u015Faret\xE7iyi di\u011Fer katmanlara ve k\xF6\u015Felere yap\u0131\u015Ft\u0131r","pinningButton":"Payla\u015F\u0131lan k\xF6\u015Feleri birbirine sabitle"}}')},function(n){n.exports=JSON.parse('{"tooltips":{"placeMarker":"Kliknut\xEDm vytvo\u0159\xEDte zna\u010Dku","firstVertex":"Kliknut\xEDm vytvo\u0159\xEDte prvn\xED objekt","continueLine":"Kliknut\xEDm pokra\u010Dujte v kreslen\xED","finishLine":"Kliknut\xED na libovolnou existuj\xEDc\xED zna\u010Dku pro dokon\u010Den\xED","finishPoly":"Vyberte prvn\xED bod pro dokon\u010Den\xED","finishRect":"Klikn\u011Bte pro dokon\u010Den\xED","startCircle":"Kliknut\xEDm p\u0159idejte st\u0159ed kruhu","finishCircle":"\u041D\u0430\u0436\u043C\u0438\u0442\u0435, \u0447\u0442\u043E\u0431\u044B \u0437\u0430\u0434\u0430\u0442\u044C \u0440\u0430\u0434\u0438\u0443\u0441","placeCircleMarker":"Kliknut\xEDm nastavte polom\u011Br"},"actions":{"finish":"Dokon\u010Dit","cancel":"Zru\u0161it","removeLastVertex":"Zru\u0161it posledn\xED akci"},"buttonTitles":{"drawMarkerButton":"P\u0159idat zna\u010Dku","drawPolyButton":"Nakreslit polygon","drawLineButton":"Nakreslit k\u0159ivku","drawCircleButton":"Nakreslit kruh","drawRectButton":"Nakreslit obd\xE9ln\xEDk","editButton":"Upravit vrstvu","dragButton":"P\u0159eneste vrstvu","cutButton":"Vyjmout vrstvu","deleteButton":"Smazat vrstvu","drawCircleMarkerButton":"P\u0159idat kruhovou zna\u010Dku","snappingButton":"Nav\xE1zat ta\u017Enou zna\u010Dku k dal\u0161\xEDm vrstv\xE1m a vrchol\u016Fm","pinningButton":"Spojit spole\u010Dn\xE9 body dohromady"}}')},function(n,i,t){var s=t(144),o=t(145);n.exports=function(h,c){return h!=null&&o(h,c,s)}},function(n,i,t){var s=this&&this.__importDefault||function(E){return E&&E.__esModule?E:{default:E}};Object.defineProperty(i,"__esModule",{value:!0});var o=s(t(42)),h=s(t(150)),c=s(t(151)),d=t(10);function y(E,z){var j,q=!1;for(j=0;j<E.coordinates.length;j++)if(R(E.coordinates[j],z.coordinates)){q=!0;break}return q}function _(E,z){for(var j=0,q=z.coordinates;j<q.length;j++){for(var et=q[j],J=!1,ht=0,lt=E.coordinates;ht<lt.length;ht++)if(R(et,lt[ht])){J=!0;break}if(!J)return!1}return!0}function v(E,z){for(var j=!1,q=0,et=z.coordinates;q<et.length;q++){var J=et[q];if(c.default(J,E,{ignoreEndVertices:!0})&&(j=!0),!c.default(J,E))return!1}return!!j}function x(E,z){for(var j=0,q=z.coordinates;j<q.length;j++){var et=q[j];if(!h.default(et,E,{ignoreBoundary:!0}))return!1}return!0}function w(E,z){for(var j=!1,q=0,et=z.coordinates;q<et.length;q++){var J=et[q];if(c.default({type:"Point",coordinates:J},E,{ignoreEndVertices:!0})&&(j=!0),!c.default({type:"Point",coordinates:J},E,{ignoreEndVertices:!1}))return!1}return j}function C(E,z){var j=!1,q=0;if(!I(o.default(E),o.default(z)))return!1;for(;q<z.coordinates.length-1;q++){var et=P(z.coordinates[q],z.coordinates[q+1]);if(h.default({type:"Point",coordinates:et},E,{ignoreBoundary:!0})){j=!0;break}}return j}function A(E,z){if(E.type==="Feature"&&E.geometry===null||z.type==="Feature"&&z.geometry===null||!I(o.default(E),o.default(z)))return!1;for(var j=0,q=d.getGeom(z).coordinates;j<q.length;j++)for(var et=0,J=q[j];et<J.length;et++){var ht=J[et];if(!h.default(ht,E))return!1}return!0}function I(E,z){return!(E[0]>z[0])&&!(E[2]<z[2])&&!(E[1]>z[1])&&!(E[3]<z[3])}function R(E,z){return E[0]===z[0]&&E[1]===z[1]}function P(E,z){return[(E[0]+z[0])/2,(E[1]+z[1])/2]}i.default=function(E,z){var j=d.getGeom(E),q=d.getGeom(z),et=d.getType(E),J=d.getType(z),ht=d.getCoords(E),lt=d.getCoords(z);switch(et){case"Point":switch(J){case"Point":return R(ht,lt);default:throw new Error("feature2 "+J+" geometry not supported")}case"MultiPoint":switch(J){case"Point":return y(j,q);case"MultiPoint":return _(j,q);default:throw new Error("feature2 "+J+" geometry not supported")}case"LineString":switch(J){case"Point":return c.default(q,j,{ignoreEndVertices:!0});case"LineString":return w(j,q);case"MultiPoint":return v(j,q);default:throw new Error("feature2 "+J+" geometry not supported")}case"Polygon":switch(J){case"Point":return h.default(q,j,{ignoreBoundary:!0});case"LineString":return C(j,q);case"Polygon":return A(j,q);case"MultiPoint":return x(j,q);default:throw new Error("feature2 "+J+" geometry not supported")}default:throw new Error("feature1 "+et+" geometry not supported")}},i.isPointInMultiPoint=y,i.isMultiPointInMultiPoint=_,i.isMultiPointOnLine=v,i.isMultiPointInPoly=x,i.isLineOnLine=w,i.isLineInPoly=C,i.isPolyInPoly=A,i.doBBoxOverlap=I,i.compareCoords=R,i.getMidpoint=P},function(n,i,t){n.exports=t(155)},function(n,i){Array.prototype.findIndex=Array.prototype.findIndex||function(t){if(this===null)throw new TypeError("Array.prototype.findIndex called on null or undefined");if(typeof t!="function")throw new TypeError("callback must be a function");for(var s=Object(this),o=s.length>>>0,h=arguments[1],c=0;c<o;c++)if(t.call(h,s[c],c,s))return c;return-1},Array.prototype.find=Array.prototype.find||function(t){if(this===null)throw new TypeError("Array.prototype.find called on null or undefined");if(typeof t!="function")throw new TypeError("callback must be a function");for(var s=Object(this),o=s.length>>>0,h=arguments[1],c=0;c<o;c++){var d=s[c];if(t.call(h,d,c,s))return d}},typeof Object.assign!="function"&&(Object.assign=function(t){if(t==null)throw new TypeError("Cannot convert undefined or null to object");t=Object(t);for(var s=1;s<arguments.length;s++){var o=arguments[s];if(o!=null)for(var h in o)Object.prototype.hasOwnProperty.call(o,h)&&(t[h]=o[h])}return t}),[Element.prototype,CharacterData.prototype,DocumentType.prototype].forEach(function(t){t.hasOwnProperty("remove")||Object.defineProperty(t,"remove",{configurable:!0,enumerable:!0,writable:!0,value:function(){this.parentNode.removeChild(this)}})}),Array.prototype.includes||Object.defineProperty(Array.prototype,"includes",{value:function(t,s){if(this==null)throw new TypeError('"this" is null or not defined');var o=Object(this),h=o.length>>>0;if(h===0)return!1;for(var c,d,y=0|s,_=Math.max(y>=0?y:h-Math.abs(y),0);_<h;){if((c=o[_])===(d=t)||typeof c=="number"&&typeof d=="number"&&isNaN(c)&&isNaN(d))return!0;_++}return!1}})},function(n,i,t){var s=t(71),o=t(31),h=t(102),c=t(104),d=t(2),y=t(38),_=t(37);n.exports=function v(x,w,C,A,I){x!==w&&h(w,function(R,P){if(I||(I=new s),d(R))c(x,w,P,C,v,A,I);else{var E=A?A(_(x,P),R,P+"",x,w,I):void 0;E===void 0&&(E=R),o(x,P,E)}},y)}},function(n,i,t){var s=t(11),o=t(77),h=t(78),c=t(79),d=t(80),y=t(81);function _(v){var x=this.__data__=new s(v);this.size=x.size}_.prototype.clear=o,_.prototype.delete=h,_.prototype.get=c,_.prototype.has=d,_.prototype.set=y,n.exports=_},function(n,i){n.exports=function(){this.__data__=[],this.size=0}},function(n,i,t){var s=t(12),o=Array.prototype.splice;n.exports=function(h){var c=this.__data__,d=s(c,h);return!(d<0)&&(d==c.length-1?c.pop():o.call(c,d,1),--this.size,!0)}},function(n,i,t){var s=t(12);n.exports=function(o){var h=this.__data__,c=s(h,o);return c<0?void 0:h[c][1]}},function(n,i,t){var s=t(12);n.exports=function(o){return s(this.__data__,o)>-1}},function(n,i,t){var s=t(12);n.exports=function(o,h){var c=this.__data__,d=s(c,o);return d<0?(++this.size,c.push([o,h])):c[d][1]=h,this}},function(n,i,t){var s=t(11);n.exports=function(){this.__data__=new s,this.size=0}},function(n,i){n.exports=function(t){var s=this.__data__,o=s.delete(t);return this.size=s.size,o}},function(n,i){n.exports=function(t){return this.__data__.get(t)}},function(n,i){n.exports=function(t){return this.__data__.has(t)}},function(n,i,t){var s=t(11),o=t(28),h=t(30);n.exports=function(c,d){var y=this.__data__;if(y instanceof s){var _=y.__data__;if(!o||_.length<199)return _.push([c,d]),this.size=++y.size,this;y=this.__data__=new h(_)}return y.set(c,d),this.size=y.size,this}},function(n,i,t){var s=t(18),o=t(86),h=t(2),c=t(88),d=/^\[object .+?Constructor\]$/,y=Function.prototype,_=Object.prototype,v=y.toString,x=_.hasOwnProperty,w=RegExp("^"+v.call(x).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");n.exports=function(C){return!(!h(C)||o(C))&&(s(C)?w:d).test(c(C))}},function(n,i){var t;t=function(){return this}();try{t=t||new Function("return this")()}catch{typeof window=="object"&&(t=window)}n.exports=t},function(n,i,t){var s=t(19),o=Object.prototype,h=o.hasOwnProperty,c=o.toString,d=s?s.toStringTag:void 0;n.exports=function(y){var _=h.call(y,d),v=y[d];try{y[d]=void 0;var x=!0}catch{}var w=c.call(y);return x&&(_?y[d]=v:delete y[d]),w}},function(n,i){var t=Object.prototype.toString;n.exports=function(s){return t.call(s)}},function(n,i,t){var s,o=t(87),h=(s=/[^.]+$/.exec(o&&o.keys&&o.keys.IE_PROTO||""))?"Symbol(src)_1."+s:"";n.exports=function(c){return!!h&&h in c}},function(n,i,t){var s=t(4)["__core-js_shared__"];n.exports=s},function(n,i){var t=Function.prototype.toString;n.exports=function(s){if(s!=null){try{return t.call(s)}catch{}try{return s+""}catch{}}return""}},function(n,i){n.exports=function(t,s){return t==null?void 0:t[s]}},function(n,i,t){var s=t(91),o=t(11),h=t(28);n.exports=function(){this.size=0,this.__data__={hash:new s,map:new(h||o),string:new s}}},function(n,i,t){var s=t(92),o=t(93),h=t(94),c=t(95),d=t(96);function y(_){var v=-1,x=_==null?0:_.length;for(this.clear();++v<x;){var w=_[v];this.set(w[0],w[1])}}y.prototype.clear=s,y.prototype.delete=o,y.prototype.get=h,y.prototype.has=c,y.prototype.set=d,n.exports=y},function(n,i,t){var s=t(14);n.exports=function(){this.__data__=s?s(null):{},this.size=0}},function(n,i){n.exports=function(t){var s=this.has(t)&&delete this.__data__[t];return this.size-=s?1:0,s}},function(n,i,t){var s=t(14),o=Object.prototype.hasOwnProperty;n.exports=function(h){var c=this.__data__;if(s){var d=c[h];return d==="__lodash_hash_undefined__"?void 0:d}return o.call(c,h)?c[h]:void 0}},function(n,i,t){var s=t(14),o=Object.prototype.hasOwnProperty;n.exports=function(h){var c=this.__data__;return s?c[h]!==void 0:o.call(c,h)}},function(n,i,t){var s=t(14);n.exports=function(o,h){var c=this.__data__;return this.size+=this.has(o)?0:1,c[o]=s&&h===void 0?"__lodash_hash_undefined__":h,this}},function(n,i,t){var s=t(15);n.exports=function(o){var h=s(this,o).delete(o);return this.size-=h?1:0,h}},function(n,i){n.exports=function(t){var s=typeof t;return s=="string"||s=="number"||s=="symbol"||s=="boolean"?t!=="__proto__":t===null}},function(n,i,t){var s=t(15);n.exports=function(o){return s(this,o).get(o)}},function(n,i,t){var s=t(15);n.exports=function(o){return s(this,o).has(o)}},function(n,i,t){var s=t(15);n.exports=function(o,h){var c=s(this,o),d=c.size;return c.set(o,h),this.size+=c.size==d?0:1,this}},function(n,i,t){var s=t(103)();n.exports=s},function(n,i){n.exports=function(t){return function(s,o,h){for(var c=-1,d=Object(s),y=h(s),_=y.length;_--;){var v=y[t?_:++c];if(o(d[v],v,d)===!1)break}return s}}},function(n,i,t){var s=t(31),o=t(105),h=t(106),c=t(109),d=t(110),y=t(22),_=t(6),v=t(114),x=t(35),w=t(18),C=t(2),A=t(116),I=t(36),R=t(37),P=t(120);n.exports=function(E,z,j,q,et,J,ht){var lt=R(E,j),dt=R(z,j),gt=ht.get(dt);if(gt)s(E,j,gt);else{var vt=J?J(lt,dt,j+"",E,z,ht):void 0,At=vt===void 0;if(At){var K=_(dt),rt=!K&&x(dt),ft=!K&&!rt&&I(dt);vt=dt,K||rt||ft?_(lt)?vt=lt:v(lt)?vt=c(lt):rt?(At=!1,vt=o(dt,!0)):ft?(At=!1,vt=h(dt,!0)):vt=[]:A(dt)||y(dt)?(vt=lt,y(lt)?vt=P(lt):C(lt)&&!w(lt)||(vt=d(dt))):At=!1}At&&(ht.set(dt,vt),et(vt,dt,q,J,ht),ht.delete(dt)),s(E,j,vt)}}},function(n,i,t){(function(s){var o=t(4),h=i&&!i.nodeType&&i,c=h&&typeof s=="object"&&s&&!s.nodeType&&s,d=c&&c.exports===h?o.Buffer:void 0,y=d?d.allocUnsafe:void 0;s.exports=function(_,v){if(v)return _.slice();var x=_.length,w=y?y(x):new _.constructor(x);return _.copy(w),w}}).call(this,t(21)(n))},function(n,i,t){var s=t(107);n.exports=function(o,h){var c=h?s(o.buffer):o.buffer;return new o.constructor(c,o.byteOffset,o.length)}},function(n,i,t){var s=t(108);n.exports=function(o){var h=new o.constructor(o.byteLength);return new s(h).set(new s(o)),h}},function(n,i,t){var s=t(4).Uint8Array;n.exports=s},function(n,i){n.exports=function(t,s){var o=-1,h=t.length;for(s||(s=Array(h));++o<h;)s[o]=t[o];return s}},function(n,i,t){var s=t(111),o=t(33),h=t(34);n.exports=function(c){return typeof c.constructor!="function"||h(c)?{}:s(o(c))}},function(n,i,t){var s=t(2),o=Object.create,h=function(){function c(){}return function(d){if(!s(d))return{};if(o)return o(d);c.prototype=d;var y=new c;return c.prototype=void 0,y}}();n.exports=h},function(n,i){n.exports=function(t,s){return function(o){return t(s(o))}}},function(n,i,t){var s=t(9),o=t(5);n.exports=function(h){return o(h)&&s(h)=="[object Arguments]"}},function(n,i,t){var s=t(23),o=t(5);n.exports=function(h){return o(h)&&s(h)}},function(n,i){n.exports=function(){return!1}},function(n,i,t){var s=t(9),o=t(33),h=t(5),c=Function.prototype,d=Object.prototype,y=c.toString,_=d.hasOwnProperty,v=y.call(Object);n.exports=function(x){if(!h(x)||s(x)!="[object Object]")return!1;var w=o(x);if(w===null)return!0;var C=_.call(w,"constructor")&&w.constructor;return typeof C=="function"&&C instanceof C&&y.call(C)==v}},function(n,i,t){var s=t(9),o=t(24),h=t(5),c={};c["[object Float32Array]"]=c["[object Float64Array]"]=c["[object Int8Array]"]=c["[object Int16Array]"]=c["[object Int32Array]"]=c["[object Uint8Array]"]=c["[object Uint8ClampedArray]"]=c["[object Uint16Array]"]=c["[object Uint32Array]"]=!0,c["[object Arguments]"]=c["[object Array]"]=c["[object ArrayBuffer]"]=c["[object Boolean]"]=c["[object DataView]"]=c["[object Date]"]=c["[object Error]"]=c["[object Function]"]=c["[object Map]"]=c["[object Number]"]=c["[object Object]"]=c["[object RegExp]"]=c["[object Set]"]=c["[object String]"]=c["[object WeakMap]"]=!1,n.exports=function(d){return h(d)&&o(d.length)&&!!c[s(d)]}},function(n,i){n.exports=function(t){return function(s){return t(s)}}},function(n,i,t){(function(s){var o=t(29),h=i&&!i.nodeType&&i,c=h&&typeof s=="object"&&s&&!s.nodeType&&s,d=c&&c.exports===h&&o.process,y=function(){try{var _=c&&c.require&&c.require("util").types;return _||d&&d.binding&&d.binding("util")}catch{}}();s.exports=y}).call(this,t(21)(n))},function(n,i,t){var s=t(121),o=t(38);n.exports=function(h){return s(h,o(h))}},function(n,i,t){var s=t(122),o=t(20);n.exports=function(h,c,d,y){var _=!d;d||(d={});for(var v=-1,x=c.length;++v<x;){var w=c[v],C=y?y(d[w],h[w],w,d,h):void 0;C===void 0&&(C=h[w]),_?o(d,w,C):s(d,w,C)}return d}},function(n,i,t){var s=t(20),o=t(13),h=Object.prototype.hasOwnProperty;n.exports=function(c,d,y){var _=c[d];h.call(c,d)&&o(_,y)&&(y!==void 0||d in c)||s(c,d,y)}},function(n,i,t){var s=t(124),o=t(22),h=t(6),c=t(35),d=t(25),y=t(36),_=Object.prototype.hasOwnProperty;n.exports=function(v,x){var w=h(v),C=!w&&o(v),A=!w&&!C&&c(v),I=!w&&!C&&!A&&y(v),R=w||C||A||I,P=R?s(v.length,String):[],E=P.length;for(var z in v)!x&&!_.call(v,z)||R&&(z=="length"||A&&(z=="offset"||z=="parent")||I&&(z=="buffer"||z=="byteLength"||z=="byteOffset")||d(z,E))||P.push(z);return P}},function(n,i){n.exports=function(t,s){for(var o=-1,h=Array(t);++o<t;)h[o]=s(o);return h}},function(n,i,t){var s=t(2),o=t(34),h=t(126),c=Object.prototype.hasOwnProperty;n.exports=function(d){if(!s(d))return h(d);var y=o(d),_=[];for(var v in d)(v!="constructor"||!y&&c.call(d,v))&&_.push(v);return _}},function(n,i){n.exports=function(t){var s=[];if(t!=null)for(var o in Object(t))s.push(o);return s}},function(n,i,t){var s=t(128),o=t(135);n.exports=function(h){return s(function(c,d){var y=-1,_=d.length,v=_>1?d[_-1]:void 0,x=_>2?d[2]:void 0;for(v=h.length>3&&typeof v=="function"?(_--,v):void 0,x&&o(d[0],d[1],x)&&(v=_<3?void 0:v,_=1),c=Object(c);++y<_;){var w=d[y];w&&h(c,w,y,v)}return c})}},function(n,i,t){var s=t(39),o=t(129),h=t(131);n.exports=function(c,d){return h(o(c,d,s),c+"")}},function(n,i,t){var s=t(130),o=Math.max;n.exports=function(h,c,d){return c=o(c===void 0?h.length-1:c,0),function(){for(var y=arguments,_=-1,v=o(y.length-c,0),x=Array(v);++_<v;)x[_]=y[c+_];_=-1;for(var w=Array(c+1);++_<c;)w[_]=y[_];return w[c]=d(x),s(h,this,w)}}},function(n,i){n.exports=function(t,s,o){switch(o.length){case 0:return t.call(s);case 1:return t.call(s,o[0]);case 2:return t.call(s,o[0],o[1]);case 3:return t.call(s,o[0],o[1],o[2])}return t.apply(s,o)}},function(n,i,t){var s=t(132),o=t(134)(s);n.exports=o},function(n,i,t){var s=t(133),o=t(32),h=t(39),c=o?function(d,y){return o(d,"toString",{configurable:!0,enumerable:!1,value:s(y),writable:!0})}:h;n.exports=c},function(n,i){n.exports=function(t){return function(){return t}}},function(n,i){var t=Date.now;n.exports=function(s){var o=0,h=0;return function(){var c=t(),d=16-(c-h);if(h=c,d>0){if(++o>=800)return arguments[0]}else o=0;return s.apply(void 0,arguments)}}},function(n,i,t){var s=t(13),o=t(23),h=t(25),c=t(2);n.exports=function(d,y,_){if(!c(_))return!1;var v=typeof y;return!!(v=="number"?o(_)&&h(y,_.length):v=="string"&&y in _)&&s(_[y],d)}},function(n,i,t){var s=t(40),o=t(41);n.exports=function(h,c){for(var d=0,y=(c=s(c,h)).length;h!=null&&d<y;)h=h[o(c[d++])];return d&&d==y?h:void 0}},function(n,i,t){var s=t(6),o=t(26),h=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,c=/^\w*$/;n.exports=function(d,y){if(s(d))return!1;var _=typeof d;return!(_!="number"&&_!="symbol"&&_!="boolean"&&d!=null&&!o(d))||c.test(d)||!h.test(d)||y!=null&&d in Object(y)}},function(n,i,t){var s=t(139),o=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,h=/\\(\\)?/g,c=s(function(d){var y=[];return d.charCodeAt(0)===46&&y.push(""),d.replace(o,function(_,v,x,w){y.push(x?w.replace(h,"$1"):v||_)}),y});n.exports=c},function(n,i,t){var s=t(140);n.exports=function(o){var h=s(o,function(d){return c.size===500&&c.clear(),d}),c=h.cache;return h}},function(n,i,t){var s=t(30);function o(h,c){if(typeof h!="function"||c!=null&&typeof c!="function")throw new TypeError("Expected a function");var d=function(){var y=arguments,_=c?c.apply(this,y):y[0],v=d.cache;if(v.has(_))return v.get(_);var x=h.apply(this,y);return d.cache=v.set(_,x)||v,x};return d.cache=new(o.Cache||s),d}o.Cache=s,n.exports=o},function(n,i,t){var s=t(142);n.exports=function(o){return o==null?"":s(o)}},function(n,i,t){var s=t(19),o=t(143),h=t(6),c=t(26),d=s?s.prototype:void 0,y=d?d.toString:void 0;n.exports=function _(v){if(typeof v=="string")return v;if(h(v))return o(v,_)+"";if(c(v))return y?y.call(v):"";var x=v+"";return x=="0"&&1/v==-1/0?"-0":x}},function(n,i){n.exports=function(t,s){for(var o=-1,h=t==null?0:t.length,c=Array(h);++o<h;)c[o]=s(t[o],o,t);return c}},function(n,i){var t=Object.prototype.hasOwnProperty;n.exports=function(s,o){return s!=null&&t.call(s,o)}},function(n,i,t){var s=t(40),o=t(22),h=t(6),c=t(25),d=t(24),y=t(41);n.exports=function(_,v,x){for(var w=-1,C=(v=s(v,_)).length,A=!1;++w<C;){var I=y(v[w]);if(!(A=_!=null&&x(_,I)))break;_=_[I]}return A||++w!=C?A:!!(C=_==null?0:_.length)&&d(C)&&c(I,C)&&(h(_)||o(_))}},function(n,i,t){Object.defineProperty(i,"__esModule",{value:!0});var s=t(7),o=t(10),h=t(16);i.default=function(c){if(!c)throw new Error("geojson is required");var d=[];return h.flattenEach(c,function(y){(function(_,v){var x=[],w=_.geometry;if(w!==null){switch(w.type){case"Polygon":x=o.getCoords(w);break;case"LineString":x=[o.getCoords(w)]}x.forEach(function(C){(function(A,I){var R=[];return A.reduce(function(P,E){var z,j,q,et,J,ht,lt=s.lineString([P,E],I);return lt.bbox=(j=E,q=(z=P)[0],et=z[1],J=j[0],ht=j[1],[q<J?q:J,et<ht?et:ht,q>J?q:J,et>ht?et:ht]),R.push(lt),E}),R})(C,_.properties).forEach(function(A){A.id=v.length,v.push(A)})})}})(y,d)}),s.featureCollection(d)}},function(n,i,t){var s=t(148),o=t(7),h=t(16),c=t(42).default,d=h.featureEach,y=(h.coordEach,o.polygon,o.featureCollection);function _(v){var x=s(v);return x.insert=function(w){if(w.type!=="Feature")throw new Error("invalid feature");return w.bbox=w.bbox?w.bbox:c(w),s.prototype.insert.call(this,w)},x.load=function(w){var C=[];return Array.isArray(w)?w.forEach(function(A){if(A.type!=="Feature")throw new Error("invalid features");A.bbox=A.bbox?A.bbox:c(A),C.push(A)}):d(w,function(A){if(A.type!=="Feature")throw new Error("invalid features");A.bbox=A.bbox?A.bbox:c(A),C.push(A)}),s.prototype.load.call(this,C)},x.remove=function(w,C){if(w.type!=="Feature")throw new Error("invalid feature");return w.bbox=w.bbox?w.bbox:c(w),s.prototype.remove.call(this,w,C)},x.clear=function(){return s.prototype.clear.call(this)},x.search=function(w){var C=s.prototype.search.call(this,this.toBBox(w));return y(C)},x.collides=function(w){return s.prototype.collides.call(this,this.toBBox(w))},x.all=function(){var w=s.prototype.all.call(this);return y(w)},x.toJSON=function(){return s.prototype.toJSON.call(this)},x.fromJSON=function(w){return s.prototype.fromJSON.call(this,w)},x.toBBox=function(w){var C;if(w.bbox)C=w.bbox;else if(Array.isArray(w)&&w.length===4)C=w;else if(Array.isArray(w)&&w.length===6)C=[w[0],w[1],w[3],w[4]];else if(w.type==="Feature")C=c(w);else{if(w.type!=="FeatureCollection")throw new Error("invalid geojson");C=c(w)}return{minX:C[0],minY:C[1],maxX:C[2],maxY:C[3]}},x}n.exports=_,n.exports.default=_},function(n,i,t){n.exports=o,n.exports.default=o;var s=t(149);function o(P,E){if(!(this instanceof o))return new o(P,E);this._maxEntries=Math.max(4,P||9),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),E&&this._initFormat(E),this.clear()}function h(P,E,z){if(!z)return E.indexOf(P);for(var j=0;j<E.length;j++)if(z(P,E[j]))return j;return-1}function c(P,E){d(P,0,P.children.length,E,P)}function d(P,E,z,j,q){q||(q=I(null)),q.minX=1/0,q.minY=1/0,q.maxX=-1/0,q.maxY=-1/0;for(var et,J=E;J<z;J++)et=P.children[J],y(q,P.leaf?j(et):et);return q}function y(P,E){return P.minX=Math.min(P.minX,E.minX),P.minY=Math.min(P.minY,E.minY),P.maxX=Math.max(P.maxX,E.maxX),P.maxY=Math.max(P.maxY,E.maxY),P}function _(P,E){return P.minX-E.minX}function v(P,E){return P.minY-E.minY}function x(P){return(P.maxX-P.minX)*(P.maxY-P.minY)}function w(P){return P.maxX-P.minX+(P.maxY-P.minY)}function C(P,E){return P.minX<=E.minX&&P.minY<=E.minY&&E.maxX<=P.maxX&&E.maxY<=P.maxY}function A(P,E){return E.minX<=P.maxX&&E.minY<=P.maxY&&E.maxX>=P.minX&&E.maxY>=P.minY}function I(P){return{children:P,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function R(P,E,z,j,q){for(var et,J=[E,z];J.length;)(z=J.pop())-(E=J.pop())<=j||(et=E+Math.ceil((z-E)/j/2)*j,s(P,et,E,z,q),J.push(E,et,et,z))}o.prototype={all:function(){return this._all(this.data,[])},search:function(P){var E=this.data,z=[],j=this.toBBox;if(!A(P,E))return z;for(var q,et,J,ht,lt=[];E;){for(q=0,et=E.children.length;q<et;q++)J=E.children[q],A(P,ht=E.leaf?j(J):J)&&(E.leaf?z.push(J):C(P,ht)?this._all(J,z):lt.push(J));E=lt.pop()}return z},collides:function(P){var E=this.data,z=this.toBBox;if(!A(P,E))return!1;for(var j,q,et,J,ht=[];E;){for(j=0,q=E.children.length;j<q;j++)if(et=E.children[j],A(P,J=E.leaf?z(et):et)){if(E.leaf||C(P,J))return!0;ht.push(et)}E=ht.pop()}return!1},load:function(P){if(!P||!P.length)return this;if(P.length<this._minEntries){for(var E=0,z=P.length;E<z;E++)this.insert(P[E]);return this}var j=this._build(P.slice(),0,P.length-1,0);if(this.data.children.length)if(this.data.height===j.height)this._splitRoot(this.data,j);else{if(this.data.height<j.height){var q=this.data;this.data=j,j=q}this._insert(j,this.data.height-j.height-1,!0)}else this.data=j;return this},insert:function(P){return P&&this._insert(P,this.data.height-1),this},clear:function(){return this.data=I([]),this},remove:function(P,E){if(!P)return this;for(var z,j,q,et,J=this.data,ht=this.toBBox(P),lt=[],dt=[];J||lt.length;){if(J||(J=lt.pop(),j=lt[lt.length-1],z=dt.pop(),et=!0),J.leaf&&(q=h(P,J.children,E))!==-1)return J.children.splice(q,1),lt.push(J),this._condense(lt),this;et||J.leaf||!C(J,ht)?j?(z++,J=j.children[z],et=!1):J=null:(lt.push(J),dt.push(z),z=0,j=J,J=J.children[0])}return this},toBBox:function(P){return P},compareMinX:_,compareMinY:v,toJSON:function(){return this.data},fromJSON:function(P){return this.data=P,this},_all:function(P,E){for(var z=[];P;)P.leaf?E.push.apply(E,P.children):z.push.apply(z,P.children),P=z.pop();return E},_build:function(P,E,z,j){var q,et=z-E+1,J=this._maxEntries;if(et<=J)return c(q=I(P.slice(E,z+1)),this.toBBox),q;j||(j=Math.ceil(Math.log(et)/Math.log(J)),J=Math.ceil(et/Math.pow(J,j-1))),(q=I([])).leaf=!1,q.height=j;var ht,lt,dt,gt,vt=Math.ceil(et/J),At=vt*Math.ceil(Math.sqrt(J));for(R(P,E,z,At,this.compareMinX),ht=E;ht<=z;ht+=At)for(R(P,ht,dt=Math.min(ht+At-1,z),vt,this.compareMinY),lt=ht;lt<=dt;lt+=vt)gt=Math.min(lt+vt-1,dt),q.children.push(this._build(P,lt,gt,j-1));return c(q,this.toBBox),q},_chooseSubtree:function(P,E,z,j){for(var q,et,J,ht,lt,dt,gt,vt,At,K;j.push(E),!E.leaf&&j.length-1!==z;){for(gt=vt=1/0,q=0,et=E.children.length;q<et;q++)lt=x(J=E.children[q]),At=P,K=J,(dt=(Math.max(K.maxX,At.maxX)-Math.min(K.minX,At.minX))*(Math.max(K.maxY,At.maxY)-Math.min(K.minY,At.minY))-lt)<vt?(vt=dt,gt=lt<gt?lt:gt,ht=J):dt===vt&&lt<gt&&(gt=lt,ht=J);E=ht||E.children[0]}return E},_insert:function(P,E,z){var j=this.toBBox,q=z?P:j(P),et=[],J=this._chooseSubtree(q,this.data,E,et);for(J.children.push(P),y(J,q);E>=0&&et[E].children.length>this._maxEntries;)this._split(et,E),E--;this._adjustParentBBoxes(q,et,E)},_split:function(P,E){var z=P[E],j=z.children.length,q=this._minEntries;this._chooseSplitAxis(z,q,j);var et=this._chooseSplitIndex(z,q,j),J=I(z.children.splice(et,z.children.length-et));J.height=z.height,J.leaf=z.leaf,c(z,this.toBBox),c(J,this.toBBox),E?P[E-1].children.push(J):this._splitRoot(z,J)},_splitRoot:function(P,E){this.data=I([P,E]),this.data.height=P.height+1,this.data.leaf=!1,c(this.data,this.toBBox)},_chooseSplitIndex:function(P,E,z){var j,q,et,J,ht,lt,dt,gt,vt,At,K,rt,ft,zt;for(lt=dt=1/0,j=E;j<=z-E;j++)q=d(P,0,j,this.toBBox),et=d(P,j,z,this.toBBox),vt=q,At=et,K=void 0,rt=void 0,ft=void 0,zt=void 0,K=Math.max(vt.minX,At.minX),rt=Math.max(vt.minY,At.minY),ft=Math.min(vt.maxX,At.maxX),zt=Math.min(vt.maxY,At.maxY),J=Math.max(0,ft-K)*Math.max(0,zt-rt),ht=x(q)+x(et),J<lt?(lt=J,gt=j,dt=ht<dt?ht:dt):J===lt&&ht<dt&&(dt=ht,gt=j);return gt},_chooseSplitAxis:function(P,E,z){var j=P.leaf?this.compareMinX:_,q=P.leaf?this.compareMinY:v;this._allDistMargin(P,E,z,j)<this._allDistMargin(P,E,z,q)&&P.children.sort(j)},_allDistMargin:function(P,E,z,j){P.children.sort(j);var q,et,J=this.toBBox,ht=d(P,0,E,J),lt=d(P,z-E,z,J),dt=w(ht)+w(lt);for(q=E;q<z-E;q++)et=P.children[q],y(ht,P.leaf?J(et):et),dt+=w(ht);for(q=z-E-1;q>=E;q--)et=P.children[q],y(lt,P.leaf?J(et):et),dt+=w(lt);return dt},_adjustParentBBoxes:function(P,E,z){for(var j=z;j>=0;j--)y(E[j],P)},_condense:function(P){for(var E,z=P.length-1;z>=0;z--)P[z].children.length===0?z>0?(E=P[z-1].children).splice(E.indexOf(P[z]),1):this.clear():c(P[z],this.toBBox)},_initFormat:function(P){var E=["return a"," - b",";"];this.compareMinX=new Function("a","b",E.join(P[0])),this.compareMinY=new Function("a","b",E.join(P[1])),this.toBBox=new Function("a","return {minX: a"+P[0]+", minY: a"+P[1]+", maxX: a"+P[2]+", maxY: a"+P[3]+"};")}}},function(n,i,t){n.exports=function(){function s(h,c,d){var y=h[c];h[c]=h[d],h[d]=y}function o(h,c){return h<c?-1:h>c?1:0}return function(h,c,d,y,_){(function v(x,w,C,A,I){for(;A>C;){if(A-C>600){var R=A-C+1,P=w-C+1,E=Math.log(R),z=.5*Math.exp(2*E/3),j=.5*Math.sqrt(E*z*(R-z)/R)*(P-R/2<0?-1:1),q=Math.max(C,Math.floor(w-P*z/R+j)),et=Math.min(A,Math.floor(w+(R-P)*z/R+j));v(x,w,q,et,I)}var J=x[w],ht=C,lt=A;for(s(x,C,w),I(x[A],J)>0&&s(x,C,A);ht<lt;){for(s(x,ht,lt),ht++,lt--;I(x[ht],J)<0;)ht++;for(;I(x[lt],J)>0;)lt--}I(x[C],J)===0?s(x,C,lt):(lt++,s(x,lt,A)),lt<=w&&(C=lt+1),w<=lt&&(A=lt-1)}})(h,c,d||0,y||h.length-1,_||o)}}()},function(n,i,t){Object.defineProperty(i,"__esModule",{value:!0});var s=t(10);function o(h,c,d){var y=!1;c[0][0]===c[c.length-1][0]&&c[0][1]===c[c.length-1][1]&&(c=c.slice(0,c.length-1));for(var _=0,v=c.length-1;_<c.length;v=_++){var x=c[_][0],w=c[_][1],C=c[v][0],A=c[v][1];if(h[1]*(x-C)+w*(C-h[0])+A*(h[0]-x)==0&&(x-h[0])*(C-h[0])<=0&&(w-h[1])*(A-h[1])<=0)return!d;w>h[1]!=A>h[1]&&h[0]<(C-x)*(h[1]-w)/(A-w)+x&&(y=!y)}return y}i.default=function(h,c,d){if(d===void 0&&(d={}),!h)throw new Error("point is required");if(!c)throw new Error("polygon is required");var y=s.getCoord(h),_=s.getGeom(c),v=_.type,x=c.bbox,w=_.coordinates;if(x&&function(P,E){return E[0]<=P[0]&&E[1]<=P[1]&&E[2]>=P[0]&&E[3]>=P[1]}(y,x)===!1)return!1;v==="Polygon"&&(w=[w]);for(var C=!1,A=0;A<w.length&&!C;A++)if(o(y,w[A][0],d.ignoreBoundary)){for(var I=!1,R=1;R<w[A].length&&!I;)o(y,w[A][R],!d.ignoreBoundary)&&(I=!0),R++;I||(C=!0)}return C}},function(n,i,t){Object.defineProperty(i,"__esModule",{value:!0});var s=t(10);function o(h,c,d,y){var _=d[0],v=d[1],x=h[0],w=h[1],C=c[0],A=c[1],I=C-x,R=A-w;return(d[0]-x)*R-(d[1]-w)*I==0&&(y?y==="start"?Math.abs(I)>=Math.abs(R)?I>0?x<_&&_<=C:C<=_&&_<x:R>0?w<v&&v<=A:A<=v&&v<w:y==="end"?Math.abs(I)>=Math.abs(R)?I>0?x<=_&&_<C:C<_&&_<=x:R>0?w<=v&&v<A:A<v&&v<=w:y==="both"&&(Math.abs(I)>=Math.abs(R)?I>0?x<_&&_<C:C<_&&_<x:R>0?w<v&&v<A:A<v&&v<w):Math.abs(I)>=Math.abs(R)?I>0?x<=_&&_<=C:C<=_&&_<=x:R>0?w<=v&&v<=A:A<=v&&v<=w)}i.default=function(h,c,d){d===void 0&&(d={});for(var y=s.getCoord(h),_=s.getCoords(c),v=0;v<_.length-1;v++){var x=!1;if(d.ignoreEndVertices&&(v===0&&(x="start"),v===_.length-2&&(x="end"),v===0&&v+1===_.length-1&&(x="both")),o(_[v],_[v+1],y,x))return!0}return!1}},function(n,i){var t,s,o=n.exports={};function h(){throw new Error("setTimeout has not been defined")}function c(){throw new Error("clearTimeout has not been defined")}function d(R){if(t===setTimeout)return setTimeout(R,0);if((t===h||!t)&&setTimeout)return t=setTimeout,setTimeout(R,0);try{return t(R,0)}catch{try{return t.call(null,R,0)}catch{return t.call(this,R,0)}}}(function(){try{t=typeof setTimeout=="function"?setTimeout:h}catch{t=h}try{s=typeof clearTimeout=="function"?clearTimeout:c}catch{s=c}})();var y,_=[],v=!1,x=-1;function w(){v&&y&&(v=!1,y.length?_=y.concat(_):x=-1,_.length&&C())}function C(){if(!v){var R=d(w);v=!0;for(var P=_.length;P;){for(y=_,_=[];++x<P;)y&&y[x].run();x=-1,P=_.length}y=null,v=!1,function(E){if(s===clearTimeout)return clearTimeout(E);if((s===c||!s)&&clearTimeout)return s=clearTimeout,clearTimeout(E);try{s(E)}catch{try{return s.call(null,E)}catch{return s.call(this,E)}}}(R)}}function A(R,P){this.fun=R,this.array=P}function I(){}o.nextTick=function(R){var P=new Array(arguments.length-1);if(arguments.length>1)for(var E=1;E<arguments.length;E++)P[E-1]=arguments[E];_.push(new A(R,P)),_.length!==1||v||d(C)},A.prototype.run=function(){this.fun.apply(null,this.array)},o.title="browser",o.browser=!0,o.env={},o.argv=[],o.version="",o.versions={},o.on=I,o.addListener=I,o.once=I,o.off=I,o.removeListener=I,o.removeAllListeners=I,o.emit=I,o.prependListener=I,o.prependOnceListener=I,o.listeners=function(R){return[]},o.binding=function(R){throw new Error("process.binding is not supported")},o.cwd=function(){return"/"},o.chdir=function(R){throw new Error("process.chdir is not supported")},o.umask=function(){return 0}},function(n,i,t){},function(n,i,t){},function(n,i,t){t.r(i),t(69);var s=t(43),o=t(3),h=t.n(o),c=t(44),d=t(45),y=t(46),_=t(47),v=t(48),x=t(49),w=t(50),C=t(51),A=t(52),I=t(53),R=t(54),P={en:c,de:d,it:y,id:_,ro:v,ru:x,es:w,nl:C,fr:A,pt_br:t(55),zh:I,zh_tw:R,pl:t(56),sv:t(57),el:t(58),hu:t(59),da:t(60),no:t(61),fa:t(62),ua:t(63),tr:t(64),cz:t(65)};function E(r,l){var u=Object.keys(r);if(Object.getOwnPropertySymbols){var p=Object.getOwnPropertySymbols(r);l&&(p=p.filter(function(g){return Object.getOwnPropertyDescriptor(r,g).enumerable})),u.push.apply(u,p)}return u}function z(r,l,u){return l in r?Object.defineProperty(r,l,{value:u,enumerable:!0,configurable:!0,writable:!0}):r[l]=u,r}var j={_globalEditModeEnabled:!1,enableGlobalEditMode:function(r){this._globalEditModeEnabled=!0,this.Toolbar.toggleButton("editMode",this.globalEditModeEnabled()),L.PM.Utils.findLayers(this.map).forEach(function(l){l.pm.enable(r)}),this.throttledReInitEdit||(this.throttledReInitEdit=L.Util.throttle(this.handleLayerAdditionInGlobalEditMode,100,this)),this._addedLayers=[],this.map.on("layeradd",this._layerAdded,this),this.map.on("layeradd",this.throttledReInitEdit,this),this._fireGlobalEditModeToggled(!0)},disableGlobalEditMode:function(){this._globalEditModeEnabled=!1,L.PM.Utils.findLayers(this.map).forEach(function(r){r.pm.disable()}),this.map.off("layeradd",this.throttledReInitEdit,this),this.Toolbar.toggleButton("editMode",this.globalEditModeEnabled()),this._fireGlobalEditModeToggled(!1)},globalEditEnabled:function(){return this.globalEditModeEnabled()},globalEditModeEnabled:function(){return this._globalEditModeEnabled},toggleGlobalEditMode:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.globalOptions;this.globalEditModeEnabled()?this.disableGlobalEditMode():this.enableGlobalEditMode(r)},handleLayerAdditionInGlobalEditMode:function(){var r=this,l=this._addedLayers;this._addedLayers=[],l.forEach(function(u){!!u.pm&&!u._pmTempLayer&&r.globalEditModeEnabled()&&u.pm.enable(function(p){for(var g=1;g<arguments.length;g++){var M=arguments[g]!=null?arguments[g]:{};g%2?E(Object(M),!0).forEach(function(S){z(p,S,M[S])}):Object.getOwnPropertyDescriptors?Object.defineProperties(p,Object.getOwnPropertyDescriptors(M)):E(Object(M)).forEach(function(S){Object.defineProperty(p,S,Object.getOwnPropertyDescriptor(M,S))})}return p}({},r.globalOptions))})},_layerAdded:function(r){var l=r.layer;this._addedLayers.push(l)}},q={_globalDragModeEnabled:!1,enableGlobalDragMode:function(){var r=L.PM.Utils.findLayers(this.map);this._globalDragModeEnabled=!0,r.forEach(function(l){l.pm.enableLayerDrag()}),this.throttledReInitDrag||(this.throttledReInitDrag=L.Util.throttle(this.reinitGlobalDragMode,100,this)),this.map.on("layeradd",this.throttledReInitDrag,this),this.Toolbar.toggleButton("dragMode",this.globalDragModeEnabled()),this._fireGlobalDragModeToggled(!0)},disableGlobalDragMode:function(){var r=L.PM.Utils.findLayers(this.map);this._globalDragModeEnabled=!1,r.forEach(function(l){l.pm.disableLayerDrag()}),this.map.off("layeradd",this.throttledReInitDrag,this),this.Toolbar.toggleButton("dragMode",this.globalDragModeEnabled()),this._fireGlobalDragModeToggled(!1)},globalDragModeEnabled:function(){return!!this._globalDragModeEnabled},toggleGlobalDragMode:function(){this.globalDragModeEnabled()?this.disableGlobalDragMode():this.enableGlobalDragMode()},reinitGlobalDragMode:function(r){var l=r.layer;!!l.pm&&!l._pmTempLayer&&this.globalDragModeEnabled()&&(this.disableGlobalDragMode(),this.enableGlobalDragMode())}},et={_globalRemovalModeEnabled:!1,enableGlobalRemovalMode:function(){var r=this;this._globalRemovalModeEnabled=!0,this.map.eachLayer(function(l){r._isRelevantForRemoval(l)&&(l.pm.disable(),l.on("click",r.removeLayer,r))}),this.throttledReInitRemoval||(this.throttledReInitRemoval=L.Util.throttle(this.reinitGlobalRemovalMode,100,this)),this.map.on("layeradd",this.throttledReInitRemoval,this),this.Toolbar.toggleButton("removalMode",this.globalRemovalModeEnabled()),this._fireGlobalRemovalModeToggled(!0)},disableGlobalRemovalMode:function(){var r=this;this._globalRemovalModeEnabled=!1,this.map.eachLayer(function(l){l.off("click",r.removeLayer,r)}),this.map.off("layeradd",this.throttledReInitRemoval,this),this.Toolbar.toggleButton("removalMode",this.globalRemovalModeEnabled()),this._fireGlobalRemovalModeToggled(!1)},globalRemovalEnabled:function(){return this.globalRemovalModeEnabled()},globalRemovalModeEnabled:function(){return!!this._globalRemovalModeEnabled},toggleGlobalRemovalMode:function(){this.globalRemovalModeEnabled()?this.disableGlobalRemovalMode():this.enableGlobalRemovalMode()},reinitGlobalRemovalMode:function(r){var l=r.layer;this._isRelevantForRemoval(l)&&this.globalRemovalModeEnabled()&&(this.disableGlobalRemovalMode(),this.enableGlobalRemovalMode())},removeLayer:function(r){var l=r.target;this._isRelevantForRemoval(l)&&!l.pm.dragging()&&(l.removeFrom(this.map.pm._getContainingLayer()),l.remove(),l instanceof L.LayerGroup?(this._fireRemoveLayerGroup(l),this._fireRemoveLayerGroup(this.map,l)):(l.pm._fireRemove(l),l.pm._fireRemove(this.map,l)))},_isRelevantForRemoval:function(r){return r.pm&&!(r instanceof L.LayerGroup)&&(!L.PM.optIn&&!r.options.pmIgnore||L.PM.optIn&&r.options.pmIgnore===!1)&&!r._pmTempLayer&&r.pm.options.allowRemoval}},J={_globalRotateModeEnabled:!1,enableGlobalRotateMode:function(){var r=this;this._globalRotateModeEnabled=!0,L.PM.Utils.findLayers(this.map).filter(function(l){return l instanceof L.Polyline}).forEach(function(l){r._isRelevantForRotate(l)&&l.pm.enableRotate()}),this.throttledReInitRotate||(this.throttledReInitRotate=L.Util.throttle(this._reinitGlobalRotateMode,100,this)),this.map.on("layeradd",this.throttledReInitRotate,this),this.Toolbar.toggleButton("rotateMode",this.globalRotateModeEnabled()),this._fireGlobalRotateModeToggled()},disableGlobalRotateMode:function(){this._globalRotateModeEnabled=!1,L.PM.Utils.findLayers(this.map).filter(function(r){return r instanceof L.Polyline}).forEach(function(r){r.pm.disableRotate()}),this.map.off("layeradd",this.throttledReInitRotate,this),this.Toolbar.toggleButton("rotateMode",this.globalRotateModeEnabled()),this._fireGlobalRotateModeToggled()},globalRotateModeEnabled:function(){return!!this._globalRotateModeEnabled},toggleGlobalRotateMode:function(){this.globalRotateModeEnabled()?this.disableGlobalRotateMode():this.enableGlobalRotateMode()},_reinitGlobalRotateMode:function(r){var l=r.layer;this._isRelevantForRotate(l)&&this.globalRotateModeEnabled()&&(this.disableGlobalRotateMode(),this.enableGlobalRotateMode())},_isRelevantForRotate:function(r){return r.pm&&!(r instanceof L.LayerGroup)&&(!L.PM.optIn&&!r.options.pmIgnore||L.PM.optIn&&r.options.pmIgnore===!1)&&!r._pmTempLayer&&r.pm.options.allowRotation}};function ht(r,l){var u=Object.keys(r);if(Object.getOwnPropertySymbols){var p=Object.getOwnPropertySymbols(r);l&&(p=p.filter(function(g){return Object.getOwnPropertyDescriptor(r,g).enumerable})),u.push.apply(u,p)}return u}function lt(r){for(var l=1;l<arguments.length;l++){var u=arguments[l]!=null?arguments[l]:{};l%2?ht(Object(u),!0).forEach(function(p){dt(r,p,u[p])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(u)):ht(Object(u)).forEach(function(p){Object.defineProperty(r,p,Object.getOwnPropertyDescriptor(u,p))})}return r}function dt(r,l,u){return l in r?Object.defineProperty(r,l,{value:u,enumerable:!0,configurable:!0,writable:!0}):r[l]=u,r}var gt={_fireDrawStart:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"Draw",l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.__fire(this._map,"pm:drawstart",{shape:this._shape,workingLayer:this._layer},r,l)},_fireDrawEnd:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"Draw",l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.__fire(this._map,"pm:drawend",{shape:this._shape},r,l)},_fireCreate:function(r){var l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"Draw",u=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};this.__fire(this._map,"pm:create",{shape:this._shape,marker:r,layer:r},l,u)},_fireCenterPlaced:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"Draw",l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},u=r==="Draw"?this._layer:void 0,p=r!=="Draw"?this._layer:void 0;this.__fire(this._layer,"pm:centerplaced",{shape:this._shape,workingLayer:u,layer:p,latlng:this._layer.getLatLng()},r,l)},_fireCut:function(r,l,u){var p=arguments.length>3&&arguments[3]!==void 0?arguments[3]:"Draw",g=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{};this.__fire(r,"pm:cut",{shape:this._shape,layer:l,originalLayer:u},p,g)},_fireEdit:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this._layer,l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"Edit",u=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};this.__fire(r,"pm:edit",{layer:this._layer,shape:this.getShape()},l,u)},_fireEnable:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"Edit",l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.__fire(this._layer,"pm:enable",{layer:this._layer,shape:this.getShape()},r,l)},_fireDisable:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"Edit",l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.__fire(this._layer,"pm:disable",{layer:this._layer,shape:this.getShape()},r,l)},_fireUpdate:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"Edit",l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.__fire(this._layer,"pm:update",{layer:this._layer,shape:this.getShape()},r,l)},_fireMarkerDragStart:function(r){var l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:void 0,u=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"Edit",p=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};this.__fire(this._layer,"pm:markerdragstart",{layer:this._layer,markerEvent:r,shape:this.getShape(),indexPath:l},u,p)},_fireMarkerDrag:function(r){var l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:void 0,u=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"Edit",p=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};this.__fire(this._layer,"pm:markerdrag",{layer:this._layer,markerEvent:r,shape:this.getShape(),indexPath:l},u,p)},_fireMarkerDragEnd:function(r){var l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:void 0,u=arguments.length>2&&arguments[2]!==void 0?arguments[2]:void 0,p=arguments.length>3&&arguments[3]!==void 0?arguments[3]:"Edit",g=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{};this.__fire(this._layer,"pm:markerdragend",{layer:this._layer,markerEvent:r,shape:this.getShape(),indexPath:l,intersectionReset:u},p,g)},_fireDragStart:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"Edit",l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.__fire(this._layer,"pm:dragstart",{layer:this._layer,shape:this.getShape()},r,l)},_fireDrag:function(r){var l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"Edit",u=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};this.__fire(this._layer,"pm:drag",lt(lt({},r),{},{shape:this.getShape()}),l,u)},_fireDragEnd:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"Edit",l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.__fire(this._layer,"pm:dragend",{layer:this._layer,shape:this.getShape()},r,l)},_fireRemove:function(r){var l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:r,u=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"Edit",p=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};this.__fire(r,"pm:remove",{layer:l,shape:this.getShape()},u,p)},_fireVertexAdded:function(r,l,u){var p=arguments.length>3&&arguments[3]!==void 0?arguments[3]:"Edit",g=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{};this.__fire(this._layer,"pm:vertexadded",{layer:this._layer,workingLayer:this._layer,marker:r,indexPath:l,latlng:u,shape:this.getShape()},p,g)},_fireVertexRemoved:function(r,l){var u=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"Edit",p=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};this.__fire(this._layer,"pm:vertexremoved",{layer:this._layer,marker:r,indexPath:l,shape:this.getShape()},u,p)},_fireVertexClick:function(r,l){var u=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"Edit",p=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};this.__fire(this._layer,"pm:vertexclick",{layer:this._layer,markerEvent:r,indexPath:l,shape:this.getShape()},u,p)},_fireIntersect:function(r){var l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"Edit",u=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};this.__fire(this._layer,"pm:intersect",{layer:this._layer,intersection:r,shape:this.getShape()},l,u)},_fireLayerReset:function(r,l){var u=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"Edit",p=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};this.__fire(this._layer,"pm:layerreset",{layer:this._layer,markerEvent:r,indexPath:l,shape:this.getShape()},u,p)},_fireSnapDrag:function(r,l){var u=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"Snapping",p=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};this.__fire(r,"pm:snapdrag",l,u,p)},_fireSnap:function(r,l){var u=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"Snapping",p=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};this.__fire(r,"pm:snap",l,u,p)},_fireUnsnap:function(r,l){var u=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"Snapping",p=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};this.__fire(r,"pm:unsnap",l,u,p)},_fireRotationEnable:function(r,l){var u=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"Rotation",p=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};this.__fire(r,"pm:rotateenable",{layer:this._layer,helpLayer:this._rotatePoly},u,p)},_fireRotationDisable:function(r){var l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"Rotation",u=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};this.__fire(r,"pm:rotatedisable",{layer:this._layer},l,u)},_fireRotationStart:function(r,l){var u=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"Rotation",p=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};this.__fire(r,"pm:rotatestart",{layer:this._rotationLayer,helpLayer:this._layer,startAngle:this._startAngle,originLatLngs:l},u,p)},_fireRotation:function(r,l,u){var p=arguments.length>3&&arguments[3]!==void 0?arguments[3]:"Rotation",g=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{};this.__fire(r,"pm:rotate",{layer:this._rotationLayer,helpLayer:this._layer,startAngle:this._startAngle,angle:this._rotationLayer.pm.getAngle(),angleDiff:l,oldLatLngs:u,newLatLngs:this._rotationLayer.getLatLngs()},p,g)},_fireRotationEnd:function(r,l,u){var p=arguments.length>3&&arguments[3]!==void 0?arguments[3]:"Rotation",g=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{};this.__fire(r,"pm:rotateend",{layer:this._rotationLayer,helpLayer:this._layer,startAngle:l,angle:this._rotationLayer.pm.getAngle(),originLatLngs:u,newLatLngs:this._rotationLayer.getLatLngs()},p,g)},_fireActionClick:function(r,l,u){var p=arguments.length>3&&arguments[3]!==void 0?arguments[3]:"Toolbar",g=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{};this.__fire(this._map,"pm:actionclick",{text:r.text,action:r,btnName:l,button:u},p,g)},_fireButtonClick:function(r,l){var u=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"Toolbar",p=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};this.__fire(this._map,"pm:buttonclick",{btnName:r,button:l},u,p)},_fireLangChange:function(r,l,u,p){var g=arguments.length>4&&arguments[4]!==void 0?arguments[4]:"Global",M=arguments.length>5&&arguments[5]!==void 0?arguments[5]:{};this.__fire(this.map,"pm:langchange",{oldLang:r,activeLang:l,fallback:u,translations:p},g,M)},_fireGlobalDragModeToggled:function(r){var l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"Global",u=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};this.__fire(this.map,"pm:globaldragmodetoggled",{enabled:r,map:this.map},l,u)},_fireGlobalEditModeToggled:function(r){var l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"Global",u=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};this.__fire(this.map,"pm:globaleditmodetoggled",{enabled:r,map:this.map},l,u)},_fireGlobalRemovalModeToggled:function(r){var l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"Global",u=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};this.__fire(this.map,"pm:globalremovalmodetoggled",{enabled:r,map:this.map},l,u)},_fireGlobalCutModeToggled:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"Global",l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.__fire(this._map,"pm:globalcutmodetoggled",{enabled:!!this._enabled,map:this._map},r,l)},_fireGlobalDrawModeToggled:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"Global",l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.__fire(this._map,"pm:globaldrawmodetoggled",{enabled:this._enabled,shape:this._shape,map:this._map},r,l)},_fireGlobalRotateModeToggled:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"Global",l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.__fire(this.map,"pm:globalrotatemodetoggled",{enabled:this.globalRotateModeEnabled(),map:this.map},r,l)},_fireRemoveLayerGroup:function(r){var l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:r,u=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"Edit",p=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};this.__fire(r,"pm:remove",{layer:l,shape:void 0},u,p)},_fireKeyeventEvent:function(r,l,u){var p=arguments.length>3&&arguments[3]!==void 0?arguments[3]:"Global",g=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{};this.__fire(this.map,"pm:keyevent",{event:r,eventType:l,focusOn:u},p,g)},__fire:function(r,l,u,p){var g=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{};u=h()(u,g,{source:p}),L.PM.Utils._fireEvent(r,l,u)}},vt={_lastEvents:{keydown:void 0,keyup:void 0,current:void 0},_initKeyListener:function(r){this.map=r,L.DomEvent.on(document,"keydown keyup",this._onKeyListener,this),L.DomEvent.on(document,"blur",this._onKeyListener,this)},_onKeyListener:function(r){var l="document";this.map.getContainer().contains(r.target)&&(l="map");var u={event:r,eventType:r.type,focusOn:l};this._lastEvents[r.type]=u,this._lastEvents.current=u,this.map.pm._fireKeyeventEvent(r,r.type,l)},getLastKeyEvent:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"current";return this._lastEvents[r]},isShiftKeyPressed:function(){var r;return(r=this._lastEvents.current)===null||r===void 0?void 0:r.event.shiftKey},isAltKeyPressed:function(){var r;return(r=this._lastEvents.current)===null||r===void 0?void 0:r.event.altKey},isCtrlKeyPressed:function(){var r;return(r=this._lastEvents.current)===null||r===void 0?void 0:r.event.ctrlKey},isMetaKeyPressed:function(){var r;return(r=this._lastEvents.current)===null||r===void 0?void 0:r.event.metaKey},getPressedKey:function(){var r;return(r=this._lastEvents.current)===null||r===void 0?void 0:r.event.key}},At=L.Class.extend({includes:[j,q,et,J,gt],initialize:function(r){this.map=r,this.Draw=new L.PM.Draw(r),this.Toolbar=new L.PM.Toolbar(r),this.Keyboard=vt,this.globalOptions={snappable:!0,layerGroup:void 0,snappingOrder:["Marker","CircleMarker","Circle","Line","Polygon","Rectangle"],panes:{vertexPane:"markerPane",layerPane:"overlayPane",markerPane:"markerPane"}},this.Keyboard._initKeyListener(r)},setLang:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"en",l=arguments.length>1?arguments[1]:void 0,u=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"en",p=L.PM.activeLang;l&&(P[r]=h()(P[u],l)),L.PM.activeLang=r,this.map.pm.Toolbar.reinit(),this._fireLangChange(p,r,u,P[r])},addControls:function(r){this.Toolbar.addControls(r)},removeControls:function(){this.Toolbar.removeControls()},toggleControls:function(){this.Toolbar.toggleControls()},controlsVisible:function(){return this.Toolbar.isVisible},enableDraw:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"Polygon",l=arguments.length>1?arguments[1]:void 0;r==="Poly"&&(r="Polygon"),this.Draw.enable(r,l)},disableDraw:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"Polygon";r==="Poly"&&(r="Polygon"),this.Draw.disable(r)},setPathOptions:function(r){var l=this,u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},p=u.ignoreShapes||[],g=u.merge||!1;this.map.pm.Draw.shapes.forEach(function(M){p.indexOf(M)===-1&&l.map.pm.Draw[M].setPathOptions(r,g)})},getGlobalOptions:function(){return this.globalOptions},setGlobalOptions:function(r){var l=this,u=h()(this.globalOptions,r),p=!1;this.map.pm.Draw.CircleMarker.enabled()&&this.map.pm.Draw.CircleMarker.options.editable!==u.editable&&(this.map.pm.Draw.CircleMarker.disable(),p=!0),this.map.pm.Draw.shapes.forEach(function(g){l.map.pm.Draw[g].setOptions(u)}),p&&this.map.pm.Draw.CircleMarker.enable(),L.PM.Utils.findLayers(this.map).forEach(function(g){g.pm.setOptions(u)}),this.applyGlobalOptions(),this.globalOptions=u},applyGlobalOptions:function(){L.PM.Utils.findLayers(this.map).forEach(function(r){r.pm.enabled()&&r.pm.applyOptions()})},globalDrawModeEnabled:function(){return!!this.Draw.getActiveShape()},globalCutModeEnabled:function(){return!!this.Draw.Cut.enabled()},enableGlobalCutMode:function(r){return this.Draw.Cut.enable(r)},toggleGlobalCutMode:function(r){return this.Draw.Cut.toggle(r)},disableGlobalCutMode:function(){return this.Draw.Cut.disable()},getGeomanLayers:function(){var r=arguments.length>0&&arguments[0]!==void 0&&arguments[0],l=L.PM.Utils.findLayers(this.map);if(!r)return l;var u=L.featureGroup();return u._pmTempLayer=!0,l.forEach(function(p){u.addLayer(p)}),u},getGeomanDrawLayers:function(){var r=arguments.length>0&&arguments[0]!==void 0&&arguments[0],l=L.PM.Utils.findLayers(this.map).filter(function(p){return p._drawnByGeoman===!0});if(!r)return l;var u=L.featureGroup();return u._pmTempLayer=!0,l.forEach(function(p){u.addLayer(p)}),u},_getContainingLayer:function(){return this.globalOptions.layerGroup&&this.globalOptions.layerGroup instanceof L.LayerGroup?this.globalOptions.layerGroup:this.map},_isCRSSimple:function(){return this.map.options.crs===L.CRS.Simple}}),K=t(0),rt=t.n(K),ft=t(66),zt=t.n(ft);function ot(r){var l=L.PM.activeLang;return zt()(P,l)||(l="en"),rt()(P[l],r)}function It(r){return!function l(u){return u.filter(function(p){return![null,"",void 0].includes(p)}).reduce(function(p,g){return p.concat(Array.isArray(g)?l(g):g)},[])}(r).length}function kt(r){return r.reduce(function(l,u){return u.length!==0&&l.push(Array.isArray(u)?kt(u):u),l},[])}function Rt(r,l,u){for(var p,g,M,S=6378137,D=63567523142e-4,B=1/298.257223563,N=r.lng,H=r.lat,Y=u,V=Math.PI,tt=l*V/180,ut=Math.sin(tt),ct=Math.cos(tt),yt=(1-B)*Math.tan(H*V/180),mt=1/Math.sqrt(1+yt*yt),xt=yt*mt,Lt=Math.atan2(yt,ct),_t=mt*ut,Gt=1-_t*_t,Me=Gt*(S*S-D*D)/(D*D),Dr=1+Me/16384*(4096+Me*(Me*(320-175*Me)-768)),Ne=Me/1024*(256+Me*(Me*(74-47*Me)-128)),Qe=Y/(D*Dr),ar=2*Math.PI;Math.abs(Qe-ar)>1e-12;)p=Math.cos(2*Lt+Qe),ar=Qe,Qe=Y/(D*Dr)+Ne*(g=Math.sin(Qe))*(p+Ne/4*((M=Math.cos(Qe))*(2*p*p-1)-Ne/6*p*(4*g*g-3)*(4*p*p-3)));var Ln=xt*g-mt*M*ct,wn=Math.atan2(xt*M+mt*g*ct,(1-B)*Math.sqrt(_t*_t+Ln*Ln)),Yi=B/16*Gt*(4+B*(4-3*Gt)),kn=N+180*(Math.atan2(g*ut,mt*M-xt*g*ct)-(1-Yi)*B*_t*(Qe+Yi*g*(p+Yi*M*(2*p*p-1))))/V,Bi=180*wn/V;return L.latLng(kn,Bi)}function se(r,l,u,p){for(var g,M,S=!(arguments.length>4&&arguments[4]!==void 0)||arguments[4],D=[],B=0;B<u;B+=1){if(S)g=Rt(r,360*B/u+p,l),M=L.latLng(g.lng,g.lat);else{var N=r.lat+Math.cos(2*B*Math.PI/u)*l,H=r.lng+Math.sin(2*B*Math.PI/u)*l;M=L.latLng(N,H)}D.push(M)}return D}function Kt(r,l,u,p){return function(g,M,S){M=(M+360)%360;var D=Math.PI/180,B=180/Math.PI,N=6378137,H=g.lng*D,Y=g.lat*D,V=M*D,tt=Math.sin(Y),ut=Math.cos(Y),ct=Math.cos(S/N),yt=Math.sin(S/N),mt=Math.asin(tt*ct+ut*yt*Math.cos(V)),xt=H+Math.atan2(Math.sin(V)*yt*ut,ct-tt*Math.sin(mt));return xt=(xt*=B)>180?xt-360:xt<-180?xt+360:xt,L.latLng([mt*B,xt])}(l,function(g,M,S){var D=g.latLngToContainerPoint(M),B=g.latLngToContainerPoint(S),N=180*Math.atan2(B.y-D.y,B.x-D.x)/Math.PI+90;return N+=N<0?360:0}(r,l,u),p)}function $t(r){var l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:r.getLatLngs();return r instanceof L.Polygon?L.polygon(l).getLatLngs():L.polyline(l).getLatLngs()}function Bt(r,l){var u,p;if((u=l.options.crs)===null||u===void 0||(p=u.projection)===null||p===void 0?void 0:p.MAX_LATITUDE){var g,M,S=(g=l.options.crs)===null||g===void 0||(M=g.projection)===null||M===void 0?void 0:M.MAX_LATITUDE;r.lat=Math.max(Math.min(S,r.lat),-S)}return r}function Ut(r,l){var u=Object.keys(r);if(Object.getOwnPropertySymbols){var p=Object.getOwnPropertySymbols(r);l&&(p=p.filter(function(g){return Object.getOwnPropertyDescriptor(r,g).enumerable})),u.push.apply(u,p)}return u}function ge(r){for(var l=1;l<arguments.length;l++){var u=arguments[l]!=null?arguments[l]:{};l%2?Ut(Object(u),!0).forEach(function(p){_e(r,p,u[p])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(u)):Ut(Object(u)).forEach(function(p){Object.defineProperty(r,p,Object.getOwnPropertyDescriptor(u,p))})}return r}function _e(r,l,u){return l in r?Object.defineProperty(r,l,{value:u,enumerable:!0,configurable:!0,writable:!0}):r[l]=u,r}var Ve=L.Control.extend({includes:[gt],options:{position:"topleft"},initialize:function(r){this._button=ge(ge({},this.options),r)},onAdd:function(r){return this._map=r,this._map.pm.Toolbar.options.oneBlock?this._container=this._map.pm.Toolbar._createContainer(this.options.position):this._button.tool==="edit"?this._container=this._map.pm.Toolbar.editContainer:this._button.tool==="options"?this._container=this._map.pm.Toolbar.optionsContainer:this._button.tool==="custom"?this._container=this._map.pm.Toolbar.customContainer:this._container=this._map.pm.Toolbar.drawContainer,this.buttonsDomNode=this._makeButton(this._button),this._container.appendChild(this.buttonsDomNode),this._container},onRemove:function(){return this.buttonsDomNode.remove(),this._container},getText:function(){return this._button.text},getIconUrl:function(){return this._button.iconUrl},destroy:function(){this._button={},this._update()},toggle:function(r){return this._button.toggleStatus=typeof r=="boolean"?r:!this._button.toggleStatus,this._applyStyleClasses(),this._button.toggleStatus},toggled:function(){return this._button.toggleStatus},onCreate:function(){this.toggle(!1)},_triggerClick:function(r){r&&r.preventDefault(),this._button.onClick(r,{button:this,event:r}),this._clicked(r),this._button.afterClick(r,{button:this,event:r})},_makeButton:function(r){var l=this,u=this.options.position.indexOf("right")>-1?"pos-right":"",p=L.DomUtil.create("div","button-container  ".concat(u),this._container),g=L.DomUtil.create("a","leaflet-buttons-control-button",p);g.setAttribute("role","button"),g.setAttribute("tabindex","0"),g.href="#";var M=L.DomUtil.create("div","leaflet-pm-actions-container ".concat(u),p),S=r.actions,D={cancel:{text:ot("actions.cancel"),onClick:function(){this._triggerClick()}},finishMode:{text:ot("actions.finish"),onClick:function(){this._triggerClick()}},removeLastVertex:{text:ot("actions.removeLastVertex"),onClick:function(){this._map.pm.Draw[r.jsClass]._removeLastVertex()}},finish:{text:ot("actions.finish"),onClick:function(N){this._map.pm.Draw[r.jsClass]._finishShape(N)}}};S.forEach(function(N){var H,Y=typeof N=="string"?N:N.name;if(D[Y])H=D[Y];else{if(!N.text)return;H=N}var V=L.DomUtil.create("a","leaflet-pm-action ".concat(u," action-").concat(Y),M);V.setAttribute("role","button"),V.setAttribute("tabindex","0"),V.href="#",V.innerHTML=H.text,!r.disabled&&H.onClick&&(L.DomEvent.addListener(V,"click",function(tt){tt.preventDefault();var ut="",ct=l._map.pm.Toolbar.buttons;for(var yt in ct)if(ct[yt]._button===r){ut=yt;break}l._fireActionClick(H,ut,r)},l),L.DomEvent.addListener(V,"click",H.onClick,l)),L.DomEvent.disableClickPropagation(V)}),r.toggleStatus&&L.DomUtil.addClass(p,"active");var B=L.DomUtil.create("div","control-icon",g);return r.title&&B.setAttribute("title",r.title),r.iconUrl&&B.setAttribute("src",r.iconUrl),r.className&&L.DomUtil.addClass(B,r.className),r.disabled||(L.DomEvent.addListener(g,"click",function(){l._button.disableOtherButtons&&l._map.pm.Toolbar.triggerClickOnToggledButtons(l);var N="",H=l._map.pm.Toolbar.buttons;for(var Y in H)if(H[Y]._button===r){N=Y;break}l._fireButtonClick(N,r)}),L.DomEvent.addListener(g,"click",this._triggerClick,this)),r.disabled&&(L.DomUtil.addClass(g,"pm-disabled"),L.DomUtil.addClass(B,"pm-disabled")),L.DomEvent.disableClickPropagation(g),p},_applyStyleClasses:function(){this._container&&(this._button.toggleStatus&&this._button.cssToggle!==!1?(L.DomUtil.addClass(this.buttonsDomNode,"active"),L.DomUtil.addClass(this._container,"activeChild")):(L.DomUtil.removeClass(this.buttonsDomNode,"active"),L.DomUtil.removeClass(this._container,"activeChild")))},_clicked:function(){this._button.doToggle&&this.toggle()}});function ue(r,l){var u=Object.keys(r);if(Object.getOwnPropertySymbols){var p=Object.getOwnPropertySymbols(r);l&&(p=p.filter(function(g){return Object.getOwnPropertyDescriptor(r,g).enumerable})),u.push.apply(u,p)}return u}function $(r){for(var l=1;l<arguments.length;l++){var u=arguments[l]!=null?arguments[l]:{};l%2?ue(Object(u),!0).forEach(function(p){k(r,p,u[p])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(u)):ue(Object(u)).forEach(function(p){Object.defineProperty(r,p,Object.getOwnPropertyDescriptor(u,p))})}return r}function k(r,l,u){return l in r?Object.defineProperty(r,l,{value:u,enumerable:!0,configurable:!0,writable:!0}):r[l]=u,r}function T(r){return(T=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(l){return typeof l}:function(l){return l&&typeof Symbol=="function"&&l.constructor===Symbol&&l!==Symbol.prototype?"symbol":typeof l})(r)}L.Control.PMButton=Ve;var F=L.Class.extend({options:{drawMarker:!0,drawRectangle:!0,drawPolyline:!0,drawPolygon:!0,drawCircle:!0,drawCircleMarker:!0,editMode:!0,dragMode:!0,cutPolygon:!0,removalMode:!0,rotateMode:!0,snappingOption:!0,drawControls:!0,editControls:!0,optionsControls:!0,customControls:!0,oneBlock:!1,position:"topleft",positions:{draw:"",edit:"",options:"",custom:""}},customButtons:[],initialize:function(r){this.init(r)},reinit:function(){var r=this.isVisible;this.removeControls(),this._defineButtons(),r&&this.addControls()},init:function(r){this.map=r,this.buttons={},this.isVisible=!1,this.drawContainer=L.DomUtil.create("div","leaflet-pm-toolbar leaflet-pm-draw leaflet-bar leaflet-control"),this.editContainer=L.DomUtil.create("div","leaflet-pm-toolbar leaflet-pm-edit leaflet-bar leaflet-control"),this.optionsContainer=L.DomUtil.create("div","leaflet-pm-toolbar leaflet-pm-options leaflet-bar leaflet-control"),this.customContainer=L.DomUtil.create("div","leaflet-pm-toolbar leaflet-pm-custom leaflet-bar leaflet-control"),this._defineButtons()},_createContainer:function(r){var l="".concat(r,"Container");return this[l]||(this[l]=L.DomUtil.create("div","leaflet-pm-toolbar leaflet-pm-".concat(r," leaflet-bar leaflet-control"))),this[l]},getButtons:function(){return this.buttons},addControls:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.options;typeof r.editPolygon!="undefined"&&(r.editMode=r.editPolygon),typeof r.deleteLayer!="undefined"&&(r.removalMode=r.deleteLayer),L.Util.setOptions(this,r),this.applyIconStyle(),this.isVisible=!0,this._showHideButtons()},applyIconStyle:function(){var r=this.getButtons(),l={geomanIcons:{drawMarker:"control-icon leaflet-pm-icon-marker",drawPolyline:"control-icon leaflet-pm-icon-polyline",drawRectangle:"control-icon leaflet-pm-icon-rectangle",drawPolygon:"control-icon leaflet-pm-icon-polygon",drawCircle:"control-icon leaflet-pm-icon-circle",drawCircleMarker:"control-icon leaflet-pm-icon-circle-marker",editMode:"control-icon leaflet-pm-icon-edit",dragMode:"control-icon leaflet-pm-icon-drag",cutPolygon:"control-icon leaflet-pm-icon-cut",removalMode:"control-icon leaflet-pm-icon-delete"}};for(var u in r){var p=r[u];L.Util.setOptions(p,{className:l.geomanIcons[u]})}},removeControls:function(){var r=this.getButtons();for(var l in r)r[l].remove();this.isVisible=!1},toggleControls:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.options;this.isVisible?this.removeControls():this.addControls(r)},_addButton:function(r,l){return this.buttons[r]=l,this.options[r]=this.options[r]||!1,this.buttons[r]},triggerClickOnToggledButtons:function(r){var l=["snappingOption"];for(var u in this.buttons)!l.includes(u)&&this.buttons[u]!==r&&this.buttons[u].toggled()&&this.buttons[u]._triggerClick()},toggleButton:function(r,l){var u=!(arguments.length>2&&arguments[2]!==void 0)||arguments[2];return r==="editPolygon"&&(r="editMode"),r==="deleteLayer"&&(r="removalMode"),u&&this.triggerClickOnToggledButtons(this.buttons[r]),!!this.buttons[r]&&this.buttons[r].toggle(l)},_defineButtons:function(){var r=this,l={className:"control-icon leaflet-pm-icon-marker",title:ot("buttonTitles.drawMarkerButton"),jsClass:"Marker",onClick:function(){},afterClick:function(V,tt){r.map.pm.Draw[tt.button._button.jsClass].toggle()},doToggle:!0,toggleStatus:!1,disableOtherButtons:!0,position:this.options.position,actions:["cancel"]},u={title:ot("buttonTitles.drawPolyButton"),className:"control-icon leaflet-pm-icon-polygon",jsClass:"Polygon",onClick:function(){},afterClick:function(V,tt){r.map.pm.Draw[tt.button._button.jsClass].toggle()},doToggle:!0,toggleStatus:!1,disableOtherButtons:!0,position:this.options.position,actions:["finish","removeLastVertex","cancel"]},p={className:"control-icon leaflet-pm-icon-polyline",title:ot("buttonTitles.drawLineButton"),jsClass:"Line",onClick:function(){},afterClick:function(V,tt){r.map.pm.Draw[tt.button._button.jsClass].toggle()},doToggle:!0,toggleStatus:!1,disableOtherButtons:!0,position:this.options.position,actions:["finish","removeLastVertex","cancel"]},g={title:ot("buttonTitles.drawCircleButton"),className:"control-icon leaflet-pm-icon-circle",jsClass:"Circle",onClick:function(){},afterClick:function(V,tt){r.map.pm.Draw[tt.button._button.jsClass].toggle()},doToggle:!0,toggleStatus:!1,disableOtherButtons:!0,position:this.options.position,actions:["cancel"]},M={title:ot("buttonTitles.drawCircleMarkerButton"),className:"control-icon leaflet-pm-icon-circle-marker",jsClass:"CircleMarker",onClick:function(){},afterClick:function(V,tt){r.map.pm.Draw[tt.button._button.jsClass].toggle()},doToggle:!0,toggleStatus:!1,disableOtherButtons:!0,position:this.options.position,actions:["cancel"]},S={title:ot("buttonTitles.drawRectButton"),className:"control-icon leaflet-pm-icon-rectangle",jsClass:"Rectangle",onClick:function(){},afterClick:function(V,tt){r.map.pm.Draw[tt.button._button.jsClass].toggle()},doToggle:!0,toggleStatus:!1,disableOtherButtons:!0,position:this.options.position,actions:["cancel"]},D={title:ot("buttonTitles.editButton"),className:"control-icon leaflet-pm-icon-edit",onClick:function(){},afterClick:function(){r.map.pm.toggleGlobalEditMode()},doToggle:!0,toggleStatus:!1,disableOtherButtons:!0,position:this.options.position,tool:"edit",actions:["finishMode"]},B={title:ot("buttonTitles.dragButton"),className:"control-icon leaflet-pm-icon-drag",onClick:function(){},afterClick:function(){r.map.pm.toggleGlobalDragMode()},doToggle:!0,toggleStatus:!1,disableOtherButtons:!0,position:this.options.position,tool:"edit",actions:["finishMode"]},N={title:ot("buttonTitles.cutButton"),className:"control-icon leaflet-pm-icon-cut",jsClass:"Cut",onClick:function(){},afterClick:function(V,tt){r.map.pm.Draw[tt.button._button.jsClass].toggle({snappable:!0,cursorMarker:!0,allowSelfIntersection:!1})},doToggle:!0,toggleStatus:!1,disableOtherButtons:!0,position:this.options.position,tool:"edit",actions:["finish","removeLastVertex","cancel"]},H={title:ot("buttonTitles.deleteButton"),className:"control-icon leaflet-pm-icon-delete",onClick:function(){},afterClick:function(){r.map.pm.toggleGlobalRemovalMode()},doToggle:!0,toggleStatus:!1,disableOtherButtons:!0,position:this.options.position,tool:"edit",actions:["finishMode"]},Y={title:ot("buttonTitles.rotateButton"),className:"control-icon leaflet-pm-icon-rotate",onClick:function(){},afterClick:function(){r.map.pm.toggleGlobalRotateMode()},doToggle:!0,toggleStatus:!1,disableOtherButtons:!0,position:this.options.position,tool:"edit",actions:["finishMode"]};this._addButton("drawMarker",new L.Control.PMButton(l)),this._addButton("drawPolyline",new L.Control.PMButton(p)),this._addButton("drawRectangle",new L.Control.PMButton(S)),this._addButton("drawPolygon",new L.Control.PMButton(u)),this._addButton("drawCircle",new L.Control.PMButton(g)),this._addButton("drawCircleMarker",new L.Control.PMButton(M)),this._addButton("editMode",new L.Control.PMButton(D)),this._addButton("dragMode",new L.Control.PMButton(B)),this._addButton("cutPolygon",new L.Control.PMButton(N)),this._addButton("removalMode",new L.Control.PMButton(H)),this._addButton("rotateMode",new L.Control.PMButton(Y))},_showHideButtons:function(){if(this.isVisible){this.removeControls(),this.isVisible=!0;var r=this.getButtons(),l=[];for(var u in this.options.drawControls===!1&&(l=l.concat(Object.keys(r).filter(function(g){return!r[g]._button.tool}))),this.options.editControls===!1&&(l=l.concat(Object.keys(r).filter(function(g){return r[g]._button.tool==="edit"}))),this.options.optionsControls===!1&&(l=l.concat(Object.keys(r).filter(function(g){return r[g]._button.tool==="options"}))),this.options.customControls===!1&&(l=l.concat(Object.keys(r).filter(function(g){return r[g]._button.tool==="custom"}))),r)if(this.options[u]&&l.indexOf(u)===-1){var p=r[u]._button.tool;p||(p="draw"),r[u].setPosition(this._getBtnPosition(p)),r[u].addTo(this.map)}}},_getBtnPosition:function(r){return this.options.positions&&this.options.positions[r]?this.options.positions[r]:this.options.position},setBlockPosition:function(r,l){this.options.positions[r]=l,this._showHideButtons(),this.changeControlOrder()},getBlockPositions:function(){return this.options.positions},copyDrawControl:function(r,l){if(!l)throw new TypeError("Button has no name");T(l)!=="object"&&(l={name:l});var u=this._btnNameMapping(r);if(!l.name)throw new TypeError("Button has no name");if(this.buttons[l.name])throw new TypeError("Button with this name already exists");var p=this.map.pm.Draw.createNewDrawInstance(l.name,u);return l=$($({},this.buttons[u]._button),l),{drawInstance:p,control:this.createCustomControl(l)}},createCustomControl:function(r){if(!r.name)throw new TypeError("Button has no name");if(this.buttons[r.name])throw new TypeError("Button with this name already exists");r.onClick||(r.onClick=function(){}),r.afterClick||(r.afterClick=function(){}),r.toggle!==!1&&(r.toggle=!0),r.block&&(r.block=r.block.toLowerCase()),r.block&&r.block!=="draw"||(r.block=""),r.className?r.className.indexOf("control-icon")===-1&&(r.className="control-icon ".concat(r.className)):r.className="control-icon";var l={tool:r.block,className:r.className,title:r.title||"",jsClass:r.name,onClick:r.onClick,afterClick:r.afterClick,doToggle:r.toggle,toggleStatus:!1,disableOtherButtons:!0,cssToggle:r.toggle,position:this.options.position,actions:r.actions||[],disabled:!!r.disabled};this.options[r.name]!==!1&&(this.options[r.name]=!0);var u=this._addButton(r.name,new L.Control.PMButton(l));return this.changeControlOrder(),u},changeControlOrder:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],l=this._shapeMapping(),u=[];r.forEach(function(N){l[N]?u.push(l[N]):u.push(N)});var p=this.getButtons(),g={};u.forEach(function(N){p[N]&&(g[N]=p[N])});var M=Object.keys(p).filter(function(N){return!p[N]._button.tool});M.forEach(function(N){u.indexOf(N)===-1&&(g[N]=p[N])});var S=Object.keys(p).filter(function(N){return p[N]._button.tool==="edit"});S.forEach(function(N){u.indexOf(N)===-1&&(g[N]=p[N])});var D=Object.keys(p).filter(function(N){return p[N]._button.tool==="options"});D.forEach(function(N){u.indexOf(N)===-1&&(g[N]=p[N])});var B=Object.keys(p).filter(function(N){return p[N]._button.tool==="custom"});B.forEach(function(N){u.indexOf(N)===-1&&(g[N]=p[N])}),Object.keys(p).forEach(function(N){u.indexOf(N)===-1&&(g[N]=p[N])}),this.map.pm.Toolbar.buttons=g,this._showHideButtons()},getControlOrder:function(){var r=this.getButtons(),l=[];for(var u in r)l.push(u);return l},changeActionsOfControl:function(r,l){var u=this._btnNameMapping(r);if(!u)throw new TypeError("No name passed");if(!l)throw new TypeError("No actions passed");if(!this.buttons[u])throw new TypeError("Button with this name not exists");this.buttons[u]._button.actions=l,this.changeControlOrder()},setButtonDisabled:function(r,l){var u=this._btnNameMapping(r);this.buttons[u]._button.disabled=!!l,this._showHideButtons()},_shapeMapping:function(){return{Marker:"drawMarker",Circle:"drawCircle",Polygon:"drawPolygon",Rectangle:"drawRectangle",Polyline:"drawPolyline",Line:"drawPolyline",CircleMarker:"drawCircleMarker",Edit:"editMode",Drag:"dragMode",Cut:"cutPolygon",Removal:"removalMode",Rotate:"rotateMode"}},_btnNameMapping:function(r){var l=this._shapeMapping();return l[r]?l[r]:r}});function U(r,l){var u=Object.keys(r);if(Object.getOwnPropertySymbols){var p=Object.getOwnPropertySymbols(r);l&&(p=p.filter(function(g){return Object.getOwnPropertyDescriptor(r,g).enumerable})),u.push.apply(u,p)}return u}function Z(r){for(var l=1;l<arguments.length;l++){var u=arguments[l]!=null?arguments[l]:{};l%2?U(Object(u),!0).forEach(function(p){it(r,p,u[p])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(u)):U(Object(u)).forEach(function(p){Object.defineProperty(r,p,Object.getOwnPropertyDescriptor(u,p))})}return r}function it(r,l,u){return l in r?Object.defineProperty(r,l,{value:u,enumerable:!0,configurable:!0,writable:!0}):r[l]=u,r}var st={_initSnappableMarkers:function(){this.options.snapDistance=this.options.snapDistance||30,this.options.snapSegment=this.options.snapSegment===void 0||this.options.snapSegment,this._assignEvents(this._markers),this._layer.off("pm:dragstart",this._unsnap,this),this._layer.on("pm:dragstart",this._unsnap,this)},_disableSnapping:function(){this._layer.off("pm:dragstart",this._unsnap,this)},_assignEvents:function(r){var l=this;r.forEach(function(u){Array.isArray(u)?l._assignEvents(u):(u.off("drag",l._handleSnapping,l),u.on("drag",l._handleSnapping,l),u.off("dragend",l._cleanupSnapping,l),u.on("dragend",l._cleanupSnapping,l))})},_cleanupSnapping:function(){delete this._snapList,this.throttledList&&(this._map.off("layeradd",this.throttledList,this),this.throttledList=void 0),this._map.off("pm:remove",this._handleSnapLayerRemoval,this),this.debugIndicatorLines&&this.debugIndicatorLines.forEach(function(r){r.remove()})},_handleThrottleSnapping:function(){this.throttledList&&this._createSnapList()},_handleSnapping:function(r){var l=this,u=r.target;if(u._snapped=!1,this.throttledList||(this.throttledList=L.Util.throttle(this._handleThrottleSnapping,100,this)),this._map.pm.Keyboard.isAltKeyPressed()||(this._snapList===void 0&&(this._createSnapList(),this._map.off("layeradd",this.throttledList,this),this._map.on("layeradd",this.throttledList,this)),this._snapList.length<=0))return!1;var p=this._calcClosestLayer(u.getLatLng(),this._snapList);if(Object.keys(p).length===0)return!1;var g,M=p.layer instanceof L.Marker||p.layer instanceof L.CircleMarker||!this.options.snapSegment;g=M?p.latlng:this._checkPrioritiySnapping(p);var S=this.options.snapDistance,D={marker:u,shape:this._shape,snapLatLng:g,segment:p.segment,layer:this._layer,workingLayer:this._layer,layerInteractedWith:p.layer,distance:p.distance};if(this._fireSnapDrag(D.marker,D),this._fireSnapDrag(this._layer,D),p.distance<S){u._orgLatLng=u.getLatLng(),u.setLatLng(g),u._snapped=!0,u._snapInfo=D;var B=this._snapLatLng||{},N=g||{};B.lat===N.lat&&B.lng===N.lng||(l._snapLatLng=g,l._fireSnap(u,D),l._fireSnap(l._layer,D))}else this._snapLatLng&&(this._unsnap(D),u._snapped=!1,this._fireUnsnap(D.marker,D),this._fireUnsnap(this._layer,D));return!0},_createSnapList:function(){var r=this,l=[],u=[],p=this._map;p.off("pm:remove",this._handleSnapLayerRemoval,this),p.on("pm:remove",this._handleSnapLayerRemoval,this),p.eachLayer(function(g){if((g instanceof L.Polyline||g instanceof L.Marker||g instanceof L.CircleMarker||g instanceof L.ImageOverlay)&&g.options.snapIgnore!==!0){if(g.options.snapIgnore===void 0&&(!L.PM.optIn&&g.options.pmIgnore===!0||L.PM.optIn&&g.options.pmIgnore!==!1))return;(g instanceof L.Circle||g instanceof L.CircleMarker)&&g.pm&&g.pm._hiddenPolyCircle?l.push(g.pm._hiddenPolyCircle):g instanceof L.ImageOverlay&&(g=L.rectangle(g.getBounds())),l.push(g);var M=L.polyline([],{color:"red",pmIgnore:!0});M._pmTempLayer=!0,u.push(M),(g instanceof L.Circle||g instanceof L.CircleMarker)&&u.push(M)}}),l=(l=(l=l.filter(function(g){return r._layer!==g})).filter(function(g){return g._latlng||g._latlngs&&!It(g._latlngs)})).filter(function(g){return!g._pmTempLayer}),this._otherSnapLayers?(this._otherSnapLayers.forEach(function(){var g=L.polyline([],{color:"red",pmIgnore:!0});g._pmTempLayer=!0,u.push(g)}),this._snapList=l.concat(this._otherSnapLayers)):this._snapList=l,this.debugIndicatorLines=u},_handleSnapLayerRemoval:function(r){var l=r.layer,u=this._snapList.findIndex(function(p){return p._leaflet_id===l._leaflet_id});this._snapList.splice(u,1)},_calcClosestLayer:function(r,l){var u=this,p=[],g={};return l.forEach(function(M,S){if(!M._parentCopy||M._parentCopy!==u._layer){var D=u._calcLayerDistances(r,M);u.debugIndicatorLines[S]&&u.debugIndicatorLines[S].setLatLngs([r,D.latlng]),(g.distance===void 0||D.distance<=g.distance)&&(D.distance<g.distance&&(p=[]),(g=D).layer=M,p.push(g))}}),this._getClosestLayerByPriority(p)},_calcLayerDistances:function(r,l){var u,p,g,M=this,S=this._map,D=l instanceof L.Marker||l instanceof L.CircleMarker,B=l instanceof L.Polygon,N=r,H=D?l.getLatLng():l.getLatLngs();return D?{latlng:Z({},H),distance:this._getDistance(S,H,N)}:(function Y(V){V.forEach(function(tt,ut){if(Array.isArray(tt))Y(tt);else if(M.options.snapSegment){var ct,yt=tt;ct=B?ut+1===V.length?0:ut+1:ut+1===V.length?void 0:ut+1;var mt=V[ct];if(mt){var xt=M._getDistanceToSegment(S,N,yt,mt);(p===void 0||xt<p)&&(p=xt,g=[yt,mt])}}else{var Lt=M._getDistance(S,N,tt);(p===void 0||Lt<p)&&(p=Lt,u=tt)}})}(H),this.options.snapSegment?{latlng:Z({},this._getClosestPointOnSegment(S,r,g[0],g[1])),segment:g,distance:p}:{latlng:u,distance:p})},_getClosestLayerByPriority:function(r){r=r.sort(function(g,M){return g._leaflet_id-M._leaflet_id});var l=this._map.pm.globalOptions.snappingOrder||[],u=0,p={};return l.concat(["Marker","CircleMarker","Circle","Line","Polygon","Rectangle"]).forEach(function(g){p[g]||(u+=1,p[g]=u)}),r.sort(function(g,M){var S=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"asc";if(!M||Object.keys(M).length===0)return function(V,tt){return V-tt};for(var D,B=Object.keys(M),N=B.length,H={};N--;)D=B[N],H[D.toLowerCase()]=M[D];function Y(V){return V instanceof L.Marker?"Marker":V instanceof L.Circle?"Circle":V instanceof L.CircleMarker?"CircleMarker":V instanceof L.Rectangle?"Rectangle":V instanceof L.Polygon?"Polygon":V instanceof L.Polyline?"Line":void 0}return function(V,tt){var ut,ct;if(g==="instanceofShape"){if(ut=Y(V.layer).toLowerCase(),ct=Y(tt.layer).toLowerCase(),!ut||!ct)return 0}else{if(!V.hasOwnProperty(g)||!tt.hasOwnProperty(g))return 0;ut=V[g].toLowerCase(),ct=tt[g].toLowerCase()}var yt=ut in H?H[ut]:Number.MAX_SAFE_INTEGER,mt=ct in H?H[ct]:Number.MAX_SAFE_INTEGER,xt=0;return yt<mt?xt=-1:yt>mt&&(xt=1),S==="desc"?-1*xt:xt}}("instanceofShape",p)),r[0]||{}},_checkPrioritiySnapping:function(r){var l=this._map,u=r.segment[0],p=r.segment[1],g=r.latlng,M=this._getDistance(l,u,g),S=this._getDistance(l,p,g),D=M<S?u:p,B=M<S?M:S;if(this.options.snapMiddle){var N=L.PM.Utils.calcMiddleLatLng(l,u,p),H=this._getDistance(l,N,g);H<M&&H<S&&(D=N,B=H)}return Z({},B<this.options.snapDistance?D:g)},_unsnap:function(){delete this._snapLatLng},_getClosestPointOnSegment:function(r,l,u,p){var g=r.getMaxZoom();g===1/0&&(g=r.getZoom());var M=r.project(l,g),S=r.project(u,g),D=r.project(p,g),B=L.LineUtil.closestPointOnSegment(M,S,D);return r.unproject(B,g)},_getDistanceToSegment:function(r,l,u,p){var g=r.latLngToLayerPoint(l),M=r.latLngToLayerPoint(u),S=r.latLngToLayerPoint(p);return L.LineUtil.pointToSegmentDistance(g,M,S)},_getDistance:function(r,l,u){return r.latLngToLayerPoint(l).distanceTo(r.latLngToLayerPoint(u))}},nt=L.Class.extend({includes:[st,gt],options:{snappable:!0,snapDistance:20,snapMiddle:!1,allowSelfIntersection:!0,tooltips:!0,templineStyle:{},hintlineStyle:{color:"#3388ff",dashArray:"5,5"},pathOptions:null,cursorMarker:!0,finishOn:null,markerStyle:{draggable:!0,icon:L.icon()},hideMiddleMarkers:!1,minRadiusCircle:null,maxRadiusCircle:null,minRadiusCircleMarker:null,maxRadiusCircleMarker:null,editable:!1,markerEditable:!0,continueDrawing:!1,snapSegment:!0,requireSnapToFinish:!1},setOptions:function(r){L.Util.setOptions(this,r)},getOptions:function(){return this.options},initialize:function(r){var l=this,u=new L.Icon.Default;u.options.tooltipAnchor=[0,0],this.options.markerStyle.icon=u,this._map=r,this.shapes=["Marker","CircleMarker","Line","Polygon","Rectangle","Circle","Cut"],this.shapes.forEach(function(p){l[p]=new L.PM.Draw[p](l._map)}),this.Marker.setOptions({continueDrawing:!0}),this.CircleMarker.setOptions({continueDrawing:!0})},setPathOptions:function(r){var l=arguments.length>1&&arguments[1]!==void 0&&arguments[1];this.options.pathOptions=l?h()(this.options.pathOptions,r):r},getShapes:function(){return this.shapes},getShape:function(){return this._shape},enable:function(r,l){if(!r)throw new Error("Error: Please pass a shape as a parameter. Possible shapes are: ".concat(this.getShapes().join(",")));this.disable(),this[r].enable(l)},disable:function(){var r=this;this.shapes.forEach(function(l){r[l].disable()})},addControls:function(){var r=this;this.shapes.forEach(function(l){r[l].addButton()})},getActiveShape:function(){var r,l=this;return this.shapes.forEach(function(u){l[u]._enabled&&(r=u)}),r},_setGlobalDrawMode:function(){this._shape==="Cut"?this._fireGlobalCutModeToggled():this._fireGlobalDrawModeToggled();var r=L.PM.Utils.findLayers(this._map);this._enabled?r.forEach(function(l){L.PM.Utils.disablePopup(l)}):r.forEach(function(l){L.PM.Utils.enablePopup(l)})},createNewDrawInstance:function(r,l){var u=this._getShapeFromBtnName(l);if(this[r])throw new TypeError("Draw Type already exists");if(!L.PM.Draw[u])throw new TypeError("There is no class L.PM.Draw.".concat(u));return this[r]=new L.PM.Draw[u](this._map),this[r].toolbarButtonName=r,this[r]._shape=r,this.shapes.push(r),this[l]&&this[r].setOptions(this[l].options),this[r].setOptions(this[r].options),this[r]},_getShapeFromBtnName:function(r){var l={drawMarker:"Marker",drawCircle:"Circle",drawPolygon:"Polygon",drawPolyline:"Line",drawRectangle:"Rectangle",drawCircleMarker:"CircleMarker",editMode:"Edit",dragMode:"Drag",cutPolygon:"Cut",removalMode:"Removal",rotateMode:"Rotate"};return l[r]?l[r]:this[r]?this[r]._shape:r},_finishLayer:function(r){r.pm&&(r.pm.setOptions(this.options),r.pm._shape=this._shape,r.pm._map=this._map),this._addDrawnLayerProp(r)},_addDrawnLayerProp:function(r){r._drawnByGeoman=!0},_setPane:function(r,l){l==="layerPane"?r.options.pane=this._map.pm.globalOptions.panes&&this._map.pm.globalOptions.panes.layerPane||"overlayPane":l==="vertexPane"?r.options.pane=this._map.pm.globalOptions.panes&&this._map.pm.globalOptions.panes.vertexPane||"markerPane":l==="markerPane"&&(r.options.pane=this._map.pm.globalOptions.panes&&this._map.pm.globalOptions.panes.markerPane||"markerPane")},_isFirstLayer:function(){return(this._map||this._layer._map).pm.getGeomanLayers().length===0}});nt.Marker=nt.extend({initialize:function(r){this._map=r,this._shape="Marker",this.toolbarButtonName="drawMarker"},enable:function(r){var l=this;L.Util.setOptions(this,r),this._enabled=!0,this._map.on("click",this._createMarker,this),this._map.pm.Toolbar.toggleButton(this.toolbarButtonName,!0),this._hintMarker=L.marker([0,0],this.options.markerStyle),this._setPane(this._hintMarker,"markerPane"),this._hintMarker._pmTempLayer=!0,this._hintMarker.addTo(this._map),this.options.tooltips&&this._hintMarker.bindTooltip(ot("tooltips.placeMarker"),{permanent:!0,offset:L.point(0,10),direction:"bottom",opacity:.8}).openTooltip(),this._layer=this._hintMarker,this._map.on("mousemove",this._syncHintMarker,this),this.options.markerEditable&&this._map.eachLayer(function(u){l.isRelevantMarker(u)&&u.pm.enable()}),this._fireDrawStart(),this._setGlobalDrawMode()},disable:function(){var r=this;this._enabled&&(this._enabled=!1,this._map.off("click",this._createMarker,this),this._hintMarker.remove(),this._map.off("mousemove",this._syncHintMarker,this),this._map.eachLayer(function(l){r.isRelevantMarker(l)&&l.pm.disable()}),this._map.pm.Toolbar.toggleButton(this.toolbarButtonName,!1),this.options.snappable&&this._cleanupSnapping(),this._fireDrawEnd(),this._setGlobalDrawMode())},enabled:function(){return this._enabled},toggle:function(r){this.enabled()?this.disable():this.enable(r)},isRelevantMarker:function(r){return r instanceof L.Marker&&r.pm&&!r._pmTempLayer},_syncHintMarker:function(r){if(this._hintMarker.setLatLng(r.latlng),this.options.snappable){var l=r;l.target=this._hintMarker,this._handleSnapping(l)}},_createMarker:function(r){if(r.latlng&&(!this.options.requireSnapToFinish||this._hintMarker._snapped||this._isFirstLayer())){this._hintMarker._snapped||this._hintMarker.setLatLng(r.latlng);var l=this._hintMarker.getLatLng(),u=new L.Marker(l,this.options.markerStyle);this._setPane(u,"markerPane"),this._finishLayer(u),u.pm||(u.options.draggable=!1),u.addTo(this._map.pm._getContainingLayer()),u.pm&&this.options.markerEditable?u.pm.enable():u.dragging&&u.dragging.disable(),this._fireCreate(u),this._cleanupSnapping(),this.options.continueDrawing||this.disable()}}});var bt=t(8),Mt=t.n(bt);function St(r,l){var u=Object.keys(r);if(Object.getOwnPropertySymbols){var p=Object.getOwnPropertySymbols(r);l&&(p=p.filter(function(g){return Object.getOwnPropertyDescriptor(r,g).enumerable})),u.push.apply(u,p)}return u}function Pt(r){for(var l=1;l<arguments.length;l++){var u=arguments[l]!=null?arguments[l]:{};l%2?St(Object(u),!0).forEach(function(p){Jt(r,p,u[p])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(u)):St(Object(u)).forEach(function(p){Object.defineProperty(r,p,Object.getOwnPropertyDescriptor(u,p))})}return r}function Jt(r,l,u){return l in r?Object.defineProperty(r,l,{value:u,enumerable:!0,configurable:!0,writable:!0}):r[l]=u,r}function Et(r,l){var u=Object.keys(r);if(Object.getOwnPropertySymbols){var p=Object.getOwnPropertySymbols(r);l&&(p=p.filter(function(g){return Object.getOwnPropertyDescriptor(r,g).enumerable})),u.push.apply(u,p)}return u}function Dt(r){for(var l=1;l<arguments.length;l++){var u=arguments[l]!=null?arguments[l]:{};l%2?Et(Object(u),!0).forEach(function(p){Vt(r,p,u[p])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(u)):Et(Object(u)).forEach(function(p){Object.defineProperty(r,p,Object.getOwnPropertyDescriptor(u,p))})}return r}function Vt(r,l,u){return l in r?Object.defineProperty(r,l,{value:u,enumerable:!0,configurable:!0,writable:!0}):r[l]=u,r}nt.Line=nt.extend({initialize:function(r){this._map=r,this._shape="Line",this.toolbarButtonName="drawPolyline",this._doesSelfIntersect=!1},enable:function(r){L.Util.setOptions(this,r),this._enabled=!0,this._layerGroup=new L.LayerGroup,this._layerGroup._pmTempLayer=!0,this._layerGroup.addTo(this._map),this._layer=L.polyline([],this.options.templineStyle),this._setPane(this._layer,"layerPane"),this._layer._pmTempLayer=!0,this._layerGroup.addLayer(this._layer),this._hintline=L.polyline([],this.options.hintlineStyle),this._setPane(this._hintline,"layerPane"),this._hintline._pmTempLayer=!0,this._layerGroup.addLayer(this._hintline),this._hintMarker=L.marker(this._map.getCenter(),{interactive:!1,zIndexOffset:100,icon:L.divIcon({className:"marker-icon cursor-marker"})}),this._setPane(this._hintMarker,"vertexPane"),this._hintMarker._pmTempLayer=!0,this._layerGroup.addLayer(this._hintMarker),this.options.cursorMarker&&L.DomUtil.addClass(this._hintMarker._icon,"visible"),this.options.tooltips&&this._hintMarker.bindTooltip(ot("tooltips.firstVertex"),{permanent:!0,offset:L.point(0,10),direction:"bottom",opacity:.8}).openTooltip(),this._map._container.style.cursor="crosshair",this._map.on("click",this._createVertex,this),this.options.finishOn&&this.options.finishOn!=="snap"&&this._map.on(this.options.finishOn,this._finishShape,this),this.options.finishOn==="dblclick"&&(this.tempMapDoubleClickZoomState=this._map.doubleClickZoom._enabled,this.tempMapDoubleClickZoomState&&this._map.doubleClickZoom.disable()),this._map.on("mousemove",this._syncHintMarker,this),this._hintMarker.on("move",this._syncHintLine,this),this._map.pm.Toolbar.toggleButton(this.toolbarButtonName,!0),this._otherSnapLayers=[],this._fireDrawStart(),this._setGlobalDrawMode()},disable:function(){this._enabled&&(this._enabled=!1,this._map._container.style.cursor="",this._map.off("click",this._createVertex,this),this._map.off("mousemove",this._syncHintMarker,this),this.options.finishOn&&this.options.finishOn!=="snap"&&this._map.off(this.options.finishOn,this._finishShape,this),this.tempMapDoubleClickZoomState&&this._map.doubleClickZoom.enable(),this._map.removeLayer(this._layerGroup),this._map.pm.Toolbar.toggleButton(this.toolbarButtonName,!1),this.options.snappable&&this._cleanupSnapping(),this._fireDrawEnd(),this._setGlobalDrawMode())},enabled:function(){return this._enabled},toggle:function(r){this.enabled()?this.disable():this.enable(r)},_syncHintLine:function(){var r=this._layer.getLatLngs();if(r.length>0){var l=r[r.length-1];this._hintline.setLatLngs([l,this._hintMarker.getLatLng()])}},_syncHintMarker:function(r){if(this._hintMarker.setLatLng(r.latlng),this.options.snappable){var l=r;l.target=this._hintMarker,this._handleSnapping(l)}this.options.allowSelfIntersection||this._handleSelfIntersection(!0,r.latlng)},hasSelfIntersection:function(){return Mt()(this._layer.toGeoJSON(15)).features.length>0},_handleSelfIntersection:function(r,l){var u=L.polyline(this._layer.getLatLngs());r&&(l||(l=this._hintMarker.getLatLng()),u.addLatLng(l));var p=Mt()(u.toGeoJSON(15));this._doesSelfIntersect=p.features.length>0,this._doesSelfIntersect?this._hintline.setStyle({color:"#f00000ff"}):this._hintline.isEmpty()||this._hintline.setStyle(this.options.hintlineStyle)},_createVertex:function(r){if(this.options.allowSelfIntersection||(this._handleSelfIntersection(!0,r.latlng),!this._doesSelfIntersect)){this._hintMarker._snapped||this._hintMarker.setLatLng(r.latlng);var l=this._hintMarker.getLatLng();if(l.equals(this._layer.getLatLngs()[0]))this._finishShape(r);else{this._layer._latlngInfo=this._layer._latlngInfo||[],this._layer._latlngInfo.push({latlng:l,snapInfo:this._hintMarker._snapInfo}),this._layer.addLatLng(l);var u=this._createMarker(l);this._setTooltipText(),this._hintline.setLatLngs([l,l]),this._fireVertexAdded(u,void 0,l,"Draw"),this.options.finishOn==="snap"&&this._hintMarker._snapped&&this._finishShape(r)}}},_removeLastVertex:function(){var r=this._layer.getLatLngs(),l=r.pop();if(r.length<1)this.disable();else{var u=this._layerGroup.getLayers().filter(function(p){return p instanceof L.Marker}).filter(function(p){return!L.DomUtil.hasClass(p._icon,"cursor-marker")}).find(function(p){return p.getLatLng()===l});this._layerGroup.removeLayer(u),this._layer.setLatLngs(r),this._syncHintLine(),this._setTooltipText()}},_finishShape:function(){if((this.options.allowSelfIntersection||(this._handleSelfIntersection(!1),!this._doesSelfIntersect))&&(!this.options.requireSnapToFinish||this._hintMarker._snapped||this._isFirstLayer())){var r=this._layer.getLatLngs();if(!(r.length<=1)){var l=L.polyline(r,this.options.pathOptions);this._setPane(l,"layerPane"),this._finishLayer(l),l.addTo(this._map.pm._getContainingLayer()),this._fireCreate(l),this.options.snappable&&this._cleanupSnapping(),this.disable(),this.options.continueDrawing&&this.enable()}}},_createMarker:function(r){var l=new L.Marker(r,{draggable:!1,icon:L.divIcon({className:"marker-icon"})});return this._setPane(l,"vertexPane"),l._pmTempLayer=!0,this._layerGroup.addLayer(l),l.on("click",this._finishShape,this),l},_setTooltipText:function(){var r="";r=ot(this._layer.getLatLngs().flat().length<=1?"tooltips.continueLine":"tooltips.finishLine"),this._hintMarker.setTooltipContent(r)}}),nt.Polygon=nt.Line.extend({initialize:function(r){this._map=r,this._shape="Polygon",this.toolbarButtonName="drawPolygon"},_createMarker:function(r){var l=new L.Marker(r,{draggable:!1,icon:L.divIcon({className:"marker-icon"})});return this._setPane(l,"vertexPane"),l._pmTempLayer=!0,this._layerGroup.addLayer(l),this._layer.getLatLngs().flat().length===1?(l.on("click",this._finishShape,this),this._tempSnapLayerIndex=this._otherSnapLayers.push(l)-1,this.options.snappable&&this._cleanupSnapping()):l.on("click",function(){return 1}),l},_setTooltipText:function(){var r="";r=ot(this._layer.getLatLngs().flat().length<=2?"tooltips.continueLine":"tooltips.finishPoly"),this._hintMarker.setTooltipContent(r)},_finishShape:function(r){if((this.options.allowSelfIntersection||(this._handleSelfIntersection(!0,this._layer.getLatLngs()[0]),!this._doesSelfIntersect))&&(!this.options.requireSnapToFinish||this._hintMarker._snapped||this._isFirstLayer())){var l=this._layer.getLatLngs();if(!(l.length<=2)){var u=L.polygon(l,this.options.pathOptions);this._setPane(u,"layerPane"),this._finishLayer(u),u.addTo(this._map.pm._getContainingLayer()),this._fireCreate(u),this._cleanupSnapping(),this._otherSnapLayers.splice(this._tempSnapLayerIndex,1),delete this._tempSnapLayerIndex,this.disable(),this.options.continueDrawing&&this.enable()}}}}),nt.Rectangle=nt.extend({initialize:function(r){this._map=r,this._shape="Rectangle",this.toolbarButtonName="drawRectangle"},enable:function(r){if(L.Util.setOptions(this,r),this._enabled=!0,this._layerGroup=new L.LayerGroup,this._layerGroup._pmTempLayer=!0,this._layerGroup.addTo(this._map),this._layer=L.rectangle([[0,0],[0,0]],this.options.pathOptions),this._setPane(this._layer,"layerPane"),this._layer._pmTempLayer=!0,this._startMarker=L.marker([0,0],{icon:L.divIcon({className:"marker-icon rect-start-marker"}),draggable:!1,zIndexOffset:-100,opacity:this.options.cursorMarker?1:0}),this._setPane(this._startMarker,"vertexPane"),this._startMarker._pmTempLayer=!0,this._layerGroup.addLayer(this._startMarker),this._hintMarker=L.marker([0,0],{zIndexOffset:150,icon:L.divIcon({className:"marker-icon cursor-marker"})}),this._setPane(this._hintMarker,"vertexPane"),this._hintMarker._pmTempLayer=!0,this._layerGroup.addLayer(this._hintMarker),this.options.tooltips&&this._hintMarker.bindTooltip(ot("tooltips.firstVertex"),{permanent:!0,offset:L.point(0,10),direction:"bottom",opacity:.8}).openTooltip(),this.options.cursorMarker){L.DomUtil.addClass(this._hintMarker._icon,"visible"),this._styleMarkers=[];for(var l=0;l<2;l+=1){var u=L.marker([0,0],{icon:L.divIcon({className:"marker-icon rect-style-marker"}),draggable:!1,zIndexOffset:100});this._setPane(u,"vertexPane"),u._pmTempLayer=!0,this._layerGroup.addLayer(u),this._styleMarkers.push(u)}}this._map._container.style.cursor="crosshair",this._map.on("click",this._placeStartingMarkers,this),this._map.on("mousemove",this._syncHintMarker,this),this._map.pm.Toolbar.toggleButton(this.toolbarButtonName,!0),this._otherSnapLayers=[],this._fireDrawStart(),this._setGlobalDrawMode()},disable:function(){this._enabled&&(this._enabled=!1,this._map._container.style.cursor="",this._map.off("click",this._finishShape,this),this._map.off("click",this._placeStartingMarkers,this),this._map.off("mousemove",this._syncHintMarker,this),this._map.removeLayer(this._layerGroup),this._map.pm.Toolbar.toggleButton(this.toolbarButtonName,!1),this.options.snappable&&this._cleanupSnapping(),this._fireDrawEnd(),this._setGlobalDrawMode())},enabled:function(){return this._enabled},toggle:function(r){this.enabled()?this.disable():this.enable(r)},_placeStartingMarkers:function(r){this._hintMarker._snapped||this._hintMarker.setLatLng(r.latlng);var l=this._hintMarker.getLatLng();L.DomUtil.addClass(this._startMarker._icon,"visible"),this._startMarker.setLatLng(l),this.options.cursorMarker&&this._styleMarkers&&this._styleMarkers.forEach(function(u){L.DomUtil.addClass(u._icon,"visible"),u.setLatLng(l)}),this._map.off("click",this._placeStartingMarkers,this),this._map.on("click",this._finishShape,this),this._hintMarker.setTooltipContent(ot("tooltips.finishRect")),this._setRectangleOrigin()},_setRectangleOrigin:function(){var r=this._startMarker.getLatLng();r&&(this._layerGroup.addLayer(this._layer),this._layer.setLatLngs([r,r]),this._hintMarker.on("move",this._syncRectangleSize,this))},_syncHintMarker:function(r){if(this._hintMarker.setLatLng(r.latlng),this.options.snappable){var l=r;l.target=this._hintMarker,this._handleSnapping(l)}},_syncRectangleSize:function(){var r=this,l=Bt(this._startMarker.getLatLng(),this._map),u=Bt(this._hintMarker.getLatLng(),this._map),p=L.PM.Utils._getRotatedRectangle(l,u,this.options.rectangleAngle||0,this._map);if(this._layer.setLatLngs(p),this.options.cursorMarker&&this._styleMarkers){var g=[];p.forEach(function(M){M.equals(l,1e-8)||M.equals(u,1e-8)||g.push(M)}),g.forEach(function(M,S){try{r._styleMarkers[S].setLatLng(M)}catch{}})}},_findCorners:function(){var r=this._layer.getBounds();return[r.getNorthWest(),r.getNorthEast(),r.getSouthEast(),r.getSouthWest()]},_finishShape:function(r){this._hintMarker._snapped||this._hintMarker.setLatLng(r.latlng);var l=this._hintMarker.getLatLng(),u=this._startMarker.getLatLng();if(!this.options.requireSnapToFinish||this._hintMarker._snapped||this._isFirstLayer()){var p=L.rectangle([u,l],this.options.pathOptions);if(this.options.rectangleAngle){var g=L.PM.Utils._getRotatedRectangle(u,l,this.options.rectangleAngle||0,this._map);p.setLatLngs(g),p.pm&&p.pm._setAngle(this.options.rectangleAngle||0)}this._setPane(p,"layerPane"),this._finishLayer(p),p.addTo(this._map.pm._getContainingLayer()),this._fireCreate(p),this.disable(),this.options.continueDrawing&&this.enable()}}}),nt.Circle=nt.extend({initialize:function(r){this._map=r,this._shape="Circle",this.toolbarButtonName="drawCircle"},enable:function(r){L.Util.setOptions(this,r),this.options.radius=0,this._enabled=!0,this._layerGroup=new L.LayerGroup,this._layerGroup._pmTempLayer=!0,this._layerGroup.addTo(this._map),this._layer=L.circle([0,0],Pt(Pt({},this.options.templineStyle),{},{radius:0})),this._setPane(this._layer,"layerPane"),this._layer._pmTempLayer=!0,this._centerMarker=L.marker([0,0],{icon:L.divIcon({className:"marker-icon"}),draggable:!1,zIndexOffset:100}),this._setPane(this._centerMarker,"vertexPane"),this._centerMarker._pmTempLayer=!0,this._hintMarker=L.marker([0,0],{zIndexOffset:110,icon:L.divIcon({className:"marker-icon cursor-marker"})}),this._setPane(this._hintMarker,"vertexPane"),this._hintMarker._pmTempLayer=!0,this._layerGroup.addLayer(this._hintMarker),this.options.cursorMarker&&L.DomUtil.addClass(this._hintMarker._icon,"visible"),this.options.tooltips&&this._hintMarker.bindTooltip(ot("tooltips.startCircle"),{permanent:!0,offset:L.point(0,10),direction:"bottom",opacity:.8}).openTooltip(),this._hintline=L.polyline([],this.options.hintlineStyle),this._setPane(this._hintline,"layerPane"),this._hintline._pmTempLayer=!0,this._layerGroup.addLayer(this._hintline),this._map._container.style.cursor="crosshair",this._map.on("click",this._placeCenterMarker,this),this._map.on("mousemove",this._syncHintMarker,this),this._map.pm.Toolbar.toggleButton(this.toolbarButtonName,!0),this._otherSnapLayers=[],this._fireDrawStart(),this._setGlobalDrawMode()},disable:function(){this._enabled&&(this._enabled=!1,this._map._container.style.cursor="",this._map.off("click",this._finishShape,this),this._map.off("click",this._placeCenterMarker,this),this._map.off("mousemove",this._syncHintMarker,this),this._map.removeLayer(this._layerGroup),this._map.pm.Toolbar.toggleButton(this.toolbarButtonName,!1),this.options.snappable&&this._cleanupSnapping(),this._fireDrawEnd(),this._setGlobalDrawMode())},enabled:function(){return this._enabled},toggle:function(r){this.enabled()?this.disable():this.enable(r)},_syncHintLine:function(){var r=this._centerMarker.getLatLng(),l=this._getNewDestinationOfHintMarker();this._hintline.setLatLngs([r,l])},_syncCircleRadius:function(){var r,l=this._centerMarker.getLatLng(),u=this._hintMarker.getLatLng();r=this._map.options.crs===L.CRS.Simple?this._map.distance(l,u):l.distanceTo(u),this.options.minRadiusCircle&&r<this.options.minRadiusCircle?this._layer.setRadius(this.options.minRadiusCircle):this.options.maxRadiusCircle&&r>this.options.maxRadiusCircle?this._layer.setRadius(this.options.maxRadiusCircle):this._layer.setRadius(r)},_syncHintMarker:function(r){if(this._hintMarker.setLatLng(r.latlng),this._hintMarker.setLatLng(this._getNewDestinationOfHintMarker()),this.options.snappable){var l=r;l.target=this._hintMarker,this._handleSnapping(l)}this._handleHintMarkerSnapping()},_placeCenterMarker:function(r){this._layerGroup.addLayer(this._layer),this._layerGroup.addLayer(this._centerMarker),this._hintMarker._snapped||this._hintMarker.setLatLng(r.latlng);var l=this._hintMarker.getLatLng();this._layerGroup.addLayer(this._layer),this._centerMarker.setLatLng(l),this._map.off("click",this._placeCenterMarker,this),this._map.on("click",this._finishShape,this),this._placeCircleCenter()},_placeCircleCenter:function(){var r=this._centerMarker.getLatLng();r&&(this._layer.setLatLng(r),this._hintMarker.on("move",this._syncHintLine,this),this._hintMarker.on("move",this._syncCircleRadius,this),this._hintMarker.setTooltipContent(ot("tooltips.finishCircle")),this._fireCenterPlaced())},_finishShape:function(r){if(!this.options.requireSnapToFinish||this._hintMarker._snapped||this._isFirstLayer()){this._hintMarker._snapped||this._hintMarker.setLatLng(r.latlng);var l,u=this._centerMarker.getLatLng(),p=this._hintMarker.getLatLng();l=this._map.options.crs===L.CRS.Simple?this._map.distance(u,p):u.distanceTo(p),this.options.minRadiusCircle&&l<this.options.minRadiusCircle?l=this.options.minRadiusCircle:this.options.maxRadiusCircle&&l>this.options.maxRadiusCircle&&(l=this.options.maxRadiusCircle);var g=Pt(Pt({},this.options.pathOptions),{},{radius:l}),M=L.circle(u,g);this._setPane(M,"layerPane"),this._finishLayer(M),M.addTo(this._map.pm._getContainingLayer()),M.pm&&M.pm._updateHiddenPolyCircle(),this._fireCreate(M),this.disable(),this.options.continueDrawing&&this.enable()}},_getNewDestinationOfHintMarker:function(){var r=this._centerMarker.getLatLng(),l=this._hintMarker.getLatLng(),u=r.distanceTo(l);return r.equals(L.latLng([0,0]))||(this.options.minRadiusCircle&&u<this.options.minRadiusCircle?l=Kt(this._map,r,l,this.options.minRadiusCircle):this.options.maxRadiusCircle&&u>this.options.maxRadiusCircle&&(l=Kt(this._map,r,l,this.options.maxRadiusCircle))),l},_handleHintMarkerSnapping:function(){if(this._hintMarker._snapped){var r=this._centerMarker.getLatLng(),l=this._hintMarker.getLatLng(),u=r.distanceTo(l);(this.options.minRadiusCircle&&u<this.options.minRadiusCircle||this.options.maxRadiusCircle&&u>this.options.maxRadiusCircle)&&this._hintMarker.setLatLng(this._hintMarker._orgLatLng)}this._hintMarker.setLatLng(this._getNewDestinationOfHintMarker())}}),nt.CircleMarker=nt.Marker.extend({initialize:function(r){this._map=r,this._shape="CircleMarker",this.toolbarButtonName="drawCircleMarker",this._layerIsDragging=!1},enable:function(r){var l=this;L.Util.setOptions(this,r),this._enabled=!0,this._map.pm.Toolbar.toggleButton(this.toolbarButtonName,!0),this.options.editable?(this._layerGroup=new L.LayerGroup,this._layerGroup._pmTempLayer=!0,this._layerGroup.addTo(this._map),this._layer=L.circleMarker([0,0],this.options.templineStyle),this._setPane(this._layer,"layerPane"),this._layer._pmTempLayer=!0,this._centerMarker=L.marker([0,0],{icon:L.divIcon({className:"marker-icon"}),draggable:!1,zIndexOffset:100}),this._setPane(this._centerMarker,"vertexPane"),this._centerMarker._pmTempLayer=!0,this._hintMarker=L.marker([0,0],{zIndexOffset:110,icon:L.divIcon({className:"marker-icon cursor-marker"})}),this._setPane(this._hintMarker,"vertexPane"),this._hintMarker._pmTempLayer=!0,this._layerGroup.addLayer(this._hintMarker),this.options.cursorMarker&&L.DomUtil.addClass(this._hintMarker._icon,"visible"),this.options.tooltips&&this._hintMarker.bindTooltip(ot("tooltips.startCircle"),{permanent:!0,offset:L.point(0,10),direction:"bottom",opacity:.8}).openTooltip(),this._hintline=L.polyline([],this.options.hintlineStyle),this._setPane(this._hintline,"layerPane"),this._hintline._pmTempLayer=!0,this._layerGroup.addLayer(this._hintline),this._map.on("click",this._placeCenterMarker,this),this._map._container.style.cursor="crosshair"):(this._map.on("click",this._createMarker,this),this._hintMarker=L.circleMarker([0,0],this.options.templineStyle),this._setPane(this._hintMarker,"layerPane"),this._hintMarker._pmTempLayer=!0,this._hintMarker.addTo(this._map),this._layer=this._hintMarker,this.options.tooltips&&this._hintMarker.bindTooltip(ot("tooltips.placeCircleMarker"),{permanent:!0,offset:L.point(0,10),direction:"bottom",opacity:.8}).openTooltip()),this._map.on("mousemove",this._syncHintMarker,this),!this.options.editable&&this.options.markerEditable&&this._map.eachLayer(function(u){l.isRelevantMarker(u)&&u.pm.enable()}),this._layer.bringToBack(),this._fireDrawStart(),this._setGlobalDrawMode()},disable:function(){var r=this;this._enabled&&(this._enabled=!1,this.options.editable?(this._map._container.style.cursor="",this._map.off("click",this._finishShape,this),this._map.off("click",this._placeCenterMarker,this),this._map.removeLayer(this._layerGroup)):(this._map.off("click",this._createMarker,this),this._map.eachLayer(function(l){r.isRelevantMarker(l)&&l.pm.disable()}),this._hintMarker.remove()),this._map.off("mousemove",this._syncHintMarker,this),this._map.pm.Toolbar.toggleButton(this.toolbarButtonName,!1),this.options.snappable&&this._cleanupSnapping(),this._fireDrawEnd(),this._setGlobalDrawMode())},_placeCenterMarker:function(r){this._layerGroup.addLayer(this._layer),this._layerGroup.addLayer(this._centerMarker),this._hintMarker._snapped||this._hintMarker.setLatLng(r.latlng);var l=this._hintMarker.getLatLng();this._layerGroup.addLayer(this._layer),this._centerMarker.setLatLng(l),this._map.off("click",this._placeCenterMarker,this),this._map.on("click",this._finishShape,this),this._placeCircleCenter()},_placeCircleCenter:function(){var r=this._centerMarker.getLatLng();r&&(this._layer.setLatLng(r),this._hintMarker.on("move",this._syncHintLine,this),this._hintMarker.on("move",this._syncCircleRadius,this),this._hintMarker.setTooltipContent(ot("tooltips.finishCircle")),this._fireCenterPlaced())},_syncHintLine:function(){var r=this._centerMarker.getLatLng(),l=this._getNewDestinationOfHintMarker();this._hintline.setLatLngs([r,l])},_syncCircleRadius:function(){var r=this._centerMarker.getLatLng(),l=this._hintMarker.getLatLng(),u=this._map.project(r).distanceTo(this._map.project(l));this.options.minRadiusCircleMarker&&u<this.options.minRadiusCircleMarker?this._layer.setRadius(this.options.minRadiusCircleMarker):this.options.maxRadiusCircleMarker&&u>this.options.maxRadiusCircleMarker?this._layer.setRadius(this.options.maxRadiusCircleMarker):this._layer.setRadius(u)},_syncHintMarker:function(r){if(this._hintMarker.setLatLng(r.latlng),this._hintMarker.setLatLng(this._getNewDestinationOfHintMarker()),this.options.snappable){var l=r;l.target=this._hintMarker,this._handleSnapping(l)}this._handleHintMarkerSnapping()},isRelevantMarker:function(r){return r instanceof L.CircleMarker&&!(r instanceof L.Circle)&&r.pm&&!r._pmTempLayer},_createMarker:function(r){if((!this.options.requireSnapToFinish||this._hintMarker._snapped||this._isFirstLayer())&&r.latlng&&!this._layerIsDragging){this._hintMarker._snapped||this._hintMarker.setLatLng(r.latlng);var l=this._hintMarker.getLatLng(),u=L.circleMarker(l,this.options.pathOptions);this._setPane(u,"layerPane"),this._finishLayer(u),u.addTo(this._map.pm._getContainingLayer()),u.pm&&this.options.markerEditable&&u.pm.enable(),this._fireCreate(u),this._cleanupSnapping(),this.options.continueDrawing||this.disable()}},_finishShape:function(r){if(!this.options.requireSnapToFinish||this._hintMarker._snapped||this._isFirstLayer()){this._hintMarker._snapped||this._hintMarker.setLatLng(r.latlng);var l=this._centerMarker.getLatLng(),u=this._hintMarker.getLatLng(),p=this._map.project(l).distanceTo(this._map.project(u));this.options.editable&&(this.options.minRadiusCircleMarker&&p<this.options.minRadiusCircleMarker?p=this.options.minRadiusCircleMarker:this.options.maxRadiusCircleMarker&&p>this.options.maxRadiusCircleMarker&&(p=this.options.maxRadiusCircleMarker));var g=Dt(Dt({},this.options.pathOptions),{},{radius:p}),M=L.circleMarker(l,g);this._setPane(M,"layerPane"),this._finishLayer(M),M.addTo(this._map.pm._getContainingLayer()),M.pm&&M.pm._updateHiddenPolyCircle(),this._fireCreate(M),this.disable(),this.options.continueDrawing&&this.enable()}},_getNewDestinationOfHintMarker:function(){var r=this._hintMarker.getLatLng();if(this.options.editable){var l=this._centerMarker.getLatLng();if(l.equals(L.latLng([0,0])))return r;var u=this._map.project(l).distanceTo(this._map.project(r));this.options.minRadiusCircleMarker&&u<this.options.minRadiusCircleMarker?r=Kt(this._map,l,r,this._pxRadiusToMeter(this.options.minRadiusCircleMarker)):this.options.maxRadiusCircleMarker&&u>this.options.maxRadiusCircleMarker&&(r=Kt(this._map,l,r,this._pxRadiusToMeter(this.options.maxRadiusCircleMarker)))}return r},_handleHintMarkerSnapping:function(){if(this.options.editable){if(this._hintMarker._snapped){var r=this._centerMarker.getLatLng(),l=this._hintMarker.getLatLng(),u=this._map.project(r).distanceTo(this._map.project(l));(this.options.minRadiusCircleMarker&&u<this.options.minRadiusCircleMarker||this.options.maxRadiusCircleMarker&&u>this.options.maxRadiusCircleMarker)&&this._hintMarker.setLatLng(this._hintMarker._orgLatLng)}this._hintMarker.setLatLng(this._getNewDestinationOfHintMarker())}},_pxRadiusToMeter:function(r){var l=this._centerMarker.getLatLng(),u=this._map.project(l),p=L.point(u.x+r,u.y);return this._map.unproject(p).distanceTo(l)}});var Ht=t(1),Xt=t.n(Ht);function ee(r,l,u){var p=r[l];r[l]=r[u],r[u]=p}function oe(r,l){return r<l?-1:r>l?1:0}var Se=function(r,l,u,p,g){(function M(S,D,B,N,H){for(;N>B;){if(N-B>600){var Y=N-B+1,V=D-B+1,tt=Math.log(Y),ut=.5*Math.exp(2*tt/3),ct=.5*Math.sqrt(tt*ut*(Y-ut)/Y)*(V-Y/2<0?-1:1),yt=Math.max(B,Math.floor(D-V*ut/Y+ct)),mt=Math.min(N,Math.floor(D+(Y-V)*ut/Y+ct));M(S,D,yt,mt,H)}var xt=S[D],Lt=B,_t=N;for(ee(S,B,D),H(S[N],xt)>0&&ee(S,B,N);Lt<_t;){for(ee(S,Lt,_t),Lt++,_t--;H(S[Lt],xt)<0;)Lt++;for(;H(S[_t],xt)>0;)_t--}H(S[B],xt)===0?ee(S,B,_t):(_t++,ee(S,_t,N)),_t<=D&&(B=_t+1),D<=_t&&(N=_t-1)}})(r,l,u||0,p||r.length-1,g||oe)};function Ce(r,l){if(!(this instanceof Ce))return new Ce(r,l);this._maxEntries=Math.max(4,r||9),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),l&&this._initFormat(l),this.clear()}function pe(r,l,u){if(!u)return l.indexOf(r);for(var p=0;p<l.length;p++)if(u(r,l[p]))return p;return-1}function ce(r,l){Wt(r,0,r.children.length,l,r)}function Wt(r,l,u,p,g){g||(g=ki(null)),g.minX=1/0,g.minY=1/0,g.maxX=-1/0,g.maxY=-1/0;for(var M,S=l;S<u;S++)M=r.children[S],fe(g,r.leaf?p(M):M);return g}function fe(r,l){return r.minX=Math.min(r.minX,l.minX),r.minY=Math.min(r.minY,l.minY),r.maxX=Math.max(r.maxX,l.maxX),r.maxY=Math.max(r.maxY,l.maxY),r}function fi(r,l){return r.minX-l.minX}function He(r,l){return r.minY-l.minY}function ye(r){return(r.maxX-r.minX)*(r.maxY-r.minY)}function we(r){return r.maxX-r.minX+(r.maxY-r.minY)}function Ee(r,l){return r.minX<=l.minX&&r.minY<=l.minY&&l.maxX<=r.maxX&&l.maxY<=r.maxY}function Fi(r,l){return l.minX<=r.maxX&&l.minY<=r.maxY&&l.maxX>=r.minX&&l.maxY>=r.minY}function ki(r){return{children:r,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function $e(r,l,u,p,g){for(var M,S=[l,u];S.length;)(u=S.pop())-(l=S.pop())<=p||(M=l+Math.ceil((u-l)/p/2)*p,Se(r,M,l,u,g),S.push(l,M,M,u))}Ce.prototype={all:function(){return this._all(this.data,[])},search:function(r){var l=this.data,u=[],p=this.toBBox;if(!Fi(r,l))return u;for(var g,M,S,D,B=[];l;){for(g=0,M=l.children.length;g<M;g++)S=l.children[g],Fi(r,D=l.leaf?p(S):S)&&(l.leaf?u.push(S):Ee(r,D)?this._all(S,u):B.push(S));l=B.pop()}return u},collides:function(r){var l=this.data,u=this.toBBox;if(!Fi(r,l))return!1;for(var p,g,M,S,D=[];l;){for(p=0,g=l.children.length;p<g;p++)if(M=l.children[p],Fi(r,S=l.leaf?u(M):M)){if(l.leaf||Ee(r,S))return!0;D.push(M)}l=D.pop()}return!1},load:function(r){if(!r||!r.length)return this;if(r.length<this._minEntries){for(var l=0,u=r.length;l<u;l++)this.insert(r[l]);return this}var p=this._build(r.slice(),0,r.length-1,0);if(this.data.children.length)if(this.data.height===p.height)this._splitRoot(this.data,p);else{if(this.data.height<p.height){var g=this.data;this.data=p,p=g}this._insert(p,this.data.height-p.height-1,!0)}else this.data=p;return this},insert:function(r){return r&&this._insert(r,this.data.height-1),this},clear:function(){return this.data=ki([]),this},remove:function(r,l){if(!r)return this;for(var u,p,g,M,S=this.data,D=this.toBBox(r),B=[],N=[];S||B.length;){if(S||(S=B.pop(),p=B[B.length-1],u=N.pop(),M=!0),S.leaf&&(g=pe(r,S.children,l))!==-1)return S.children.splice(g,1),B.push(S),this._condense(B),this;M||S.leaf||!Ee(S,D)?p?(u++,S=p.children[u],M=!1):S=null:(B.push(S),N.push(u),u=0,p=S,S=S.children[0])}return this},toBBox:function(r){return r},compareMinX:fi,compareMinY:He,toJSON:function(){return this.data},fromJSON:function(r){return this.data=r,this},_all:function(r,l){for(var u=[];r;)r.leaf?l.push.apply(l,r.children):u.push.apply(u,r.children),r=u.pop();return l},_build:function(r,l,u,p){var g,M=u-l+1,S=this._maxEntries;if(M<=S)return ce(g=ki(r.slice(l,u+1)),this.toBBox),g;p||(p=Math.ceil(Math.log(M)/Math.log(S)),S=Math.ceil(M/Math.pow(S,p-1))),(g=ki([])).leaf=!1,g.height=p;var D,B,N,H,Y=Math.ceil(M/S),V=Y*Math.ceil(Math.sqrt(S));for($e(r,l,u,V,this.compareMinX),D=l;D<=u;D+=V)for($e(r,D,N=Math.min(D+V-1,u),Y,this.compareMinY),B=D;B<=N;B+=Y)H=Math.min(B+Y-1,N),g.children.push(this._build(r,B,H,p-1));return ce(g,this.toBBox),g},_chooseSubtree:function(r,l,u,p){for(var g,M,S,D,B,N,H,Y,V,tt;p.push(l),!l.leaf&&p.length-1!==u;){for(H=Y=1/0,g=0,M=l.children.length;g<M;g++)B=ye(S=l.children[g]),V=r,tt=S,(N=(Math.max(tt.maxX,V.maxX)-Math.min(tt.minX,V.minX))*(Math.max(tt.maxY,V.maxY)-Math.min(tt.minY,V.minY))-B)<Y?(Y=N,H=B<H?B:H,D=S):N===Y&&B<H&&(H=B,D=S);l=D||l.children[0]}return l},_insert:function(r,l,u){var p=this.toBBox,g=u?r:p(r),M=[],S=this._chooseSubtree(g,this.data,l,M);for(S.children.push(r),fe(S,g);l>=0&&M[l].children.length>this._maxEntries;)this._split(M,l),l--;this._adjustParentBBoxes(g,M,l)},_split:function(r,l){var u=r[l],p=u.children.length,g=this._minEntries;this._chooseSplitAxis(u,g,p);var M=this._chooseSplitIndex(u,g,p),S=ki(u.children.splice(M,u.children.length-M));S.height=u.height,S.leaf=u.leaf,ce(u,this.toBBox),ce(S,this.toBBox),l?r[l-1].children.push(S):this._splitRoot(u,S)},_splitRoot:function(r,l){this.data=ki([r,l]),this.data.height=r.height+1,this.data.leaf=!1,ce(this.data,this.toBBox)},_chooseSplitIndex:function(r,l,u){var p,g,M,S,D,B,N,H,Y,V,tt,ut,ct,yt;for(B=N=1/0,p=l;p<=u-l;p++)g=Wt(r,0,p,this.toBBox),M=Wt(r,p,u,this.toBBox),Y=g,V=M,tt=void 0,ut=void 0,ct=void 0,yt=void 0,tt=Math.max(Y.minX,V.minX),ut=Math.max(Y.minY,V.minY),ct=Math.min(Y.maxX,V.maxX),yt=Math.min(Y.maxY,V.maxY),S=Math.max(0,ct-tt)*Math.max(0,yt-ut),D=ye(g)+ye(M),S<B?(B=S,H=p,N=D<N?D:N):S===B&&D<N&&(N=D,H=p);return H},_chooseSplitAxis:function(r,l,u){var p=r.leaf?this.compareMinX:fi,g=r.leaf?this.compareMinY:He;this._allDistMargin(r,l,u,p)<this._allDistMargin(r,l,u,g)&&r.children.sort(p)},_allDistMargin:function(r,l,u,p){r.children.sort(p);var g,M,S=this.toBBox,D=Wt(r,0,l,S),B=Wt(r,u-l,u,S),N=we(D)+we(B);for(g=l;g<u-l;g++)M=r.children[g],fe(D,r.leaf?S(M):M),N+=we(D);for(g=u-l-1;g>=l;g--)M=r.children[g],fe(B,r.leaf?S(M):M),N+=we(B);return N},_adjustParentBBoxes:function(r,l,u){for(var p=u;p>=0;p--)fe(l[p],r)},_condense:function(r){for(var l,u=r.length-1;u>=0;u--)r[u].children.length===0?u>0?(l=r[u-1].children).splice(l.indexOf(r[u]),1):this.clear():ce(r[u],this.toBBox)},_initFormat:function(r){var l=["return a"," - b",";"];this.compareMinX=new Function("a","b",l.join(r[0])),this.compareMinY=new Function("a","b",l.join(r[1])),this.toBBox=new Function("a","return {minX: a"+r[0]+", minY: a"+r[1]+", maxX: a"+r[2]+", maxY: a"+r[3]+"};")}};var me=Ce;function di(r,l,u){if(!hn(u=u||{}))throw new Error("options is invalid");var p=u.bbox,g=u.id;if(r===void 0)throw new Error("geometry is required");if(l&&l.constructor!==Object)throw new Error("properties must be an Object");p&&un(p),g&&cn(g);var M={type:"Feature"};return g&&(M.id=g),p&&(M.bbox=p),M.properties=l||{},M.geometry=r,M}function ln(r,l,u){if(!r)throw new Error("coordinates is required");if(!Array.isArray(r))throw new Error("coordinates must be an Array");if(r.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!Gi(r[0])||!Gi(r[1]))throw new Error("coordinates must contain numbers");return di({type:"Point",coordinates:r},l,u)}function Mi(r,l,u){if(!r)throw new Error("coordinates is required");if(r.length<2)throw new Error("coordinates must be an array of two or more positions");if(!Gi(r[0][1])||!Gi(r[0][1]))throw new Error("coordinates must contain numbers");return di({type:"LineString",coordinates:r},l,u)}function he(r,l){if(!hn(l=l||{}))throw new Error("options is invalid");var u=l.bbox,p=l.id;if(!r)throw new Error("No features passed");if(!Array.isArray(r))throw new Error("features must be an Array");u&&un(u),p&&cn(p);var g={type:"FeatureCollection"};return p&&(g.id=p),u&&(g.bbox=u),g.features=r,g}function Gi(r){return!isNaN(r)&&r!==null&&!Array.isArray(r)}function hn(r){return!!r&&r.constructor===Object}function un(r){if(!r)throw new Error("bbox is required");if(!Array.isArray(r))throw new Error("bbox must be an Array");if(r.length!==4&&r.length!==6)throw new Error("bbox must be an Array of 4 or 6 numbers");r.forEach(function(l){if(!Gi(l))throw new Error("bbox must only contain numbers")})}function cn(r){if(!r)throw new Error("id is required");if(["string","number"].indexOf(typeof r)===-1)throw new Error("id must be a number or a string")}function ji(r,l,u){if(r!==null)for(var p,g,M,S,D,B,N,H,Y=0,V=0,tt=r.type,ut=tt==="FeatureCollection",ct=tt==="Feature",yt=ut?r.features.length:1,mt=0;mt<yt;mt++){D=(H=!!(N=ut?r.features[mt].geometry:ct?r.geometry:r)&&N.type==="GeometryCollection")?N.geometries.length:1;for(var xt=0;xt<D;xt++){var Lt=0,_t=0;if((S=H?N.geometries[xt]:N)!==null){B=S.coordinates;var Gt=S.type;switch(Y=!u||Gt!=="Polygon"&&Gt!=="MultiPolygon"?0:1,Gt){case null:break;case"Point":if(l(B,V,mt,Lt,_t)===!1)return!1;V++,Lt++;break;case"LineString":case"MultiPoint":for(p=0;p<B.length;p++){if(l(B[p],V,mt,Lt,_t)===!1)return!1;V++,Gt==="MultiPoint"&&Lt++}Gt==="LineString"&&Lt++;break;case"Polygon":case"MultiLineString":for(p=0;p<B.length;p++){for(g=0;g<B[p].length-Y;g++){if(l(B[p][g],V,mt,Lt,_t)===!1)return!1;V++}Gt==="MultiLineString"&&Lt++,Gt==="Polygon"&&_t++}Gt==="Polygon"&&Lt++;break;case"MultiPolygon":for(p=0;p<B.length;p++){for(Gt==="MultiPolygon"&&(_t=0),g=0;g<B[p].length;g++){for(M=0;M<B[p][g].length-Y;M++){if(l(B[p][g][M],V,mt,Lt,_t)===!1)return!1;V++}_t++}Lt++}break;case"GeometryCollection":for(p=0;p<S.geometries.length;p++)if(ji(S.geometries[p],l,u)===!1)return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function Re(r,l){if(r.type==="Feature")l(r,0);else if(r.type==="FeatureCollection")for(var u=0;u<r.features.length&&l(r.features[u],u)!==!1;u++);}function kr(r,l){var u,p,g,M,S,D,B,N,H,Y,V=0,tt=r.type==="FeatureCollection",ut=r.type==="Feature",ct=tt?r.features.length:1;for(u=0;u<ct;u++){for(D=tt?r.features[u].geometry:ut?r.geometry:r,N=tt?r.features[u].properties:ut?r.properties:{},H=tt?r.features[u].bbox:ut?r.bbox:void 0,Y=tt?r.features[u].id:ut?r.id:void 0,S=(B=!!D&&D.type==="GeometryCollection")?D.geometries.length:1,g=0;g<S;g++)if((M=B?D.geometries[g]:D)!==null)switch(M.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":if(l(M,V,N,H,Y)===!1)return!1;break;case"GeometryCollection":for(p=0;p<M.geometries.length;p++)if(l(M.geometries[p],V,N,H,Y)===!1)return!1;break;default:throw new Error("Unknown Geometry Type")}else if(l(null,V,N,H,Y)===!1)return!1;V++}}function Mr(r,l){kr(r,function(u,p,g,M,S){var D,B=u===null?null:u.type;switch(B){case null:case"Point":case"LineString":case"Polygon":return l(di(u,g,{bbox:M,id:S}),p,0)!==!1&&void 0}switch(B){case"MultiPoint":D="Point";break;case"MultiLineString":D="LineString";break;case"MultiPolygon":D="Polygon"}for(var N=0;N<u.coordinates.length;N++){var H=u.coordinates[N];if(l(di({type:D,coordinates:H},g),p,N)===!1)return!1}})}function zn(r){var l=[r[0],r[1]],u=[r[0],r[3]],p=[r[2],r[3]];return{type:"Feature",bbox:r,properties:{},geometry:{type:"Polygon",coordinates:[[l,[r[2],r[1]],p,u,l]]}}}function Nn(r){var l=[1/0,1/0,-1/0,-1/0];return ji(r,function(u){l[0]>u[0]&&(l[0]=u[0]),l[1]>u[1]&&(l[1]=u[1]),l[2]<u[0]&&(l[2]=u[0]),l[3]<u[1]&&(l[3]=u[1])}),l}var Fn=function(r){var l=me(r);return l.insert=function(u){if(Array.isArray(u)){var p=u;(u=zn(p)).bbox=p}else u.bbox=u.bbox?u.bbox:Nn(u);return me.prototype.insert.call(this,u)},l.load=function(u){var p=[];return Array.isArray(u)?u.forEach(function(g){var M=zn(g);M.bbox=g,p.push(M)}):Re(u,function(g){g.bbox=g.bbox?g.bbox:Nn(g),p.push(g)}),me.prototype.load.call(this,p)},l.remove=function(u){if(Array.isArray(u)){var p=u;(u=zn(p)).bbox=p}return me.prototype.remove.call(this,u)},l.clear=function(){return me.prototype.clear.call(this)},l.search=function(u){return{type:"FeatureCollection",features:me.prototype.search.call(this,this.toBBox(u))}},l.collides=function(u){return me.prototype.collides.call(this,this.toBBox(u))},l.all=function(){return{type:"FeatureCollection",features:me.prototype.all.call(this)}},l.toJSON=function(){return me.prototype.toJSON.call(this)},l.fromJSON=function(u){return me.prototype.fromJSON.call(this,u)},l.toBBox=function(u){var p;return{minX:(p=u.bbox?u.bbox:Array.isArray(u)&&u.length===4?u:Nn(u))[0],minY:p[1],maxX:p[2],maxY:p[3]}},l},gs={meters:63710088e-1,metres:63710088e-1,millimeters:6371008800,millimetres:6371008800,centimeters:637100880,centimetres:637100880,kilometers:6371.0088,kilometres:6371.0088,miles:3958.761333810546,nauticalmiles:63710088e-1/1852,inches:63710088e-1*39.37,yards:63710088e-1/1.0936,feet:20902260511392e-6,radians:1,degrees:63710088e-1/111325};function Pr(r,l){if(r==null)throw new Error("radians is required");if(l&&typeof l!="string")throw new Error("units must be a string");var u=gs[l||"kilometers"];if(!u)throw new Error(l+" units is invalid");return r*u}function Pi(r){if(r==null)throw new Error("degrees is required");return r%360*Math.PI/180}function _s(r){return!!r&&r.constructor===Object}function Sr(r){if(!r)throw new Error("coord is required");if(r.type==="Feature"&&r.geometry!==null&&r.geometry.type==="Point")return r.geometry.coordinates;if(r.type==="Point")return r.coordinates;if(Array.isArray(r)&&r.length>=2&&r[0].length===void 0&&r[1].length===void 0)return r;throw new Error("coord must be GeoJSON Point or an Array of numbers")}var Ue=function(r,l,u){if(!_s(u=u||{}))throw new Error("options is invalid");var p=u.units,g=Sr(r),M=Sr(l),S=Pi(M[1]-g[1]),D=Pi(M[0]-g[0]),B=Pi(g[1]),N=Pi(M[1]),H=Math.pow(Math.sin(S/2),2)+Math.pow(Math.sin(D/2),2)*Math.cos(B)*Math.cos(N);return Pr(2*Math.atan2(Math.sqrt(H),Math.sqrt(1-H)),p)},fn=function(r){var l=r[0],u=r[1],p=r[2],g=r[3];if(Ue(r.slice(0,2),[p,u])>=Ue(r.slice(0,2),[l,g])){var M=(u+g)/2;return[l,M-(p-l)/2,p,M+(p-l)/2]}var S=(l+p)/2;return[S-(g-u)/2,u,S+(g-u)/2,g]},Si=function(r){var l=[1/0,1/0,-1/0,-1/0];return ji(r,function(u){l[0]>u[0]&&(l[0]=u[0]),l[1]>u[1]&&(l[1]=u[1]),l[2]<u[0]&&(l[2]=u[0]),l[3]<u[1]&&(l[3]=u[1])}),l};function ys(r){return!!r&&r.constructor===Object}function Cr(r,l,u){if(r!==null)for(var p,g,M,S,D,B,N,H,Y=0,V=0,tt=r.type,ut=tt==="FeatureCollection",ct=tt==="Feature",yt=ut?r.features.length:1,mt=0;mt<yt;mt++){D=(H=!!(N=ut?r.features[mt].geometry:ct?r.geometry:r)&&N.type==="GeometryCollection")?N.geometries.length:1;for(var xt=0;xt<D;xt++){var Lt=0,_t=0;if((S=H?N.geometries[xt]:N)!==null){B=S.coordinates;var Gt=S.type;switch(Y=!u||Gt!=="Polygon"&&Gt!=="MultiPolygon"?0:1,Gt){case null:break;case"Point":if(l(B,V,mt,Lt,_t)===!1)return!1;V++,Lt++;break;case"LineString":case"MultiPoint":for(p=0;p<B.length;p++){if(l(B[p],V,mt,Lt,_t)===!1)return!1;V++,Gt==="MultiPoint"&&Lt++}Gt==="LineString"&&Lt++;break;case"Polygon":case"MultiLineString":for(p=0;p<B.length;p++){for(g=0;g<B[p].length-Y;g++){if(l(B[p][g],V,mt,Lt,_t)===!1)return!1;V++}Gt==="MultiLineString"&&Lt++,Gt==="Polygon"&&_t++}Gt==="Polygon"&&Lt++;break;case"MultiPolygon":for(p=0;p<B.length;p++){for(Gt==="MultiPolygon"&&(_t=0),g=0;g<B[p].length;g++){for(M=0;M<B[p][g].length-Y;M++){if(l(B[p][g][M],V,mt,Lt,_t)===!1)return!1;V++}_t++}Lt++}break;case"GeometryCollection":for(p=0;p<S.geometries.length;p++)if(Cr(S.geometries[p],l,u)===!1)return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}var Gn=function(r,l){if(!ys(l=l||{}))throw new Error("options is invalid");var u=l.precision,p=l.coordinates,g=l.mutate;if(u=u==null||isNaN(u)?6:u,p=p==null||isNaN(p)?3:p,!r)throw new Error("<geojson> is required");if(typeof u!="number")throw new Error("<precision> must be a number");if(typeof p!="number")throw new Error("<coordinates> must be a number");g!==!1&&g!==void 0||(r=JSON.parse(JSON.stringify(r)));var M=Math.pow(10,u);return Cr(r,function(S){(function(D,B,N){D.length>N&&D.splice(N,D.length);for(var H=0;H<D.length;H++)D[H]=Math.round(D[H]*B)/B})(S,M,p)}),r};function pi(r){if(!r)throw new Error("coord is required");if(r.type==="Feature"&&r.geometry!==null&&r.geometry.type==="Point")return r.geometry.coordinates;if(r.type==="Point")return r.coordinates;if(Array.isArray(r)&&r.length>=2&&r[0].length===void 0&&r[1].length===void 0)return r;throw new Error("coord must be GeoJSON Point or an Array of numbers")}function Ke(r){if(!r)throw new Error("coords is required");if(r.type==="Feature"&&r.geometry!==null)return r.geometry.coordinates;if(r.coordinates)return r.coordinates;if(Array.isArray(r))return r;throw new Error("coords must be GeoJSON Feature, Geometry Object or an Array")}function jn(r,l){if(!r)throw new Error((l||"geojson")+" is required");if(r.geometry&&r.geometry.type)return r.geometry.type;if(r.type)return r.type;throw new Error((l||"geojson")+" is invalid")}var mi=function(r){if(!r)throw new Error("geojson is required");var l=[];return Mr(r,function(u){(function(p,g){var M=[],S=p.geometry;switch(S.type){case"Polygon":M=Ke(S);break;case"LineString":M=[Ke(S)]}M.forEach(function(D){(function(B,N){var H=[];return B.reduce(function(Y,V){var tt,ut,ct,yt,mt,xt,Lt=Mi([Y,V],N);return Lt.bbox=(ut=V,ct=(tt=Y)[0],yt=tt[1],mt=ut[0],xt=ut[1],[ct<mt?ct:mt,yt<xt?yt:xt,ct>mt?ct:mt,yt>xt?yt:xt]),H.push(Lt),V}),H})(D,p.properties).forEach(function(B){B.id=g.length,g.push(B)})})})(u,l)}),he(l)};function Nt(r,l){var u=Ke(r),p=Ke(l);if(u.length!==2)throw new Error("<intersects> line1 must only contain 2 coordinates");if(p.length!==2)throw new Error("<intersects> line2 must only contain 2 coordinates");var g=u[0][0],M=u[0][1],S=u[1][0],D=u[1][1],B=p[0][0],N=p[0][1],H=p[1][0],Y=p[1][1],V=(Y-N)*(S-g)-(H-B)*(D-M),tt=(H-B)*(M-N)-(Y-N)*(g-B),ut=(S-g)*(M-N)-(D-M)*(g-B);if(V===0)return null;var ct=tt/V,yt=ut/V;return ct>=0&&ct<=1&&yt>=0&&yt<=1?ln([g+ct*(S-g),M+ct*(D-M)]):null}var Qt=function(r,l){var u={},p=[];if(r.type==="LineString"&&(r=di(r)),l.type==="LineString"&&(l=di(l)),r.type==="Feature"&&l.type==="Feature"&&r.geometry.type==="LineString"&&l.geometry.type==="LineString"&&r.geometry.coordinates.length===2&&l.geometry.coordinates.length===2){var g=Nt(r,l);return g&&p.push(g),he(p)}var M=Fn();return M.load(mi(l)),Re(mi(r),function(S){Re(M.search(S),function(D){var B=Nt(S,D);if(B){var N=Ke(B).join(",");u[N]||(u[N]=!0,p.push(B))}})}),he(p)};function dn(r){if(r==null)throw new Error("radians is required");return 180*(r%(2*Math.PI))/Math.PI}function Xe(r){if(r==null)throw new Error("degrees is required");return r%360*Math.PI/180}function Ci(r){return!!r&&r.constructor===Object}function pn(r){if(!r)throw new Error("coord is required");if(r.type==="Feature"&&r.geometry!==null&&r.geometry.type==="Point")return r.geometry.coordinates;if(r.type==="Point")return r.coordinates;if(Array.isArray(r)&&r.length>=2&&r[0].length===void 0&&r[1].length===void 0)return r;throw new Error("coord must be GeoJSON Point or an Array of numbers")}function Ct(r,l,u){if(!Ci(u=u||{}))throw new Error("options is invalid");if(u.final===!0)return function(Y,V){var tt=Ct(V,Y);return tt=(tt+180)%360}(r,l);var p=pn(r),g=pn(l),M=Xe(p[0]),S=Xe(g[0]),D=Xe(p[1]),B=Xe(g[1]),N=Math.sin(S-M)*Math.cos(B),H=Math.cos(D)*Math.sin(B)-Math.sin(D)*Math.cos(B)*Math.cos(S-M);return dn(Math.atan2(N,H))}var ie=Ct,Un={meters:63710088e-1,metres:63710088e-1,millimeters:6371008800,millimetres:6371008800,centimeters:637100880,centimetres:637100880,kilometers:6371.0088,kilometres:6371.0088,miles:3958.761333810546,nauticalmiles:63710088e-1/1852,inches:63710088e-1*39.37,yards:63710088e-1/1.0936,feet:20902260511392e-6,radians:1,degrees:63710088e-1/111325};function mn(r,l,u){if(!Je(u=u||{}))throw new Error("options is invalid");var p=u.bbox,g=u.id;if(r===void 0)throw new Error("geometry is required");if(l&&l.constructor!==Object)throw new Error("properties must be an Object");p&&Zi(p),g&&qi(g);var M={type:"Feature"};return g&&(M.id=g),p&&(M.bbox=p),M.properties=l||{},M.geometry=r,M}function Te(r,l,u){if(!r)throw new Error("coordinates is required");if(!Array.isArray(r))throw new Error("coordinates must be an Array");if(r.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!ne(r[0])||!ne(r[1]))throw new Error("coordinates must contain numbers");return mn({type:"Point",coordinates:r},l,u)}function vs(r,l){if(r==null)throw new Error("distance is required");if(l&&typeof l!="string")throw new Error("units must be a string");var u=Un[l||"kilometers"];if(!u)throw new Error(l+" units is invalid");return r/u}function Ui(r){if(r==null)throw new Error("radians is required");return 180*(r%(2*Math.PI))/Math.PI}function Ye(r){if(r==null)throw new Error("degrees is required");return r%360*Math.PI/180}function ne(r){return!isNaN(r)&&r!==null&&!Array.isArray(r)}function Je(r){return!!r&&r.constructor===Object}function Zi(r){if(!r)throw new Error("bbox is required");if(!Array.isArray(r))throw new Error("bbox must be an Array");if(r.length!==4&&r.length!==6)throw new Error("bbox must be an Array of 4 or 6 numbers");r.forEach(function(l){if(!ne(l))throw new Error("bbox must only contain numbers")})}function qi(r){if(!r)throw new Error("id is required");if(["string","number"].indexOf(typeof r)===-1)throw new Error("id must be a number or a string")}var gn=function(r,l,u,p){if(!Je(p=p||{}))throw new Error("options is invalid");var g=p.units,M=p.properties,S=function(V){if(!V)throw new Error("coord is required");if(V.type==="Feature"&&V.geometry!==null&&V.geometry.type==="Point")return V.geometry.coordinates;if(V.type==="Point")return V.coordinates;if(Array.isArray(V)&&V.length>=2&&V[0].length===void 0&&V[1].length===void 0)return V;throw new Error("coord must be GeoJSON Point or an Array of numbers")}(r),D=Ye(S[0]),B=Ye(S[1]),N=Ye(u),H=vs(l,g),Y=Math.asin(Math.sin(B)*Math.cos(H)+Math.cos(B)*Math.sin(H)*Math.cos(N));return Te([Ui(D+Math.atan2(Math.sin(N)*Math.sin(H)*Math.cos(B),Math.cos(H)-Math.sin(B)*Math.sin(Y))),Ui(Y)],M)};function We(r,l,u){var p=r[l];r[l]=r[u],r[u]=p}function Zn(r,l){return r<l?-1:r>l?1:0}var qn=function(r,l,u,p,g){(function M(S,D,B,N,H){for(;N>B;){if(N-B>600){var Y=N-B+1,V=D-B+1,tt=Math.log(Y),ut=.5*Math.exp(2*tt/3),ct=.5*Math.sqrt(tt*ut*(Y-ut)/Y)*(V-Y/2<0?-1:1),yt=Math.max(B,Math.floor(D-V*ut/Y+ct)),mt=Math.min(N,Math.floor(D+(Y-V)*ut/Y+ct));M(S,D,yt,mt,H)}var xt=S[D],Lt=B,_t=N;for(We(S,B,D),H(S[N],xt)>0&&We(S,B,N);Lt<_t;){for(We(S,Lt,_t),Lt++,_t--;H(S[Lt],xt)<0;)Lt++;for(;H(S[_t],xt)>0;)_t--}H(S[B],xt)===0?We(S,B,_t):(_t++,We(S,_t,N)),_t<=D&&(B=_t+1),D<=_t&&(N=_t-1)}})(r,l,u||0,p||r.length-1,g||Zn)};function gi(r,l){if(!(this instanceof gi))return new gi(r,l);this._maxEntries=Math.max(4,r||9),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),l&&this._initFormat(l),this.clear()}function Vn(r,l,u){if(!u)return l.indexOf(r);for(var p=0;p<l.length;p++)if(u(r,l[p]))return p;return-1}function ei(r,l){ii(r,0,r.children.length,l,r)}function ii(r,l,u,p,g){g||(g=ni(null)),g.minX=1/0,g.minY=1/0,g.maxX=-1/0,g.maxY=-1/0;for(var M,S=l;S<u;S++)M=r.children[S],Ei(g,r.leaf?p(M):M);return g}function Ei(r,l){return r.minX=Math.min(r.minX,l.minX),r.minY=Math.min(r.minY,l.minY),r.maxX=Math.max(r.maxX,l.maxX),r.maxY=Math.max(r.maxY,l.maxY),r}function _n(r,l){return r.minX-l.minX}function Er(r,l){return r.minY-l.minY}function Tt(r){return(r.maxX-r.minX)*(r.maxY-r.minY)}function ve(r){return r.maxX-r.minX+(r.maxY-r.minY)}function te(r,l){return r.minX<=l.minX&&r.minY<=l.minY&&l.maxX<=r.maxX&&l.maxY<=r.maxY}function Vi(r,l){return l.minX<=r.maxX&&l.minY<=r.maxY&&l.maxX>=r.minX&&l.maxY>=r.minY}function ni(r){return{children:r,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function Hi(r,l,u,p,g){for(var M,S=[l,u];S.length;)(u=S.pop())-(l=S.pop())<=p||(M=l+Math.ceil((u-l)/p/2)*p,qn(r,M,l,u,g),S.push(l,M,M,u))}gi.prototype={all:function(){return this._all(this.data,[])},search:function(r){var l=this.data,u=[],p=this.toBBox;if(!Vi(r,l))return u;for(var g,M,S,D,B=[];l;){for(g=0,M=l.children.length;g<M;g++)S=l.children[g],Vi(r,D=l.leaf?p(S):S)&&(l.leaf?u.push(S):te(r,D)?this._all(S,u):B.push(S));l=B.pop()}return u},collides:function(r){var l=this.data,u=this.toBBox;if(!Vi(r,l))return!1;for(var p,g,M,S,D=[];l;){for(p=0,g=l.children.length;p<g;p++)if(M=l.children[p],Vi(r,S=l.leaf?u(M):M)){if(l.leaf||te(r,S))return!0;D.push(M)}l=D.pop()}return!1},load:function(r){if(!r||!r.length)return this;if(r.length<this._minEntries){for(var l=0,u=r.length;l<u;l++)this.insert(r[l]);return this}var p=this._build(r.slice(),0,r.length-1,0);if(this.data.children.length)if(this.data.height===p.height)this._splitRoot(this.data,p);else{if(this.data.height<p.height){var g=this.data;this.data=p,p=g}this._insert(p,this.data.height-p.height-1,!0)}else this.data=p;return this},insert:function(r){return r&&this._insert(r,this.data.height-1),this},clear:function(){return this.data=ni([]),this},remove:function(r,l){if(!r)return this;for(var u,p,g,M,S=this.data,D=this.toBBox(r),B=[],N=[];S||B.length;){if(S||(S=B.pop(),p=B[B.length-1],u=N.pop(),M=!0),S.leaf&&(g=Vn(r,S.children,l))!==-1)return S.children.splice(g,1),B.push(S),this._condense(B),this;M||S.leaf||!te(S,D)?p?(u++,S=p.children[u],M=!1):S=null:(B.push(S),N.push(u),u=0,p=S,S=S.children[0])}return this},toBBox:function(r){return r},compareMinX:_n,compareMinY:Er,toJSON:function(){return this.data},fromJSON:function(r){return this.data=r,this},_all:function(r,l){for(var u=[];r;)r.leaf?l.push.apply(l,r.children):u.push.apply(u,r.children),r=u.pop();return l},_build:function(r,l,u,p){var g,M=u-l+1,S=this._maxEntries;if(M<=S)return ei(g=ni(r.slice(l,u+1)),this.toBBox),g;p||(p=Math.ceil(Math.log(M)/Math.log(S)),S=Math.ceil(M/Math.pow(S,p-1))),(g=ni([])).leaf=!1,g.height=p;var D,B,N,H,Y=Math.ceil(M/S),V=Y*Math.ceil(Math.sqrt(S));for(Hi(r,l,u,V,this.compareMinX),D=l;D<=u;D+=V)for(Hi(r,D,N=Math.min(D+V-1,u),Y,this.compareMinY),B=D;B<=N;B+=Y)H=Math.min(B+Y-1,N),g.children.push(this._build(r,B,H,p-1));return ei(g,this.toBBox),g},_chooseSubtree:function(r,l,u,p){for(var g,M,S,D,B,N,H,Y,V,tt;p.push(l),!l.leaf&&p.length-1!==u;){for(H=Y=1/0,g=0,M=l.children.length;g<M;g++)B=Tt(S=l.children[g]),V=r,tt=S,(N=(Math.max(tt.maxX,V.maxX)-Math.min(tt.minX,V.minX))*(Math.max(tt.maxY,V.maxY)-Math.min(tt.minY,V.minY))-B)<Y?(Y=N,H=B<H?B:H,D=S):N===Y&&B<H&&(H=B,D=S);l=D||l.children[0]}return l},_insert:function(r,l,u){var p=this.toBBox,g=u?r:p(r),M=[],S=this._chooseSubtree(g,this.data,l,M);for(S.children.push(r),Ei(S,g);l>=0&&M[l].children.length>this._maxEntries;)this._split(M,l),l--;this._adjustParentBBoxes(g,M,l)},_split:function(r,l){var u=r[l],p=u.children.length,g=this._minEntries;this._chooseSplitAxis(u,g,p);var M=this._chooseSplitIndex(u,g,p),S=ni(u.children.splice(M,u.children.length-M));S.height=u.height,S.leaf=u.leaf,ei(u,this.toBBox),ei(S,this.toBBox),l?r[l-1].children.push(S):this._splitRoot(u,S)},_splitRoot:function(r,l){this.data=ni([r,l]),this.data.height=r.height+1,this.data.leaf=!1,ei(this.data,this.toBBox)},_chooseSplitIndex:function(r,l,u){var p,g,M,S,D,B,N,H,Y,V,tt,ut,ct,yt;for(B=N=1/0,p=l;p<=u-l;p++)g=ii(r,0,p,this.toBBox),M=ii(r,p,u,this.toBBox),Y=g,V=M,tt=void 0,ut=void 0,ct=void 0,yt=void 0,tt=Math.max(Y.minX,V.minX),ut=Math.max(Y.minY,V.minY),ct=Math.min(Y.maxX,V.maxX),yt=Math.min(Y.maxY,V.maxY),S=Math.max(0,ct-tt)*Math.max(0,yt-ut),D=Tt(g)+Tt(M),S<B?(B=S,H=p,N=D<N?D:N):S===B&&D<N&&(N=D,H=p);return H},_chooseSplitAxis:function(r,l,u){var p=r.leaf?this.compareMinX:_n,g=r.leaf?this.compareMinY:Er;this._allDistMargin(r,l,u,p)<this._allDistMargin(r,l,u,g)&&r.children.sort(p)},_allDistMargin:function(r,l,u,p){r.children.sort(p);var g,M,S=this.toBBox,D=ii(r,0,l,S),B=ii(r,u-l,u,S),N=ve(D)+ve(B);for(g=l;g<u-l;g++)M=r.children[g],Ei(D,r.leaf?S(M):M),N+=ve(D);for(g=u-l-1;g>=l;g--)M=r.children[g],Ei(B,r.leaf?S(M):M),N+=ve(B);return N},_adjustParentBBoxes:function(r,l,u){for(var p=u;p>=0;p--)Ei(l[p],r)},_condense:function(r){for(var l,u=r.length-1;u>=0;u--)r[u].children.length===0?u>0?(l=r[u-1].children).splice(l.indexOf(r[u]),1):this.clear():ei(r[u],this.toBBox)},_initFormat:function(r){var l=["return a"," - b",";"];this.compareMinX=new Function("a","b",l.join(r[0])),this.compareMinY=new Function("a","b",l.join(r[1])),this.toBBox=new Function("a","return {minX: a"+r[0]+", minY: a"+r[1]+", maxX: a"+r[2]+", maxY: a"+r[3]+"};")}};var Oe=gi;function Ie(r,l,u){if(!yn(u=u||{}))throw new Error("options is invalid");var p=u.bbox,g=u.id;if(r===void 0)throw new Error("geometry is required");if(l&&l.constructor!==Object)throw new Error("properties must be an Object");p&&Tr(p),g&&Hn(g);var M={type:"Feature"};return g&&(M.id=g),p&&(M.bbox=p),M.properties=l||{},M.geometry=r,M}function Ti(r,l,u){if(!r)throw new Error("coordinates is required");if(!Array.isArray(r))throw new Error("coordinates must be an Array");if(r.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!ke(r[0])||!ke(r[1]))throw new Error("coordinates must contain numbers");return Ie({type:"Point",coordinates:r},l,u)}function _i(r,l,u){if(!r)throw new Error("coordinates is required");if(r.length<2)throw new Error("coordinates must be an array of two or more positions");if(!ke(r[0][1])||!ke(r[0][1]))throw new Error("coordinates must contain numbers");return Ie({type:"LineString",coordinates:r},l,u)}function be(r,l){if(!yn(l=l||{}))throw new Error("options is invalid");var u=l.bbox,p=l.id;if(!r)throw new Error("No features passed");if(!Array.isArray(r))throw new Error("features must be an Array");u&&Tr(u),p&&Hn(p);var g={type:"FeatureCollection"};return p&&(g.id=p),u&&(g.bbox=u),g.features=r,g}function ke(r){return!isNaN(r)&&r!==null&&!Array.isArray(r)}function yn(r){return!!r&&r.constructor===Object}function Tr(r){if(!r)throw new Error("bbox is required");if(!Array.isArray(r))throw new Error("bbox must be an Array");if(r.length!==4&&r.length!==6)throw new Error("bbox must be an Array of 4 or 6 numbers");r.forEach(function(l){if(!ke(l))throw new Error("bbox must only contain numbers")})}function Hn(r){if(!r)throw new Error("id is required");if(["string","number"].indexOf(typeof r)===-1)throw new Error("id must be a number or a string")}function vn(r,l,u){if(r!==null)for(var p,g,M,S,D,B,N,H,Y=0,V=0,tt=r.type,ut=tt==="FeatureCollection",ct=tt==="Feature",yt=ut?r.features.length:1,mt=0;mt<yt;mt++){D=(H=!!(N=ut?r.features[mt].geometry:ct?r.geometry:r)&&N.type==="GeometryCollection")?N.geometries.length:1;for(var xt=0;xt<D;xt++){var Lt=0,_t=0;if((S=H?N.geometries[xt]:N)!==null){B=S.coordinates;var Gt=S.type;switch(Y=!u||Gt!=="Polygon"&&Gt!=="MultiPolygon"?0:1,Gt){case null:break;case"Point":if(l(B,V,mt,Lt,_t)===!1)return!1;V++,Lt++;break;case"LineString":case"MultiPoint":for(p=0;p<B.length;p++){if(l(B[p],V,mt,Lt,_t)===!1)return!1;V++,Gt==="MultiPoint"&&Lt++}Gt==="LineString"&&Lt++;break;case"Polygon":case"MultiLineString":for(p=0;p<B.length;p++){for(g=0;g<B[p].length-Y;g++){if(l(B[p][g],V,mt,Lt,_t)===!1)return!1;V++}Gt==="MultiLineString"&&Lt++,Gt==="Polygon"&&_t++}Gt==="Polygon"&&Lt++;break;case"MultiPolygon":for(p=0;p<B.length;p++){for(Gt==="MultiPolygon"&&(_t=0),g=0;g<B[p].length;g++){for(M=0;M<B[p][g].length-Y;M++){if(l(B[p][g][M],V,mt,Lt,_t)===!1)return!1;V++}_t++}Lt++}break;case"GeometryCollection":for(p=0;p<S.geometries.length;p++)if(vn(S.geometries[p],l,u)===!1)return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function $i(r,l){if(r.type==="Feature")l(r,0);else if(r.type==="FeatureCollection")for(var u=0;u<r.features.length&&l(r.features[u],u)!==!1;u++);}function $n(r,l){var u,p,g,M,S,D,B,N,H,Y,V=0,tt=r.type==="FeatureCollection",ut=r.type==="Feature",ct=tt?r.features.length:1;for(u=0;u<ct;u++){for(D=tt?r.features[u].geometry:ut?r.geometry:r,N=tt?r.features[u].properties:ut?r.properties:{},H=tt?r.features[u].bbox:ut?r.bbox:void 0,Y=tt?r.features[u].id:ut?r.id:void 0,S=(B=!!D&&D.type==="GeometryCollection")?D.geometries.length:1,g=0;g<S;g++)if((M=B?D.geometries[g]:D)!==null)switch(M.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":if(l(M,V,N,H,Y)===!1)return!1;break;case"GeometryCollection":for(p=0;p<M.geometries.length;p++)if(l(M.geometries[p],V,N,H,Y)===!1)return!1;break;default:throw new Error("Unknown Geometry Type")}else if(l(null,V,N,H,Y)===!1)return!1;V++}}function Ki(r,l){$n(r,function(u,p,g,M,S){var D,B=u===null?null:u.type;switch(B){case null:case"Point":case"LineString":case"Polygon":return l(Ie(u,g,{bbox:M,id:S}),p,0)!==!1&&void 0}switch(B){case"MultiPoint":D="Point";break;case"MultiLineString":D="LineString";break;case"MultiPolygon":D="Polygon"}for(var N=0;N<u.coordinates.length;N++){var H=u.coordinates[N];if(l(Ie({type:D,coordinates:H},g),p,N)===!1)return!1}})}function Kn(r){var l=[r[0],r[1]],u=[r[0],r[3]],p=[r[2],r[3]];return{type:"Feature",bbox:r,properties:{},geometry:{type:"Polygon",coordinates:[[l,[r[2],r[1]],p,u,l]]}}}function bn(r){var l=[1/0,1/0,-1/0,-1/0];return vn(r,function(u){l[0]>u[0]&&(l[0]=u[0]),l[1]>u[1]&&(l[1]=u[1]),l[2]<u[0]&&(l[2]=u[0]),l[3]<u[1]&&(l[3]=u[1])}),l}var Ft=function(r){var l=Oe(r);return l.insert=function(u){if(Array.isArray(u)){var p=u;(u=Kn(p)).bbox=p}else u.bbox=u.bbox?u.bbox:bn(u);return Oe.prototype.insert.call(this,u)},l.load=function(u){var p=[];return Array.isArray(u)?u.forEach(function(g){var M=Kn(g);M.bbox=g,p.push(M)}):$i(u,function(g){g.bbox=g.bbox?g.bbox:bn(g),p.push(g)}),Oe.prototype.load.call(this,p)},l.remove=function(u){if(Array.isArray(u)){var p=u;(u=Kn(p)).bbox=p}return Oe.prototype.remove.call(this,u)},l.clear=function(){return Oe.prototype.clear.call(this)},l.search=function(u){return{type:"FeatureCollection",features:Oe.prototype.search.call(this,this.toBBox(u))}},l.collides=function(u){return Oe.prototype.collides.call(this,this.toBBox(u))},l.all=function(){return{type:"FeatureCollection",features:Oe.prototype.all.call(this)}},l.toJSON=function(){return Oe.prototype.toJSON.call(this)},l.fromJSON=function(u){return Oe.prototype.fromJSON.call(this,u)},l.toBBox=function(u){var p;return{minX:(p=u.bbox?u.bbox:Array.isArray(u)&&u.length===4?u:bn(u))[0],minY:p[1],maxX:p[2],maxY:p[3]}},l};function Oi(r){if(!r)throw new Error("coords is required");if(r.type==="Feature"&&r.geometry!==null)return r.geometry.coordinates;if(r.coordinates)return r.coordinates;if(Array.isArray(r))return r;throw new Error("coords must be GeoJSON Feature, Geometry Object or an Array")}var Ae=function(r){if(!r)throw new Error("geojson is required");var l=[];return Ki(r,function(u){(function(p,g){var M=[],S=p.geometry;switch(S.type){case"Polygon":M=Oi(S);break;case"LineString":M=[Oi(S)]}M.forEach(function(D){(function(B,N){var H=[];return B.reduce(function(Y,V){var tt,ut,ct,yt,mt,xt,Lt=_i([Y,V],N);return Lt.bbox=(ut=V,ct=(tt=Y)[0],yt=tt[1],mt=ut[0],xt=ut[1],[ct<mt?ct:mt,yt<xt?yt:xt,ct>mt?ct:mt,yt>xt?yt:xt]),H.push(Lt),V}),H})(D,p.properties).forEach(function(B){B.id=g.length,g.push(B)})})})(u,l)}),be(l)};function Ii(r,l){var u=Oi(r),p=Oi(l);if(u.length!==2)throw new Error("<intersects> line1 must only contain 2 coordinates");if(p.length!==2)throw new Error("<intersects> line2 must only contain 2 coordinates");var g=u[0][0],M=u[0][1],S=u[1][0],D=u[1][1],B=p[0][0],N=p[0][1],H=p[1][0],Y=p[1][1],V=(Y-N)*(S-g)-(H-B)*(D-M),tt=(H-B)*(M-N)-(Y-N)*(g-B),ut=(S-g)*(M-N)-(D-M)*(g-B);if(V===0)return null;var ct=tt/V,yt=ut/V;return ct>=0&&ct<=1&&yt>=0&&yt<=1?Ti([g+ct*(S-g),M+ct*(D-M)]):null}var Or=function(r,l){var u={},p=[];if(r.type==="LineString"&&(r=Ie(r)),l.type==="LineString"&&(l=Ie(l)),r.type==="Feature"&&l.type==="Feature"&&r.geometry.type==="LineString"&&l.geometry.type==="LineString"&&r.geometry.coordinates.length===2&&l.geometry.coordinates.length===2){var g=Ii(r,l);return g&&p.push(g),be(p)}var M=Ft();return M.load(Ae(l)),$i(Ae(r),function(S){$i(M.search(S),function(D){var B=Ii(S,D);if(B){var N=Oi(B).join(",");u[N]||(u[N]=!0,p.push(B))}})}),be(p)},bs=function(r,l,u){if(!yn(u=u||{}))throw new Error("options is invalid");var p=r.geometry?r.geometry.type:r.type;if(p!=="LineString"&&p!=="MultiLineString")throw new Error("lines must be LineString or MultiLineString");var g=Ti([1/0,1/0],{dist:1/0}),M=0;return Ki(r,function(S){for(var D=Oi(S),B=0;B<D.length-1;B++){var N=Ti(D[B]);N.properties.dist=Ue(l,N,u);var H=Ti(D[B+1]);H.properties.dist=Ue(l,H,u);var Y=Ue(N,H,u),V=Math.max(N.properties.dist,H.properties.dist),tt=ie(N,H),ut=gn(l,V,tt+90,u),ct=gn(l,V,tt-90,u),yt=Or(_i([ut.geometry.coordinates,ct.geometry.coordinates]),_i([N.geometry.coordinates,H.geometry.coordinates])),mt=null;yt.features.length>0&&((mt=yt.features[0]).properties.dist=Ue(l,mt,u),mt.properties.location=M+Ue(N,mt,u)),N.properties.dist<g.properties.dist&&((g=N).properties.index=B,g.properties.location=M),H.properties.dist<g.properties.dist&&((g=H).properties.index=B+1,g.properties.location=M+Y),mt&&mt.properties.dist<g.properties.dist&&((g=mt).properties.index=B),M+=Y}}),g};function xn(r,l){var u=[],p=Fn();return Mr(l,function(g){if(u.forEach(function(D,B){D.id=B}),u.length){var M=p.search(g);if(M.features.length){var S=Yn(g,M);u=u.filter(function(D){return D.id!==S.id}),p.remove(S),Re(Xn(S,g),function(D){u.push(D),p.insert(D)})}}else(u=Xn(r,g).features).forEach(function(D){D.bbox||(D.bbox=fn(Si(D)))}),p.load(he(u))}),he(u)}function Xn(r,l){var u=[],p=Ke(r)[0],g=Ke(r)[r.geometry.coordinates.length-1];if(Jn(p,pi(l))||Jn(g,pi(l)))return he([r]);var M=Fn(),S=mi(r);M.load(S);var D=M.search(l);if(!D.features.length)return he([r]);var B=Yn(l,D),N=function(H,Y,V){var tt=V;return Re(H,function(ut,ct){tt=ct===0&&V===void 0?ut:Y(tt,ut,ct)}),tt}(S,function(H,Y,V){var tt=Ke(Y)[1],ut=pi(l);return V===B.id?(H.push(ut),u.push(Mi(H)),Jn(ut,tt)?[ut]:[ut,tt]):(H.push(tt),H)},[p]);return N.length>1&&u.push(Mi(N)),he(u)}function Yn(r,l){if(!l.features.length)throw new Error("lines must contain features");if(l.features.length===1)return l.features[0];var u,p=1/0;return Re(l,function(g){var M=bs(g,r).properties.dist;M<p&&(u=g,p=M)}),u}function Jn(r,l){return r[0]===l[0]&&r[1]===l[1]}var Wn=function(r,l){if(!r)throw new Error("line is required");if(!l)throw new Error("splitter is required");var u=jn(r),p=jn(l);if(u!=="LineString")throw new Error("line must be LineString");if(p==="FeatureCollection")throw new Error("splitter cannot be a FeatureCollection");if(p==="GeometryCollection")throw new Error("splitter cannot be a GeometryCollection");var g=Gn(l,{precision:7});switch(p){case"Point":return Xn(r,g);case"MultiPoint":return xn(r,g);case"LineString":case"MultiLineString":case"Polygon":case"MultiPolygon":return xn(r,Qt(r,g))}},xs=t(67),Ze=t.n(xs),Ls=t(27),Qn=t.n(Ls);function Xi(r){var l={type:"Feature"};return l.geometry=r,l}function Ai(r){return r.type==="Feature"?r.geometry:r}function ri(r){return r.geometry.coordinates}function tr(r){return Xi({type:"Polygon",coordinates:r})}function er(r){return Xi({type:"MultiPolygon",coordinates:r})}function ws(r){r instanceof L.Polyline&&(r=r.toGeoJSON(15));var l=ri(r),u=function g(M){return Array.isArray(M)?1+g(M[0]):-1}(l),p=[];return u>1?l.forEach(function(g){p.push(function(M){return Xi({type:"LineString",coordinates:M})}(g))}):p.push(r),p}function ks(r){var l=[];return r.eachLayer(function(u){l.push(ri(u.toGeoJSON(15)))}),function(u){return Xi({type:"MultiLineString",coordinates:u})}(l)}function ir(r,l){return function(u){if(Array.isArray(u))return u}(r)||function(u,p){if(!(typeof Symbol=="undefined"||!(Symbol.iterator in Object(u)))){var g=[],M=!0,S=!1,D=void 0;try{for(var B,N=u[Symbol.iterator]();!(M=(B=N.next()).done)&&(g.push(B.value),!p||g.length!==p);M=!0);}catch(H){S=!0,D=H}finally{try{M||N.return==null||N.return()}finally{if(S)throw D}}return g}}(r,l)||function(u,p){if(!!u){if(typeof u=="string")return Ir(u,p);var g=Object.prototype.toString.call(u).slice(8,-1);if(g==="Object"&&u.constructor&&(g=u.constructor.name),g==="Map"||g==="Set")return Array.from(u);if(g==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(g))return Ir(u,p)}}(r,l)||function(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}function Ir(r,l){(l==null||l>r.length)&&(l=r.length);for(var u=0,p=new Array(l);u<l;u++)p[u]=r[u];return p}nt.Cut=nt.Polygon.extend({initialize:function(r){this._map=r,this._shape="Cut",this.toolbarButtonName="cutPolygon"},_finishShape:function(){var r=this;if(this._editedLayers=[],this.options.allowSelfIntersection||(this._handleSelfIntersection(!0,this._layer.getLatLngs()[0]),!this._doesSelfIntersect)){var l=this._layer.getLatLngs(),u=L.polygon(l,this.options.pathOptions);u._latlngInfos=this._layer._latlngInfo,this.cut(u),this._cleanupSnapping(),this._otherSnapLayers.splice(this._tempSnapLayerIndex,1),delete this._tempSnapLayerIndex,this._editedLayers.forEach(function(p){var g=p.layer,M=p.originalLayer;r._fireCut(M,g,M),r._fireCut(r._map,g,M),M.pm._fireEdit()}),this._editedLayers=[],this.disable(),this.options.continueDrawing&&this.enable()}},cut:function(r){var l=this,u=this._map._layers,p=r._latlngInfos||[];Object.keys(u).map(function(g){return u[g]}).filter(function(g){return g.pm}).filter(function(g){return!g._pmTempLayer}).filter(function(g){return!L.PM.optIn&&!g.options.pmIgnore||L.PM.optIn&&g.options.pmIgnore===!1}).filter(function(g){return g instanceof L.Polyline}).filter(function(g){return g!==r}).filter(function(g){return g.pm.options.allowCutting}).filter(function(g){return!(l.options.layersToCut&&L.Util.isArray(l.options.layersToCut)&&l.options.layersToCut.length>0)||l.options.layersToCut.indexOf(g)>-1}).filter(function(g){return!l._layerGroup.hasLayer(g)}).filter(function(g){try{var M=!!Xt()(r.toGeoJSON(15),g.toGeoJSON(15)).features.length>0;return M||g instanceof L.Polyline&&!(g instanceof L.Polygon)?M:(S=r.toGeoJSON(15),D=g.toGeoJSON(15),B=Ai(S),N=Ai(D),!((H=Qn.a.intersection(B.coordinates,N.coordinates)).length===0||!(H.length===1?tr(H[0]):er(H))))}catch{return g instanceof L.Polygon&&console.error("You can't cut polygons with self-intersections"),!1}var S,D,B,N,H}).forEach(function(g){var M;if(g instanceof L.Polygon){var S=(M=L.polygon(g.getLatLngs())).getLatLngs();p.forEach(function(V){if(V&&V.snapInfo){var tt=V.latlng,ut=l._calcClosestLayer(tt,[M]);if(ut&&ut.segment&&ut.distance<l.options.snapDistance){var ct=ut.segment;if(ct&&ct.length===2){var yt=L.PM.Utils._getIndexFromSegment(S,ct),mt=yt.indexPath,xt=yt.parentPath,Lt=yt.newIndex;(mt.length>1?rt()(S,xt):S).splice(Lt,0,tt)}}}})}else M=g;var D=l._cutLayer(r,M),B=L.geoJSON(D,g.options);if(B.getLayers().length===1){var N=B.getLayers();B=ir(N,1)[0]}l._setPane(B,"layerPane");var H=B.addTo(l._map.pm._getContainingLayer());if(H.pm.enable(g.pm.options),H.pm.disable(),g._pmTempLayer=!0,r._pmTempLayer=!0,g.remove(),g.removeFrom(l._map.pm._getContainingLayer()),r.remove(),r.removeFrom(l._map.pm._getContainingLayer()),H.getLayers&&H.getLayers().length===0&&l._map.pm.removeLayer({target:H}),H instanceof L.LayerGroup&&H.eachLayer(function(V){l._addDrawnLayerProp(V)}),l._addDrawnLayerProp(H),l.options.layersToCut&&L.Util.isArray(l.options.layersToCut)&&l.options.layersToCut.length>0){var Y=l.options.layersToCut.indexOf(g);Y>-1&&l.options.layersToCut.splice(Y,1)}l._editedLayers.push({layer:H,originalLayer:g})})},_cutLayer:function(r,l){var u,p,g,M,S,D,B=L.geoJSON();if(l instanceof L.Polygon)p=l.toGeoJSON(15),g=r.toGeoJSON(15),M=Ai(p),S=Ai(g),u=(D=Qn.a.difference(M.coordinates,S.coordinates)).length===0?null:D.length===1?tr(D[0]):er(D);else{var N=ws(l);N.forEach(function(H){var Y=Wn(H,r.toGeoJSON(15));(Y&&Y.features.length>0?L.geoJSON(Y):L.geoJSON(H)).getLayers().forEach(function(V){Ze()(r.toGeoJSON(15),V.toGeoJSON(15))||V.addTo(B)})}),u=N.length>1?ks(B):B.toGeoJSON(15)}return u}});var Ar={enableLayerDrag:function(){var r;if(this.options.draggable){this.disable(),this._layerDragEnabled=!0,this._map||(this._map=this._layer._map),(this._layer instanceof L.Marker||this._layer instanceof L.ImageOverlay)&&L.DomEvent.on(this._getDOMElem(),"dragstart",this._stopDOMImageDrag),this._layer.dragging&&this._layer.dragging.disable(),this._tempDragCoord=null,((r=this._layer._map)===null||r===void 0?void 0:r.options.preferCanvas)?(this._layer.on("mouseout",this.removeDraggingClass,this),this._layer.on("mouseover",this.addDraggingClass,this)):this.addDraggingClass(),this._originalMapDragState=this._layer._map.dragging._enabled,this._safeToCacheDragState=!0;var l=this._layer instanceof L.Marker?this._layer._icon:this._layer._path;l&&L.DomEvent.on(l,"touchstart mousedown",this._simulateMouseDownEvent,this)}},disableLayerDrag:function(){var r;this._layerDragEnabled=!1,((r=this._layer._map)===null||r===void 0?void 0:r.options.preferCanvas)?(this._layer.off("mouseout",this.removeDraggingClass,this),this._layer.off("mouseover",this.addDraggingClass,this)):this.removeDraggingClass(),this._safeToCacheDragState=!1,this._layer.dragging&&this._layer.dragging.disable();var l=this._layer instanceof L.Marker?this._layer._icon:this._layer._path;l&&L.DomEvent.off(l,"touchstart mousedown",this._simulateMouseDownEvent,this)},dragging:function(){return this._dragging},layerDragEnabled:function(){return!!this._layerDragEnabled},_simulateMouseDownEvent:function(r){var l={originalEvent:r,target:this._layer};return l.containerPoint=this._map.mouseEventToContainerPoint(r),l.latlng=this._map.containerPointToLatLng(l.containerPoint),this._dragMixinOnMouseDown(l),!1},_simulateMouseMoveEvent:function(r){var l={originalEvent:r,target:this._layer};return l.containerPoint=this._map.mouseEventToContainerPoint(r),l.latlng=this._map.containerPointToLatLng(l.containerPoint),this._dragMixinOnMouseMove(l),!1},_simulateMouseUpEvent:function(r){var l={originalEvent:r,target:this._layer};return l.containerPoint=this._map.mouseEventToContainerPoint(r),l.latlng=this._map.containerPointToLatLng(l.containerPoint),this._dragMixinOnMouseUp(l),!1},_dragMixinOnMouseDown:function(r){if(!(r.originalEvent.button>0)){this._overwriteEventIfItComesFromMarker(r);var l=r._fromLayerSync,u=this._syncLayers("_dragMixinOnMouseDown",r);this._layer instanceof L.Marker&&(!this.options.snappable||l||u?this._disableSnapping():this._initSnappableMarkers()),this._layer instanceof L.CircleMarker&&!(this._layer instanceof L.Circle)&&(!this.options.snappable||l||u?this._layer.pm.options.editable?this._layer.pm._disableSnapping():this._layer.pm._disableSnappingDrag():this._layer.pm.options.editable||this._initSnappableMarkersDrag()),this._safeToCacheDragState&&(this._originalMapDragState=this._layer._map.dragging._enabled,this._safeToCacheDragState=!1),this._tempDragCoord=r.latlng,L.DomEvent.on(this._map.getContainer(),"touchend mouseup",this._simulateMouseUpEvent,this),L.DomEvent.on(this._map.getContainer(),"touchmove mousemove",this._simulateMouseMoveEvent,this)}},_dragMixinOnMouseMove:function(r){this._overwriteEventIfItComesFromMarker(r);var l=this._getDOMElem();this._syncLayers("_dragMixinOnMouseMove",r),this._dragging||(this._dragging=!0,L.DomUtil.addClass(l,"leaflet-pm-dragging"),this._layer instanceof L.Marker||this._layer.bringToFront(),this._originalMapDragState&&this._layer._map.dragging.disable(),this._fireDragStart()),this._onLayerDrag(r),this._layer instanceof L.CircleMarker&&this._layer.pm._updateHiddenPolyCircle()},_dragMixinOnMouseUp:function(r){var l=this,u=this._getDOMElem();return this._syncLayers("_dragMixinOnMouseUp",r),this._originalMapDragState&&this._layer._map.dragging.enable(),this._safeToCacheDragState=!0,L.DomEvent.off(this._map.getContainer(),"touchmove mousemove",this._simulateMouseMoveEvent,this),L.DomEvent.off(this._map.getContainer(),"touchend mouseup",this._simulateMouseUpEvent,this),!!this._dragging&&(this._layer instanceof L.CircleMarker&&this._layer.pm._updateHiddenPolyCircle(),window.setTimeout(function(){l._dragging=!1,L.DomUtil.removeClass(u,"leaflet-pm-dragging"),l._fireDragEnd(),l._fireEdit(),l._layerEdited=!0},10),!0)},_onLayerDrag:function(r){var l=r.latlng,u=l.lat-this._tempDragCoord.lat,p=l.lng-this._tempDragCoord.lng,g=function H(Y){return Y.map(function(V){return Array.isArray(V)?H(V):{lat:V.lat+u,lng:V.lng+p}})};if(this._layer instanceof L.Circle||this._layer instanceof L.CircleMarker&&this._layer.options.editable){var M=g([this._layer.getLatLng()]);this._layer.setLatLng(M[0])}else if(this._layer instanceof L.CircleMarker||this._layer instanceof L.Marker){var S=this._layer.getLatLng();this._layer._snapped&&(S=this._layer._orgLatLng);var D=g([S]);this._layer.setLatLng(D[0])}else if(this._layer instanceof L.ImageOverlay){var B=g([this._layer.getBounds().getNorthWest(),this._layer.getBounds().getSouthEast()]);this._layer.setBounds(B)}else{var N=g(this._layer.getLatLngs());this._layer.setLatLngs(N)}this._tempDragCoord=l,r.layer=this._layer,this._fireDrag(r)},addDraggingClass:function(){var r=this._getDOMElem();r&&L.DomUtil.addClass(r,"leaflet-pm-draggable")},removeDraggingClass:function(){var r=this._getDOMElem();r&&L.DomUtil.removeClass(r,"leaflet-pm-draggable")},_getDOMElem:function(){var r=null;return this._layer._path?r=this._layer._path:this._layer._renderer&&this._layer._renderer._container?r=this._layer._renderer._container:this._layer._image?r=this._layer._image:this._layer._icon&&(r=this._layer._icon),r},_overwriteEventIfItComesFromMarker:function(r){r.target.getLatLng&&(!r.target._radius||r.target._radius<=10)&&(r.containerPoint=this._map.mouseEventToContainerPoint(r.originalEvent),r.latlng=this._map.containerPointToLatLng(r.containerPoint))},_syncLayers:function(r,l){var u=this;if(this.enabled())return!1;if(!l._fromLayerSync&&this._layer===l.target&&this.options.syncLayersOnDrag){l._fromLayerSync=!0;var p=[];if(L.Util.isArray(this.options.syncLayersOnDrag))p=this.options.syncLayersOnDrag,this.options.syncLayersOnDrag.forEach(function(S){S instanceof L.LayerGroup&&(p=p.concat(S.pm.getLayers(!0)))});else if(this.options.syncLayersOnDrag===!0&&this._parentLayerGroup)for(var g in this._parentLayerGroup){var M=this._parentLayerGroup[g];M.pm&&(p=M.pm.getLayers(!0))}return L.Util.isArray(p)&&p.length>0&&(p=p.filter(function(S){return!!S.pm}).filter(function(S){return!!S.pm.options.draggable})).forEach(function(S){S!==u._layer&&S.pm[r]&&(S._snapped=!1,S.pm[r](l))}),p.length>0}return!1},_stopDOMImageDrag:function(r){return r.preventDefault(),!1}};function yi(r,l){l instanceof L.Layer&&(l=l.getLatLng());var u=r.getMaxZoom();return u===1/0&&(u=r.getZoom()),r.project(l,u)}function vi(r,l){var u=r.getMaxZoom();return u===1/0&&(u=r.getZoom()),r.unproject(l,u)}var bi={_onRotateStart:function(r){this._preventRenderingMarkers(!0),this._rotationOriginLatLng=this._getRotationCenter().clone(),this._rotationOriginPoint=yi(this._map,this._rotationOriginLatLng),this._rotationStartPoint=yi(this._map,r.target.getLatLng()),this._initialRotateLatLng=$t(this._layer),this._startAngle=this.getAngle();var l=$t(this._rotationLayer,this._rotationLayer.pm._rotateOrgLatLng);this._fireRotationStart(this._rotationLayer,l),this._fireRotationStart(this._map,l)},_onRotate:function(r){var l=yi(this._map,r.target.getLatLng()),u=this._rotationStartPoint,p=this._rotationOriginPoint,g=Math.atan2(l.y-p.y,l.x-p.x)-Math.atan2(u.y-p.y,u.x-p.x);this._layer.setLatLngs(this._rotateLayer(g,this._initialRotateLatLng,this._rotationOriginLatLng,L.PM.Matrix.init(),this._map));var M=this;(function N(H){var Y=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],V=arguments.length>2&&arguments[2]!==void 0?arguments[2]:-1;if(V>-1&&Y.push(V),L.Util.isArray(H[0]))H.forEach(function(ut,ct){return N(ut,Y.slice(),ct)});else{var tt=rt()(M._markers,Y);H.forEach(function(ut,ct){tt[ct].setLatLng(ut)})}})(this._layer.getLatLngs());var S=$t(this._rotationLayer);this._rotationLayer.setLatLngs(this._rotateLayer(g,this._rotationLayer.pm._rotateOrgLatLng,this._rotationOriginLatLng,L.PM.Matrix.init(),this._map));var D=180*g/Math.PI,B=(D=D<0?D+360:D)+this._startAngle;this._setAngle(B),this._rotationLayer.pm._setAngle(B),this._fireRotation(this._rotationLayer,D,S),this._fireRotation(this._map,D,S)},_onRotateEnd:function(){var r=this._startAngle;delete this._rotationOriginLatLng,delete this._rotationOriginPoint,delete this._rotationStartPoint,delete this._initialRotateLatLng,delete this._startAngle;var l=$t(this._rotationLayer,this._rotationLayer.pm._rotateOrgLatLng);this._rotationLayer.pm._rotateOrgLatLng=$t(this._rotationLayer),this._fireRotationEnd(this._rotationLayer,r,l),this._fireRotationEnd(this._map,r,l),this._rotationLayer.pm._fireEdit(this._rotationLayer,"Rotation"),this._preventRenderingMarkers(!1)},_rotateLayer:function(r,l,u,p,g){var M=yi(g,u);return this._matrix=p.clone().rotate(r,M).flip(),function S(D,B,N){var H=N.getMaxZoom();if(H===1/0&&(H=N.getZoom()),L.Util.isArray(D)){var Y=[];return D.forEach(function(V){Y.push(S(V,B,N))}),Y}return D instanceof L.LatLng?function(V,tt,ut,ct){return ut.unproject(tt.transform(ut.project(V,ct)),ct)}(D,B,N,H):null}(l,this._matrix,g)},_setAngle:function(r){r=r<0?r+360:r,this._angle=r%360},_getRotationCenter:function(){var r=L.polygon(this._layer.getLatLngs(),{stroke:!1,fill:!1,pmIgnore:!0}).addTo(this._layer._map),l=r.getCenter();return r.removeFrom(this._layer._map),l},enableRotate:function(){this.options.allowRotation?(this._rotatePoly=L.polygon(this._layer.getLatLngs(),{fill:!1,stroke:!1,pmIgnore:!1,snapIgnore:!0}).addTo(this._layer._map),this._rotatePoly.pm._setAngle(this.getAngle()),this._rotatePoly.pm.setOptions(this._layer._map.pm.getGlobalOptions()),this._rotatePoly.pm.setOptions({rotate:!0,snappable:!1,hideMiddleMarkers:!0}),this._rotatePoly.pm._rotationLayer=this._layer,this._rotatePoly.pm.enable(),this._rotateOrgLatLng=$t(this._layer),this._rotateEnabled=!0,this._layer.on("remove",this.disableRotate,this),this._fireRotationEnable(this._layer),this._fireRotationEnable(this._layer._map)):this.disableRotate()},disableRotate:function(){this.rotateEnabled()&&(this._rotatePoly.pm.disable(),this._rotatePoly.remove(),this._rotatePoly.pm.setOptions({rotate:!1}),this._rotatePoly=void 0,this._rotateOrgLatLng=void 0,this._layer.off("remove",this.disableRotate,this),this._rotateEnabled=!1,this._fireRotationDisable(this._layer),this._fireRotationDisable(this._layer._map))},rotateEnabled:function(){return this._rotateEnabled},rotateLayer:function(r){var l=r*(Math.PI/180);this._layer.setLatLngs(this._rotateLayer(l,this._layer.getLatLngs(),this._getRotationCenter(),L.PM.Matrix.init(),this._layer._map)),this._rotateOrgLatLng=L.polygon(this._layer.getLatLngs()).getLatLngs(),this._setAngle(this.getAngle()+r),this.rotateEnabled()&&this._rotatePoly&&this._rotatePoly.pm.enabled()&&(this._rotatePoly.setLatLngs(this._rotateLayer(l,this._rotatePoly.getLatLngs(),this._getRotationCenter(),L.PM.Matrix.init(),this._rotatePoly._map)),this._rotatePoly.pm._initMarkers())},rotateLayerToAngle:function(r){var l=r-this.getAngle();this.rotateLayer(l)},getAngle:function(){return this._angle||0}},de=L.Class.extend({includes:[Ar,st,bi,gt],options:{snappable:!0,snapDistance:20,allowSelfIntersection:!0,allowSelfIntersectionEdit:!1,preventMarkerRemoval:!1,removeLayerBelowMinVertexCount:!0,limitMarkersToCount:-1,hideMiddleMarkers:!1,snapSegment:!0,syncLayersOnDrag:!1,draggable:!0,allowEditing:!0,allowRemoval:!0,allowCutting:!0,allowRotation:!0,addVertexOn:"click",removeVertexOn:"contextmenu",removeVertexValidation:void 0,addVertexValidation:void 0,moveVertexValidation:void 0},setOptions:function(r){L.Util.setOptions(this,r)},getOptions:function(){return this.options},applyOptions:function(){},isPolygon:function(){return this._layer instanceof L.Polygon},getShape:function(){return this._shape},_setPane:function(r,l){l==="layerPane"?r.options.pane=this._map.pm.globalOptions.panes&&this._map.pm.globalOptions.panes.layerPane||"overlayPane":l==="vertexPane"?r.options.pane=this._map.pm.globalOptions.panes&&this._map.pm.globalOptions.panes.vertexPane||"markerPane":l==="markerPane"&&(r.options.pane=this._map.pm.globalOptions.panes&&this._map.pm.globalOptions.panes.markerPane||"markerPane")},remove:function(){(this._map||this._layer._map).pm.removeLayer({target:this._layer})},_vertexValidation:function(r,l){var u=l.target,p={layer:this._layer,marker:u,event:l},g="";return r==="move"?g="moveVertexValidation":r==="add"?g="addVertexValidation":r==="remove"&&(g="removeVertexValidation"),this.options[g]&&typeof this.options[g]=="function"&&!this.options[g](p)?(r==="move"&&(u._cancelDragEventChain=u.getLatLng()),!1):(u._cancelDragEventChain=null,!0)},_vertexValidationDrag:function(r){return!r._cancelDragEventChain||(r._latlng=r._cancelDragEventChain,r.update(),!1)},_vertexValidationDragEnd:function(r){return!r._cancelDragEventChain||(r._cancelDragEventChain=null,!1)}});function si(r){return function(l){if(Array.isArray(l))return ze(l)}(r)||function(l){if(typeof Symbol!="undefined"&&Symbol.iterator in Object(l))return Array.from(l)}(r)||function(l,u){if(!!l){if(typeof l=="string")return ze(l,u);var p=Object.prototype.toString.call(l).slice(8,-1);if(p==="Object"&&l.constructor&&(p=l.constructor.name),p==="Map"||p==="Set")return Array.from(l);if(p==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(p))return ze(l,u)}}(r)||function(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}function ze(r,l){(l==null||l>r.length)&&(l=r.length);for(var u=0,p=new Array(l);u<l;u++)p[u]=r[u];return p}de.LayerGroup=L.Class.extend({initialize:function(r){var l=this;this._layerGroup=r,this._layers=this.getLayers(),this._getMap(),this._layers.forEach(function(u){return l._initLayer(u)}),this._layerGroup.on("layeradd",L.Util.throttle(function(u){if(!u.layer._pmTempLayer){l._layers=l.getLayers();var p=l._layers.filter(function(g){return!g.pm._parentLayerGroup||!(l._layerGroup._leaflet_id in g.pm._parentLayerGroup)});p.forEach(function(g){l._initLayer(g)}),p.length>0&&l._getMap()&&l._getMap().pm.globalEditModeEnabled()&&l.enabled()&&l.enable(l.getOptions())}},100,this),this),this._layerGroup.on("layerremove",function(u){l._removeLayerFromGroup(u.target)},this),this._layerGroup.on("layerremove",L.Util.throttle(function(u){u.target._pmTempLayer||(l._layers=l.getLayers())},100,this),this)},enable:function(r){var l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];l.length===0&&(this._layers=this.getLayers()),this._options=r,this._layers.forEach(function(u){u instanceof L.LayerGroup?l.indexOf(u._leaflet_id)===-1&&(l.push(u._leaflet_id),u.pm.enable(r,l)):u.pm.enable(r)})},disable:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];r.length===0&&(this._layers=this.getLayers()),this._layers.forEach(function(l){l instanceof L.LayerGroup?r.indexOf(l._leaflet_id)===-1&&(r.push(l._leaflet_id),l.pm.disable(r)):l.pm.disable()})},enabled:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];r.length===0&&(this._layers=this.getLayers());var l=this._layers.find(function(u){return u instanceof L.LayerGroup?r.indexOf(u._leaflet_id)===-1&&(r.push(u._leaflet_id),u.pm.enabled(r)):u.pm.enabled()});return!!l},toggleEdit:function(r){var l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];l.length===0&&(this._layers=this.getLayers()),this._options=r,this._layers.forEach(function(u){u instanceof L.LayerGroup?l.indexOf(u._leaflet_id)===-1&&(l.push(u._leaflet_id),u.pm.toggleEdit(r,l)):u.pm.toggleEdit(r)})},_initLayer:function(r){var l=L.Util.stamp(this._layerGroup);r.pm._parentLayerGroup||(r.pm._parentLayerGroup={}),r.pm._parentLayerGroup[l]=this._layerGroup},_removeLayerFromGroup:function(r){if(r.pm&&r.pm._layerGroup){var l=L.Util.stamp(this._layerGroup);delete r.pm._layerGroup[l]}},dragging:function(){if(this._layers=this.getLayers(),this._layers){var r=this._layers.find(function(l){return l.pm.dragging()});return!!r}return!1},getOptions:function(){return this.options},_getMap:function(){var r;return this._map||((r=this._layers.find(function(l){return!!l._map}))===null||r===void 0?void 0:r._map)||null},getLayers:function(){var r=arguments.length>0&&arguments[0]!==void 0&&arguments[0],l=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1],u=!(arguments.length>2&&arguments[2]!==void 0)||arguments[2],p=arguments.length>3&&arguments[3]!==void 0?arguments[3]:[],g=[];return r?this._layerGroup.getLayers().forEach(function(M){g.push(M),M instanceof L.LayerGroup&&p.indexOf(M._leaflet_id)===-1&&(p.push(M._leaflet_id),g=g.concat(M.pm.getLayers(!0,!0,!0,p)))}):g=this._layerGroup.getLayers(),u&&(g=g.filter(function(M){return!(M instanceof L.LayerGroup)})),l&&(g=(g=(g=g.filter(function(M){return!!M.pm})).filter(function(M){return!M._pmTempLayer})).filter(function(M){return!L.PM.optIn&&!M.options.pmIgnore||L.PM.optIn&&M.options.pmIgnore===!1})),g},setOptions:function(r){var l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];l.length===0&&(this._layers=this.getLayers()),this.options=r,this._layers.forEach(function(u){u.pm&&(u instanceof L.LayerGroup?l.indexOf(u._leaflet_id)===-1&&(l.push(u._leaflet_id),u.pm.setOptions(r,l)):u.pm.setOptions(r))})}}),de.Marker=de.extend({_shape:"Marker",initialize:function(r){this._layer=r,this._enabled=!1,this._layer.on("dragend",this._onDragEnd,this)},enable:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{draggable:!0};L.Util.setOptions(this,r),this._map=this._layer._map,this.options.allowEditing?this.enabled()||(this.applyOptions(),this._enabled=!0,this._fireEnable()):this.disable()},disable:function(){this._enabled=!1,this.disableLayerDrag(),this._layer.off("contextmenu",this._removeMarker,this),this.enabled()&&(this._layerEdited&&this._fireUpdate(),this._layerEdited=!1,this._fireDisable())},enabled:function(){return this._enabled},toggleEdit:function(r){this.enabled()?this.disable():this.enable(r)},applyOptions:function(){this.options.snappable?this._initSnappableMarkers():this._disableSnapping(),this.options.draggable?this.enableLayerDrag():this.disableLayerDrag(),this.options.preventMarkerRemoval||this._layer.on("contextmenu",this._removeMarker,this)},_removeMarker:function(r){var l=r.target;l.remove(),this._fireRemove(l),this._fireRemove(this._map,l)},_onDragEnd:function(){this._fireEdit(),this._layerEdited=!0},_initSnappableMarkers:function(){var r=this._layer;this.options.snapDistance=this.options.snapDistance||30,this.options.snapSegment=this.options.snapSegment===void 0||this.options.snapSegment,r.off("pm:drag",this._handleSnapping,this),r.on("pm:drag",this._handleSnapping,this),r.off("pm:dragend",this._cleanupSnapping,this),r.on("pm:dragend",this._cleanupSnapping,this),r.off("pm:dragstart",this._unsnap,this),r.on("pm:dragstart",this._unsnap,this)},_disableSnapping:function(){var r=this._layer;r.off("pm:drag",this._handleSnapping,this),r.off("pm:dragend",this._cleanupSnapping,this),r.off("pm:dragstart",this._unsnap,this)}});var Br={filterMarkerGroup:function(){this.markerCache=[],this.createCache(),this._layer.on("pm:edit",this.createCache,this),this.applyLimitFilters({}),this._layer.on("pm:disable",this._removeMarkerLimitEvents,this),this.options.limitMarkersToCount>-1&&(this._layer.on("pm:vertexremoved",this._initMarkers,this),this._map.on("mousemove",this.applyLimitFilters,this))},_removeMarkerLimitEvents:function(){this._map.off("mousemove",this.applyLimitFilters,this),this._layer.off("pm:edit",this.createCache,this),this._layer.off("pm:disable",this._removeMarkerLimitEvents,this),this._layer.off("pm:vertexremoved",this._initMarkers,this)},createCache:function(){var r=[].concat(si(this._markerGroup.getLayers()),si(this.markerCache));this.markerCache=r.filter(function(l,u,p){return p.indexOf(l)===u})},renderLimits:function(r){var l=this;this.markerCache.forEach(function(u){r.includes(u)?l._markerGroup.addLayer(u):l._markerGroup.removeLayer(u)})},applyLimitFilters:function(r){var l=r.latlng,u=l===void 0?{lat:0,lng:0}:l;if(!this._preventRenderMarkers){var p=si(this._filterClosestMarkers(u));this.renderLimits(p)}},_filterClosestMarkers:function(r){var l=si(this.markerCache),u=this.options.limitMarkersToCount;return l.sort(function(p,g){return p._latlng.distanceTo(r)-g._latlng.distanceTo(r)}),l.filter(function(p,g){return!(u>-1)||g<u})},_preventRenderMarkers:!1,_preventRenderingMarkers:function(r){this._preventRenderMarkers=!!r}};function Ms(r,l){return function(u){if(Array.isArray(u))return u}(r)||function(u,p){if(!(typeof Symbol=="undefined"||!(Symbol.iterator in Object(u)))){var g=[],M=!0,S=!1,D=void 0;try{for(var B,N=u[Symbol.iterator]();!(M=(B=N.next()).done)&&(g.push(B.value),!p||g.length!==p);M=!0);}catch(H){S=!0,D=H}finally{try{M||N.return==null||N.return()}finally{if(S)throw D}}return g}}(r,l)||function(u,p){if(!!u){if(typeof u=="string")return nr(u,p);var g=Object.prototype.toString.call(u).slice(8,-1);if(g==="Object"&&u.constructor&&(g=u.constructor.name),g==="Map"||g==="Set")return Array.from(u);if(g==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(g))return nr(u,p)}}(r,l)||function(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}function nr(r,l){(l==null||l>r.length)&&(l=r.length);for(var u=0,p=new Array(l);u<l;u++)p[u]=r[u];return p}de.Line=de.extend({includes:[Br],_shape:"Line",initialize:function(r){this._layer=r,this._enabled=!1},enable:function(r){L.Util.setOptions(this,r),this._map=this._layer._map,this._map&&(this.options.allowEditing?(this.enabled()&&this.disable(),this._enabled=!0,this._initMarkers(),this.applyOptions(),this._layer.on("remove",this._onLayerRemove,this),this.options.allowSelfIntersection||this._layer.on("pm:vertexremoved",this._handleSelfIntersectionOnVertexRemoval,this),this.options.allowSelfIntersection?this.cachedColor=void 0:(this._layer.options.color!=="#f00000ff"?(this.cachedColor=this._layer.options.color,this.isRed=!1):this.isRed=!0,this._handleLayerStyle()),this._fireEnable()):this.disable())},disable:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this._layer;if(!this.enabled()||r.pm._dragging)return!1;r.pm._enabled=!1,r.pm._markerGroup.clearLayers(),r.pm._markerGroup.removeFrom(this._map),this._layer.off("remove",this._onLayerRemove,this),this.options.allowSelfIntersection||this._layer.off("pm:vertexremoved",this._handleSelfIntersectionOnVertexRemoval,this);var l=r._path?r._path:this._layer._renderer._container;return L.DomUtil.removeClass(l,"leaflet-pm-draggable"),this.hasSelfIntersection()&&L.DomUtil.removeClass(l,"leaflet-pm-invalid"),this._layerEdited&&this._fireUpdate(),this._layerEdited=!1,this._fireDisable(),!0},enabled:function(){return this._enabled},toggleEdit:function(r){return this.enabled()?this.disable():this.enable(r),this.enabled()},applyOptions:function(){this.options.snappable?this._initSnappableMarkers():this._disableSnapping()},_onLayerRemove:function(r){this.disable(r.target)},_initMarkers:function(){var r=this,l=this._map,u=this._layer.getLatLngs();this._markerGroup&&this._markerGroup.clearLayers(),this._markerGroup=new L.LayerGroup,this._markerGroup._pmTempLayer=!0,this._markers=function p(g){if(Array.isArray(g[0]))return g.map(p,r);var M=g.map(r._createMarker,r);return r.options.hideMiddleMarkers!==!0&&g.map(function(S,D){var B=r.isPolygon()?(D+1)%g.length:D+1;return r._createMiddleMarker(M[D],M[B])}),M}(u),this.filterMarkerGroup(),l.addLayer(this._markerGroup)},_createMarker:function(r){var l=new L.Marker(r,{draggable:!0,icon:L.divIcon({className:"marker-icon"})});return this._setPane(l,"vertexPane"),l._pmTempLayer=!0,this.options.rotate?(l.on("dragstart",this._onRotateStart,this),l.on("drag",this._onRotate,this),l.on("dragend",this._onRotateEnd,this)):(l.on("click",this._onVertexClick,this),l.on("dragstart",this._onMarkerDragStart,this),l.on("move",this._onMarkerDrag,this),l.on("dragend",this._onMarkerDragEnd,this),this.options.preventMarkerRemoval||l.on(this.options.removeVertexOn,this._removeMarker,this)),this._markerGroup.addLayer(l),l},_createMiddleMarker:function(r,l){if(!r||!l)return!1;var u=L.PM.Utils.calcMiddleLatLng(this._map,r.getLatLng(),l.getLatLng()),p=this._createMarker(u),g=L.divIcon({className:"marker-icon marker-icon-middle"});return p.setIcon(g),p.leftM=r,p.rightM=l,r._middleMarkerNext=p,l._middleMarkerPrev=p,p.on(this.options.addVertexOn,this._onMiddleMarkerClick,this),p.on("movestart",this._onMiddleMarkerMoveStart,this),p},_onMiddleMarkerClick:function(r){var l=r.target;if(this._vertexValidation("add",r)){var u=L.divIcon({className:"marker-icon"});l.setIcon(u),this._addMarker(l,l.leftM,l.rightM)}},_onMiddleMarkerMoveStart:function(r){var l=r.target;l.on("moveend",this._onMiddleMarkerMoveEnd,this),this._vertexValidation("add",r)?(l._dragging=!0,this._addMarker(l,l.leftM,l.rightM)):l.on("move",this._onMiddleMarkerMovePrevent,this)},_onMiddleMarkerMovePrevent:function(r){var l=r.target;this._vertexValidationDrag(l)},_onMiddleMarkerMoveEnd:function(r){var l=r.target;if(l.off("move",this._onMiddleMarkerMovePrevent,this),l.off("moveend",this._onMiddleMarkerMoveEnd,this),this._vertexValidationDragEnd(l)){var u=L.divIcon({className:"marker-icon"});l.setIcon(u),setTimeout(function(){delete l._dragging},100)}},_addMarker:function(r,l,u){r.off("movestart",this._onMiddleMarkerMoveStart,this),r.off(this.options.addVertexOn,this._onMiddleMarkerClick,this);var p=r.getLatLng(),g=this._layer._latlngs;delete r.leftM,delete r.rightM;var M=this.findDeepMarkerIndex(this._markers,l),S=M.indexPath,D=M.index,B=M.parentPath,N=S.length>1?rt()(g,B):g,H=S.length>1?rt()(this._markers,B):this._markers;N.splice(D+1,0,p),H.splice(D+1,0,r),this._layer.setLatLngs(g),this.options.hideMiddleMarkers!==!0&&(this._createMiddleMarker(l,r),this._createMiddleMarker(r,u)),this._fireEdit(),this._layerEdited=!0,this._fireVertexAdded(r,this.findDeepMarkerIndex(this._markers,r).indexPath,p),this.options.snappable&&this._initSnappableMarkers()},hasSelfIntersection:function(){return Mt()(this._layer.toGeoJSON(15)).features.length>0},_handleSelfIntersectionOnVertexRemoval:function(){this._handleLayerStyle(!0),this.hasSelfIntersection()&&(this._layer.setLatLngs(this._coordsBeforeEdit),this._coordsBeforeEdit=null,this._initMarkers())},_handleLayerStyle:function(r){var l=this._layer;if(this.hasSelfIntersection()){if(!this.options.allowSelfIntersection&&this.options.allowSelfIntersectionEdit&&this._updateDisabledMarkerStyle(this._markers,!0),this.isRed)return;r?this._flashLayer():(l.setStyle({color:"#f00000ff"}),this.isRed=!0),this._fireIntersect(Mt()(this._layer.toGeoJSON(15)))}else l.setStyle({color:this.cachedColor}),this.isRed=!1,!this.options.allowSelfIntersection&&this.options.allowSelfIntersectionEdit&&this._updateDisabledMarkerStyle(this._markers,!1)},_flashLayer:function(){var r=this;this.cachedColor||(this.cachedColor=this._layer.options.color),this._layer.setStyle({color:"#f00000ff"}),this.isRed=!0,window.setTimeout(function(){r._layer.setStyle({color:r.cachedColor}),r.isRed=!1},200)},_updateDisabledMarkerStyle:function(r,l){var u=this;r.forEach(function(p){if(Array.isArray(p))return u._updateDisabledMarkerStyle(p,l);p._icon&&(l&&!u._checkMarkerAllowedToDrag(p)?L.DomUtil.addClass(p._icon,"vertexmarker-disabled"):L.DomUtil.removeClass(p._icon,"vertexmarker-disabled"))})},_removeMarker:function(r){var l=r.target;if(this._vertexValidation("remove",r)){if(!this.options.allowSelfIntersection){var u=this._layer.getLatLngs();this._coordsBeforeEdit=JSON.parse(JSON.stringify(u))}var p=this._layer.getLatLngs(),g=this.findDeepMarkerIndex(this._markers,l),M=g.indexPath,S=g.index,D=g.parentPath;if(M){var B=M.length>1?rt()(p,D):p,N=M.length>1?rt()(this._markers,D):this._markers;if(this.options.removeLayerBelowMinVertexCount||!(B.length<=2||this.isPolygon()&&B.length<=3)){B.splice(S,1),this._layer.setLatLngs(p),this.isPolygon()&&B.length<=2&&B.splice(0,B.length);var H=!1;if(B.length<=1&&(B.splice(0,B.length),this._layer.setLatLngs(p),this.disable(),this.enable(this.options),H=!0),It(p)&&this._layer.remove(),p=kt(p),this._layer.setLatLngs(p),this._markers=kt(this._markers),!H&&(N=M.length>1?rt()(this._markers,D):this._markers,l._middleMarkerPrev&&this._markerGroup.removeLayer(l._middleMarkerPrev),l._middleMarkerNext&&this._markerGroup.removeLayer(l._middleMarkerNext),this._markerGroup.removeLayer(l),N)){var Y,V;if(this.isPolygon()?(Y=(S+1)%N.length,V=(S+(N.length-1))%N.length):(V=S-1<0?void 0:S-1,Y=S+1>=N.length?void 0:S+1),Y!==V){var tt=N[V],ut=N[Y];this.options.hideMiddleMarkers!==!0&&this._createMiddleMarker(tt,ut)}N.splice(S,1)}this._fireEdit(),this._layerEdited=!0,this._fireVertexRemoved(l,M)}else this._flashLayer()}}},findDeepMarkerIndex:function(r,l){var u;r.some(function g(M){return function(S,D){var B=M.concat(D);return S._leaflet_id===l._leaflet_id?(u=B,!0):Array.isArray(S)&&S.some(g(B))}}([]));var p={};return u&&(p={indexPath:u,index:u[u.length-1],parentPath:u.slice(0,u.length-1)}),p},updatePolygonCoordsFromMarkerDrag:function(r){var l=this._layer.getLatLngs(),u=r.getLatLng(),p=this.findDeepMarkerIndex(this._markers,r),g=p.indexPath,M=p.index,S=p.parentPath;(g.length>1?rt()(l,S):l).splice(M,1,u),this._layer.setLatLngs(l)},_getNeighborMarkers:function(r){var l=this.findDeepMarkerIndex(this._markers,r),u=l.indexPath,p=l.index,g=l.parentPath,M=u.length>1?rt()(this._markers,g):this._markers,S=(p+1)%M.length;return{prevMarker:M[(p+(M.length-1))%M.length],nextMarker:M[S]}},_checkMarkerAllowedToDrag:function(r){var l=this._getNeighborMarkers(r),u=l.prevMarker,p=l.nextMarker,g=L.polyline([u.getLatLng(),r.getLatLng()]),M=L.polyline([r.getLatLng(),p.getLatLng()]),S=Xt()(this._layer.toGeoJSON(15),g.toGeoJSON(15)).features.length,D=Xt()(this._layer.toGeoJSON(15),M.toGeoJSON(15)).features.length;return r.getLatLng()===this._markers[0][0].getLatLng()?D+=1:r.getLatLng()===this._markers[0][this._markers[0].length-1].getLatLng()&&(S+=1),!(S<=2&&D<=2)},_onMarkerDragStart:function(r){var l=r.target;if(this.cachedColor||(this.cachedColor=this._layer.options.color),this._vertexValidation("move",r)){var u=this.findDeepMarkerIndex(this._markers,l).indexPath;this._fireMarkerDragStart(r,u),this.options.allowSelfIntersection||(this._coordsBeforeEdit=this._layer.getLatLngs()),!this.options.allowSelfIntersection&&this.options.allowSelfIntersectionEdit&&this.hasSelfIntersection()?this._markerAllowedToDrag=this._checkMarkerAllowedToDrag(l):this._markerAllowedToDrag=null}},_onMarkerDrag:function(r){var l=r.target;if(this._vertexValidationDrag(l)){var u=this.findDeepMarkerIndex(this._markers,l),p=u.indexPath,g=u.index,M=u.parentPath;if(p){if(!this.options.allowSelfIntersection&&this.options.allowSelfIntersectionEdit&&this.hasSelfIntersection()&&this._markerAllowedToDrag===!1)return this._layer.setLatLngs(this._coordsBeforeEdit),this._initMarkers(),void this._handleLayerStyle();this.updatePolygonCoordsFromMarkerDrag(l);var S=p.length>1?rt()(this._markers,M):this._markers,D=(g+1)%S.length,B=(g+(S.length-1))%S.length,N=l.getLatLng(),H=S[B].getLatLng(),Y=S[D].getLatLng();if(l._middleMarkerNext){var V=L.PM.Utils.calcMiddleLatLng(this._map,N,Y);l._middleMarkerNext.setLatLng(V)}if(l._middleMarkerPrev){var tt=L.PM.Utils.calcMiddleLatLng(this._map,N,H);l._middleMarkerPrev.setLatLng(tt)}this.options.allowSelfIntersection||this._handleLayerStyle(),this._fireMarkerDrag(r,p)}}},_onMarkerDragEnd:function(r){var l=r.target;if(this._vertexValidationDragEnd(l)){var u=this.findDeepMarkerIndex(this._markers,l).indexPath,p=this.hasSelfIntersection();p&&this.options.allowSelfIntersectionEdit&&this._markerAllowedToDrag&&(p=!1);var g=!this.options.allowSelfIntersection&&p;if(this._fireMarkerDragEnd(r,u,g),g)return this._layer.setLatLngs(this._coordsBeforeEdit),this._coordsBeforeEdit=null,this._initMarkers(),this.options.snappable&&this._initSnappableMarkers(),this._handleLayerStyle(),void this._fireLayerReset(r,u);!this.options.allowSelfIntersection&&this.options.allowSelfIntersectionEdit&&this._handleLayerStyle(),this._fireEdit(),this._layerEdited=!0}},_onVertexClick:function(r){var l=r.target;if(!l._dragging){var u=this.findDeepMarkerIndex(this._markers,l).indexPath;this._fireVertexClick(r,u)}}}),de.Polygon=de.Line.extend({_shape:"Polygon",_checkMarkerAllowedToDrag:function(r){var l=this._getNeighborMarkers(r),u=l.prevMarker,p=l.nextMarker,g=L.polyline([u.getLatLng(),r.getLatLng()]),M=L.polyline([r.getLatLng(),p.getLatLng()]),S=Xt()(this._layer.toGeoJSON(15),g.toGeoJSON(15)).features.length,D=Xt()(this._layer.toGeoJSON(15),M.toGeoJSON(15)).features.length;return!(S<=2&&D<=2)}}),de.Rectangle=de.Polygon.extend({_shape:"Rectangle",_initMarkers:function(){var r=this,l=this._map,u=this._findCorners();this._markerGroup&&this._markerGroup.clearLayers(),this._markerGroup=new L.LayerGroup,this._markerGroup._pmTempLayer=!0,l.addLayer(this._markerGroup),this._markers=[],this._markers[0]=u.map(this._createMarker,this);var p=Ms(this._markers,1);this._cornerMarkers=p[0],this._layer.getLatLngs()[0].forEach(function(g,M){var S=r._cornerMarkers.find(function(D){return D._index===M});S&&S.setLatLng(g)})},applyOptions:function(){this.options.snappable?this._initSnappableMarkers():this._disableSnapping(),this._addMarkerEvents()},_createMarker:function(r,l){var u=new L.Marker(r,{draggable:!0,icon:L.divIcon({className:"marker-icon"})});return this._setPane(u,"vertexPane"),u._origLatLng=r,u._index=l,u._pmTempLayer=!0,this._markerGroup.addLayer(u),u},_addMarkerEvents:function(){var r=this;this._markers[0].forEach(function(l){l.on("dragstart",r._onMarkerDragStart,r),l.on("drag",r._onMarkerDrag,r),l.on("dragend",r._onMarkerDragEnd,r),r.options.preventMarkerRemoval||l.on("contextmenu",r._removeMarker,r)})},_removeMarker:function(){return null},_onMarkerDragStart:function(r){if(this._vertexValidation("move",r)){var l=r.target,u=this._cornerMarkers;l._oppositeCornerLatLng=u.find(function(p){return p._index===(l._index+2)%4}).getLatLng(),l._snapped=!1,this._fireMarkerDragStart(r)}},_onMarkerDrag:function(r){var l=r.target;this._vertexValidationDrag(l)&&l._index!==void 0&&(this._adjustRectangleForMarkerMove(l),this._fireMarkerDrag(r))},_onMarkerDragEnd:function(r){var l=r.target;this._vertexValidationDragEnd(l)&&(this._cornerMarkers.forEach(function(u){delete u._oppositeCornerLatLng}),this._fireMarkerDragEnd(r),this._fireEdit(),this._layerEdited=!0)},_adjustRectangleForMarkerMove:function(r){L.extend(r._origLatLng,r._latlng);var l=L.PM.Utils._getRotatedRectangle(r.getLatLng(),r._oppositeCornerLatLng,this._angle||0,this._map);this._layer.setLatLngs(l),this._adjustAllMarkers(),this._layer.redraw()},_adjustAllMarkers:function(){var r=this,l=this._layer.getLatLngs()[0];l&&l.length!==4&&l.length>0?(l.forEach(function(u,p){r._cornerMarkers[p].setLatLng(u)}),this._cornerMarkers.slice(l.length).forEach(function(u){u.setLatLng(l[0])})):l&&l.length?this._cornerMarkers.forEach(function(u){u.setLatLng(l[u._index])}):console.error("The layer has no LatLngs")},_findCorners:function(){this._layer.getBounds();var r=this._layer.getLatLngs()[0];return L.PM.Utils._getRotatedRectangle(r[0],r[2],this._angle||0,this._map)}}),de.Circle=de.extend({_shape:"Circle",initialize:function(r){this._layer=r,this._enabled=!1,this._updateHiddenPolyCircle()},enable:function(r){var l=this;L.Util.setOptions(this,r),this._map=this._layer._map,this.options.allowEditing?(this.enabled()||this.disable(),this._enabled=!0,this._initMarkers(),this.applyOptions(),this._layer.on("remove",function(u){l.disable(u.target)}),this._updateHiddenPolyCircle(),this._fireEnable()):this.disable()},disable:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this._layer;if(!this.enabled()||r.pm._dragging)return!1;this._centerMarker.off("dragstart",this._onCircleDragStart,this),this._centerMarker.off("drag",this._onCircleDrag,this),this._centerMarker.off("dragend",this._onCircleDragEnd,this),this._outerMarker.off("drag",this._handleOuterMarkerSnapping,this),r.pm._enabled=!1,r.pm._helperLayers.clearLayers();var l=r._path?r._path:this._layer._renderer._container;return L.DomUtil.removeClass(l,"leaflet-pm-draggable"),this._layerEdited&&this._fireUpdate(),this._layerEdited=!1,this._fireDisable(),!0},enabled:function(){return this._enabled},toggleEdit:function(r){this.enabled()?this.disable():this.enable(r)},_initMarkers:function(){var r=this._map;this._helperLayers&&this._helperLayers.clearLayers(),this._helperLayers=new L.LayerGroup,this._helperLayers._pmTempLayer=!0,this._helperLayers.addTo(r);var l=this._layer.getLatLng(),u=this._layer._radius,p=this._getLatLngOnCircle(l,u);this._centerMarker=this._createCenterMarker(l),this._outerMarker=this._createOuterMarker(p),this._markers=[this._centerMarker,this._outerMarker],this._createHintLine(this._centerMarker,this._outerMarker)},applyOptions:function(){this.options.snappable?(this._initSnappableMarkers(),this._outerMarker.on("drag",this._handleOuterMarkerSnapping,this),this._outerMarker.on("move",this._syncHintLine,this),this._outerMarker.on("move",this._syncCircleRadius,this),this._centerMarker.on("move",this._moveCircle,this)):this._disableSnapping()},_createHintLine:function(r,l){var u=r.getLatLng(),p=l.getLatLng();this._hintline=L.polyline([u,p],this.options.hintlineStyle),this._setPane(this._hintline,"layerPane"),this._hintline._pmTempLayer=!0,this._helperLayers.addLayer(this._hintline)},_createCenterMarker:function(r){var l=this._createMarker(r);return L.DomUtil.addClass(l._icon,"leaflet-pm-draggable"),l.on("drag",this._moveCircle,this),l.on("dragstart",this._onCircleDragStart,this),l.on("drag",this._onCircleDrag,this),l.on("dragend",this._onCircleDragEnd,this),l},_createOuterMarker:function(r){var l=this._createMarker(r);return l.on("drag",this._resizeCircle,this),l},_createMarker:function(r){var l=new L.Marker(r,{draggable:!0,icon:L.divIcon({className:"marker-icon"})});return this._setPane(l,"vertexPane"),l._origLatLng=r,l._pmTempLayer=!0,l.on("dragstart",this._onMarkerDragStart,this),l.on("drag",this._onMarkerDrag,this),l.on("dragend",this._onMarkerDragEnd,this),this._helperLayers.addLayer(l),l},_resizeCircle:function(){this._outerMarker.setLatLng(this._getNewDestinationOfOuterMarker()),this._syncHintLine(),this._syncCircleRadius()},_moveCircle:function(r){if(!r.target._cancelDragEventChain){var l=r.latlng;this._layer.setLatLng(l);var u=this._layer._radius,p=this._getLatLngOnCircle(l,u);this._outerMarker._latlng=p,this._outerMarker.update(),this._syncHintLine(),this._updateHiddenPolyCircle(),this._fireCenterPlaced("Edit")}},_syncCircleRadius:function(){var r=this._centerMarker.getLatLng(),l=this._outerMarker.getLatLng(),u=this._map.distance(r,l);this.options.minRadiusCircle&&u<this.options.minRadiusCircle?this._layer.setRadius(this.options.minRadiusCircle):this.options.maxRadiusCircle&&u>this.options.maxRadiusCircle?this._layer.setRadius(this.options.maxRadiusCircle):this._layer.setRadius(u),this._updateHiddenPolyCircle()},_syncHintLine:function(){var r=this._centerMarker.getLatLng(),l=this._outerMarker.getLatLng();this._hintline.setLatLngs([r,l])},_disableSnapping:function(){var r=this;this._markers.forEach(function(l){l.off("move",r._syncHintLine,r),l.off("move",r._syncCircleRadius,r),l.off("drag",r._handleSnapping,r),l.off("dragend",r._cleanupSnapping,r)}),this._layer.off("pm:dragstart",this._unsnap,this)},_onMarkerDragStart:function(r){this._vertexValidation("move",r)&&this._fireMarkerDragStart(r)},_onMarkerDrag:function(r){var l=r.target;this._vertexValidationDrag(l)&&this._fireMarkerDrag(r)},_onMarkerDragEnd:function(r){var l=r.target;this._vertexValidationDragEnd(l)&&(this._fireEdit(),this._layerEdited=!0,this._fireMarkerDragEnd(r))},_onCircleDragStart:function(r){this._vertexValidationDrag(r.target)?(delete this._vertexValidationReset,this._fireDragStart(r)):this._vertexValidationReset=!0},_onCircleDrag:function(r){this._vertexValidationReset||this._fireDrag(r)},_onCircleDragEnd:function(){this._vertexValidationReset?delete this._vertexValidationReset:this._fireDragEnd()},_updateHiddenPolyCircle:function(){var r=this._map&&this._map.pm._isCRSSimple();this._hiddenPolyCircle?this._hiddenPolyCircle.setLatLngs(L.PM.Utils.circleToPolygon(this._layer,200,!r).getLatLngs()):this._hiddenPolyCircle=L.PM.Utils.circleToPolygon(this._layer,200,!r),this._hiddenPolyCircle._parentCopy||(this._hiddenPolyCircle._parentCopy=this._layer)},_getLatLngOnCircle:function(r,l){var u=this._map.project(r),p=L.point(u.x+l,u.y);return this._map.unproject(p)},_getNewDestinationOfOuterMarker:function(){var r=this._centerMarker.getLatLng(),l=this._outerMarker.getLatLng(),u=this._map.distance(r,l);return this.options.minRadiusCircle&&u<this.options.minRadiusCircle?l=Kt(this._map,r,l,this.options.minRadiusCircle):this.options.maxRadiusCircle&&u>this.options.maxRadiusCircle&&(l=Kt(this._map,r,l,this.options.maxRadiusCircle)),l},_handleOuterMarkerSnapping:function(){if(this._outerMarker._snapped){var r=this._centerMarker.getLatLng(),l=this._outerMarker.getLatLng(),u=this._map.distance(r,l);(this.options.minRadiusCircle&&u<this.options.minRadiusCircle||this.options.maxRadiusCircle&&u>this.options.maxRadiusCircle)&&this._outerMarker.setLatLng(this._outerMarker._orgLatLng)}this._outerMarker.setLatLng(this._getNewDestinationOfOuterMarker())}}),de.CircleMarker=de.extend({_shape:"CircleMarker",initialize:function(r){this._layer=r,this._enabled=!1,this._updateHiddenPolyCircle()},enable:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{draggable:!0,snappable:!0};L.Util.setOptions(this,r),this._map=this._layer._map,this._map&&(this.options.allowEditing?(this.enabled()&&this.disable(),this.applyOptions(),this._enabled=!0,this._layer.on("pm:dragstart",this._onDragStart,this),this._layer.on("pm:drag",this._onMarkerDrag,this),this._layer.on("pm:dragend",this._onMarkerDragEnd,this),this._updateHiddenPolyCircle(),this._fireEnable()):this.disable())},disable:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this._layer;return!r.pm._dragging&&(r.pm._helperLayers&&r.pm._helperLayers.clearLayers(),this._map||(this._map=this._layer._map),this.options.editable?(this._map.off("move",this._syncMarkers,this),this._outerMarker&&this._outerMarker.on("drag",this._handleOuterMarkerSnapping,this)):this._map.off("move",this._updateHiddenPolyCircle,this),this.disableLayerDrag(),this._layer.off("contextmenu",this._removeMarker,this),this.enabled()&&(this._layerEdited&&this._fireUpdate(),this._layerEdited=!1,this._fireDisable()),r.pm._enabled=!1,!0)},enabled:function(){return this._enabled},toggleEdit:function(r){this.enabled()?this.disable():this.enable(r)},applyOptions:function(){!this.options.editable&&this.options.draggable?this.enableLayerDrag():this.disableLayerDrag(),this.options.editable?(this._initMarkers(),this._map.on("move",this._syncMarkers,this)):this._map.on("move",this._updateHiddenPolyCircle,this),this.options.snappable?this.options.editable?(this._initSnappableMarkers(),this._centerMarker.on("drag",this._moveCircle,this),this.options.editable&&this._outerMarker.on("drag",this._handleOuterMarkerSnapping,this),this._outerMarker.on("move",this._syncHintLine,this),this._outerMarker.on("move",this._syncCircleRadius,this)):this._initSnappableMarkersDrag():this.options.editable?this._disableSnapping():this._disableSnappingDrag(),this.options.preventMarkerRemoval||this._layer.on("contextmenu",this._removeMarker,this)},_initMarkers:function(){var r=this._map;this._helperLayers&&this._helperLayers.clearLayers(),this._helperLayers=new L.LayerGroup,this._helperLayers._pmTempLayer=!0,this._helperLayers.addTo(r);var l=this._layer.getLatLng(),u=this._layer._radius,p=this._getLatLngOnCircle(l,u);this._centerMarker=this._createCenterMarker(l),this._outerMarker=this._createOuterMarker(p),this._markers=[this._centerMarker,this._outerMarker],this._createHintLine(this._centerMarker,this._outerMarker)},_getLatLngOnCircle:function(r,l){var u=this._map.project(r),p=L.point(u.x+l,u.y);return this._map.unproject(p)},_createHintLine:function(r,l){var u=r.getLatLng(),p=l.getLatLng();this._hintline=L.polyline([u,p],this.options.hintlineStyle),this._setPane(this._hintline,"layerPane"),this._hintline._pmTempLayer=!0,this._helperLayers.addLayer(this._hintline)},_createCenterMarker:function(r){var l=this._createMarker(r);return this.options.draggable?L.DomUtil.addClass(l._icon,"leaflet-pm-draggable"):l.dragging.disable(),l},_createOuterMarker:function(r){var l=this._createMarker(r);return l.on("drag",this._resizeCircle,this),l},_createMarker:function(r){var l=new L.Marker(r,{draggable:!0,icon:L.divIcon({className:"marker-icon"})});return this._setPane(l,"vertexPane"),l._origLatLng=r,l._pmTempLayer=!0,l.on("dragstart",this._onMarkerDragStart,this),l.on("drag",this._onMarkerDrag,this),l.on("dragend",this._onMarkerDragEnd,this),this._helperLayers.addLayer(l),l},_moveCircle:function(){var r=this._centerMarker.getLatLng();this._layer.setLatLng(r);var l=this._layer._radius,u=this._getLatLngOnCircle(r,l);this._outerMarker._latlng=u,this._outerMarker.update(),this._syncHintLine(),this._updateHiddenPolyCircle(),this._fireCenterPlaced("Edit")},_syncMarkers:function(){var r=this._layer.getLatLng(),l=this._layer._radius,u=this._getLatLngOnCircle(r,l);this._outerMarker.setLatLng(u),this._centerMarker.setLatLng(r),this._syncHintLine(),this._updateHiddenPolyCircle()},_resizeCircle:function(){this._outerMarker.setLatLng(this._getNewDestinationOfOuterMarker()),this._syncHintLine(),this._syncCircleRadius()},_syncCircleRadius:function(){var r=this._centerMarker.getLatLng(),l=this._outerMarker.getLatLng(),u=this._map.project(r).distanceTo(this._map.project(l));this.options.minRadiusCircleMarker&&u<this.options.minRadiusCircleMarker?this._layer.setRadius(this.options.minRadiusCircleMarker):this.options.maxRadiusCircleMarker&&u>this.options.maxRadiusCircleMarker?this._layer.setRadius(this.options.maxRadiusCircleMarker):this._layer.setRadius(u),this._updateHiddenPolyCircle()},_syncHintLine:function(){var r=this._centerMarker.getLatLng(),l=this._outerMarker.getLatLng();this._hintline.setLatLngs([r,l])},_removeMarker:function(){this.options.editable&&this.disable(),this._layer.remove(),this._fireRemove(this._layer),this._fireRemove(this._map,this._layer)},_onDragStart:function(r){this._map.pm.Draw.CircleMarker._layerIsDragging=!0,this._vertexValidation("move",r)},_onMarkerDragStart:function(r){this._vertexValidation("move",r)&&this._fireMarkerDragStart(r)},_onMarkerDrag:function(r){var l=r.target;l instanceof L.Marker&&!this._vertexValidationDrag(l)||this._fireMarkerDrag(r)},_onMarkerDragEnd:function(r){this._map.pm.Draw.CircleMarker._layerIsDragging=!1;var l=r.target;this._vertexValidationDragEnd(l)&&(this.options.editable&&(this._fireEdit(),this._layerEdited=!0),this._fireMarkerDragEnd(r))},_initSnappableMarkersDrag:function(){var r=this._layer;this.options.snapDistance=this.options.snapDistance||30,this.options.snapSegment=this.options.snapSegment===void 0||this.options.snapSegment,r.off("pm:drag",this._handleSnapping,this),r.on("pm:drag",this._handleSnapping,this),r.off("pm:dragend",this._cleanupSnapping,this),r.on("pm:dragend",this._cleanupSnapping,this),r.off("pm:dragstart",this._unsnap,this),r.on("pm:dragstart",this._unsnap,this)},_disableSnappingDrag:function(){var r=this._layer;r.off("pm:drag",this._handleSnapping,this),r.off("pm:dragend",this._cleanupSnapping,this),r.off("pm:dragstart",this._unsnap,this)},_updateHiddenPolyCircle:function(){var r=this._layer._map||this._map;if(r){var l=L.PM.Utils.pxRadiusToMeterRadius(this._layer.getRadius(),r,this._layer.getLatLng()),u=L.circle(this._layer.getLatLng(),this._layer.options);u.setRadius(l);var p=r&&r.pm._isCRSSimple();this._hiddenPolyCircle?this._hiddenPolyCircle.setLatLngs(L.PM.Utils.circleToPolygon(u,200,!p).getLatLngs()):this._hiddenPolyCircle=L.PM.Utils.circleToPolygon(u,200,!p),this._hiddenPolyCircle._parentCopy||(this._hiddenPolyCircle._parentCopy=this._layer)}},_getNewDestinationOfOuterMarker:function(){var r=this._centerMarker.getLatLng(),l=this._outerMarker.getLatLng(),u=this._map.project(r).distanceTo(this._map.project(l));return this.options.minRadiusCircleMarker&&u<this.options.minRadiusCircleMarker?l=Kt(this._map,r,l,L.PM.Utils.pxRadiusToMeterRadius(this.options.minRadiusCircleMarker,this._map,r)):this.options.maxRadiusCircleMarker&&u>this.options.maxRadiusCircleMarker&&(l=Kt(this._map,r,l,L.PM.Utils.pxRadiusToMeterRadius(this.options.maxRadiusCircleMarker,this._map,r))),l},_handleOuterMarkerSnapping:function(){if(this._outerMarker._snapped){var r=this._centerMarker.getLatLng(),l=this._outerMarker.getLatLng(),u=this._map.project(r).distanceTo(this._map.project(l));(this.options.minRadiusCircleMarker&&u<this.options.minRadiusCircleMarker||this.options.maxRadiusCircleMarker&&u>this.options.maxRadiusCircleMarker)&&this._outerMarker.setLatLng(this._outerMarker._orgLatLng)}this._outerMarker.setLatLng(this._getNewDestinationOfOuterMarker())}}),de.ImageOverlay=de.extend({_shape:"ImageOverlay",initialize:function(r){this._layer=r,this._enabled=!1},toggleEdit:function(r){this.enabled()?this.disable():this.enable(r)},enabled:function(){return this._enabled},enable:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{draggable:!0,snappable:!0};L.Util.setOptions(this,r),this._map=this._layer._map,this._map&&(this.options.allowEditing?(this.enabled()||this.disable(),this.enableLayerDrag(),this._enabled=!0,this._otherSnapLayers=this._findCorners(),this._fireEnable()):this.disable())},disable:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this._layer;return!r.pm._dragging&&(this._map||(this._map=this._layer._map),this.disableLayerDrag(),this.enabled()||(this._layerEdited&&this._fireUpdate(),this._layerEdited=!1,this._fireDisable()),r.pm._enabled=!1,!0)},_findCorners:function(){var r=this._layer.getBounds();return[r.getNorthWest(),r.getNorthEast(),r.getSouthEast(),r.getSouthWest()]}}),t(153),t(154);var rr=function(r,l,u,p,g,M){this._matrix=[r,l,u,p,g,M]};rr.init=function(){return new L.PM.Matrix(1,0,0,1,0,0)},rr.prototype={transform:function(r){return this._transform(r.clone())},_transform:function(r){var l=this._matrix,u=r.x,p=r.y;return r.x=l[0]*u+l[1]*p+l[4],r.y=l[2]*u+l[3]*p+l[5],r},untransform:function(r){var l=this._matrix;return new L.Point((r.x/l[0]-l[4])/l[0],(r.y/l[2]-l[5])/l[2])},clone:function(){var r=this._matrix;return new L.PM.Matrix(r[0],r[1],r[2],r[3],r[4],r[5])},translate:function(r){return r===void 0?new L.Point(this._matrix[4],this._matrix[5]):(typeof r=="number"?(l=r,u=r):(l=r.x,u=r.y),this._add(1,0,0,1,l,u));var l,u},scale:function(r,l){return r===void 0?new L.Point(this._matrix[0],this._matrix[3]):(l=l||L.point(0,0),typeof r=="number"?(u=r,p=r):(u=r.x,p=r.y),this._add(u,0,0,p,l.x,l.y)._add(1,0,0,1,-l.x,-l.y));var u,p},rotate:function(r,l){var u=Math.cos(r),p=Math.sin(r);return l=l||new L.Point(0,0),this._add(u,p,-p,u,l.x,l.y)._add(1,0,0,1,-l.x,-l.y)},flip:function(){return this._matrix[1]*=-1,this._matrix[2]*=-1,this},_add:function(r,l,u,p,g,M){var S,D=[[],[],[]],B=this._matrix,N=[[B[0],B[2],B[4]],[B[1],B[3],B[5]],[0,0,1]],H=[[r,u,g],[l,p,M],[0,0,1]];r&&r instanceof L.PM.Matrix&&(H=[[(B=r._matrix)[0],B[2],B[4]],[B[1],B[3],B[5]],[0,0,1]]);for(var Y=0;Y<3;Y+=1)for(var V=0;V<3;V+=1){S=0;for(var tt=0;tt<3;tt+=1)S+=N[Y][tt]*H[tt][V];D[Y][V]=S}return this._matrix=[D[0][0],D[1][0],D[0][1],D[1][1],D[0][2],D[1][2]],this}};var sr=rr,or={calcMiddleLatLng:function(r,l,u){var p=r.project(l),g=r.project(u);return r.unproject(p._add(g)._divideBy(2))},findLayers:function(r){var l=[];return r.eachLayer(function(u){(u instanceof L.Polyline||u instanceof L.Marker||u instanceof L.Circle||u instanceof L.CircleMarker||u instanceof L.ImageOverlay)&&l.push(u)}),l=(l=(l=l.filter(function(u){return!!u.pm})).filter(function(u){return!u._pmTempLayer})).filter(function(u){return!L.PM.optIn&&!u.options.pmIgnore||L.PM.optIn&&u.options.pmIgnore===!1})},circleToPolygon:function(r){for(var l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:60,u=!(arguments.length>2&&arguments[2]!==void 0)||arguments[2],p=r.getLatLng(),g=r.getRadius(),M=se(p,g,l,0,u),S=[],D=0;D<M.length;D+=1){var B=[M[D].lat,M[D].lng];S.push(B)}return L.polygon(S,r.options)},disablePopup:function(r){r.getPopup()&&(r._tempPopupCopy=r.getPopup(),r.unbindPopup())},enablePopup:function(r){r._tempPopupCopy&&(r.bindPopup(r._tempPopupCopy),delete r._tempPopupCopy)},_fireEvent:function(r,l,u){var p=arguments.length>3&&arguments[3]!==void 0&&arguments[3];r.fire(l,u,p);var g=this.getAllParentGroups(r),M=g.groups;M.forEach(function(S){S.fire(l,u,p)})},getAllParentGroups:function(r){var l=[],u=[];return!r._pmLastGroupFetch||!r._pmLastGroupFetch.time||new Date().getTime()-r._pmLastGroupFetch.time>1e3?(function p(g){for(var M in g._eventParents)if(l.indexOf(M)===-1){l.push(M);var S=g._eventParents[M];u.push(S),p(S)}}(r),r._pmLastGroupFetch={time:new Date().getTime(),groups:u,groupIds:l},{groupIds:l,groups:u}):{groups:r._pmLastGroupFetch.groups,groupIds:r._pmLastGroupFetch.groupIds}},createGeodesicPolygon:se,getTranslation:ot,findDeepCoordIndex:function(r,l){var u;r.some(function g(M){return function(S,D){var B=M.concat(D);return S.lat&&S.lat===l.lat&&S.lng===l.lng?(u=B,!0):Array.isArray(S)&&S.some(g(B))}}([]));var p={};return u&&(p={indexPath:u,index:u[u.length-1],parentPath:u.slice(0,u.length-1)}),p},_getIndexFromSegment:function(r,l){if(l&&l.length===2){var u=this.findDeepCoordIndex(r,l[0]),p=this.findDeepCoordIndex(r,l[1]),g=Math.max(u.index,p.index);return u.index!==0&&p.index!==0||g===1||(g+=1),{indexA:u,indexB:p,newIndex:g,indexPath:u.indexPath,parentPath:u.parentPath}}return null},_getRotatedRectangle:function(r,l,u,p){var g=yi(p,r),M=yi(p,l),S=u*Math.PI/180,D=Math.cos(S),B=Math.sin(S),N=(M.x-g.x)*D+(M.y-g.y)*B,H=(M.y-g.y)*D-(M.x-g.x)*B,Y=N*D+g.x,V=N*B+g.y,tt=-H*B+g.x,ut=H*D+g.y;return[vi(p,g),vi(p,{x:Y,y:V}),vi(p,M),vi(p,{x:tt,y:ut})]},pxRadiusToMeterRadius:function(r,l,u){var p=l.project(u),g=L.point(p.x+r,p.y);return l.distance(l.unproject(g),u)}};L.PM=L.PM||{version:s.version,Map:At,Toolbar:F,Draw:nt,Edit:de,Utils:or,Matrix:sr,activeLang:"en",optIn:!1,initialize:function(r){this.addInitHooks(r)},setOptIn:function(r){this.optIn=!!r},addInitHooks:function(){function r(){this.pm=void 0,L.PM.optIn?this.options.pmIgnore===!1&&(this.pm=new L.PM.Map(this)):this.options.pmIgnore||(this.pm=new L.PM.Map(this))}function l(){this.pm=void 0,L.PM.optIn?this.options.pmIgnore===!1&&(this.pm=new L.PM.Edit.LayerGroup(this)):this.options.pmIgnore||(this.pm=new L.PM.Edit.LayerGroup(this))}function u(){this.pm=void 0,L.PM.optIn?this.options.pmIgnore===!1&&(this.pm=new L.PM.Edit.Marker(this)):this.options.pmIgnore||(this.pm=new L.PM.Edit.Marker(this))}function p(){this.pm=void 0,L.PM.optIn?this.options.pmIgnore===!1&&(this.pm=new L.PM.Edit.CircleMarker(this)):this.options.pmIgnore||(this.pm=new L.PM.Edit.CircleMarker(this))}function g(){this.pm=void 0,L.PM.optIn?this.options.pmIgnore===!1&&(this.pm=new L.PM.Edit.Line(this)):this.options.pmIgnore||(this.pm=new L.PM.Edit.Line(this))}function M(){this.pm=void 0,L.PM.optIn?this.options.pmIgnore===!1&&(this.pm=new L.PM.Edit.Polygon(this)):this.options.pmIgnore||(this.pm=new L.PM.Edit.Polygon(this))}function S(){this.pm=void 0,L.PM.optIn?this.options.pmIgnore===!1&&(this.pm=new L.PM.Edit.Rectangle(this)):this.options.pmIgnore||(this.pm=new L.PM.Edit.Rectangle(this))}function D(){this.pm=void 0,L.PM.optIn?this.options.pmIgnore===!1&&(this.pm=new L.PM.Edit.Circle(this)):this.options.pmIgnore||(this.pm=new L.PM.Edit.Circle(this))}function B(){this.pm=void 0,L.PM.optIn?this.options.pmIgnore===!1&&(this.pm=new L.PM.Edit.ImageOverlay(this)):this.options.pmIgnore||(this.pm=new L.PM.Edit.ImageOverlay(this))}L.Map.addInitHook(r),L.LayerGroup.addInitHook(l),L.Marker.addInitHook(u),L.CircleMarker.addInitHook(p),L.Polyline.addInitHook(g),L.Polygon.addInitHook(M),L.Rectangle.addInitHook(S),L.Circle.addInitHook(D),L.ImageOverlay.addInitHook(B)},reInitLayer:function(r){var l=this;r instanceof L.LayerGroup&&r.eachLayer(function(u){l.reInitLayer(u)}),r.pm||L.PM.optIn&&r.options.pmIgnore!==!1||r.options.pmIgnore||(r instanceof L.Map?r.pm=new L.PM.Map(r):r instanceof L.Marker?r.pm=new L.PM.Edit.Marker(r):r instanceof L.Circle?r.pm=new L.PM.Edit.Circle(r):r instanceof L.CircleMarker?r.pm=new L.PM.Edit.CircleMarker(r):r instanceof L.Rectangle?r.pm=new L.PM.Edit.Rectangle(r):r instanceof L.Polygon?r.pm=new L.PM.Edit.Polygon(r):r instanceof L.Polyline?r.pm=new L.PM.Edit.Line(r):r instanceof L.LayerGroup?r.pm=new L.PM.Edit.LayerGroup(r):r instanceof L.ImageOverlay&&(r.pm=new L.PM.Edit.ImageOverlay(r)))}},L.PM.initialize()}]);var kh={exports:{}};(function(n,i){(function(t,s){n.exports=t(Q.exports),typeof s!="undefined"&&s.L&&t(s.L)})(function(t){return t.locales={},t.locale=null,t.registerLocale=function(o,h){t.locales[o]=t.Util.extend({},t.locales[o],h)},t.setLocale=function(o){t.locale=o},t.i18n=t._=function(o,h){t.locale&&t.locales[t.locale]&&t.locales[t.locale][o]&&(o=t.locales[t.locale][o]);try{o=t.Util.template(o,h)}catch{}return o}},window)})(kh);function Jr(n,...i){if(!i.length)return n;const t=i.shift();if(ts(n)&&ts(t))for(const s in t)ts(t[s])?(n[s]||Object.assign(n,{[s]:{}}),Jr(n[s],t[s])):Object.assign(n,{[s]:t[s]});return Jr(n,...i)}function fa(n){document.readyState!=="complete"?window.addEventListener("load",n,{once:!0}):n()}function Mh(n,i,t,s){var o;return function(){var h=arguments;clearTimeout(o),o=setTimeout(function(){o=null,s||n.apply(t,h)},i),s&&!o&&n.apply(t,h)}}const da=1e3,qs=da*60,Wr=qs*60,Qr=Wr*24;function Vs(n){let i=Math.floor(n/Qr),t=Math.floor((n-i*Qr)/Wr),s=Math.floor((n-i*Qr-t*Wr)/qs),o=Math.round((n-i*Qr-t*Wr-s*qs)/da);return o===60&&(s++,o=0),s===60&&(t++,s=0),t===24&&(i++,t=0),(i?i+"d ":"")+t.toString().padStart(2,0)+":"+s.toString().padStart(2,0)+"'"+o.toString().padStart(2,0)+'"'}function pa(n,i){typeof n=="string"&&(n=JSON.parse(n)),i=i||this;let t=i.options.distanceMarkers===!0?{lazy:!0}:L.extend({lazy:!0},i.options.distanceMarkers),s=i.options.wptIcons,o=L.geoJson(n,{distanceMarkers:t,style:h=>{let c=L.extend({},i.options.polyline);return i.options.theme&&(c.className+=" "+i.options.theme),c},pointToLayer:(h,c)=>{if(!i.options.waypoints)return;let d=h.properties,y=d.desc?d.desc:"",_=d.name?d.name:"",v=(d.sym?d.sym:_).replace(" ","-").replace('"',"").replace("'","").toLowerCase();s.hasOwnProperty(v)||(s[v]=L.divIcon(L.extend({},s[""].options,{html:'<i class="elevation-waypoint-icon '+v+'"></i>'})));let x=L.marker(c,{icon:s[v]});return(_||y)&&x.bindPopup("<b>"+_+"</b>"+(y.length>0?"<br>"+y:"")).openPopup(),i._addMarker(x),i._registerCheckPoint({latlng:c,label:_},!0),i.fire("waypoint_added",{point:x,element:c,properties:d}),x},onEachFeature:(h,c)=>{h.geometry&&h.geometry.type=="Point"||(c._latlngs.forEach((d,y,_)=>{if(d.meta={time:null,ele:null,hr:null,cad:null,atemp:null},"alt"in d&&(d.meta.ele=d.alt),h.properties){let v=h.properties;"coordTimes"in v?d.meta.time=new Date(Date.parse(v.coordTimes[y])):"times"in v?d.meta.time=new Date(Date.parse(v.times[y])):"time"in v&&(d.meta.time=new Date(Date.parse(typeof v.time=="object"?v.time[y]:v.time))),"heartRates"in v?d.meta.hr=parseInt(v.heartRates[y]):"heartRate"in v&&(d.meta.hr=parseInt(typeof v.heartRate=="object"?v.heartRate[y]:v.heartRate))}}),i.addData(c),i.options.distanceMarkers&&t.lazy&&c.on("add remove",d=>{let y=d.target;L.DistanceMarkers&&y instanceof L.Polyline&&y[d.type+"DistanceMarkers"]()}),i.track_info=L.extend({},i.track_info,{type:"geojson",name:n.name}))}});return L.Control.Elevation._d3LazyLoader.then(()=>{i._fireEvt("eledata_loaded",{data:n,layer:o,name:i.track_info.name,track_info:i.track_info})}),o}function Ph(n){return!!(n.offsetWidth||n.offsetHeight||n.getClientRects().length)}function ts(n){return n&&typeof n=="object"&&!Array.isArray(n)}function ma(n){if(!n)return!1;let i=window.getComputedStyle(n);function t(o,h){return h.visibility!=="hidden"&&h.display!=="none"}function s(o,h){let c=o.getBoundingClientRect(),d=c.left+1,y=c.right-1,_=c.top+1;c.bottom-1;let v=!0,x=o.style.pointerEvents;return h["pointer-events"]=="none"&&(o.style.pointerEvents="auto"),document.elementFromPoint(d,_)!==o&&(v=!1),document.elementFromPoint(y,_)!==o&&(v=!1),o.style.pointerEvents=x,v}return!(!t(n,i)||!s(n,i))}function ga(n,i){if(i=typeof i=="undefined"?!0:i,typeof n=="string"&&i)return n=n.trim(),n.indexOf("{")==0||n.indexOf("[")==0;try{JSON.parse(n.toString())}catch(t){return typeof n=="object"&&i?!0:(console.warn(t),!1)}return!0}function _a(n,i){if(i=typeof i=="undefined"?!0:i,typeof n=="string"&&i)return n=n.trim(),n.indexOf("<")==0;{let t=(n?n.ownerDocument||n:0).documentElement;return t?t.nodeName!=="HTML":!1}}function en(n,i,t){return i===!1?Promise.resolve():t instanceof Promise?t:new Promise((s,o)=>{let h=document.createElement("script");h.addEventListener("load",s,{once:!0}),h.src=n,document.head.appendChild(h)})}function ya(n,i){let t=nn("a","",{href:n,target:"_new",download:i||"",style:"display:none;"}),s=document.body;s.appendChild(t),t.click(),s.removeChild(t)}function va(n){return new Promise((i,t)=>{let s=!1,o=()=>{s||(L.Util.requestAnimFrame(()=>{ma(n)&&(window.removeEventListener("scroll",o),i()),s=!1}),s=!0)};window.addEventListener("scroll",o),n&&n.addEventListener("mouseenter",o,{once:!0}),o()})}function Cn(n,i){n&&i.split(" ").every(t=>t&&L.DomUtil.addClass(n,t))}function fr(n,i){n&&i.split(" ").every(t=>t&&L.DomUtil.removeClass(n,t))}function es(n,i,t){return(t?Cn:fr).call(null,n,i)}function is(n,i,t){i&&fr(n,i),t&&Cn(n,t)}function En(n,i,t){return typeof t=="undefined"?L.DomUtil.getStyle(n,i):n.style.setProperty(i,t)}function Hs(n,i,t,s){return En(n,i,s?t:"")}function $s(n,i,t,s){return n[s?"on":"off"](i,t)}function nn(n,i,t,s){let o=L.DomUtil.create(n,i||"");return t&&ba(o,t),s&&Ks(s,o),o}function Ks(n,i){return n.appendChild(i)}function Xs(n,i,t){return n.insertAdjacentElement(t,i)}function ba(n,i){for(let t in i)n.setAttribute(t,i[t])}function dr(n,i){return(i||document).querySelector(n)}const ai=L.DomEvent.on,Ys=L.DomEvent.off,xa=L.DomUtil.hasClass;function La(){return Math.random().toString(36).substr(2,9)}function pr(n,i){for(let t in n)i(n[t],t)}var Sh=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",deepMerge:Jr,deferFunc:fa,debounce:Mh,formatTime:Vs,GeoJSONLoader:pa,isDomVisible:Ph,isObject:ts,isVisible:ma,isJSONDoc:ga,isXMLDoc:_a,lazyLoader:en,saveFile:ya,waitHolder:va,addClass:Cn,removeClass:fr,toggleClass:es,replaceClass:is,style:En,toggleStyle:Hs,toggleEvent:$s,create:nn,append:Ks,insert:Xs,setAttributes:ba,select:dr,on:ai,off:Ys,hasClass:xa,randomId:La,each:pr});const ns={lightblue:{area:"#3366CC",alpha:.45,stroke:"#3366CC"},magenta:{area:"#FF005E"},yellow:{area:"#FF0"},purple:{area:"#732C7B"},steelblue:{area:"#4682B4"},red:{area:"#F00"},lime:{area:"#9CC222",line:"#566B13"}},wa=({width:n,height:i,xAttr:t,yAttr:s,scaleX:o,scaleY:h,interpolation:c="curveLinear"})=>d3.area().curve(typeof c=="string"?d3[c]:c).x(d=>d.xDiagCoord=o(d[t])).y0(i).y1(d=>h(d[s])),ka=({name:n,color:i,strokeColor:t,strokeOpacity:s,fillOpacity:o})=>{let h=d3.create("svg:path");return n&&h.classed(n,!0),h.style("pointer-events","none"),h.attr("fill",i||"#3366CC").attr("stroke",t||"#000").attr("stroke-opacity",s||"1").attr("fill-opacity",o||"0.8"),h},Js=({type:n="axis",tickSize:i=6,tickPadding:t=3,position:s,height:o,width:h,axis:c,scale:d,ticks:y,tickFormat:_,label:v,labelX:x,labelY:w,name:C="",onAxisMount:A})=>I=>{let[R,P]=[0,0];s=="bottom"&&(P=o),s=="right"&&(R=h),c=="x"&&n=="grid"?i=-o:c=="y"&&n=="grid"&&(i=-h);let E=d3["axis"+s.replace(/\b\w/g,j=>j.toUpperCase())]().scale(d).ticks(y).tickPadding(t).tickSize(i).tickFormat(_),z=I.append("g").attr("class",[c,n,s,C].join(" ")).attr("transform","translate("+R+","+P+")").call(E);return v&&z.append("svg:text").attr("x",x).attr("y",w).text(v),A&&z.call(A),z},Ma=n=>(n.type="grid",Js(n)),Pa=({theme:n,xCoord:i=0,yCoord:t=0,length:s=0})=>o=>o.attr("class",n+" height-focus line").attr("x1",i).attr("x2",i).attr("y1",t).attr("y2",s),Sa=({theme:n,xCoord:i=0,yCoord:t=0,label:s})=>o=>{o.attr("class",n+" height-focus-label").style("pointer-events","none").attr("x",i+5).attr("y",t);let h=o.select(".height-focus-y");return h.node()||(h=o.append("svg:tspan")),h.attr("class","height-focus-y").text(s),o.selectAll("tspan").attr("x",i+5),o},Ca=({theme:n,xCoord:i=0,yCoord:t=0})=>s=>s.attr("class",n+" height-focus circle-lower").attr("transform","translate("+i+","+t+")").attr("r",6).attr("cx",0).attr("cy",0),Ea=({name:n,label:i,width:t,height:s,margins:o={},color:h,path:c})=>d=>{d.attr("class","legend-item legend-"+n.toLowerCase()).attr("data-name",n);const y=d3.select(d.node().ownerSVGElement||d);return d.on("click.legend",()=>y.dispatch("legend_clicked",{detail:{path:c.node(),name:n,legend:d.node(),enabled:!c.classed("leaflet-hidden")}})),d.append("svg:rect").attr("x",t/2-50).attr("y",s+o.bottom/2).attr("width",50).attr("height",10).attr("fill",h).attr("stroke","#000").attr("stroke-opacity","0.5").attr("fill-opacity","0.25"),d.append("svg:text").text(L._(i||n)).attr("x",t/2+5).attr("font-size",10).style("text-decoration-thickness","2px").style("font-weight","700").attr("y",s+o.bottom/2).attr("dy","0.75em"),d},Ws=({xCoord:n=0,height:i})=>t=>t.attr("class","mouse-focus-line").attr("x2",n).attr("y2",0).attr("x1",n).attr("y1",i),Qs=({xCoord:n,yCoord:i,labelX:t="",labelY:s="",width:o})=>h=>{h.attr("class","mouse-focus-label");let c=h.select(".mouse-focus-label-rect"),d=h.select(".mouse-focus-label-text"),y=d.select(".mouse-focus-label-y"),_=d.select(".mouse-focus-label-x");c.node()||(c=h.append("svg:rect")),d.node()||(d=h.append("svg:text")),y.node()||(y=d.append("svg:tspan")),_.node()||(_=d.append("svg:tspan")),y.text(s),_.text(t);let v=0,x=0,w={width:0,height:0};try{w=d.node().getBBox()}catch{return h}return n&&(v=n+(n<o/2?10:-w.width-10)),i&&(x=Math.max(i-w.height,L.Browser.webkit?0:-1/0)),c.attr("class","mouse-focus-label-rect").attr("x",v-5).attr("y",x-5).attr("width",w.width+10).attr("height",w.height+10).attr("rx",3).attr("ry",3),d.attr("class","mouse-focus-label-text").style("font-weight","700").attr("y",x),y.attr("class","mouse-focus-label-y").attr("dy","1em"),_.attr("class","mouse-focus-label-x").attr("dy","2em"),d.selectAll("tspan").attr("x",v),h},Ta=({height:n,width:i})=>t=>{t.data([{x:0,y:n}]).attr("transform",d=>"translate("+d.x+","+d.y+")");let s=t.selectAll(".horizontal-drag-rect").data([{w:i}]),o=t.selectAll(".horizontal-drag-line").data([{w:i}]),h=t.selectAll(".horizontal-drag-label").data([{w:i-8}]),c=t.selectAll(".horizontal-drag-symbol").data([{type:d3.symbolTriangle,x:i+7,y:0,angle:-90,size:50}]);return s.exit().remove(),o.exit().remove(),h.exit().remove(),c.exit().remove(),s.enter().append("svg:rect").attr("class","horizontal-drag-rect").attr("x",0).attr("y",-8).attr("height",8).attr("fill","none").attr("pointer-events","all").merge(s).attr("width",d=>d.w),o.enter().append("svg:line").attr("class","horizontal-drag-line").attr("x1",0).merge(o).attr("x2",d=>d.w),h.enter().append("svg:text").attr("class","horizontal-drag-label").attr("text-anchor","end").attr("y",-8).merge(h).attr("x",d=>d.w),c.enter().append("svg:path").attr("class","horizontal-drag-symbol").merge(c).attr("d",d3.symbol().type(d=>d.type).size(d=>d.size)).attr("transform",d=>"translate("+d.x+","+d.y+") rotate("+d.angle+")"),t},to=({min:n,max:i,attr:t,name:s,forceBounds:o,scale:h})=>function(c){t=t||s,h&&h.attr&&(t=h.attr);let d=c&&c.length?d3.extent(c,y=>y[t]):[0,1];return typeof n!="undefined"&&(n<d[0]||o)&&(d[0]=n),typeof i!="undefined"&&(i>d[1]||o)&&(d[1]=i),d},Oa=({axis:n})=>function(i,t){if(n=="x")return[0,i];if(n=="y")return[t,0]},rs=({data:n,attr:i,min:t,max:s,forceBounds:o,range:h})=>d3.scaleLinear().range(h).domain(to({min:t,max:s,attr:i,forceBounds:o})(n)),Ch=({data:n=[0,1],scale:i,x:t,attr:s})=>d3.bisector(o=>o[s]).left(n,i.invert(t)),Ia=({width:n,height:i,margins:t={},ruler:s})=>{const o=n-t.left-t.right,h=i-t.top-t.bottom,c=d3.create("svg:svg").attr("class","background"),d=c.append("g"),y={grid:d.append("g").attr("class","grid"),area:d.append("g").attr("class","area"),point:d.append("g").attr("class","point"),axis:d.append("g").attr("class","axis"),brush:d.append("g").attr("class","brush"),tooltip:d.append("g").attr("class","tooltip").attr("display","none"),ruler:d.append("g").attr("class","ruler"),legend:d.append("g").attr("class","legend")},_=y.area.append("svg:clipPath").attr("id","elevation-clipper"),v=_.append("svg:rect"),x=y.area.append("svg:foreignObject"),w=x.append("xhtml:canvas").attr("class","canvas-plot"),C=w.node().getContext("2d"),A=y.ruler,I=y.tooltip,R=y.brush;I.append("svg:line").call(Ws({xCoord:0,height:h})),I.append("g").call(Qs({xCoord:0,yCoord:0,height:h,width:o,labelX:"",labelY:""}));let P=d3.brushX().on("start.cursor end.cursor brush.cursor",()=>R.select(".overlay").attr("cursor",null));const E=q=>({x:rs(q.x),y:rs(q.y)});let z={clipPath:_,canvas:w,context:C,dragG:A,focusG:I,brush:P},j={svg:c,g:d,panes:y,utils:z,scale:E};return j._resize=({width:q,height:et,margins:J={},ruler:ht})=>{const lt=q-J.left-J.right,dt=et-J.top-J.bottom;c.attr("viewBox",`0 0 ${q} ${et}`).attr("width",q).attr("height",et),d.attr("transform","translate("+J.left+","+J.top+")"),/Mac|iPod|iPhone|iPad/.test(navigator.platform)&&/AppleWebkit/i.test(navigator.userAgent)&&w.style("transform","translate("+J.left+"px,"+J.top+"px)"),v.attr("x",0).attr("y",0).attr("width",lt).attr("height",dt),x.attr("width",lt).attr("height",dt),w.attr("width",lt).attr("height",dt),ht&&A.call(Ta({height:dt,width:lt})),R.call(P.extent([[0,0],[lt,dt]])),R.select(".overlay").attr("cursor",null),j._width=lt,j._height=dt,j.svg.dispatch("resize",{detail:{width:lt,height:dt}})},j.pane=q=>(y[q]||(y[q]=d.append("g").attr("class",q)),y[q]),j.get=q=>z[q],j._resize({width:n,height:i,margins:t}),j};var Eh=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",Colors:ns,Area:wa,Path:ka,Axis:Js,Grid:Ma,HeightFocusLine:Pa,HeightFocusLabel:Sa,HeightFocusMarker:Ca,LegendItem:Ea,MouseFocusLine:Ws,MouseFocusLabel:Qs,Ruler:Ta,Domain:to,Range:Oa,Scale:rs,Bisect:Ch,Chart:Ia}),Aa=L.Class.extend({includes:L.Evented?L.Evented.prototype:L.Mixin.Events,initialize:function(n,i){this.options=n,this.control=i,this._data=[],this._props={scales:{},paths:{},areas:{},grids:{},axes:{},legendItems:{},focusLabels:{}},this._scales={},this._domains={},this._ranges={},this._paths={},this._brushEnabled=n.dragging,this._zoomEnabled=n.zooming,n.imperial?(this._xLabel="mi",this._yLabel="ft"):(this._xLabel=n.xLabel,this._yLabel=n.yLabel);let t=this._chart=Ia(n);this._container=t.svg,this._grid=t.pane("grid"),this._area=t.pane("area"),this._point=t.pane("point"),this._axis=t.pane("axis"),this._legend=t.pane("legend"),this._initScale(),this._clipPath=t.get("clipPath"),this._canvas=t.get("canvas"),this._context=t.get("context"),this._dragG=t.get("dragG"),this._focusG=t.get("focusG"),this._brush=t.get("brush"),this._focusline=this._focusG.select(".mouse-focus-line"),this._focuslabel=this._focusG.select(".mouse-focus-label"),this._zoom=d3.zoom(),this._drag=d3.drag(),this._initInteractions()},update:function(n){return n&&(n.data&&(this._data=n.data),n.options&&(this.options=n.options)),this._updateScale(),this._updateArea(),this._updateAxis(),this._updateLegend(),this._updateClipper(),this},render:function(){return n=>n.append(()=>this._container.node())},clear:function(){this._resetDrag(),this._hideDiagramIndicator(),this._area.selectAll("path").attr("d","M0 0"),this._context.clearRect(0,0,this._width(),this._height()),this._path},_drawPath:function(n){let i=this.options,t=this._context,s=this._paths[n],o=this._props.areas[n],h=s.node(),c=this._scales[o.scaleX],d=this._scales[o.scaleY];if(o=L.extend({},o,{width:this._width(),height:this._height(),scaleX:c,scaleY:d}),!d||!d)return console.warn("Unable to render path:"+n);if(s.datum(this._data).attr("d",wa(o)),!s.classed("leaflet-hidden"))if(i.preferCanvas){s.classed("canvas-path",!0),t.beginPath(),t.moveTo(0,0);let y=new Path2D(s.attr("d"));t.strokeStyle=s.attr("stroke"),t.fillStyle=s.attr("fill"),t.lineWidth=1.25,t.globalCompositeOperation="source-over",t.globalAlpha=s.attr("stroke-opacity")||.3,t.stroke(y),t.globalAlpha=s.attr("fill-opacity")||.45,t.fill(y),t.globalAlpha=1,t.closePath()}else this._area.append(()=>h)},_hasActiveLayers:function(){const n=this._paths;for(var i in n)if(!n[i].classed("leaflet-hidden"))return!0;return!1},_initBrush:function(n){const i=s=>{if(!this._data.length)return;let o=s.selection;if(o){let h=this._findIndexForXCoord(o[0]),c=this._findIndexForXCoord(o[1]);this.fire("dragged",{dragstart:this._data[h],dragend:this._data[c]})}},t=s=>{if(!this._data.length||s.type=="brush"&&!s.sourceEvent)return;let o=this._chart.panes.brush.select(".overlay").node(),c=d3.pointers(s,o)[0][0],d=this._data[this._findIndexForXCoord(c)];this.fire("mouse_move",{item:d,xCoord:c})};this._brush.filter(s=>this._brushEnabled&&!s.shiftKey&&!s.button).on("end.update",i).on("brush.update",t),this._chart.panes.brush.on("mouseenter.focus touchstart.focus",this.fire.bind(this,"mouse_enter")).on("mouseout.focus touchend.focus",this.fire.bind(this,"mouse_out")).on("mousemove.focus touchmove.focus",t)},_initClipper:function(){let n=this._container,i=this.options.margins;const t=this._zoom,s=c=>{c.sourceEvent&&c.sourceEvent.type=="mousedown"&&n.style("cursor","grabbing"),c.transform.k==1&&c.transform.x==0&&this._container.classed("zoomed",!0),this.zooming=!0},o=c=>{c.transform.k==1&&c.transform.x==0&&this._container.classed("zoomed",!1),this.zooming=!1,n.style("cursor","")},h=c=>{this.zooming=!1,this._updateScale(),this.zooming=!0,this._scales.distance=this._x=c.transform.rescaleX(this._x),this._resetDrag(),c.sourceEvent&&c.sourceEvent.type=="mousemove"&&this._hideDiagramIndicator(),this.fire("zoom")};t.scaleExtent([1,10]).extent([[i.left,0],[this._width()-i.right,this._height()]]).translateExtent([[i.left,-1/0],[this._width()-i.right,1/0]]).filter(c=>this._zoomEnabled&&(c.shiftKey||c.buttons==4)).on("start",s).on("end",o).on("zoom",h),n.call(t)},_initInteractions:function(){this._initBrush(),this._initRuler(),this._initClipper(),this._initLegend()},_initLegend:function(){this._container.on("legend_clicked",n=>{let{path:i,legend:t,name:s,enabled:o}=n.detail;if(!i)return;let h=dr("text",t),c=dr("rect",t);Hs(h,"text-decoration-line","line-through",o),Hs(c,"fill-opacity","0",o),es(i,"leaflet-hidden",o),this._updateArea(),this.fire("elepath_toggle",{path:i,name:s,legend:t,enabled:o})})},_initRuler:function(){if(!this.options.ruler)return;const n=d3.format(".0f"),i=this._drag,t=(o,h)=>{let c=this._height(),d=this._dragG.data()[0].y;(d>=c||d<=0)&&this._dragG.select(".horizontal-drag-label").text(""),this._hideDiagramIndicator()},s=(o,h)=>{let c=this._height(),d=d3.pointers(o,this._area.node())[0][1],y=d>0?d<c?d:c:0,_=this._y.invert(y),v=L.extend(this._dragG.data()[0],{y});this._dragG.data([v]).attr("transform",x=>"translate("+x.x+","+x.y+")").classed("active",y<c),this._container.select(".horizontal-drag-label").text(n(_)+" "+this._yLabel),this.fire("ruler_filter",{coords:d<c&&d>0?this._findCoordsForY(d):[]})};i.on("start end",t).on("drag",s),this._dragG.call(i)},_initScale:function(){let n=this.options;this._registerAxisScale({axis:"x",position:"bottom",attr:n.xAttr,min:n.xAxisMin,max:n.xAxisMax,name:"distance"}),this._registerAxisScale({axis:"y",position:"left",attr:n.yAttr,min:n.yAxisMin,max:n.yAxisMax,name:"altitude"}),this._x=this._scales.distance,this._y=this._scales.altitude},_registerAreaPath:function(n){let i=this.options;n.xAttr||(n.xAttr=i.xAttr),n.yAttr||(n.yAttr=i.yAttr),typeof n.preferCanvas=="undefined"&&(n.preferCanvas=i.preferCanvas);let t=ka(n);this._paths[n.name]=t,this._props.areas[n.name]=n,i.legend&&(this._props.legendItems[n.name]={name:n.name,label:n.label,color:n.color,path:t})},_registerAxisGrid:function(n){this._props.grids[n.name||n.axis]=n},_registerAxisScale:function(n){let i=this.options,t=n.scale;if(typeof t!="function"){t=L.extend({data:this._data,forceBounds:i.forceAxisBounds},t),t.attr=t.attr||n.name;let s=this._domains[n.name]=to(n),o=this._ranges[n.name]=Oa(n);t.range=t.range||o(this._width(),this._height()),t.domain=t.domain||s(this._data),this._props.scales[n.name]=t,n.scale=this._scales[n.name]=rs(t)}return n.ticks||(n.axis=="x"?n.ticks=i.xTicks:n.axis=="y"&&(n.ticks=i.yTicks)),this._props.axes[n.name]=n,t},_registerCheckPoint:function(n){if(!this._data.length)return;let i,t,s;if(n.latlng)i=this._data[this._findIndexForLatLng(n.latlng)],t=this._x(i.dist),s=this._y(i.z);else if(!isNaN(n.dist))t=this._x(n.dist),i=this._data[this._findIndexForXCoord(t)],s=this._y(i.z);else if(isNaN(t)||isNaN(s))return;(!n.item||!n.item.property("isConnected"))&&(n.position=n.position||"bottom",n.item=this._point.append("g"),n.item.append("svg:line").attr("y1",0).attr("x1",0).attr("style","stroke: rgb(51, 51, 51); stroke-width: 0.5; stroke-dasharray: 2, 2;"),n.item.append("svg:circle").attr("class"," height-focus circle-lower").attr("r",3),n.label&&n.item.append("svg:text").attr("dx","4px").attr("dy","-4px")),n.item.datum({pos:n.position,x:t,y:s}).attr("class",o=>"point "+o.pos).attr("transform",o=>"translate("+o.x+","+o.y+")"),n.item.select("line").datum({y2:{top:-s,bottom:this._height()-s}[n.position],x2:{left:-t,right:this._width()-t}[n.position]||0}).attr("y2",o=>o.y2).attr("x2",o=>o.x2),n.label&&n.item.select("text").text(n.label)},_registerFocusLabel:function(n){this._props.focusLabels[n.name]=n},_updateArea:function(){let n=this._paths;this._context.clearRect(0,0,this._width(),this._height());for(var i in n)n[i].classed("leaflet-hidden")||this._drawPath(i)},_updateAxis:function(){let n=this.options;this._grid.selectAll("g").remove(),this._axis.selectAll("g").remove();let i=this._props.grids,t=this._props.axes,s,o,h,c={width:this._width(),height:this._height(),tickFormat:""},d={width:this._width(),height:this._height()};for(let y in i)s=L.extend({},c,i[y]),h=Ma(s),this._grid.call(h);for(let y in t)n[y]===!1||n[y]==="summary"||(s=L.extend({},d,t[y]),o=Js(s),this._axis.call(o));this._axis.selectAll(".y.axis.right").each((y,_,v)=>{let x=d3.select(v[_]),w=x.attr("transform"),C=w.substring(w.indexOf("(")+1,w.indexOf(")")).split(",");x.attr("transform","translate("+(+C[0]+_*40)+","+C[1]+")"),_>0&&(x.select(":scope > path").attr("opacity",.25),x.selectAll(":scope > .tick line").attr("opacity",.75))})},_updateClipper:function(){let n=this.options.margins;this._zoom.scaleExtent([1,10]).extent([[n.left,0],[this._width()-n.right,this._height()]]).translateExtent([[n.left,-1/0],[this._width()-n.right,1/0]])},_updateLegend:function(){if(this.options.legend==!1)return;let n=this._props.legendItems,i;this._legend.selectAll("g").remove();for(var t in n)i=Ea(L.extend({width:this._width(),height:this._height(),margins:this.options.margins},n[t])),this._legend.append("g").call(i);let s=this._legend.selectAll(".legend-item"),o=s.nodes().length,h=Array(Math.floor(o/2)).fill(null).map((v,x)=>(x+1)*2-(1-Math.sign(o%2))),c=h.slice().reverse().map(v=>-v);o%2!=0&&c.push(0),h=c.concat(h);let d=this._axis.selectAll(".x.axis.bottom").nodes().length,y=30+d*2,_=o*30;o&&this.options.margins.right<_&&(this.options.margins.right=_,this.fire("margins_updated")),d&&this.options.margins.bottom<y&&(this.options.margins.bottom=y,this.fire("margins_updated")),s.each((v,x,w)=>{let C=d3.select(w[x]);C.select("rect");let A=C.attr("data-name"),I=this._paths[A],R=h[x]*55,P=d*2;C.attr("transform","translate("+R+", "+P+")"),A in this.options&&this.options[A]=="disabled"&&(I.classed("leaflet-hidden",!0),C.select("text").style("text-decoration-line","line-through"),C.select("rect").style("fill-opacity","0")),this._clipPath&&I.attr("clip-path","url(#"+this._clipPath.attr("id")+")")})},_updateScale:function(){if(this.zooming)return{x:this._x,y:this._y};this.options;let n=this._scales,i=this._domains,t=this._ranges;for(let s in n)n[s].domain(i[s](this._data)).range(t[s](this._width(),this._height()));return{x:this._x,y:this._y}},_width:function(){return this._chart._width},_height:function(){return this._chart._height},_findCoordsForY:function(n){let i=this._data,t=this._y.invert(n);const s=i.reduce((d,y,_)=>(y.z>=t&&d.push(_),d),[]);let o=0,h;return s.reduce((d,y,_)=>(h=_+1,(s[h]!==s[_]+1||h===s.length)&&(d.push(s.slice(o,h).map(v=>i[v].latlng)),o=h),d),[])},_findIndexForXCoord:function(n){return d3.bisector(i=>i[this.options.xAttr]).left(this._data||[0,1],this._x.invert(n))},_findIndexForLatLng:function(n){let i=null,t=1/0;return this._data.forEach((s,o)=>{let h=n.distanceTo(s.latlng);h<t&&(t=h,i=o)}),i},_resetDrag:function(){this._chart.panes.brush.select(".selection").attr("width")&&(this._chart.panes.brush.call(this._brush.clear),this._hideDiagramIndicator(),this.fire("reset_drag"))},_resetZoom:function(){this._zoom&&this._zoom.transform(this._chart.svg,d3.zoomIdentity)},_showDiagramIndicator:function(n,i){let t=this.options,s=this._y(n[t.yAttr]);this._focusG.attr("display",null),this._focusline.call(Ws({xCoord:i,height:this._height()})),this._focuslabel.call(Qs({xCoord:i,yCoord:s,height:this._height(),width:this._width(),labelX:d3.format("."+t.decimalsX+"f")(n[t.xAttr])+" "+this._xLabel,labelY:d3.format("."+t.decimalsY+"f")(n[t.yAttr])+" "+this._yLabel}));let o=this._props.focusLabels,h=this._focuslabel.select("text"),c;for(var d in o)c=h.select(".mouse-focus-label-"+o[d].name),c.size()||(c=h.append("svg:tspan",".mouse-focus-label-x").attr("class","mouse-focus-label-"+o[d].name).attr("dy","1.5em")),c.text(typeof o[d].value!="function"?o[d].value:o[d].value(n)),this._focuslabel.select(".mouse-focus-label-x").attr("dy","1.5em")},_hideDiagramIndicator:function(){this._focusG.attr("display","none")}}),Th=L.Class.extend({initialize:function(n){return this.options=n,this.options.imperial?(this._xLabel="mi",this._yLabel="ft"):(this._xLabel=this.options.xLabel,this._yLabel=this.options.yLabel),this.options.marker=="elevation-line"?(this._focusline=d3.create("svg:line"),this._focusmarker=d3.create("svg:circle"),this._focuslabel=d3.create("svg:text")):this.options.marker=="position-marker"&&(this._marker=L.marker([0,0],{icon:this.options.markerIcon,zIndexOffset:1e6,interactive:!1})),this._focuslabels={},this},addTo:function(n){if(this._map=n,this.options.marker=="elevation-line"){let i=this._container=d3.select(n.getPane("elevationPane")).select("svg > g").attr("class","height-focus-group");i.append(()=>this._focusline.node()),i.append(()=>this._focusmarker.node()),i.append(()=>this._focuslabel.node())}else this.options.marker=="position-marker"&&this._marker.addTo(n,{pane:"overlayPane"});return this},update:function(n){if(n?this._props=n:n=this._props,!n)return;n.options&&(this.options=n.options),this._map||this.addTo(n.map);let i=this.options,t=this._map;this._latlng=n.item.latlng;let s=t.latLngToLayerPoint(this._latlng);t._rotate&&(s=t.rotatedPointToMapPanePoint(s));let o=L.extend({},n.item,s);if(this.options.marker=="elevation-line"){let c=this._height()/n.maxElevation*o.z,d=o.y-c;this._container.classed("leaflet-hidden",!1),this._focusmarker.call(Ca({theme:i.theme,xCoord:o.x,yCoord:o.y})),this._focusline.call(Pa({theme:i.theme,xCoord:o.x,yCoord:o.y,length:d})),this._focuslabel.call(Sa({theme:i.theme,xCoord:o.x,yCoord:d,label:d3.format("."+i.decimalsY+"f")(o[i.yAttr])+" "+this._yLabel}));let y=this._focuslabels,_=this._focuslabel,v;for(var h in y)v=_.select(".height-focus-"+y[h].name),v.size()||(v=_.append("svg:tspan").attr("class","height-focus-"+y[h].name).attr("dy","1.5em")),v.text(typeof y[h].value!="function"?y[h].value:y[h].value(n.item)),this._focuslabel.select(".height-focus-y").attr("dy","-1.5em")}else this.options.marker=="position-marker"&&(fr(this._marker.getElement(),"leaflet-hidden"),this._marker.setLatLng(this._latlng))},remove:function(){this._props=null,this.options.marker=="elevation-line"?this._container&&this._container.classed("leaflet-hidden",!0):this.options.marker=="position-marker"&&Cn(this._marker.getElement(),"leaflet-hidden")},getLatLng:function(){return this._latlng},_height:function(){let n=this.options;return n.height-n.margins.top-n.margins.bottom},_registerFocusLabel:function(n){this._focuslabels[n.name]=n}}),Oh=L.Class.extend({initialize:function(n,i){this.options=n,this.control=i;let t=this._container=nn("div","elevation-summary "+(n.summary?n.summary+"-summary":""));En(t,"max-width",n.width?n.width+"px":"")},render:function(){return n=>n.append(()=>this._container)},reset:function(){this._container.innerHTML=""},append:function(n,i,t){return this._container.innerHTML+=`<span class="${n}"><span class="summarylabel">${i}</span><span class="summaryvalue">${t}</span></span>`,this},_registerSummary:function(n){for(let i in n)this.append(i,L._(n[i].label),typeof n[i].value!="function"?n[i].value:n[i].value(this.control.track_info))}}),Ih={autofitBounds:!0,autohide:!L.Browser.mobile,autohideMarker:!0,almostover:!0,altitude:!0,collapsed:!1,detached:!0,distance:!0,distanceFactor:1,distanceMarkers:!1,decimalsX:2,decimalsY:0,dragging:!L.Browser.mobile,downloadLink:"link",elevationDiv:"#elevation-div",followMarker:!0,forceAxisBounds:!1,height:200,heightFactor:1,imperial:!1,interpolation:"curveLinear",lazyLoadJS:!0,legend:!0,loadData:{defer:!1,lazy:!1},margins:{top:30,right:30,bottom:30,left:40},marker:"elevation-line",markerIcon:L.divIcon({className:"elevation-position-marker",html:'<i class="elevation-position-icon"></i>',iconSize:[32,32],iconAnchor:[16,16]}),placeholder:!1,position:"topright",polyline:{className:"elevation-polyline",color:"#000",opacity:.75,weight:5,lineCap:"round"},polylineSegments:{className:"elevation-polyline-segments",color:"#F00",interactive:!1},preferCanvas:!1,reverseCoords:!1,ruler:!0,skipNullZCoords:!1,theme:"lightblue-theme",responsive:!0,summary:"inline",slope:!1,speed:!1,sLimit:void 0,time:!1,timeFactor:3600,timeFormat:!1,sDeltaMax:void 0,sInterpolation:"curveStepAfter",sRange:void 0,width:600,waypoints:!0,wptIcons:{"":L.divIcon({className:"elevation-waypoint-marker",html:'<i class="elevation-waypoint-icon"></i>',iconSize:[30,30],iconAnchor:[8,30]})},xAttr:"dist",xLabel:"km",xTicks:void 0,yAttr:"z",yAxisMax:void 0,yAxisMin:void 0,yLabel:"m",yTicks:void 0,zFollow:!1,zooming:!L.Browser.Mobile};const re=L.Control.Elevation=L.Control.extend({includes:L.Evented?L.Evented.prototype:L.Mixin.Events,options:Ih,__mileFactor:.621371,__footFactor:3.28084,__D3:"https://unpkg.com/d3@6.5.0/dist/d3.min.js",__TOGEOJSON:"https://unpkg.com/@tmcw/togeojson@4.3.0/dist/togeojson.umd.js",__LGEOMUTIL:"https://unpkg.com/leaflet-geometryutil@0.9.3/src/leaflet.geometryutil.js",__LALMOSTOVER:"https://unpkg.com/leaflet-almostover@1.0.1/src/leaflet.almostover.js",__LDISTANCEM:"https://unpkg.com/@raruto/leaflet-elevation@1.7.3/libs/leaflet-distance-marker.min.js",addData:function(n,i){typeof i=="undefined"&&n.on&&(i=n),re._d3LazyLoader=en(this.__D3,typeof d3!="object"||!this.options.lazyLoadJS,re._d3LazyLoader).then(()=>{this._addData(n),this._addLayer(i),this._fireEvt("eledata_added",{data:n,layer:i,track_info:this.track_info})})},addTo:function(n){if(this.options.detached){let i=this._initElevationDiv();i.isConnected||Xs(n.getContainer(),i,"afterend"),Ks(i,this.onAdd(n))}else L.Control.prototype.addTo.call(this,n);return this},clear:function(){this._marker&&this._marker.remove(),this._chart&&this._clearChart(),this._layers&&this._clearLayers(),this._markers&&this._clearMarkers(),this._data=[],this.track_info={},this._fireEvt("eledata_clear"),this._updateChart()},_clearChart:function(){this._events&&this._events.elechart_updated&&this._events.elechart_updated.forEach(n=>controlElevation.off("elechart_updated",n.fn,n.ctx)),this._chart&&this._chart._container&&(this._chart._container.selectAll("g.point .point").remove(),this._chart.clear())},_clearLayers:function(){this._layers&&this._layers.eachLayer&&(this._layers.eachLayer(n=>n.remove()),this._layers.clearLayers())},_clearMarkers:function(){this._markers&&this._markers.eachLayer&&(this._markers.eachLayer(n=>n.remove()),this._markers.clearLayers())},disableBrush:function(){this._chart._brushEnabled=!1,this._resetDrag()},enableBrush:function(){this._chart._brushEnabled=!0},enableDragging:function(){this.enableBrushing()},disableDragging:function(){this.disableBrushing()},disableZoom:function(){this._chart._zoomEnabled=!1,this._chart._resetZoom()},enableZoom:function(){this._chart._zoomEnabled=!0},fitBounds:function(n){n=n||this.getBounds(),this._map&&n.isValid()&&this._map.fitBounds(n)},getBounds:function(n){return n=n||this._data,L.latLngBounds(n.map(i=>i.latlng))},getZFollow:function(){return this._zFollow},hide:function(){En(this._container,"display","none")},initialize:function(n){this._data=[],this._layers=L.featureGroup(),this._markers=L.featureGroup(),this._markedSegments=L.polyline([]),this._chartEnabled=!0,this.track_info={},this.options=Jr({},this.options,n),this._zFollow=this.options.zFollow,this.options.followMarker&&(this._setMapView=L.Util.throttle(this._setMapView,300,this)),this.options.placeholder&&(this.options.loadData.lazy=this.options.loadData.defer=!0),this.options.legend&&(this.options.margins.bottom+=30),this.options.theme&&(this.options.polylineSegments.className+=" "+this.options.theme),this._markedSegments.setStyle(this.options.polylineSegments),L.extend(ns,this.options.colors||{})},load:function(n,i){this.loadData(n,i)},loadChart:function(n){this.addTo(n)},loadData:function(n,i){i=L.extend({},this.options.loadData,i),i.defer?this.loadDefer(n,i):i.lazy?this.loadLazy(n,i):_a(n)?this.loadXML(n):ga(n)?this.loadGeoJSON(n):this.loadFile(n)},loadDefer:function(n,i){i=L.extend({},this.options.loadData,i),i.defer=!1,fa(L.bind(this.loadData,this,n,i))},loadFile:function(n){fetch(n).then(i=>i.text()).then(i=>{this._downloadURL=n,this.loadData(i,{lazy:!1,defer:!1})}).catch(i=>console.warn(i))},loadGeoJSON:function(n){pa(n,this)},loadGPX:function(n){this.loadXML(n)},loadXML:function(n){re._togeojsonLazyLoader=en(this.__TOGEOJSON,typeof toGeoJSON!="function"||!this.options.lazyLoadJS,re._togeojsonLazyLoader).then(()=>{let i=new DOMParser().parseFromString(n,"text/xml"),t=i.documentElement.tagName.toLowerCase();t in toGeoJSON||(t=i.documentElement.tagName=="TrainingCenterDatabase"?"tcx":"gpx");let s=toGeoJSON[t](i),o=i.getElementsByTagName("name");return o[0]?s.name=o[0].innerHTML:this._downloadURL&&(s.name=this._downloadURL.split("/").pop().split("#")[0].split("?")[0]),this.loadGeoJSON(s,this)})},loadLazy:function(n,i){i=L.extend({},this.options.loadData,i);let t=i.lazy.parentNode?i.lazy:this.placeholder;va(t).then(()=>{i.lazy=!1,this.loadData(n,i),this.once("eledata_loaded",()=>this.placeholder.parentNode.removeChild(t))})},onAdd:function(n){this._map=n;let i=this._container=nn("div","elevation-control elevation "+this.options.theme);return this.options.detached||Cn(i,"leaflet-control"),this.options.placeholder&&!this._data.length&&(this.placeholder=nn("img","elevation-placeholder",typeof this.options.placeholder=="string"?{src:this.options.placeholder,alt:""}:this.options.placeholder),Xs(i,this.placeholder,"afterbegin")),re._d3LazyLoader=en(this.__D3,typeof d3!="object"||!this.options.lazyLoadJS,re._d3LazyLoader).then(()=>{this._initButton(i),this._initChart(i),this._initSummary(i),this._initMarker(n),this._initLayer(n),n.on("zoom viewreset zoomanim",this._hideMarker,this).on("resize",this._resetView,this).on("resize",this._resizeChart,this).on("rotate",this._rotateMarker,this).on("mousedown",this._resetDrag,this),ai(n.getContainer(),"mousewheel",this._resetDrag,this),ai(n.getContainer(),"touchstart",this._resetDrag,this),this.on("eledata_added eledata_loaded",this._updateChart,this).on("eledata_added eledata_loaded",this._updateSummary,this),this._updateChart(),this._updateSummary()}),i},onRemove:function(n){this._container=null,n.off("zoom viewreset zoomanim",this._hideMarker,this).off("resize",this._resetView,this).off("resize",this._resizeChart,this).off("mousedown",this._resetDrag,this),Ys(n.getContainer(),"mousewheel",this._resetDrag,this),Ys(n.getContainer(),"touchstart",this._resetDrag,this),this.off("eledata_added eledata_loaded",this._updateChart,this).off("eledata_added eledata_loaded",this._updateSummary,this)},redraw:function(){this._resizeChart()},setZFollow:function(n){this._zFollow=n},show:function(){En(this._container,"display","block")},_addData:function(n){if(!n)return;let i=n.geometry;if(i)switch(i.type){case"LineString":this._addGeoJSONData(i.coordinates);break;case"MultiLineString":pr(i.coordinates,t=>this._addGeoJSONData(t));break;default:console.warn("Unsopperted GeoJSON feature geometry type:"+i.type)}n.type==="FeatureCollection"&&pr(n.features,t=>this._addData(t)),n._latlngs&&this._addGPXData(n._latlngs)},_addGeoJSONData:function(n){pr(n,i=>{this._addPoint(i[1],i[0],i[2]),this._fireEvt("elepoint_added",{point:i,index:this._data.length-1})}),this._fireEvt("eletrack_added",{coords:n,index:this._data.length-1})},_addGPXData:function(n){pr(n,i=>{this._addPoint(i.lat,i.lng,typeof i.alt!="undefined"?i.alt:i.meta.ele),this._fireEvt("elepoint_added",{point:i,index:this._data.length-1})}),this._fireEvt("eletrack_added",{coords:n,index:this._data.length-1})},_addPoint:function(n,i,t){this.options.reverseCoords&&([n,i]=[i,n]),this._data.push({x:n,y:i,z:t,latlng:L.latLng(n,i,t)}),this._fireEvt("eledata_updated",{index:this._data.length-1})},_addLayer:function(n){n&&this._layers.addLayer(n)},_addMarker:function(n){n&&this._markers.addLayer(n)},_initElevationDiv:function(){let n=dr(this.options.elevationDiv);return n||(this.options.elevationDiv="#elevation-div_"+La(),n=nn("div","leaflet-control elevation elevation-div",{id:this.options.elevationDiv.substr(1)})),this.options.detached&&is(n,"leaflet-control","elevation-detached"),this.eleDiv=n,this.eleDiv},_collapse:function(){is(this._container,"elevation-expanded","elevation-collapsed")},_expand:function(){is(this._container,"elevation-collapsed","elevation-expanded")},_findItemForLatLng:function(n){return this._data[this._chart._findIndexForLatLng(n)]},_findItemForX:function(n){return this._data[this._chart._findIndexForXCoord(n)]},_fireEvt:function(n,i,t){this.fire&&this.fire(n,i,t),this._map&&this._map.fire(n,i,t)},_height:function(){if(this._chart)return this._chart._height();let n=this.options;return n.height-n.margins.top-n.margins.bottom},_hideMarker:function(){this.options.autohideMarker&&this._marker.remove()},_initChart:function(n){let i=this.options;if(i.xTicks=this._xTicks(),i.yTicks=this._yTicks(),i.responsive)if(i.detached){let{offsetWidth:s,offsetHeight:o}=this.eleDiv;s>0&&(i.width=s),o>20&&(i.height=o-20)}else{let{clientWidth:s}=this._map.getContainer();i._maxWidth=i._maxWidth>i.width?i._maxWidth:i.width,this._container.style.maxWidth=i._maxWidth+"px",i._maxWidth>s&&(i.width=s-30)}let t=this._chart=new Aa(i,this);this._x=this._chart._x,this._y=this._chart._y,d3.select(n).call(t.render()),t.on("reset_drag",this._hideMarker,this).on("mouse_enter",this._fireEvt.bind("elechart_enter"),this).on("dragged",this._dragendHandler,this).on("mouse_move",this._mousemoveHandler,this).on("mouse_out",this._mouseoutHandler,this).on("ruler_filter",this._rulerFilterHandler,this).on("zoom",this._updateChart,this).on("elepath_toggle",this._toggleChartHandler,this).on("margins_updated",this._resizeChart,this),this._fireEvt("elechart_axis"),this.options.legend&&this._fireEvt("elechart_legend"),this._fireEvt("elechart_init")},_initLayer:function(){this._layers.on("layeradd layerremove",n=>{let i=n.layer,t=i.getElement&&i.getElement();es(t,this.options.polyline.className+" "+this.options.theme,n.type=="layeradd"),$s(i,"mousemove",this._mousemoveLayerHandler.bind(this),n.type=="layeradd"),$s(i,"mouseout",this._mouseoutHandler.bind(this),n.type=="layeradd")})},_initMarker:function(n){let i=n.getPane("elevationPane");i||(i=this._pane=n.createPane("elevationPane",n.getPane("norotatePane")||n.getPane("mapPane")),i.style.zIndex=625,i.style.pointerEvents="none"),this._renderer&&this._renderer.remove(),this._renderer=L.svg({pane:"elevationPane"}).addTo(this._map),this._marker=new Th(this.options),this._fireEvt("elechart_marker")},_initButton:function(n){if(n.setAttribute("aria-haspopup",!0),this.options.detached||L.DomEvent.disableClickPropagation(n),L.Browser.mobile&&ai(n,"click",L.DomEvent.stopPropagation),ai(n,"mousewheel",this._mousewheelHandler,this),!this.options.detached){let i=this._button=nn("a","elevation-toggle elevation-toggle-icon"+(this.options.autohide?"":" close-button"),{href:"#",title:L._("Elevation")},n);this.options.collapsed&&(this._collapse(),this.options.autohide?(ai(n,"mouseover",this._expand,this),ai(n,"mouseout",this._collapse,this)):(ai(i,"click",L.DomEvent.stop),ai(i,"click",this._toggle,this)),ai(i,"focus",this._toggle,this),this._map.on("click",this._collapse,this))}},_initSummary:function(n){let i=this._summary=new Oh({summary:this.options.summary},this);d3.select(n).call(i.render()),this.summaryDiv=this._summary._container},_dragendHandler:function(n){this._hideMarker(),this.fitBounds(L.latLngBounds([n.dragstart.latlng,n.dragend.latlng])),this._fireEvt("elechart_dragged")},_mousemoveHandler:function(n){if(!this._data.length||!this._chartEnabled)return;let i=this._findItemForX(n.xCoord);if(i){let t=n.xCoord;this._chartEnabled&&this._chart._showDiagramIndicator(i,t),this._updateMarker(i),this._setMapView(i),this._map&&Cn(this._map.getContainer(),"elechart-hover"),this._fireEvt("elechart_change",{data:i,xCoord:t}),this._fireEvt("elechart_hover",{data:i,xCoord:t})}},_mousemoveLayerHandler:function(n){if(!this._data.length)return;let i=this._findItemForLatLng(n.latlng);if(i){let t=i.xDiagCoord;this._chartEnabled&&this._chart._showDiagramIndicator(i,t),this._updateMarker(i),this._fireEvt("elechart_change",{data:i,xCoord:t})}},_mouseoutHandler:function(){this.options.detached||(this._hideMarker(),this._chart._hideDiagramIndicator()),this._map&&fr(this._map.getContainer(),"elechart-hover"),this._fireEvt("elechart_leave")},_mousewheelHandler:function(n){if(this._map.gestureHandling&&this._map.gestureHandling._enabled)return;let i=this._marker.getLatLng()||this._map.getCenter(),t=this._map.getZoom()+Math.sign(n.deltaY);this._resetDrag(),this._map.flyTo(i,t)},_registerCheckPoint:function(n){this.on("elechart_updated",()=>this._chart._registerCheckPoint(n))},_registerAreaPath:function(n){this.on("elechart_init",()=>this._chart._registerAreaPath(n))},_registerAxisGrid:function(n){this.on("elechart_axis",()=>this._chart._registerAxisGrid(n))},_registerAxisScale:function(n){this.on("elechart_axis",()=>this._chart._registerAxisScale(n))},_registerFocusLabel:function(n){if(n.chart){let i=L.extend({},n,{value:n.chart});this.on("elechart_init",()=>this._chart._registerFocusLabel(i))}if(n.marker){let i=L.extend({},n,{value:n.marker});this.on("elechart_marker",()=>this._marker._registerFocusLabel(i))}},_registerSummary:function(n){this.on("elechart_summary",()=>this._summary._registerSummary(n))},_resetDrag:function(){this._chart._resetDrag(),this._hideMarker()},_resetView:function(){this._map&&this._map._isFullscreen||(this._resetDrag(),this._hideMarker(),this.options.autofitBounds&&this.fitBounds())},_resizeChart:function(){if(En(this._container,"display")=="none")return;let n=this.options;if(n.responsive){let i;if(n.detached)i=(this.eleDiv||this._container).offsetWidth;else{let{clientWidth:t}=this._map.getContainer();i=n._maxWidth>t?t-30:n._maxWidth}if(i){let t=this._chart;n.width=i,t&&t._chart&&(t._chart._resize(n),n.xTicks=this._xTicks(),n.yTicks=this._yTicks(),this._updateChart())}}this._updateMapSegments()},_rulerFilterHandler:function(n){this._updateMapSegments(n.coords)},_toggle:function(){xa(this._container,"elevation-expanded")?this._collapse():this._expand()},_setMapView:function(n){if(!this.options.followMarker||!this._map)return;let i=this._map.getZoom();typeof this._zFollow=="number"?(i<this._zFollow&&(i=this._zFollow),this._map.setView(n.latlng,i,{animate:!0,duration:.25})):this._map.getBounds().contains(n.latlng)||this._map.setView(n.latlng,i,{animate:!0,duration:.25})},_toggleChartHandler:function(n){let{path:i,name:t,enabled:s}=n;this._chartEnabled=this._chart._hasActiveLayers(),this._layers.eachLayer(o=>{let h=o.getElement&&o.getElement();es(h,this.options.polyline.className+" "+this.options.theme,this._chartEnabled)}),this.options[t]=!s&&this.options[t]=="disabled"?"enabled":"disabled",this._chartEnabled||(this._chart._hideDiagramIndicator(),this._marker.remove())},_updateChart:function(){!this._container||(this._fireEvt("elechart_axis"),this._fireEvt("elechart_area"),this._chart.update({data:this._data,options:this.options}),this._x=this._chart._x,this._y=this._chart._y,this._fireEvt("elechart_updated"))},_updateMarker:function(n){!this._marker||this._marker.update({map:this._map,item:n,maxElevation:this.track_info.elevation_max||0,options:this.options})},_rotateMarker:function(){!this._marker||this._marker.update()},_updateMapSegments:function(n){this._markedSegments.setLatLngs(n||[]),n&&this._map&&!this._map.hasLayer(this._markedSegments)&&this._markedSegments.addTo(this._map)},_updateSummary:function(){this._summary.reset(),this.options.summary&&this._fireEvt("elechart_summary"),this.options.downloadLink&&this._downloadURL&&(this.summaryDiv.innerHTML+='<span class="download"><a href="#">'+L._("Download")+"</a></span>",dr(".download a",this.summaryDiv).onclick=n=>{n.preventDefault(),this._fireEvt("eletrack_download",{downloadLink:this.options.downloadLink,confirm:ya.bind(this,this._downloadURL)})})},_width:function(){if(this._chart)return this._chart._width();let n=this.options;return n.width-n.margins.left-n.margins.right},_xTicks:function(){return this.__xTicks&&(this.__xTicks=this.options.xTicks),this.__xTicks||Math.round(this._width()/75)},_yTicks:function(){return this.__yTicks&&(this.__yTicks=this.options.yTicks),this.__yTicks||Math.round(this._height()/30)}});re.addInitHook(function(){this.on("waypoint_added",function(t){let s=t.point,o=s._popup;o&&(o.options.className="elevation-popup"),o&&o._content&&(o._content=decodeURI(o._content),s.bindTooltip(o._content,{direction:"auto",sticky:!0,opacity:1,className:"elevation-tooltip"}).openTooltip())}),this.on("eletrack_download",function(t){t.downloadLink=="modal"&&typeof CustomEvent=="function"?document.dispatchEvent(new CustomEvent("eletrack_download",{detail:t})):(t.downloadLink=="link"||t.downloadLink===!0)&&t.confirm()}),this.on("eledata_loaded",function(t){let s=this._map,o=t.layer;if(!s){console.warn("Undefined elevation map object");return}s.once("layeradd",h=>this.options.autofitBounds&&this.fitBounds(o.getBounds())),L.Browser.mobile?this.options.polyline&&o.addTo(s):re._geomutilLazyLoader=en(this.__LGEOMUTIL,typeof L.GeometryUtil!="function"||!this.options.lazyLoadJS,re._geomutilLazyLoader).then(()=>{this.options.almostOver&&(re._almostoverLazyLoader=en(this.__LALMOSTOVER,typeof L.Handler.AlmostOver!="function"||!this.options.lazyLoadJS,re._almostoverLazyLoader).then(()=>{s.addHandler("almostOver",L.Handler.AlmostOver),L.GeometryUtil&&s.almostOver&&s.almostOver.enabled()&&(s.almostOver.addLayer(o),s.on("almost:move",h=>this._mousemoveLayerHandler(h)).on("almost:out",h=>this._mouseoutHandler(h)))})),this.options.distanceMarkers?re._distanceMarkersLazyLoader=en(this.__LDISTANCEM,typeof L.DistanceMarkers!="function"||!this.options.lazyLoadJS,re._distanceMarkersLazyLoader).then(()=>this.options.polyline&&o.addTo(s)):this.options.polyline&&o.addTo(s)})});let n=L.Canvas.prototype._fillStroke,i=this;L.Canvas.include({_fillStroke:function(t,s){if(i._layers.hasLayer(s)){let o=i.options.theme.replace("-theme",""),h=ns[o]||{},c=s.options;if(c.color=h.line||h.area||o,c.stroke=!!c.color,n.call(this,t,s),c.stroke&&c.weight!==0){let d=t.globalCompositeOperation||"source-over";t.globalCompositeOperation="destination-over",t.strokeStyle="#FFF",t.lineWidth=c.weight*1.75,t.stroke(),t.globalCompositeOperation=d}}else n.call(this,t,s)}}),this.on("elechart_init",function(){this.once("elechart_change elechart_hover",function(t){this._chartEnabled&&(this._chart._showDiagramIndicator(t.data,t.xCoord),this._chart._showDiagramIndicator(t.data,t.xCoord)),this._updateMarker(t.data)})})});re.addInitHook(function(){let n=this.options,i={};this.options.imperial?(this._distanceFactor=this.__mileFactor,this._xLabel="mi"):(this._distanceFactor=n.distanceFactor,this._xLabel=n.xLabel),this.on("eledata_updated",function(t){let s=this._data,o=t.index,h=this.track_info,c=h.distance||0,d=s[o].latlng,y=o>0?s[o-1].latlng:d,_=d.distanceTo(y)*this._distanceFactor;c+=Math.round(_/1e3*1e5)/1e5,s[o].dist=c,h.distance=c}),this.on("elechart_axis",function(){this._chart._registerAxisGrid({axis:"x",position:"bottom",scale:this._chart._x})}),this.options.distance!="summary"&&this.on("elechart_axis",function(){i.x=this._chart._x,i.label=this._chart._xLabel,this._chart._registerAxisScale({axis:"x",position:"bottom",scale:i.x,label:i.label,labelY:25,labelX:()=>this._width()+6,name:"distance"})}),this._registerSummary({totlen:{label:"Total Length: ",value:t=>(t.distance||0).toFixed(2)+"&nbsp;"+this._xLabel}})});re.addInitHook(function(){let n=this.options,i={};n.imperial?(this._heightFactor=this.__footFactor,this._yLabel="ft"):(this._heightFactor=n.heightFactor,this._yLabel=n.yLabel),this.on("eledata_updated",function(t){let s=this._data,o=t.index,h=s[o].z*this._heightFactor,c=this.track_info,d=c.elevation_max||-1/0,y=c.elevation_min||1/0;if(!this.options.skipNullZCoords&&o>0){let _=s[o-1].z;if(isNaN(_)){let v=this._lastValidZ,x=h;if(!isNaN(v)&&!isNaN(x)?_=(v+x)/2:isNaN(v)?isNaN(x)||(_=x):_=v,!isNaN(_))return s.splice(o-1,1);s[o-1].z=_}}isNaN(h)||(d=d<h?h:d,y=y>h?h:y,this._lastValidZ=h),s[o].z=h,c.elevation_max=d,c.elevation_min=y}),this.on("elechart_axis",function(){this._chart._registerAxisGrid({axis:"y",position:"left",scale:this._chart._y})}),this.options.altitude!="summary"&&(this.on("elechart_axis",function(){i.y=this._chart._y,i.label=this._yLabel,this._chart._registerAxisScale({axis:"y",position:"left",scale:i.y,label:i.label,labelX:-3,labelY:-8,name:"altitude"})}),this.on("elechart_init",function(){let t=this.options.theme.replace("-theme",""),s=ns[t]||{},o=this.options.detached?s.alpha||"0.8":1,h=this.options.detached?s.stroke:!1;this._chart._registerAreaPath({name:"altitude",label:"Altitude",scaleX:"distance",scaleY:"altitude",color:s.area||t,strokeColor:h||"#000",strokeOpacity:"1",fillOpacity:o,preferCanvas:this.options.preferCanvas})})),this._registerSummary({maxele:{label:"Max Elevation: ",value:t=>(t.elevation_max||0).toFixed(2)+"&nbsp;"+this._yLabel},minele:{label:"Min Elevation: ",value:t=>(t.elevation_min||0).toFixed(2)+"&nbsp;"+this._yLabel}})});re.addInitHook(function(){let n=this.options,i={};i.label=n.timeLabel||"t",this._timeFactor=n.timeFactor,this._timeAVGSpeed=(n.timeAVGSpeed||3.6)*(n.speedFactor||1),n.timeFormat?n.timeFormat=="time"?n.timeFormat=t=>new Date(t).toLocaleTimeString():n.timeFormat=="date"&&(n.timeFormat=t=>new Date(t).toLocaleDateString()):n.timeFormat=t=>new Date(t).toLocaleString().replaceAll("/","-").replaceAll(","," "),n.xTimeFormat=n.xTimeFormat||(t=>Vs(t).split("'")[0]),n.time&&n.time!="summary"&&!L.Browser.mobile&&this._registerAxisScale({axis:"x",position:"top",scale:{attr:"duration",min:0},label:i.label,labelY:-10,labelX:()=>this._width(),name:"time",tickFormat:t=>t==0?"":n.xTimeFormat(t),onAxisMount:t=>{t.select(".domain").remove(),t.selectAll("text").attr("opacity",.65).style("font-family","Monospace").style("font-size","110%"),t.selectAll(".tick line").attr("y2",this._height()).attr("stroke-dasharray",2).attr("opacity",.75)}}),this.on("elepoint_added",function(t){let s=this._data,o=t.index;if(!t.point.meta||!t.point.meta.time){t.point.meta=t.point.meta||{};let v=s[o].dist-s[o>0?o-1:o].dist,x=this._timeAVGSpeed;t.point.meta.time=new Date(o>0?s[o-1].time.getTime()+v/x*this._timeFactor*1e3:Date.now())}let h=t.point.meta.time;h.getTime()-h.getTimezoneOffset()*60*1e3==0&&(h=0);let c=h,d=o>0?s[o-1].time:c,y=Math.abs(c-d),_=(this.track_info.time||0)+y;s[o].time=h,s[o].duration=_,this.track_info.time=_}),this.options.time&&(this._registerFocusLabel({name:"time",chart:t=>this.options.timeFormat(t.time)}),this._registerSummary({tottime:{label:"Total Time: ",value:t=>Vs(t.time||0)}}))});re.addInitHook(function(){if(!this.options.slope)return;let n=this.options,i={};i.label=n.slopeLabel||"%",this.options.slope!="summary"&&(this._registerAxisScale({axis:"y",position:"right",scale:{min:-1,max:1},tickPadding:16,label:i.label,labelX:25,labelY:-8,name:"slope"}),this._registerAreaPath({name:"slope",label:"Slope",yAttr:"slope",scaleX:"distance",scaleY:"slope",color:"#F00",strokeColor:"#000",strokeOpacity:"0.5",fillOpacity:"0.25"})),this.on("eledata_updated",function(t){let s=this._data,o=t.index,h=s[o].z,c=(s[o].dist-s[o>0?o-1:o].dist)*1e3,d=this.track_info,y=d.ascent||0,_=d.descent||0,v=d.slope_max||0,x=d.slope_min||0,w=0;if(!isNaN(h)){let C=o>0?h-s[o-1].z:0;C>0?y+=C:C<0&&(_-=C),c!==0&&(w=C/c*100)}if(this.options.sDeltaMax){let C=o>0?w-s[o-1].slope:0,A=this.options.sDeltaMax;Math.abs(C)>A&&(w=s[o-1].slope+A*Math.sign(C))}if(this.options.sRange){let C=this.options.sRange;w<C[0]?w=C[0]:w>C[1]&&(w=C[1])}w=L.Util.formatNum(w,2),w>v&&(v=w),w<x&&(x=w),s[o].slope=w,d.ascent=y,d.descent=_,d.slope_max=v,d.slope_min=x}),this._registerFocusLabel({name:"slope",chart:t=>t.slope+i.label,marker:t=>Math.round(t.slope)+i.label}),this._registerSummary({ascent:{label:"Total Ascent: ",value:t=>Math.round(t.ascent||0)+"&nbsp;"+this._yLabel},descent:{label:"Total Descent: ",value:t=>Math.round(t.descent||0)+"&nbsp;"+this._yLabel},minslope:{label:"Min Slope: ",value:t=>Math.round(t.slope_min||0)+"&nbsp;"+i.label},maxslope:{label:"Max Slope: ",value:t=>Math.round(t.slope_max||0)+"&nbsp;"+i.label}})});re.addInitHook(function(){if(!this.options.speed&&!this.options.acceleration)return;let n=this.options,i={};i.label=n.speedLabel||L._(this.options.imperial?"mph":"km/h"),this._speedFactor=n.speedFactor||1,this.options.speed&&this.options.speed!="summary"&&(this._registerAxisScale({axis:"y",position:"right",scale:{min:0,max:1},tickPadding:16,label:i.label,labelX:25,labelY:-8,name:"speed"}),this._registerAreaPath({name:"speed",label:"Speed",yAttr:"speed",scaleX:"distance",scaleY:"speed",color:"#03ffff",strokeColor:"#000",strokeOpacity:"0.5",fillOpacity:"0.25"})),this.on("elepoint_added",function(t){let s=this._data,o=t.index,h=s[o].time,c=o>0?s[o-1].time:h,d=h-c,y=this.track_info,_=y.speed_max||-1/0,v=y.speed_min||1/0,x=y.speed_avg||0,w=0;if(d>0){let C=(s[o].dist-s[o>0?o-1:o].dist)*1e3;w=Math.abs(C/d*this._timeFactor)*this._speedFactor}if(this.options.speedDeltaMax){let C=o>0?w-s[o-1].speed:0,A=this.options.speedDeltaMax;Math.abs(C)>A&&(w=s[o-1].speed+A*Math.sign(C))}if(this.options.speedRange){let C=this.options.speedRange;w<C[0]?w=C[0]:w>C[1]&&(w=C[1])}w=L.Util.formatNum(w,2),_=w>_?w:_,v=w<v?w:v,x=(w+x)/2,s[o].speed=w,y.speed_max=_,y.speed_min=v,y.speed_avg=x}),this.options.speed&&(this._registerFocusLabel({name:"speed",chart:t=>t.speed+" "+i.label,marker:t=>Math.round(t.speed)+" "+i.label}),this._registerSummary({minspeed:{label:"Min Speed: ",value:t=>Math.round(t.speed_min||0)+"&nbsp;"+i.label},maxspeed:{label:"Max Speed: ",value:t=>Math.round(t.speed_max||0)+"&nbsp;"+i.label},avgspeed:{label:"Avg Speed: ",value:t=>Math.round(t.speed_avg||0)+"&nbsp;"+i.label}}))});re.addInitHook(function(){if(!this.options.acceleration)return;let n=this.options,i={};i.label=n.accelerationLabel||L._(this.options.imperial?"ft/s\xB2":"m/s\xB2"),this._accelerationFactor=n.accelerationFactor||1,this.options.acceleration!="summary"&&(this._registerAxisScale({axis:"y",position:"right",scale:{min:0,max:1},tickPadding:16,label:i.label,labelX:25,labelY:-8,name:"acceleration"}),this._registerAreaPath({name:"acceleration",label:"Acceleration",yAttr:"acceleration",scaleX:"distance",scaleY:"acceleration",color:"#050402",strokeColor:"#000",strokeOpacity:"0.5",fillOpacity:"0.25"})),this.on("elepoint_added",function(t){let s=this._data,o=t.index,h=s[o].time,c=o>0?s[o-1].time:h,d=(h-c)/1e3,y=this.track_info,_=y.acceleration_max||-1/0,v=y.acceleration_min||1/0,x=y.acceleration_avg||0,w=0;if(d>0){let C=s[o].speed,A=o>0?s[o-1].speed:C,I=(C-A)*(1e3/this._timeFactor);w=Math.abs(I/d)*this._accelerationFactor}if(this.options.accelerationDeltaMax){let C=o>0?w-s[o-1].acceleration:0,A=this.options.accelerationDeltaMax;Math.abs(C)>A&&(w=s[o-1].acceleration+A*Math.sign(C))}if(this.options.accelerationRange){let C=this.options.accelerationRange;w<C[0]?w=C[0]:w>C[1]&&(w=C[1])}w=L.Util.formatNum(w,2),w>_&&(_=w),w<v&&(v=w),x=(w+x)/2,s[o].acceleration=w,y.acceleration_max=_,y.acceleration_min=v,y.acceleration_avg=x}),this._registerFocusLabel({name:"acceleration",chart:t=>t.acceleration+" "+i.label,marker:t=>Math.round(t.acceleration)+" "+i.label}),this._registerSummary({minacceleration:{label:"Min Acceleration: ",value:t=>Math.round(t.acceleration_min||0)+"&nbsp;"+i.label},maxacceleration:{label:"Max Acceleration: ",value:t=>Math.round(t.acceleration_max||0)+"&nbsp;"+i.label},avgacceleration:{label:"Avg Acceleration: ",value:t=>Math.round(t.acceleration_avg||0)+"&nbsp;"+i.label}})});re.Utils=Sh;re.Components=Eh;re.Chart=Aa;L.control.elevation=n=>new re(n);var Be=63710088e-1,Ba={centimeters:Be*100,centimetres:Be*100,degrees:Be/111325,feet:Be*3.28084,inches:Be*39.37,kilometers:Be/1e3,kilometres:Be/1e3,meters:Be,metres:Be,miles:Be/1609.344,millimeters:Be*1e3,millimetres:Be*1e3,nauticalmiles:Be/1852,radians:1,yards:Be*1.0936};function ss(n,i,t){t===void 0&&(t={});var s={type:"Feature"};return(t.id===0||t.id)&&(s.id=t.id),t.bbox&&(s.bbox=t.bbox),s.properties=i||{},s.geometry=n,s}function Ah(n,i,t){if(t===void 0&&(t={}),!n)throw new Error("coordinates is required");if(!Array.isArray(n))throw new Error("coordinates must be an Array");if(n.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!Da(n[0])||!Da(n[1]))throw new Error("coordinates must contain numbers");var s={type:"Point",coordinates:n};return ss(s,i,t)}function Tn(n,i,t){if(t===void 0&&(t={}),n.length<2)throw new Error("coordinates must be an array of two or more positions");var s={type:"LineString",coordinates:n};return ss(s,i,t)}function Bh(n,i){i===void 0&&(i={});var t={type:"FeatureCollection"};return i.id&&(t.id=i.id),i.bbox&&(t.bbox=i.bbox),t.features=n,t}function Dh(n,i){i===void 0&&(i="kilometers");var t=Ba[i];if(!t)throw new Error(i+" units is invalid");return n*t}function Rh(n,i){i===void 0&&(i="kilometers");var t=Ba[i];if(!t)throw new Error(i+" units is invalid");return n/t}function eo(n){var i=n%(2*Math.PI);return i*180/Math.PI}function ti(n){var i=n%360;return i*Math.PI/180}function Da(n){return!isNaN(n)&&n!==null&&!Array.isArray(n)}function Ra(n){return!!n&&n.constructor===Object}function os(n,i,t){if(n!==null)for(var s,o,h,c,d,y,_,v=0,x=0,w,C=n.type,A=C==="FeatureCollection",I=C==="Feature",R=A?n.features.length:1,P=0;P<R;P++){_=A?n.features[P].geometry:I?n.geometry:n,w=_?_.type==="GeometryCollection":!1,d=w?_.geometries.length:1;for(var E=0;E<d;E++){var z=0,j=0;if(c=w?_.geometries[E]:_,c!==null){y=c.coordinates;var q=c.type;switch(v=t&&(q==="Polygon"||q==="MultiPolygon")?1:0,q){case null:break;case"Point":if(i(y,x,P,z,j)===!1)return!1;x++,z++;break;case"LineString":case"MultiPoint":for(s=0;s<y.length;s++){if(i(y[s],x,P,z,j)===!1)return!1;x++,q==="MultiPoint"&&z++}q==="LineString"&&z++;break;case"Polygon":case"MultiLineString":for(s=0;s<y.length;s++){for(o=0;o<y[s].length-v;o++){if(i(y[s][o],x,P,z,j)===!1)return!1;x++}q==="MultiLineString"&&z++,q==="Polygon"&&j++}q==="Polygon"&&z++;break;case"MultiPolygon":for(s=0;s<y.length;s++){for(j=0,o=0;o<y[s].length;o++){for(h=0;h<y[s][o].length-v;h++){if(i(y[s][o][h],x,P,z,j)===!1)return!1;x++}j++}z++}break;case"GeometryCollection":for(s=0;s<c.geometries.length;s++)if(os(c.geometries[s],i,t)===!1)return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function Pf(n){var i=[];return os(n,function(t){i.push(t)}),i}function zh(n,i){var t,s,o,h,c,d,y,_,v,x,w=0,C=n.type==="FeatureCollection",A=n.type==="Feature",I=C?n.features.length:1;for(t=0;t<I;t++){for(d=C?n.features[t].geometry:A?n.geometry:n,_=C?n.features[t].properties:A?n.properties:{},v=C?n.features[t].bbox:A?n.bbox:void 0,x=C?n.features[t].id:A?n.id:void 0,y=d?d.type==="GeometryCollection":!1,c=y?d.geometries.length:1,o=0;o<c;o++){if(h=y?d.geometries[o]:d,h===null){if(i(null,w,_,v,x)===!1)return!1;continue}switch(h.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":{if(i(h,w,_,v,x)===!1)return!1;break}case"GeometryCollection":{for(s=0;s<h.geometries.length;s++)if(i(h.geometries[s],w,_,v,x)===!1)return!1;break}default:throw new Error("Unknown Geometry Type")}}w++}}function za(n,i){zh(n,function(t,s,o,h,c){var d=t===null?null:t.type;switch(d){case null:case"Point":case"LineString":case"Polygon":return i(ss(t,o,{bbox:h,id:c}),s,0)===!1?!1:void 0}var y;switch(d){case"MultiPoint":y="Point";break;case"MultiLineString":y="LineString";break;case"MultiPolygon":y="Polygon";break}for(var _=0;_<t.coordinates.length;_++){var v=t.coordinates[_],x={type:y,coordinates:v};if(i(ss(x,o),s,_)===!1)return!1}})}function Nh(n,i){za(n,function(t,s,o){var h=0;if(!!t.geometry){var c=t.geometry.type;if(!(c==="Point"||c==="MultiPoint")){var d,y=0,_=0,v=0;if(os(t,function(x,w,C,A,I){if(d===void 0||s>y||A>_||I>v){d=x,y=s,_=A,v=I,h=0;return}var R=Tn([d,x],t.properties);if(i(R,s,o,I,h)===!1)return!1;h++,d=x})===!1)return!1}}})}function Fh(n,i,t){var s=t,o=!1;return Nh(n,function(h,c,d,y,_){o===!1&&t===void 0?s=h:s=i(s,h,c,d,y,_),o=!0}),s}function Na(n){var i=[1/0,1/0,-1/0,-1/0];return os(n,function(t){i[0]>t[0]&&(i[0]=t[0]),i[1]>t[1]&&(i[1]=t[1]),i[2]<t[0]&&(i[2]=t[0]),i[3]<t[1]&&(i[3]=t[1])}),i}Na.default=Na;function mr(n){if(!n)throw new Error("coord is required");if(!Array.isArray(n)){if(n.type==="Feature"&&n.geometry!==null&&n.geometry.type==="Point")return n.geometry.coordinates;if(n.type==="Point")return n.coordinates}if(Array.isArray(n)&&n.length>=2&&!Array.isArray(n[0])&&!Array.isArray(n[1]))return n;throw new Error("coord must be GeoJSON Point or an Array of numbers")}function Fa(n,i,t){t===void 0&&(t={});var s=mr(n),o=mr(i),h=ti(o[1]-s[1]),c=ti(o[0]-s[0]),d=ti(s[1]),y=ti(o[1]),_=Math.pow(Math.sin(h/2),2)+Math.pow(Math.sin(c/2),2)*Math.cos(d)*Math.cos(y);return Dh(2*Math.atan2(Math.sqrt(_),Math.sqrt(1-_)),t.units)}function Ga(n,i,t,s){s===void 0&&(s={});var o=mr(n),h=ti(o[0]),c=ti(o[1]),d=ti(t),y=Rh(i,s.units),_=Math.asin(Math.sin(c)*Math.cos(y)+Math.cos(c)*Math.sin(y)*Math.cos(d)),v=h+Math.atan2(Math.sin(d)*Math.sin(y)*Math.cos(c),Math.cos(y)-Math.sin(c)*Math.sin(_)),x=eo(v),w=eo(_);return Ah([x,w],s.properties)}function io(n,i,t){if(t===void 0&&(t={}),t.final===!0)return Gh(n,i);var s=mr(n),o=mr(i),h=ti(s[0]),c=ti(o[0]),d=ti(s[1]),y=ti(o[1]),_=Math.sin(c-h)*Math.cos(y),v=Math.cos(d)*Math.sin(y)-Math.sin(d)*Math.cos(y)*Math.cos(c-h);return eo(Math.atan2(_,v))}function Gh(n,i){var t=io(i,n);return t=(t+180)%360,t}function jh(n,i){return i===void 0&&(i={}),Fh(n,function(t,s){var o=s.geometry.coordinates;return t+Fa(o[0],o[1],i)},0)}function Uh(n,i,t,s){if(s=s||{},!Ra(s))throw new Error("options is invalid");var o,h=[];if(n.type==="Feature")o=n.geometry.coordinates;else if(n.type==="LineString")o=n.coordinates;else throw new Error("input must be a LineString Feature or Geometry");for(var c=o.length,d=0,y,_,v,x=0;x<o.length&&!(i>=d&&x===o.length-1);x++){if(d>i&&h.length===0){if(y=i-d,!y)return h.push(o[x]),Tn(h);_=io(o[x],o[x-1])-180,v=Ga(o[x],y,_,s),h.push(v.geometry.coordinates)}if(d>=t)return y=t-d,y?(_=io(o[x],o[x-1])-180,v=Ga(o[x],y,_,s),h.push(v.geometry.coordinates),Tn(h)):(h.push(o[x]),Tn(h));if(d>=i&&h.push(o[x]),x===o.length-1)return Tn(h);d+=Fa(o[x],o[x+1],s)}if(d<i&&o.length===c)throw new Error("Start position is beyond line");var w=o[o.length-1];return Tn([w,w])}function Sf(n,i,t){if(t=t||{},!Ra(t))throw new Error("options is invalid");var s=t.units,o=t.reverse;if(!n)throw new Error("geojson is required");if(i<=0)throw new Error("segmentLength must be greater than 0");var h=[];return za(n,function(c){o&&(c.geometry.coordinates=c.geometry.coordinates.reverse()),Zh(c,i,s,function(d){h.push(d)})}),Bh(h)}function Zh(n,i,t,s){var o=jh(n,{units:t});if(o<=i)return s(n);var h=o/i;Number.isInteger(h)||(h=Math.floor(h)+1);for(var c=0;c<h;c++){var d=Uh(n,i*c,i*(c+1),{units:t});s(d,c)}}function xe(n){return(i,...t)=>qh(n,i,t)}function On(n,i){return xe(Vh(n,i).get)}const{apply:qh,construct:Cf,defineProperty:Ef,get:Tf,getOwnPropertyDescriptor:Vh,getPrototypeOf:no,has:Of,ownKeys:If,set:Af,setPrototypeOf:Bf}=Reflect,{iterator:gr,species:Df,toStringTag:ja,for:Rf}=Symbol,Hh=Object,{create:Ua,defineProperty:zf,freeze:Nf,is:Ff}=Hh,$h=Array,Kh=$h.prototype,Za=Kh[gr],Xh=xe(Za),qa=ArrayBuffer;On(qa.prototype,"byteLength");const Va=typeof SharedArrayBuffer!="undefined"?SharedArrayBuffer:null;Va&&On(Va.prototype,"byteLength");const Ha=no(Uint8Array);Ha.from;const Pe=Ha.prototype;Pe[gr];xe(Pe.keys);xe(Pe.values);xe(Pe.entries);xe(Pe.set);xe(Pe.reverse);xe(Pe.fill);xe(Pe.copyWithin);xe(Pe.sort);xe(Pe.slice);xe(Pe.subarray);On(Pe,"buffer");On(Pe,"byteOffset");On(Pe,"length");On(Pe,ja);const In=Uint32Array,Yh=Float32Array,$a=no([][gr]()),Jh=xe($a.next),Wh=xe(function*(){}().next),Qh=no($a),tu=DataView.prototype,eu=xe(tu.getUint16),Ka=WeakMap,iu=Ka.prototype,nu=xe(iu.get),Xa=new qa(4),ru=new Yh(Xa),su=new In(Xa),li=new In(512),hi=new In(512);for(let n=0;n<256;++n){const i=n-127;i<-27?(li[n]=0,li[n|256]=32768,hi[n]=24,hi[n|256]=24):i<-14?(li[n]=1024>>-i-14,li[n|256]=1024>>-i-14|32768,hi[n]=-i-1,hi[n|256]=-i-1):i<=15?(li[n]=i+15<<10,li[n|256]=i+15<<10|32768,hi[n]=13,hi[n|256]=13):i<128?(li[n]=31744,li[n|256]=64512,hi[n]=24,hi[n|256]=24):(li[n]=31744,li[n|256]=64512,hi[n]=13,hi[n|256]=13)}const as=new In(2048),rn=new In(64),ls=new In(64);as[0]=0;for(let n=1;n<1024;++n){let i=n<<13,t=0;for(;(i&8388608)==0;)t-=8388608,i<<=1;i&=~8388608,t+=947912704,as[n]=i|t}for(let n=1024;n<2048;++n)as[n]=939524096+(n-1024<<13);rn[0]=0;for(let n=1;n<31;++n)rn[n]=n<<23;rn[31]=1199570944;rn[32]=2147483648;for(let n=33;n<63;++n)rn[n]=2147483648+(n-32<<23);rn[63]=3347054592;ls[0]=0;for(let n=1;n<64;++n)n===32?ls[n]=0:ls[n]=1024;function ou(n){const i=n>>10;return su[0]=as[ls[i]+(n&1023)]+rn[i],ru[0]}function au(n){if(n[gr]===Za)return n;const i=Xh(n);return Ua(null,{next:{value:function(){return Jh(i)}},[gr]:{value:function(){return this}}})}const lu=new Ka;Ua(Qh,{next:{value:function(){const i=nu(lu,this);return Wh(i)},writable:!0,configurable:!0},[ja]:{value:"Array Iterator",configurable:!0}});function Ya(n,i,...t){return ou(eu(n,i,...au(t)))}function hu(n,i,t){const s=t&&t.debug||!1;s&&console.log("getting "+i+" in "+n);const o=typeof n=="object"?n.outer:n,h=`${i}\\="([^"]*)"`;s&&console.log("pattern:",h);const d=new RegExp(h).exec(o);if(s&&console.log("match:",d),d)return d[1]}var Ja=hu;function uu(n,i,t){const o=new RegExp(i).exec(n.slice(t));return o?t+o.index:-1}var cu=uu;const ro=cu;function fu(n,i,t){const s=t&&t.debug||!1,o=t&&t.startIndex||0;s&&console.log("starting findTagByName with",i," and ",t);const h=ro(n,`<${i}[ >]`,o);if(s&&console.log("start:",h),h===-1)return;const c=n.slice(h+i.length);let d=ro(c,"[ /]"+i+">",0);const y=d===-1;y&&(d=ro(c,"[ /]>",0));const _=h+i.length+d+1+(y?0:i.length)+1;if(s&&console.log("end:",_),_===-1)return;const v=n.slice(h,_);let x;return y?x=null:x=v.slice(v.indexOf(">")+1,v.lastIndexOf("<")),{inner:x,outer:v,start:h,end:_}}var du=fu;const pu=du;function mu(n,i,t){const s=[],o=t&&t.debug||!1;let h=t&&t.startIndex||0,c;for(;c=pu(n,i,{debug:o,startIndex:h});)h=c.end,s.push(c);return o&&console.log("findTagsByName found",s.length,"tags"),s}var gu=mu;const _r={315:"Artist",258:"BitsPerSample",265:"CellLength",264:"CellWidth",320:"ColorMap",259:"Compression",33432:"Copyright",306:"DateTime",338:"ExtraSamples",266:"FillOrder",289:"FreeByteCounts",288:"FreeOffsets",291:"GrayResponseCurve",290:"GrayResponseUnit",316:"HostComputer",270:"ImageDescription",257:"ImageLength",256:"ImageWidth",271:"Make",281:"MaxSampleValue",280:"MinSampleValue",272:"Model",254:"NewSubfileType",274:"Orientation",262:"PhotometricInterpretation",284:"PlanarConfiguration",296:"ResolutionUnit",278:"RowsPerStrip",277:"SamplesPerPixel",305:"Software",279:"StripByteCounts",273:"StripOffsets",255:"SubfileType",263:"Threshholding",282:"XResolution",283:"YResolution",326:"BadFaxLines",327:"CleanFaxData",343:"ClipPath",328:"ConsecutiveBadFaxLines",433:"Decode",434:"DefaultImageColor",269:"DocumentName",336:"DotRange",321:"HalftoneHints",346:"Indexed",347:"JPEGTables",285:"PageName",297:"PageNumber",317:"Predictor",319:"PrimaryChromaticities",532:"ReferenceBlackWhite",339:"SampleFormat",340:"SMinSampleValue",341:"SMaxSampleValue",559:"StripRowCounts",330:"SubIFDs",292:"T4Options",293:"T6Options",325:"TileByteCounts",323:"TileLength",324:"TileOffsets",322:"TileWidth",301:"TransferFunction",318:"WhitePoint",344:"XClipPathUnits",286:"XPosition",529:"YCbCrCoefficients",531:"YCbCrPositioning",530:"YCbCrSubSampling",345:"YClipPathUnits",287:"YPosition",37378:"ApertureValue",40961:"ColorSpace",36868:"DateTimeDigitized",36867:"DateTimeOriginal",34665:"Exif IFD",36864:"ExifVersion",33434:"ExposureTime",41728:"FileSource",37385:"Flash",40960:"FlashpixVersion",33437:"FNumber",42016:"ImageUniqueID",37384:"LightSource",37500:"MakerNote",37377:"ShutterSpeedValue",37510:"UserComment",33723:"IPTC",34675:"ICC Profile",700:"XMP",42112:"GDAL_METADATA",42113:"GDAL_NODATA",34377:"Photoshop",33550:"ModelPixelScale",33922:"ModelTiepoint",34264:"ModelTransformation",34735:"GeoKeyDirectory",34736:"GeoDoubleParams",34737:"GeoAsciiParams",50674:"LercParameters"},ui={};for(const n in _r)_r.hasOwnProperty(n)&&(ui[_r[n]]=parseInt(n,10));const _u=[ui.BitsPerSample,ui.ExtraSamples,ui.SampleFormat,ui.StripByteCounts,ui.StripOffsets,ui.StripRowCounts,ui.TileByteCounts,ui.TileOffsets,ui.SubIFDs],so={1:"BYTE",2:"ASCII",3:"SHORT",4:"LONG",5:"RATIONAL",6:"SBYTE",7:"UNDEFINED",8:"SSHORT",9:"SLONG",10:"SRATIONAL",11:"FLOAT",12:"DOUBLE",13:"IFD",16:"LONG8",17:"SLONG8",18:"IFD8"},Ot={};for(const n in so)so.hasOwnProperty(n)&&(Ot[so[n]]=parseInt(n,10));const Ge={WhiteIsZero:0,BlackIsZero:1,RGB:2,Palette:3,TransparencyMask:4,CMYK:5,YCbCr:6,CIELab:8,ICCLab:9},yu={Unspecified:0,Assocalpha:1,Unassalpha:2},Gf={Version:0,AddCompression:1},jf={None:0,Deflate:1},hs={1024:"GTModelTypeGeoKey",1025:"GTRasterTypeGeoKey",1026:"GTCitationGeoKey",2048:"GeographicTypeGeoKey",2049:"GeogCitationGeoKey",2050:"GeogGeodeticDatumGeoKey",2051:"GeogPrimeMeridianGeoKey",2052:"GeogLinearUnitsGeoKey",2053:"GeogLinearUnitSizeGeoKey",2054:"GeogAngularUnitsGeoKey",2055:"GeogAngularUnitSizeGeoKey",2056:"GeogEllipsoidGeoKey",2057:"GeogSemiMajorAxisGeoKey",2058:"GeogSemiMinorAxisGeoKey",2059:"GeogInvFlatteningGeoKey",2060:"GeogAzimuthUnitsGeoKey",2061:"GeogPrimeMeridianLongGeoKey",2062:"GeogTOWGS84GeoKey",3072:"ProjectedCSTypeGeoKey",3073:"PCSCitationGeoKey",3074:"ProjectionGeoKey",3075:"ProjCoordTransGeoKey",3076:"ProjLinearUnitsGeoKey",3077:"ProjLinearUnitSizeGeoKey",3078:"ProjStdParallel1GeoKey",3079:"ProjStdParallel2GeoKey",3080:"ProjNatOriginLongGeoKey",3081:"ProjNatOriginLatGeoKey",3082:"ProjFalseEastingGeoKey",3083:"ProjFalseNorthingGeoKey",3084:"ProjFalseOriginLongGeoKey",3085:"ProjFalseOriginLatGeoKey",3086:"ProjFalseOriginEastingGeoKey",3087:"ProjFalseOriginNorthingGeoKey",3088:"ProjCenterLongGeoKey",3089:"ProjCenterLatGeoKey",3090:"ProjCenterEastingGeoKey",3091:"ProjCenterNorthingGeoKey",3092:"ProjScaleAtNatOriginGeoKey",3093:"ProjScaleAtCenterGeoKey",3094:"ProjAzimuthAngleGeoKey",3095:"ProjStraightVertPoleLongGeoKey",3096:"ProjRectifiedGridAngleGeoKey",4096:"VerticalCSTypeGeoKey",4097:"VerticalCitationGeoKey",4098:"VerticalDatumGeoKey",4099:"VerticalUnitsGeoKey"},vu={};for(const n in hs)hs.hasOwnProperty(n)&&(vu[hs[n]]=parseInt(n,10));function bu(n,i){const{width:t,height:s}=n,o=new Uint8Array(t*s*3);let h;for(let c=0,d=0;c<n.length;++c,d+=3)h=256-n[c]/i*256,o[d]=h,o[d+1]=h,o[d+2]=h;return o}function xu(n,i){const{width:t,height:s}=n,o=new Uint8Array(t*s*3);let h;for(let c=0,d=0;c<n.length;++c,d+=3)h=n[c]/i*256,o[d]=h,o[d+1]=h,o[d+2]=h;return o}function Lu(n,i){const{width:t,height:s}=n,o=new Uint8Array(t*s*3),h=i.length/3,c=i.length/3*2;for(let d=0,y=0;d<n.length;++d,y+=3){const _=n[d];o[y]=i[_]/65536*256,o[y+1]=i[_+h]/65536*256,o[y+2]=i[_+c]/65536*256}return o}function wu(n){const{width:i,height:t}=n,s=new Uint8Array(i*t*3);for(let o=0,h=0;o<n.length;o+=4,h+=3){const c=n[o],d=n[o+1],y=n[o+2],_=n[o+3];s[h]=255*((255-c)/256)*((255-_)/256),s[h+1]=255*((255-d)/256)*((255-_)/256),s[h+2]=255*((255-y)/256)*((255-_)/256)}return s}function ku(n){const{width:i,height:t}=n,s=new Uint8ClampedArray(i*t*3);for(let o=0,h=0;o<n.length;o+=3,h+=3){const c=n[o],d=n[o+1],y=n[o+2];s[h]=c+1.402*(y-128),s[h+1]=c-.34414*(d-128)-.71414*(y-128),s[h+2]=c+1.772*(d-128)}return s}const Mu=.95047,Pu=1,Su=1.08883;function Cu(n){const{width:i,height:t}=n,s=new Uint8Array(i*t*3);for(let o=0,h=0;o<n.length;o+=3,h+=3){const c=n[o+0],d=n[o+1]<<24>>24,y=n[o+2]<<24>>24;let _=(c+16)/116,v=d/500+_,x=_-y/200,w,C,A;v=Mu*(v*v*v>.008856?v*v*v:(v-16/116)/7.787),_=Pu*(_*_*_>.008856?_*_*_:(_-16/116)/7.787),x=Su*(x*x*x>.008856?x*x*x:(x-16/116)/7.787),w=v*3.2406+_*-1.5372+x*-.4986,C=v*-.9689+_*1.8758+x*.0415,A=v*.0557+_*-.204+x*1.057,w=w>.0031308?1.055*w**(1/2.4)-.055:12.92*w,C=C>.0031308?1.055*C**(1/2.4)-.055:12.92*C,A=A>.0031308?1.055*A**(1/2.4)-.055:12.92*A,s[h]=Math.max(0,Math.min(1,w))*255,s[h+1]=Math.max(0,Math.min(1,C))*255,s[h+2]=Math.max(0,Math.min(1,A))*255}return s}const Wa=new Map;function sn(n,i){Array.isArray(n)||(n=[n]),n.forEach(t=>Wa.set(t,i))}async function Eu(n){const i=Wa.get(n.Compression);if(!i)throw new Error(`Unknown compression method identifier: ${n.Compression}`);const t=await i();return new t(n)}sn([void 0,1],()=>import("./raw.687e8cce.js").then(n=>n.default));sn(5,()=>import("./lzw.caf16eda.js").then(n=>n.default));sn(6,()=>{throw new Error("old style JPEG compression is not supported.")});sn(7,()=>import("./jpeg.f3e1871d.js").then(n=>n.default));sn([8,32946],()=>import("./deflate.a9d67654.js").then(n=>n.default));sn(32773,()=>import("./packbits.1e87d104.js").then(n=>n.default));sn(34887,()=>import("./lerc.77078604.js").then(n=>n.default));function us(n,i,t,s=1){return new(Object.getPrototypeOf(n)).constructor(i*t*s)}function Tu(n,i,t,s,o){const h=i/s,c=t/o;return n.map(d=>{const y=us(d,s,o);for(let _=0;_<o;++_){const v=Math.min(Math.round(c*_),t-1);for(let x=0;x<s;++x){const w=Math.min(Math.round(h*x),i-1),C=d[v*i+w];y[_*s+x]=C}}return y})}function An(n,i,t){return(1-t)*n+t*i}function Ou(n,i,t,s,o){const h=i/s,c=t/o;return n.map(d=>{const y=us(d,s,o);for(let _=0;_<o;++_){const v=c*_,x=Math.floor(v),w=Math.min(Math.ceil(v),t-1);for(let C=0;C<s;++C){const A=h*C,I=A%1,R=Math.floor(A),P=Math.min(Math.ceil(A),i-1),E=d[x*i+R],z=d[x*i+P],j=d[w*i+R],q=d[w*i+P],et=An(An(E,z,I),An(j,q,I),v%1);y[_*s+C]=et}}return y})}function Iu(n,i,t,s,o,h="nearest"){switch(h.toLowerCase()){case"nearest":return Tu(n,i,t,s,o);case"bilinear":case"linear":return Ou(n,i,t,s,o);default:throw new Error(`Unsupported resampling method: '${h}'`)}}function Au(n,i,t,s,o,h){const c=i/s,d=t/o,y=us(n,s,o,h);for(let _=0;_<o;++_){const v=Math.min(Math.round(d*_),t-1);for(let x=0;x<s;++x){const w=Math.min(Math.round(c*x),i-1);for(let C=0;C<h;++C){const A=n[v*i*h+w*h+C];y[_*s*h+x*h+C]=A}}}return y}function Bu(n,i,t,s,o,h){const c=i/s,d=t/o,y=us(n,s,o,h);for(let _=0;_<o;++_){const v=d*_,x=Math.floor(v),w=Math.min(Math.ceil(v),t-1);for(let C=0;C<s;++C){const A=c*C,I=A%1,R=Math.floor(A),P=Math.min(Math.ceil(A),i-1);for(let E=0;E<h;++E){const z=n[x*i*h+R*h+E],j=n[x*i*h+P*h+E],q=n[w*i*h+R*h+E],et=n[w*i*h+P*h+E],J=An(An(z,j,I),An(q,et,I),v%1);y[_*s*h+C*h+E]=J}}}return y}function Du(n,i,t,s,o,h,c="nearest"){switch(c.toLowerCase()){case"nearest":return Au(n,i,t,s,o,h);case"bilinear":case"linear":return Bu(n,i,t,s,o,h);default:throw new Error(`Unsupported resampling method: '${c}'`)}}function Ru(n,i,t){let s=0;for(let o=i;o<t;++o)s+=n[o];return s}function oo(n,i,t){switch(n){case 1:if(i<=8)return new Uint8Array(t);if(i<=16)return new Uint16Array(t);if(i<=32)return new Uint32Array(t);break;case 2:if(i===8)return new Int8Array(t);if(i===16)return new Int16Array(t);if(i===32)return new Int32Array(t);break;case 3:switch(i){case 16:case 32:return new Float32Array(t);case 64:return new Float64Array(t)}break}throw Error("Unsupported data format/bitsPerSample")}function zu(n,i){return(n===1||n===2)&&i<=32&&i%8==0?!1:!(n===3&&(i===16||i===32||i===64))}function Nu(n,i,t,s,o,h,c){const d=new DataView(n),y=t===2?c*h:c*h*s,_=t===2?1:s,v=oo(i,o,y),x=parseInt("1".repeat(o),2);if(i===1){let w;t===1?w=s*o:w=o;let C=h*w;(C&7)!=0&&(C=C+7&~7);for(let A=0;A<c;++A){const I=A*C;for(let R=0;R<h;++R){const P=I+R*_*o;for(let E=0;E<_;++E){const z=P+E*o,j=(A*h+R)*_+E,q=Math.floor(z/8),et=z%8;if(et+o<=8)v[j]=d.getUint8(q)>>8-o-et&x;else if(et+o<=16)v[j]=d.getUint16(q)>>16-o-et&x;else if(et+o<=24){const J=d.getUint16(q)<<8|d.getUint8(q+2);v[j]=J>>24-o-et&x}else v[j]=d.getUint32(q)>>32-o-et&x}}}}return v.buffer}class Fu{constructor(i,t,s,o,h,c){this.fileDirectory=i,this.geoKeys=t,this.dataView=s,this.littleEndian=o,this.tiles=h?{}:null,this.isTiled=!i.StripOffsets;const d=i.PlanarConfiguration;if(this.planarConfiguration=typeof d=="undefined"?1:d,this.planarConfiguration!==1&&this.planarConfiguration!==2)throw new Error("Invalid planar configuration.");this.source=c}getFileDirectory(){return this.fileDirectory}getGeoKeys(){return this.geoKeys}getWidth(){return this.fileDirectory.ImageWidth}getHeight(){return this.fileDirectory.ImageLength}getSamplesPerPixel(){return typeof this.fileDirectory.SamplesPerPixel!="undefined"?this.fileDirectory.SamplesPerPixel:1}getTileWidth(){return this.isTiled?this.fileDirectory.TileWidth:this.getWidth()}getTileHeight(){return this.isTiled?this.fileDirectory.TileLength:typeof this.fileDirectory.RowsPerStrip!="undefined"?Math.min(this.fileDirectory.RowsPerStrip,this.getHeight()):this.getHeight()}getBlockWidth(){return this.getTileWidth()}getBlockHeight(i){return this.isTiled||(i+1)*this.getTileHeight()<=this.getHeight()?this.getTileHeight():this.getHeight()-i*this.getTileHeight()}getBytesPerPixel(){let i=0;for(let t=0;t<this.fileDirectory.BitsPerSample.length;++t)i+=this.getSampleByteSize(t);return i}getSampleByteSize(i){if(i>=this.fileDirectory.BitsPerSample.length)throw new RangeError(`Sample index ${i} is out of range.`);return Math.ceil(this.fileDirectory.BitsPerSample[i]/8)}getReaderForSample(i){const t=this.fileDirectory.SampleFormat?this.fileDirectory.SampleFormat[i]:1,s=this.fileDirectory.BitsPerSample[i];switch(t){case 1:if(s<=8)return DataView.prototype.getUint8;if(s<=16)return DataView.prototype.getUint16;if(s<=32)return DataView.prototype.getUint32;break;case 2:if(s<=8)return DataView.prototype.getInt8;if(s<=16)return DataView.prototype.getInt16;if(s<=32)return DataView.prototype.getInt32;break;case 3:switch(s){case 16:return function(o,h){return Ya(this,o,h)};case 32:return DataView.prototype.getFloat32;case 64:return DataView.prototype.getFloat64}break}throw Error("Unsupported data format/bitsPerSample")}getSampleFormat(i=0){return this.fileDirectory.SampleFormat?this.fileDirectory.SampleFormat[i]:1}getBitsPerSample(i=0){return this.fileDirectory.BitsPerSample[i]}getArrayForSample(i,t){const s=this.getSampleFormat(i),o=this.getBitsPerSample(i);return oo(s,o,t)}async getTileOrStrip(i,t,s,o,h){const c=Math.ceil(this.getWidth()/this.getTileWidth()),d=Math.ceil(this.getHeight()/this.getTileHeight());let y;const{tiles:_}=this;this.planarConfiguration===1?y=t*c+i:this.planarConfiguration===2&&(y=s*c*d+t*c+i);let v,x;this.isTiled?(v=this.fileDirectory.TileOffsets[y],x=this.fileDirectory.TileByteCounts[y]):(v=this.fileDirectory.StripOffsets[y],x=this.fileDirectory.StripByteCounts[y]);const w=(await this.source.fetch([{offset:v,length:x}],h))[0];let C;return _===null||!_[y]?(C=(async()=>{let A=await o.decode(this.fileDirectory,w);const I=this.getSampleFormat(),R=this.getBitsPerSample();return zu(I,R)&&(A=Nu(A,I,this.planarConfiguration,this.getSamplesPerPixel(),R,this.getTileWidth(),this.getBlockHeight(t))),A})(),_!==null&&(_[y]=C)):C=_[y],{x:i,y:t,sample:s,data:await C}}async _readRaster(i,t,s,o,h,c,d,y,_){const v=this.getTileWidth(),x=this.getTileHeight(),w=this.getWidth(),C=this.getHeight(),A=Math.max(Math.floor(i[0]/v),0),I=Math.min(Math.ceil(i[2]/v),Math.ceil(w/v)),R=Math.max(Math.floor(i[1]/x),0),P=Math.min(Math.ceil(i[3]/x),Math.ceil(C/x)),E=i[2]-i[0];let z=this.getBytesPerPixel();const j=[],q=[];for(let ht=0;ht<t.length;++ht)this.planarConfiguration===1?j.push(Ru(this.fileDirectory.BitsPerSample,0,t[ht])/8):j.push(0),q.push(this.getReaderForSample(t[ht]));const et=[],{littleEndian:J}=this;for(let ht=R;ht<P;++ht)for(let lt=A;lt<I;++lt)for(let dt=0;dt<t.length;++dt){const gt=dt,vt=t[dt];this.planarConfiguration===2&&(z=this.getSampleByteSize(dt));const At=this.getTileOrStrip(lt,ht,vt,h,_);et.push(At),At.then(K=>{const rt=K.data,ft=new DataView(rt),zt=this.getBlockHeight(K.y),ot=K.y*x,It=K.x*v,kt=ot+zt,Rt=(K.x+1)*v,se=q[gt],Kt=Math.min(zt,zt-(kt-i[3]),C-ot),$t=Math.min(v,v-(Rt-i[2]),w-It);for(let Bt=Math.max(0,i[1]-ot);Bt<Kt;++Bt)for(let Ut=Math.max(0,i[0]-It);Ut<$t;++Ut){const ge=(Bt*v+Ut)*z,_e=se.call(ft,ge+j[gt],J);let Ve;o?(Ve=(Bt+ot-i[1])*E*t.length+(Ut+It-i[0])*t.length+gt,s[Ve]=_e):(Ve=(Bt+ot-i[1])*E+Ut+It-i[0],s[gt][Ve]=_e)}})}if(await Promise.all(et),c&&i[2]-i[0]!==c||d&&i[3]-i[1]!==d){let ht;return o?ht=Du(s,i[2]-i[0],i[3]-i[1],c,d,t.length,y):ht=Iu(s,i[2]-i[0],i[3]-i[1],c,d,y),ht.width=c,ht.height=d,ht}return s.width=c||i[2]-i[0],s.height=d||i[3]-i[1],s}async readRasters({window:i,samples:t=[],interleave:s,pool:o=null,width:h,height:c,resampleMethod:d,fillValue:y,signal:_}={}){const v=i||[0,0,this.getWidth(),this.getHeight()];if(v[0]>v[2]||v[1]>v[3])throw new Error("Invalid subsets");const x=v[2]-v[0],w=v[3]-v[1],C=x*w,A=this.getSamplesPerPixel();if(!t||!t.length)for(let E=0;E<A;++E)t.push(E);else for(let E=0;E<t.length;++E)if(t[E]>=A)return Promise.reject(new RangeError(`Invalid sample index '${t[E]}'.`));let I;if(s){const E=this.fileDirectory.SampleFormat?Math.max.apply(null,this.fileDirectory.SampleFormat):1,z=Math.max.apply(null,this.fileDirectory.BitsPerSample);I=oo(E,z,C*t.length),y&&I.fill(y)}else{I=[];for(let E=0;E<t.length;++E){const z=this.getArrayForSample(t[E],C);Array.isArray(y)&&E<y.length?z.fill(y[E]):y&&!Array.isArray(y)&&z.fill(y),I.push(z)}}const R=o||await Eu(this.fileDirectory);return await this._readRaster(v,t,I,s,R,h,c,d,_)}async readRGB({window:i,interleave:t=!0,pool:s=null,width:o,height:h,resampleMethod:c,enableAlpha:d=!1,signal:y}={}){const _=i||[0,0,this.getWidth(),this.getHeight()];if(_[0]>_[2]||_[1]>_[3])throw new Error("Invalid subsets");const v=this.fileDirectory.PhotometricInterpretation;if(v===Ge.RGB){let P=[0,1,2];if(this.fileDirectory.ExtraSamples!==yu.Unspecified&&d){P=[];for(let E=0;E<this.fileDirectory.BitsPerSample.length;E+=1)P.push(E)}return this.readRasters({window:i,interleave:t,samples:P,pool:s,width:o,height:h,resampleMethod:c,signal:y})}let x;switch(v){case Ge.WhiteIsZero:case Ge.BlackIsZero:case Ge.Palette:x=[0];break;case Ge.CMYK:x=[0,1,2,3];break;case Ge.YCbCr:case Ge.CIELab:x=[0,1,2];break;default:throw new Error("Invalid or unsupported photometric interpretation.")}const w={window:_,interleave:!0,samples:x,pool:s,width:o,height:h,resampleMethod:c,signal:y},{fileDirectory:C}=this,A=await this.readRasters(w),I=2**this.fileDirectory.BitsPerSample[0];let R;switch(v){case Ge.WhiteIsZero:R=bu(A,I);break;case Ge.BlackIsZero:R=xu(A,I);break;case Ge.Palette:R=Lu(A,C.ColorMap);break;case Ge.CMYK:R=wu(A);break;case Ge.YCbCr:R=ku(A);break;case Ge.CIELab:R=Cu(A);break;default:throw new Error("Unsupported photometric interpretation.")}if(!t){const P=new Uint8Array(R.length/3),E=new Uint8Array(R.length/3),z=new Uint8Array(R.length/3);for(let j=0,q=0;j<R.length;j+=3,++q)P[q]=R[j],E[q]=R[j+1],z[q]=R[j+2];R=[P,E,z]}return R.width=A.width,R.height=A.height,R}getTiePoints(){if(!this.fileDirectory.ModelTiepoint)return[];const i=[];for(let t=0;t<this.fileDirectory.ModelTiepoint.length;t+=6)i.push({i:this.fileDirectory.ModelTiepoint[t],j:this.fileDirectory.ModelTiepoint[t+1],k:this.fileDirectory.ModelTiepoint[t+2],x:this.fileDirectory.ModelTiepoint[t+3],y:this.fileDirectory.ModelTiepoint[t+4],z:this.fileDirectory.ModelTiepoint[t+5]});return i}getGDALMetadata(i=null){const t={};if(!this.fileDirectory.GDAL_METADATA)return null;const s=this.fileDirectory.GDAL_METADATA;let o=gu(s,"Item");i!==null&&(o=o.filter(h=>Number(Ja(h,"sample"))===i));for(let h=0;h<o.length;++h){const c=o[h];t[Ja(c,"name")]=c.inner}return t}getGDALNoData(){if(!this.fileDirectory.GDAL_NODATA)return null;const i=this.fileDirectory.GDAL_NODATA;return Number(i.substring(0,i.length-1))}getOrigin(){const i=this.fileDirectory.ModelTiepoint,t=this.fileDirectory.ModelTransformation;if(i&&i.length===6)return[i[3],i[4],i[5]];if(t)return[t[3],t[7],t[11]];throw new Error("The image does not have an affine transformation.")}getResolution(i=null){const t=this.fileDirectory.ModelPixelScale,s=this.fileDirectory.ModelTransformation;if(t)return[t[0],-t[1],t[2]];if(s)return[s[0],s[5],s[10]];if(i){const[o,h,c]=i.getResolution();return[o*i.getWidth()/this.getWidth(),h*i.getHeight()/this.getHeight(),c*i.getWidth()/this.getWidth()]}throw new Error("The image does not have an affine transformation.")}pixelIsArea(){return this.geoKeys.GTRasterTypeGeoKey===1}getBoundingBox(){const i=this.getOrigin(),t=this.getResolution(),s=i[0],o=i[1],h=s+t[0]*this.getWidth(),c=o+t[1]*this.getHeight();return[Math.min(s,h),Math.min(o,c),Math.max(s,h),Math.max(o,c)]}}var Gu=Fu;class ju{constructor(i){this._dataView=new DataView(i)}get buffer(){return this._dataView.buffer}getUint64(i,t){const s=this.getUint32(i,t),o=this.getUint32(i+4,t);let h;if(t){if(h=s+2**32*o,!Number.isSafeInteger(h))throw new Error(`${h} exceeds MAX_SAFE_INTEGER. Precision may be lost. Please report if you get this message to https://github.com/geotiffjs/geotiff.js/issues`);return h}if(h=2**32*s+o,!Number.isSafeInteger(h))throw new Error(`${h} exceeds MAX_SAFE_INTEGER. Precision may be lost. Please report if you get this message to https://github.com/geotiffjs/geotiff.js/issues`);return h}getInt64(i,t){let s=0;const o=(this._dataView.getUint8(i+(t?7:0))&128)>0;let h=!0;for(let c=0;c<8;c++){let d=this._dataView.getUint8(i+(t?c:7-c));o&&(h?d!==0&&(d=~(d-1)&255,h=!1):d=~d&255),s+=d*256**c}return o&&(s=-s),s}getUint8(i,t){return this._dataView.getUint8(i,t)}getInt8(i,t){return this._dataView.getInt8(i,t)}getUint16(i,t){return this._dataView.getUint16(i,t)}getInt16(i,t){return this._dataView.getInt16(i,t)}getUint32(i,t){return this._dataView.getUint32(i,t)}getInt32(i,t){return this._dataView.getInt32(i,t)}getFloat16(i,t){return Ya(this._dataView,i,t)}getFloat32(i,t){return this._dataView.getFloat32(i,t)}getFloat64(i,t){return this._dataView.getFloat64(i,t)}}class Uu{constructor(i,t,s,o){this._dataView=new DataView(i),this._sliceOffset=t,this._littleEndian=s,this._bigTiff=o}get sliceOffset(){return this._sliceOffset}get sliceTop(){return this._sliceOffset+this.buffer.byteLength}get littleEndian(){return this._littleEndian}get bigTiff(){return this._bigTiff}get buffer(){return this._dataView.buffer}covers(i,t){return this.sliceOffset<=i&&this.sliceTop>=i+t}readUint8(i){return this._dataView.getUint8(i-this._sliceOffset,this._littleEndian)}readInt8(i){return this._dataView.getInt8(i-this._sliceOffset,this._littleEndian)}readUint16(i){return this._dataView.getUint16(i-this._sliceOffset,this._littleEndian)}readInt16(i){return this._dataView.getInt16(i-this._sliceOffset,this._littleEndian)}readUint32(i){return this._dataView.getUint32(i-this._sliceOffset,this._littleEndian)}readInt32(i){return this._dataView.getInt32(i-this._sliceOffset,this._littleEndian)}readFloat32(i){return this._dataView.getFloat32(i-this._sliceOffset,this._littleEndian)}readFloat64(i){return this._dataView.getFloat64(i-this._sliceOffset,this._littleEndian)}readUint64(i){const t=this.readUint32(i),s=this.readUint32(i+4);let o;if(this._littleEndian){if(o=t+2**32*s,!Number.isSafeInteger(o))throw new Error(`${o} exceeds MAX_SAFE_INTEGER. Precision may be lost. Please report if you get this message to https://github.com/geotiffjs/geotiff.js/issues`);return o}if(o=2**32*t+s,!Number.isSafeInteger(o))throw new Error(`${o} exceeds MAX_SAFE_INTEGER. Precision may be lost. Please report if you get this message to https://github.com/geotiffjs/geotiff.js/issues`);return o}readInt64(i){let t=0;const s=(this._dataView.getUint8(i+(this._littleEndian?7:0))&128)>0;let o=!0;for(let h=0;h<8;h++){let c=this._dataView.getUint8(i+(this._littleEndian?h:7-h));s&&(o?c!==0&&(c=~(c-1)&255,o=!1):c=~c&255),t+=c*256**h}return s&&(t=-t),t}readOffset(i){return this._bigTiff?this.readUint64(i):this.readUint32(i)}}class Zu{async fetch(i,t=void 0){return Promise.all(i.map(s=>this.fetchSlice(s,t)))}async fetchSlice(i){throw new Error(`fetching of slice ${i} not possible, not implemented`)}get fileSize(){return null}async close(){}}class ao extends Error{constructor(i){super(i);Error.captureStackTrace&&Error.captureStackTrace(this,ao),this.name="AbortError"}}class qu extends Zu{constructor(i){super();this.arrayBuffer=i}fetchSlice(i,t){if(t&&t.aborted)throw new ao("Request aborted");return this.arrayBuffer.slice(i.offset,i.offset+i.length)}}function Vu(n){return new qu(n)}function lo(n){switch(n){case Ot.BYTE:case Ot.ASCII:case Ot.SBYTE:case Ot.UNDEFINED:return 1;case Ot.SHORT:case Ot.SSHORT:return 2;case Ot.LONG:case Ot.SLONG:case Ot.FLOAT:case Ot.IFD:return 4;case Ot.RATIONAL:case Ot.SRATIONAL:case Ot.DOUBLE:case Ot.LONG8:case Ot.SLONG8:case Ot.IFD8:return 8;default:throw new RangeError(`Invalid field type: ${n}`)}}function Hu(n){const i=n.GeoKeyDirectory;if(!i)return null;const t={};for(let s=4;s<=i[3]*4;s+=4){const o=hs[i[s]],h=i[s+1]?_r[i[s+1]]:null,c=i[s+2],d=i[s+3];let y=null;if(!h)y=d;else{if(y=n[h],typeof y=="undefined"||y===null)throw new Error(`Could not get value of geoKey '${o}'.`);typeof y=="string"?y=y.substring(d,d+c-1):y.subarray&&(y=y.subarray(d,d+c),c===1&&(y=y[0]))}t[o]=y}return t}function Bn(n,i,t,s){let o=null,h=null;const c=lo(i);switch(i){case Ot.BYTE:case Ot.ASCII:case Ot.UNDEFINED:o=new Uint8Array(t),h=n.readUint8;break;case Ot.SBYTE:o=new Int8Array(t),h=n.readInt8;break;case Ot.SHORT:o=new Uint16Array(t),h=n.readUint16;break;case Ot.SSHORT:o=new Int16Array(t),h=n.readInt16;break;case Ot.LONG:case Ot.IFD:o=new Uint32Array(t),h=n.readUint32;break;case Ot.SLONG:o=new Int32Array(t),h=n.readInt32;break;case Ot.LONG8:case Ot.IFD8:o=new Array(t),h=n.readUint64;break;case Ot.SLONG8:o=new Array(t),h=n.readInt64;break;case Ot.RATIONAL:o=new Uint32Array(t*2),h=n.readUint32;break;case Ot.SRATIONAL:o=new Int32Array(t*2),h=n.readInt32;break;case Ot.FLOAT:o=new Float32Array(t),h=n.readFloat32;break;case Ot.DOUBLE:o=new Float64Array(t),h=n.readFloat64;break;default:throw new RangeError(`Invalid field type: ${i}`)}if(i===Ot.RATIONAL||i===Ot.SRATIONAL)for(let d=0;d<t;d+=2)o[d]=h.call(n,s+d*c),o[d+1]=h.call(n,s+(d*c+4));else for(let d=0;d<t;++d)o[d]=h.call(n,s+d*c);return i===Ot.ASCII?new TextDecoder("utf-8").decode(o):o}class $u{constructor(i,t,s){this.fileDirectory=i,this.geoKeyDirectory=t,this.nextIFDByteOffset=s}}class cs extends Error{constructor(i){super(`No image at index ${i}`);this.index=i}}class Ku{async readRasters(i={}){const{window:t,width:s,height:o}=i;let{resX:h,resY:c,bbox:d}=i;const y=await this.getImage();let _=y;const v=await this.getImageCount(),x=y.getBoundingBox();if(t&&d)throw new Error('Both "bbox" and "window" passed.');if(s||o){if(t){const[A,I]=y.getOrigin(),[R,P]=y.getResolution();d=[A+t[0]*R,I+t[1]*P,A+t[2]*R,I+t[3]*P]}const C=d||x;if(s){if(h)throw new Error("Both width and resX passed");h=(C[2]-C[0])/s}if(o){if(c)throw new Error("Both width and resY passed");c=(C[3]-C[1])/o}}if(h||c){const C=[];for(let A=0;A<v;++A){const I=await this.getImage(A),{SubfileType:R,NewSubfileType:P}=I.fileDirectory;(A===0||R===2||P&1)&&C.push(I)}C.sort((A,I)=>A.getWidth()-I.getWidth());for(let A=0;A<C.length;++A){const I=C[A],R=(x[2]-x[0])/I.getWidth(),P=(x[3]-x[1])/I.getHeight();if(_=I,h&&h>R||c&&c>P)break}}let w=t;if(d){const[C,A]=y.getOrigin(),[I,R]=_.getResolution(y);w=[Math.round((d[0]-C)/I),Math.round((d[1]-A)/R),Math.round((d[2]-C)/I),Math.round((d[3]-A)/R)],w=[Math.min(w[0],w[2]),Math.min(w[1],w[3]),Math.max(w[0],w[2]),Math.max(w[1],w[3])]}return _.readRasters(jo(Go({},i),{window:w}))}}class ho extends Ku{constructor(i,t,s,o,h={}){super();this.source=i,this.littleEndian=t,this.bigTiff=s,this.firstIFDOffset=o,this.cache=h.cache||!1,this.ifdRequests=[],this.ghostValues=null}async getSlice(i,t){const s=this.bigTiff?4048:1024;return new Uu((await this.source.fetch([{offset:i,length:typeof t!="undefined"?t:s}]))[0],i,this.littleEndian,this.bigTiff)}async parseFileDirectoryAt(i){const t=this.bigTiff?20:12,s=this.bigTiff?8:2;let o=await this.getSlice(i);const h=this.bigTiff?o.readUint64(i):o.readUint16(i),c=h*t+(this.bigTiff?16:6);o.covers(i,c)||(o=await this.getSlice(i,c));const d={};let y=i+(this.bigTiff?8:2);for(let x=0;x<h;y+=t,++x){const w=o.readUint16(y),C=o.readUint16(y+2),A=this.bigTiff?o.readUint64(y+4):o.readUint32(y+4);let I,R;const P=lo(C),E=y+(this.bigTiff?12:8);if(P*A<=(this.bigTiff?8:4))I=Bn(o,C,A,E);else{const z=o.readOffset(E),j=lo(C)*A;if(o.covers(z,j))I=Bn(o,C,A,z);else{const q=await this.getSlice(z,j);I=Bn(q,C,A,z)}}A===1&&_u.indexOf(w)===-1&&!(C===Ot.RATIONAL||C===Ot.SRATIONAL)?R=I[0]:R=I,d[_r[w]]=R}const _=Hu(d),v=o.readOffset(i+s+t*h);return new $u(d,_,v)}async requestIFD(i){if(this.ifdRequests[i])return this.ifdRequests[i];if(i===0)return this.ifdRequests[i]=this.parseFileDirectoryAt(this.firstIFDOffset),this.ifdRequests[i];if(!this.ifdRequests[i-1])try{this.ifdRequests[i-1]=this.requestIFD(i-1)}catch(t){throw t instanceof cs?new cs(i):t}return this.ifdRequests[i]=(async()=>{const t=await this.ifdRequests[i-1];if(t.nextIFDByteOffset===0)throw new cs(i);return this.parseFileDirectoryAt(t.nextIFDByteOffset)})(),this.ifdRequests[i]}async getImage(i=0){const t=await this.requestIFD(i);return new Gu(t.fileDirectory,t.geoKeyDirectory,this.dataView,this.littleEndian,this.cache,this.source)}async getImageCount(){let i=0,t=!0;for(;t;)try{await this.requestIFD(i),++i}catch(s){if(s instanceof cs)t=!1;else throw s}return i}async getGhostValues(){const i=this.bigTiff?16:8;if(this.ghostValues)return this.ghostValues;const t="GDAL_STRUCTURAL_METADATA_SIZE=",s=t.length+100;let o=await this.getSlice(i,s);if(t===Bn(o,Ot.ASCII,t.length,i)){const c=Bn(o,Ot.ASCII,s,i).split(`
`)[0],d=Number(c.split("=")[1].split(" ")[0])+c.length;d>s&&(o=await this.getSlice(i,d));const y=Bn(o,Ot.ASCII,d,i);this.ghostValues={},y.split(`
`).filter(_=>_.length>0).map(_=>_.split("=")).forEach(([_,v])=>{this.ghostValues[_]=v})}return this.ghostValues}static async fromSource(i,t,s){const o=(await i.fetch([{offset:0,length:1024}],s))[0],h=new ju(o),c=h.getUint16(0,0);let d;if(c===18761)d=!0;else if(c===19789)d=!1;else throw new TypeError("Invalid byte order value.");const y=h.getUint16(2,d);let _;if(y===42)_=!1;else if(y===43){if(_=!0,h.getUint16(4,d)!==8)throw new Error("Unsupported offset byte-size.")}else throw new TypeError("Invalid magic number.");const v=_?h.getUint64(8,d):h.getUint32(4,d);return new ho(i,d,_,v,t)}close(){return typeof this.source.close=="function"?this.source.close():!1}}async function Uf(n,i){return ho.fromSource(Vu(n),i)}const Xu="1.27.0",Qa={"X-Client-Info":`supabase-js/${Xu}`};function Yu(n){return n.replace(/\/$/,"")}var uo={exports:{}};(function(n,i){var t=typeof self!="undefined"?self:Uo,s=function(){function h(){this.fetch=!1,this.DOMException=t.DOMException}return h.prototype=t,new h}();(function(h){(function(c){var d={searchParams:"URLSearchParams"in h,iterable:"Symbol"in h&&"iterator"in Symbol,blob:"FileReader"in h&&"Blob"in h&&function(){try{return new Blob,!0}catch{return!1}}(),formData:"FormData"in h,arrayBuffer:"ArrayBuffer"in h};function y(K){return K&&DataView.prototype.isPrototypeOf(K)}if(d.arrayBuffer)var _=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],v=ArrayBuffer.isView||function(K){return K&&_.indexOf(Object.prototype.toString.call(K))>-1};function x(K){if(typeof K!="string"&&(K=String(K)),/[^a-z0-9\-#$%&'*+.^_`|~]/i.test(K))throw new TypeError("Invalid character in header field name");return K.toLowerCase()}function w(K){return typeof K!="string"&&(K=String(K)),K}function C(K){var rt={next:function(){var ft=K.shift();return{done:ft===void 0,value:ft}}};return d.iterable&&(rt[Symbol.iterator]=function(){return rt}),rt}function A(K){this.map={},K instanceof A?K.forEach(function(rt,ft){this.append(ft,rt)},this):Array.isArray(K)?K.forEach(function(rt){this.append(rt[0],rt[1])},this):K&&Object.getOwnPropertyNames(K).forEach(function(rt){this.append(rt,K[rt])},this)}A.prototype.append=function(K,rt){K=x(K),rt=w(rt);var ft=this.map[K];this.map[K]=ft?ft+", "+rt:rt},A.prototype.delete=function(K){delete this.map[x(K)]},A.prototype.get=function(K){return K=x(K),this.has(K)?this.map[K]:null},A.prototype.has=function(K){return this.map.hasOwnProperty(x(K))},A.prototype.set=function(K,rt){this.map[x(K)]=w(rt)},A.prototype.forEach=function(K,rt){for(var ft in this.map)this.map.hasOwnProperty(ft)&&K.call(rt,this.map[ft],ft,this)},A.prototype.keys=function(){var K=[];return this.forEach(function(rt,ft){K.push(ft)}),C(K)},A.prototype.values=function(){var K=[];return this.forEach(function(rt){K.push(rt)}),C(K)},A.prototype.entries=function(){var K=[];return this.forEach(function(rt,ft){K.push([ft,rt])}),C(K)},d.iterable&&(A.prototype[Symbol.iterator]=A.prototype.entries);function I(K){if(K.bodyUsed)return Promise.reject(new TypeError("Already read"));K.bodyUsed=!0}function R(K){return new Promise(function(rt,ft){K.onload=function(){rt(K.result)},K.onerror=function(){ft(K.error)}})}function P(K){var rt=new FileReader,ft=R(rt);return rt.readAsArrayBuffer(K),ft}function E(K){var rt=new FileReader,ft=R(rt);return rt.readAsText(K),ft}function z(K){for(var rt=new Uint8Array(K),ft=new Array(rt.length),zt=0;zt<rt.length;zt++)ft[zt]=String.fromCharCode(rt[zt]);return ft.join("")}function j(K){if(K.slice)return K.slice(0);var rt=new Uint8Array(K.byteLength);return rt.set(new Uint8Array(K)),rt.buffer}function q(){return this.bodyUsed=!1,this._initBody=function(K){this._bodyInit=K,K?typeof K=="string"?this._bodyText=K:d.blob&&Blob.prototype.isPrototypeOf(K)?this._bodyBlob=K:d.formData&&FormData.prototype.isPrototypeOf(K)?this._bodyFormData=K:d.searchParams&&URLSearchParams.prototype.isPrototypeOf(K)?this._bodyText=K.toString():d.arrayBuffer&&d.blob&&y(K)?(this._bodyArrayBuffer=j(K.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):d.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(K)||v(K))?this._bodyArrayBuffer=j(K):this._bodyText=K=Object.prototype.toString.call(K):this._bodyText="",this.headers.get("content-type")||(typeof K=="string"?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):d.searchParams&&URLSearchParams.prototype.isPrototypeOf(K)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},d.blob&&(this.blob=function(){var K=I(this);if(K)return K;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?I(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(P)}),this.text=function(){var K=I(this);if(K)return K;if(this._bodyBlob)return E(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(z(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},d.formData&&(this.formData=function(){return this.text().then(lt)}),this.json=function(){return this.text().then(JSON.parse)},this}var et=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function J(K){var rt=K.toUpperCase();return et.indexOf(rt)>-1?rt:K}function ht(K,rt){rt=rt||{};var ft=rt.body;if(K instanceof ht){if(K.bodyUsed)throw new TypeError("Already read");this.url=K.url,this.credentials=K.credentials,rt.headers||(this.headers=new A(K.headers)),this.method=K.method,this.mode=K.mode,this.signal=K.signal,!ft&&K._bodyInit!=null&&(ft=K._bodyInit,K.bodyUsed=!0)}else this.url=String(K);if(this.credentials=rt.credentials||this.credentials||"same-origin",(rt.headers||!this.headers)&&(this.headers=new A(rt.headers)),this.method=J(rt.method||this.method||"GET"),this.mode=rt.mode||this.mode||null,this.signal=rt.signal||this.signal,this.referrer=null,(this.method==="GET"||this.method==="HEAD")&&ft)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(ft)}ht.prototype.clone=function(){return new ht(this,{body:this._bodyInit})};function lt(K){var rt=new FormData;return K.trim().split("&").forEach(function(ft){if(ft){var zt=ft.split("="),ot=zt.shift().replace(/\+/g," "),It=zt.join("=").replace(/\+/g," ");rt.append(decodeURIComponent(ot),decodeURIComponent(It))}}),rt}function dt(K){var rt=new A,ft=K.replace(/\r?\n[\t ]+/g," ");return ft.split(/\r?\n/).forEach(function(zt){var ot=zt.split(":"),It=ot.shift().trim();if(It){var kt=ot.join(":").trim();rt.append(It,kt)}}),rt}q.call(ht.prototype);function gt(K,rt){rt||(rt={}),this.type="default",this.status=rt.status===void 0?200:rt.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in rt?rt.statusText:"OK",this.headers=new A(rt.headers),this.url=rt.url||"",this._initBody(K)}q.call(gt.prototype),gt.prototype.clone=function(){return new gt(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new A(this.headers),url:this.url})},gt.error=function(){var K=new gt(null,{status:0,statusText:""});return K.type="error",K};var vt=[301,302,303,307,308];gt.redirect=function(K,rt){if(vt.indexOf(rt)===-1)throw new RangeError("Invalid status code");return new gt(null,{status:rt,headers:{location:K}})},c.DOMException=h.DOMException;try{new c.DOMException}catch{c.DOMException=function(rt,ft){this.message=rt,this.name=ft;var zt=Error(rt);this.stack=zt.stack},c.DOMException.prototype=Object.create(Error.prototype),c.DOMException.prototype.constructor=c.DOMException}function At(K,rt){return new Promise(function(ft,zt){var ot=new ht(K,rt);if(ot.signal&&ot.signal.aborted)return zt(new c.DOMException("Aborted","AbortError"));var It=new XMLHttpRequest;function kt(){It.abort()}It.onload=function(){var Rt={status:It.status,statusText:It.statusText,headers:dt(It.getAllResponseHeaders()||"")};Rt.url="responseURL"in It?It.responseURL:Rt.headers.get("X-Request-URL");var se="response"in It?It.response:It.responseText;ft(new gt(se,Rt))},It.onerror=function(){zt(new TypeError("Network request failed"))},It.ontimeout=function(){zt(new TypeError("Network request failed"))},It.onabort=function(){zt(new c.DOMException("Aborted","AbortError"))},It.open(ot.method,ot.url,!0),ot.credentials==="include"?It.withCredentials=!0:ot.credentials==="omit"&&(It.withCredentials=!1),"responseType"in It&&d.blob&&(It.responseType="blob"),ot.headers.forEach(function(Rt,se){It.setRequestHeader(se,Rt)}),ot.signal&&(ot.signal.addEventListener("abort",kt),It.onreadystatechange=function(){It.readyState===4&&ot.signal.removeEventListener("abort",kt)}),It.send(typeof ot._bodyInit=="undefined"?null:ot._bodyInit)})}return At.polyfill=!0,h.fetch||(h.fetch=At,h.Headers=A,h.Request=ht,h.Response=gt),c.Headers=A,c.Request=ht,c.Response=gt,c.fetch=At,Object.defineProperty(c,"__esModule",{value:!0}),c})({})})(s),s.fetch.ponyfill=!0,delete s.fetch.polyfill;var o=s;i=o.fetch,i.default=o.fetch,i.fetch=o.fetch,i.Headers=o.Headers,i.Request=o.Request,i.Response=o.Response,n.exports=i})(uo,uo.exports);var fs=Bl(uo.exports),yr=globalThis&&globalThis.__awaiter||function(n,i,t,s){function o(h){return h instanceof t?h:new t(function(c){c(h)})}return new(t||(t=Promise))(function(h,c){function d(v){try{_(s.next(v))}catch(x){c(x)}}function y(v){try{_(s.throw(v))}catch(x){c(x)}}function _(v){v.done?h(v.value):o(v.value).then(d,y)}_((s=s.apply(n,i||[])).next())})};const Ju=n=>n.msg||n.message||n.error_description||n.error||JSON.stringify(n),Wu=(n,i)=>{if(typeof n.json!="function")return i(n);n.json().then(t=>i({message:Ju(t),status:(n==null?void 0:n.status)||500}))},Qu=(n,i,t)=>{const s={method:n,headers:(i==null?void 0:i.headers)||{}};return n==="GET"||(s.headers=Object.assign({"Content-Type":"text/plain;charset=UTF-8"},i==null?void 0:i.headers),s.body=JSON.stringify(t)),s};function ds(n=fs,i,t,s,o){return yr(this,void 0,void 0,function*(){return new Promise((h,c)=>{n(t,Qu(i,s,o)).then(d=>{if(!d.ok)throw d;return(s==null?void 0:s.noResolveJson)?h:d.json()}).then(d=>h(d)).catch(d=>Wu(d,c))})})}function tc(n,i,t){return yr(this,void 0,void 0,function*(){return ds(n,"GET",i,t)})}function qe(n,i,t,s){return yr(this,void 0,void 0,function*(){return ds(n,"POST",i,s,t)})}function ec(n,i,t,s){return yr(this,void 0,void 0,function*(){return ds(n,"PUT",i,s,t)})}function ic(n,i,t,s){return yr(this,void 0,void 0,function*(){return ds(n,"DELETE",i,s,t)})}const nc="1.20.0",rc="http://localhost:9999",sc={"X-Client-Info":`gotrue-js/${nc}`},ps="supabase.auth.token",oc={name:"sb:token",lifetime:60*60*8,domain:"",path:"/",sameSite:"lax"};function ac(n,i,t){const s=t||{},o=encodeURIComponent,h=/^[\u0009\u0020-\u007e\u0080-\u00ff]+$/;if(typeof o!="function")throw new TypeError("option encode is invalid");if(!h.test(n))throw new TypeError("argument name is invalid");const c=o(i);if(c&&!h.test(c))throw new TypeError("argument val is invalid");let d=n+"="+c;if(s.maxAge!=null){const y=s.maxAge-0;if(isNaN(y)||!isFinite(y))throw new TypeError("option maxAge is invalid");d+="; Max-Age="+Math.floor(y)}if(s.domain){if(!h.test(s.domain))throw new TypeError("option domain is invalid");d+="; Domain="+s.domain}if(s.path){if(!h.test(s.path))throw new TypeError("option path is invalid");d+="; Path="+s.path}if(s.expires){if(typeof s.expires.toUTCString!="function")throw new TypeError("option expires is invalid");d+="; Expires="+s.expires.toUTCString()}if(s.httpOnly&&(d+="; HttpOnly"),s.secure&&(d+="; Secure"),s.sameSite)switch(typeof s.sameSite=="string"?s.sameSite.toLowerCase():s.sameSite){case"lax":d+="; SameSite=Lax";break;case"strict":d+="; SameSite=Strict";break;case"none":d+="; SameSite=None";break;default:throw new TypeError("option sameSite is invalid")}return d}function lc(n){if(!n||!n.headers||!n.headers.host)throw new Error('The "host" request header is not available');const i=n.headers.host.indexOf(":")>-1&&n.headers.host.split(":")[0]||n.headers.host;return!(["localhost","127.0.0.1"].indexOf(i)>-1||i.endsWith(".local"))}function hc(n,i){var t,s,o;return ac(n.name,n.value,{maxAge:n.maxAge,expires:new Date(Date.now()+n.maxAge*1e3),httpOnly:!0,secure:i,path:(t=n.path)!==null&&t!==void 0?t:"/",domain:(s=n.domain)!==null&&s!==void 0?s:"",sameSite:(o=n.sameSite)!==null&&o!==void 0?o:"lax"})}function uc(n,i,t){const s=t.map(h=>hc(h,lc(n))),o=i.getHeader("Set-Cookie");o&&(o instanceof Array?Array.prototype.push.apply(s,o):typeof o=="string"&&s.push(o)),i.setHeader("Set-Cookie",s)}function tl(n,i,t){uc(n,i,[t])}function cc(n,i,t){tl(n,i,{name:t,value:"",maxAge:-1})}function vr(n){return Math.round(Date.now()/1e3)+n}function fc(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(n){const i=Math.random()*16|0;return(n=="x"?i:i&3|8).toString(16)})}const on=()=>typeof window!="undefined";function zi(n,i){i||(i=window.location.href),n=n.replace(/[\[\]]/g,"\\$&");const t=new RegExp("[?&#]"+n+"(=([^&#]*)|&|#|$)"),s=t.exec(i);return s?s[2]?decodeURIComponent(s[2].replace(/\+/g," ")):"":null}var Le=globalThis&&globalThis.__awaiter||function(n,i,t,s){function o(h){return h instanceof t?h:new t(function(c){c(h)})}return new(t||(t=Promise))(function(h,c){function d(v){try{_(s.next(v))}catch(x){c(x)}}function y(v){try{_(s.throw(v))}catch(x){c(x)}}function _(v){v.done?h(v.value):o(v.value).then(d,y)}_((s=s.apply(n,i||[])).next())})};class dc{constructor({url:i="",headers:t={},cookieOptions:s,fetch:o}){this.url=i,this.headers=t,this.cookieOptions=Object.assign(Object.assign({},oc),s),this.fetch=o}signUpWithEmail(i,t,s={}){return Le(this,void 0,void 0,function*(){try{const o=Object.assign({},this.headers);let h="";s.redirectTo&&(h="?redirect_to="+encodeURIComponent(s.redirectTo));const c=yield qe(this.fetch,`${this.url}/signup${h}`,{email:i,password:t,data:s.data},{headers:o}),d=Object.assign({},c);return d.expires_in&&(d.expires_at=vr(c.expires_in)),{data:d,error:null}}catch(o){return{data:null,error:o}}})}signInWithEmail(i,t,s={}){return Le(this,void 0,void 0,function*(){try{const o=Object.assign({},this.headers);let h="?grant_type=password";s.redirectTo&&(h+="&redirect_to="+encodeURIComponent(s.redirectTo));const c=yield qe(this.fetch,`${this.url}/token${h}`,{email:i,password:t},{headers:o}),d=Object.assign({},c);return d.expires_in&&(d.expires_at=vr(c.expires_in)),{data:d,error:null}}catch(o){return{data:null,error:o}}})}signUpWithPhone(i,t,s={}){return Le(this,void 0,void 0,function*(){try{const o=Object.assign({},this.headers),h=yield qe(this.fetch,`${this.url}/signup`,{phone:i,password:t,data:s.data},{headers:o}),c=Object.assign({},h);return c.expires_in&&(c.expires_at=vr(h.expires_in)),{data:c,error:null}}catch(o){return{data:null,error:o}}})}signInWithPhone(i,t){return Le(this,void 0,void 0,function*(){try{const s=Object.assign({},this.headers),o="?grant_type=password",h=yield qe(this.fetch,`${this.url}/token${o}`,{phone:i,password:t},{headers:s}),c=Object.assign({},h);return c.expires_in&&(c.expires_at=vr(h.expires_in)),{data:c,error:null}}catch(s){return{data:null,error:s}}})}sendMagicLinkEmail(i,t={}){return Le(this,void 0,void 0,function*(){try{const s=Object.assign({},this.headers);let o="";return t.redirectTo&&(o+="?redirect_to="+encodeURIComponent(t.redirectTo)),{data:yield qe(this.fetch,`${this.url}/magiclink${o}`,{email:i},{headers:s}),error:null}}catch(s){return{data:null,error:s}}})}sendMobileOTP(i){return Le(this,void 0,void 0,function*(){try{const t=Object.assign({},this.headers);return{data:yield qe(this.fetch,`${this.url}/otp`,{phone:i},{headers:t}),error:null}}catch(t){return{data:null,error:t}}})}verifyMobileOTP(i,t,s={}){return Le(this,void 0,void 0,function*(){try{const o=Object.assign({},this.headers);return{data:yield qe(this.fetch,`${this.url}/verify`,{phone:i,token:t,type:"sms",redirect_to:s.redirectTo},{headers:o}),error:null}}catch(o){return{data:null,error:o}}})}inviteUserByEmail(i,t={}){return Le(this,void 0,void 0,function*(){try{const s=Object.assign({},this.headers);let o="";return t.redirectTo&&(o+="?redirect_to="+encodeURIComponent(t.redirectTo)),{data:yield qe(this.fetch,`${this.url}/invite${o}`,{email:i,data:t.data},{headers:s}),error:null}}catch(s){return{data:null,error:s}}})}resetPasswordForEmail(i,t={}){return Le(this,void 0,void 0,function*(){try{const s=Object.assign({},this.headers);let o="";return t.redirectTo&&(o+="?redirect_to="+encodeURIComponent(t.redirectTo)),{data:yield qe(this.fetch,`${this.url}/recover${o}`,{email:i},{headers:s}),error:null}}catch(s){return{data:null,error:s}}})}_createRequestHeaders(i){const t=Object.assign({},this.headers);return t.Authorization=`Bearer ${i}`,t}signOut(i){return Le(this,void 0,void 0,function*(){try{return yield qe(this.fetch,`${this.url}/logout`,{},{headers:this._createRequestHeaders(i),noResolveJson:!0}),{error:null}}catch(t){return{error:t}}})}getUrlForProvider(i,t){const s=[`provider=${encodeURIComponent(i)}`];return(t==null?void 0:t.redirectTo)&&s.push(`redirect_to=${encodeURIComponent(t.redirectTo)}`),(t==null?void 0:t.scopes)&&s.push(`scopes=${encodeURIComponent(t.scopes)}`),`${this.url}/authorize?${s.join("&")}`}getUser(i){return Le(this,void 0,void 0,function*(){try{const t=yield tc(this.fetch,`${this.url}/user`,{headers:this._createRequestHeaders(i)});return{user:t,data:t,error:null}}catch(t){return{user:null,data:null,error:t}}})}updateUser(i,t){return Le(this,void 0,void 0,function*(){try{const s=yield ec(this.fetch,`${this.url}/user`,t,{headers:this._createRequestHeaders(i)});return{user:s,data:s,error:null}}catch(s){return{user:null,data:null,error:s}}})}deleteUser(i,t){return Le(this,void 0,void 0,function*(){try{const s=yield ic(this.fetch,`${this.url}/admin/users/${i}`,{},{headers:this._createRequestHeaders(t)});return{user:s,data:s,error:null}}catch(s){return{user:null,data:null,error:s}}})}refreshAccessToken(i){return Le(this,void 0,void 0,function*(){try{const t=yield qe(this.fetch,`${this.url}/token?grant_type=refresh_token`,{refresh_token:i},{headers:this.headers}),s=Object.assign({},t);return s.expires_in&&(s.expires_at=vr(t.expires_in)),{data:s,error:null}}catch(t){return{data:null,error:t}}})}setAuthCookie(i,t){i.method!=="POST"&&(t.setHeader("Allow","POST"),t.status(405).end("Method Not Allowed"));const{event:s,session:o}=i.body;if(!s)throw new Error("Auth event missing!");if(s==="SIGNED_IN"){if(!o)throw new Error("Auth session missing!");tl(i,t,{name:this.cookieOptions.name,value:o.access_token,domain:this.cookieOptions.domain,maxAge:this.cookieOptions.lifetime,path:this.cookieOptions.path,sameSite:this.cookieOptions.sameSite})}s==="SIGNED_OUT"&&cc(i,t,this.cookieOptions.name),t.status(200).json({})}getUserByCookie(i){return Le(this,void 0,void 0,function*(){try{if(!i.cookies)throw new Error("Not able to parse cookies! When using Express make sure the cookie-parser middleware is in use!");if(!i.cookies[this.cookieOptions.name])throw new Error("No cookie found!");const t=i.cookies[this.cookieOptions.name],{user:s,error:o}=yield this.getUser(t);if(o)throw o;return{user:s,data:s,error:null}}catch(t){return{user:null,data:null,error:t}}})}generateLink(i,t,s={}){return Le(this,void 0,void 0,function*(){try{return{data:yield qe(this.fetch,`${this.url}/admin/generate_link`,{type:i,email:t,password:s.password,data:s.data,redirect_to:s.redirectTo},{headers:this.headers}),error:null}}catch(o){return{data:null,error:o}}})}}function pc(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self!="undefined"&&(self.globalThis=self)}}var je=globalThis&&globalThis.__awaiter||function(n,i,t,s){function o(h){return h instanceof t?h:new t(function(c){c(h)})}return new(t||(t=Promise))(function(h,c){function d(v){try{_(s.next(v))}catch(x){c(x)}}function y(v){try{_(s.throw(v))}catch(x){c(x)}}function _(v){v.done?h(v.value):o(v.value).then(d,y)}_((s=s.apply(n,i||[])).next())})};pc();const mc={url:rc,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:sc};class gc{constructor(i){this.stateChangeEmitters=new Map;const t=Object.assign(Object.assign({},mc),i);this.currentUser=null,this.currentSession=null,this.autoRefreshToken=t.autoRefreshToken,this.persistSession=t.persistSession,this.localStorage=t.localStorage||globalThis.localStorage,this.api=new dc({url:t.url,headers:t.headers,cookieOptions:t.cookieOptions,fetch:t.fetch}),this._recoverSession(),this._recoverAndRefresh(),t.detectSessionInUrl&&on()&&!!zi("access_token")&&this.getSessionFromUrl({storeSession:!0}).then(({error:s})=>{s&&console.error("Error getting session from URL.",s)})}signUp({email:i,password:t,phone:s},o={}){return je(this,void 0,void 0,function*(){try{this._removeSession();const{data:h,error:c}=s&&t?yield this.api.signUpWithPhone(s,t,{data:o.data}):yield this.api.signUpWithEmail(i,t,{redirectTo:o.redirectTo,data:o.data});if(c)throw c;if(!h)throw"An error occurred on sign up.";let d=null,y=null;return h.access_token&&(d=h,y=d.user,this._saveSession(d),this._notifyAllSubscribers("SIGNED_IN")),h.id&&(y=h),{data:h,user:y,session:d,error:null}}catch(h){return{data:null,user:null,session:null,error:h}}})}signIn({email:i,phone:t,password:s,refreshToken:o,provider:h},c={}){return je(this,void 0,void 0,function*(){try{if(this._removeSession(),i&&!s){const{error:d}=yield this.api.sendMagicLinkEmail(i,{redirectTo:c.redirectTo});return{data:null,user:null,session:null,error:d}}if(i&&s)return this._handleEmailSignIn(i,s,{redirectTo:c.redirectTo});if(t&&!s){const{error:d}=yield this.api.sendMobileOTP(t);return{data:null,user:null,session:null,error:d}}if(t&&s)return this._handlePhoneSignIn(t,s);if(o){const{error:d}=yield this._callRefreshToken(o);if(d)throw d;return{data:this.currentSession,user:this.currentUser,session:this.currentSession,error:null}}if(h)return this._handleProviderSignIn(h,{redirectTo:c.redirectTo,scopes:c.scopes});throw new Error("You must provide either an email, phone number or a third-party provider.")}catch(d){return{data:null,user:null,session:null,error:d}}})}verifyOTP({phone:i,token:t},s={}){return je(this,void 0,void 0,function*(){try{this._removeSession();const{data:o,error:h}=yield this.api.verifyMobileOTP(i,t,s);if(h)throw h;if(!o)throw"An error occurred on token verification.";let c=null,d=null;return o.access_token&&(c=o,d=c.user,this._saveSession(c),this._notifyAllSubscribers("SIGNED_IN")),o.id&&(d=o),{data:o,user:d,session:c,error:null}}catch(o){return{data:null,user:null,session:null,error:o}}})}user(){return this.currentUser}session(){return this.currentSession}refreshSession(){var i;return je(this,void 0,void 0,function*(){try{if(!((i=this.currentSession)===null||i===void 0?void 0:i.access_token))throw new Error("Not logged in.");const{error:t}=yield this._callRefreshToken();if(t)throw t;return{data:this.currentSession,user:this.currentUser,error:null}}catch(t){return{data:null,user:null,error:t}}})}update(i){var t;return je(this,void 0,void 0,function*(){try{if(!((t=this.currentSession)===null||t===void 0?void 0:t.access_token))throw new Error("Not logged in.");const{user:s,error:o}=yield this.api.updateUser(this.currentSession.access_token,i);if(o)throw o;if(!s)throw Error("Invalid user data.");const h=Object.assign(Object.assign({},this.currentSession),{user:s});return this._saveSession(h),this._notifyAllSubscribers("USER_UPDATED"),{data:s,user:s,error:null}}catch(s){return{data:null,user:null,error:s}}})}setSession(i){return je(this,void 0,void 0,function*(){try{if(!i)throw new Error("No current session.");const{data:t,error:s}=yield this.api.refreshAccessToken(i);return s?{session:null,error:s}:(this._saveSession(t),this._notifyAllSubscribers("SIGNED_IN"),{session:t,error:null})}catch(t){return{error:t,session:null}}})}setAuth(i){return this.currentSession=Object.assign(Object.assign({},this.currentSession),{access_token:i,token_type:"bearer",user:null}),this.currentSession}getSessionFromUrl(i){return je(this,void 0,void 0,function*(){try{if(!on())throw new Error("No browser detected.");const t=zi("error_description");if(t)throw new Error(t);const s=zi("provider_token"),o=zi("access_token");if(!o)throw new Error("No access_token detected.");const h=zi("expires_in");if(!h)throw new Error("No expires_in detected.");const c=zi("refresh_token");if(!c)throw new Error("No refresh_token detected.");const d=zi("token_type");if(!d)throw new Error("No token_type detected.");const _=Math.round(Date.now()/1e3)+parseInt(h),{user:v,error:x}=yield this.api.getUser(o);if(x)throw x;const w={provider_token:s,access_token:o,expires_in:parseInt(h),expires_at:_,refresh_token:c,token_type:d,user:v};return(i==null?void 0:i.storeSession)&&(this._saveSession(w),this._notifyAllSubscribers("SIGNED_IN"),zi("type")==="recovery"&&this._notifyAllSubscribers("PASSWORD_RECOVERY")),window.location.hash="",{data:w,error:null}}catch(t){return{data:null,error:t}}})}signOut(){var i;return je(this,void 0,void 0,function*(){const t=(i=this.currentSession)===null||i===void 0?void 0:i.access_token;if(this._removeSession(),this._notifyAllSubscribers("SIGNED_OUT"),t){const{error:s}=yield this.api.signOut(t);if(s)return{error:s}}return{error:null}})}onAuthStateChange(i){try{const t=fc(),s={id:t,callback:i,unsubscribe:()=>{this.stateChangeEmitters.delete(t)}};return this.stateChangeEmitters.set(t,s),{data:s,error:null}}catch(t){return{data:null,error:t}}}_handleEmailSignIn(i,t,s={}){var o,h;return je(this,void 0,void 0,function*(){try{const{data:c,error:d}=yield this.api.signInWithEmail(i,t,{redirectTo:s.redirectTo});return d||!c?{data:null,user:null,session:null,error:d}:((((o=c==null?void 0:c.user)===null||o===void 0?void 0:o.confirmed_at)||((h=c==null?void 0:c.user)===null||h===void 0?void 0:h.email_confirmed_at))&&(this._saveSession(c),this._notifyAllSubscribers("SIGNED_IN")),{data:c,user:c.user,session:c,error:null})}catch(c){return{data:null,user:null,session:null,error:c}}})}_handlePhoneSignIn(i,t){var s;return je(this,void 0,void 0,function*(){try{const{data:o,error:h}=yield this.api.signInWithPhone(i,t);return h||!o?{data:null,user:null,session:null,error:h}:(((s=o==null?void 0:o.user)===null||s===void 0?void 0:s.phone_confirmed_at)&&(this._saveSession(o),this._notifyAllSubscribers("SIGNED_IN")),{data:o,user:o.user,session:o,error:null})}catch(o){return{data:null,user:null,session:null,error:o}}})}_handleProviderSignIn(i,t={}){const s=this.api.getUrlForProvider(i,{redirectTo:t.redirectTo,scopes:t.scopes});try{return on()&&(window.location.href=s),{provider:i,url:s,data:null,session:null,user:null,error:null}}catch(o){return s?{provider:i,url:s,data:null,session:null,user:null,error:null}:{data:null,user:null,session:null,error:o}}}_recoverSession(){var i;try{const t=on()&&((i=this.localStorage)===null||i===void 0?void 0:i.getItem(ps));if(!t||typeof t!="string")return null;const s=JSON.parse(t),{currentSession:o,expiresAt:h}=s,c=Math.round(Date.now()/1e3);h>=c&&(o==null?void 0:o.user)&&(this._saveSession(o),this._notifyAllSubscribers("SIGNED_IN"))}catch(t){console.log("error",t)}}_recoverAndRefresh(){return je(this,void 0,void 0,function*(){try{const i=on()&&(yield this.localStorage.getItem(ps));if(!i)return null;const t=JSON.parse(i),{currentSession:s,expiresAt:o}=t,h=Math.round(Date.now()/1e3);if(o<h)if(this.autoRefreshToken&&s.refresh_token){const{error:c}=yield this._callRefreshToken(s.refresh_token);c&&(console.log(c.message),yield this._removeSession())}else this._removeSession();else!s||!s.user?(console.log("Current session is missing data."),this._removeSession()):(this._saveSession(s),this._notifyAllSubscribers("SIGNED_IN"))}catch(i){return console.error(i),null}})}_callRefreshToken(i){var t;return i===void 0&&(i=(t=this.currentSession)===null||t===void 0?void 0:t.refresh_token),je(this,void 0,void 0,function*(){try{if(!i)throw new Error("No current session.");const{data:s,error:o}=yield this.api.refreshAccessToken(i);if(o)throw o;if(!s)throw Error("Invalid session data.");return this._saveSession(s),this._notifyAllSubscribers("SIGNED_IN"),{data:s,error:null}}catch(s){return{data:null,error:s}}})}_notifyAllSubscribers(i){this.stateChangeEmitters.forEach(t=>t.callback(i,this.currentSession))}_saveSession(i){this.currentSession=i,this.currentUser=i.user;const t=i.expires_at;if(t){const s=Math.round(Date.now()/1e3),o=t-s,h=o>60?60:.5;this._startAutoRefreshToken((o-h)*1e3)}this.persistSession&&i.expires_at&&this._persistSession(this.currentSession)}_persistSession(i){const t={currentSession:i,expiresAt:i.expires_at};on()&&this.localStorage.setItem(ps,JSON.stringify(t))}_removeSession(){return je(this,void 0,void 0,function*(){this.currentSession=null,this.currentUser=null,this.refreshTokenTimer&&clearTimeout(this.refreshTokenTimer),on()&&(yield this.localStorage.removeItem(ps))})}_startAutoRefreshToken(i){this.refreshTokenTimer&&clearTimeout(this.refreshTokenTimer),!(i<=0||!this.autoRefreshToken)&&(this.refreshTokenTimer=setTimeout(()=>this._callRefreshToken(),i),typeof this.refreshTokenTimer.unref=="function"&&this.refreshTokenTimer.unref())}}class _c extends gc{constructor(i){super(i)}}var yc=globalThis&&globalThis.__awaiter||function(n,i,t,s){function o(h){return h instanceof t?h:new t(function(c){c(h)})}return new(t||(t=Promise))(function(h,c){function d(v){try{_(s.next(v))}catch(x){c(x)}}function y(v){try{_(s.throw(v))}catch(x){c(x)}}function _(v){v.done?h(v.value):o(v.value).then(d,y)}_((s=s.apply(n,i||[])).next())})};class co{constructor(i){this.shouldThrowOnError=!1,Object.assign(this,i),this.fetch=i.fetch||fs}throwOnError(){return this.shouldThrowOnError=!0,this}then(i,t){typeof this.schema=="undefined"||(["GET","HEAD"].includes(this.method)?this.headers["Accept-Profile"]=this.schema:this.headers["Content-Profile"]=this.schema),this.method!=="GET"&&this.method!=="HEAD"&&(this.headers["Content-Type"]="application/json");let s=this.fetch(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(o=>yc(this,void 0,void 0,function*(){var h,c,d;let y=null,_=null,v=null;if(o.ok){const w=(h=this.headers.Prefer)===null||h===void 0?void 0:h.split(",").includes("return=minimal");if(this.method!=="HEAD"&&!w){const I=yield o.text();I&&(this.headers.Accept==="text/csv"?_=I:_=JSON.parse(I))}const C=(c=this.headers.Prefer)===null||c===void 0?void 0:c.match(/count=(exact|planned|estimated)/),A=(d=o.headers.get("content-range"))===null||d===void 0?void 0:d.split("/");C&&A&&A.length>1&&(v=parseInt(A[1]))}else if(y=yield o.json(),y&&this.shouldThrowOnError)throw y;return{error:y,data:_,count:v,status:o.status,statusText:o.statusText,body:_}}));return this.shouldThrowOnError||(s=s.catch(o=>({error:{message:`FetchError: ${o.message}`,details:"",hint:"",code:o.code||""},data:null,body:null,count:null,status:400,statusText:"Bad Request"}))),s.then(i,t)}}class fo extends co{select(i="*"){let t=!1;const s=i.split("").map(o=>/\s/.test(o)&&!t?"":(o==='"'&&(t=!t),o)).join("");return this.url.searchParams.set("select",s),this}order(i,{ascending:t=!0,nullsFirst:s=!1,foreignTable:o}={}){const h=typeof o=="undefined"?"order":`${o}.order`,c=this.url.searchParams.get(h);return this.url.searchParams.set(h,`${c?`${c},`:""}${i}.${t?"asc":"desc"}.${s?"nullsfirst":"nullslast"}`),this}limit(i,{foreignTable:t}={}){const s=typeof t=="undefined"?"limit":`${t}.limit`;return this.url.searchParams.set(s,`${i}`),this}range(i,t,{foreignTable:s}={}){const o=typeof s=="undefined"?"offset":`${s}.offset`,h=typeof s=="undefined"?"limit":`${s}.limit`;return this.url.searchParams.set(o,`${i}`),this.url.searchParams.set(h,`${t-i+1}`),this}abortSignal(i){return this.signal=i,this}single(){return this.headers.Accept="application/vnd.pgrst.object+json",this}maybeSingle(){this.headers.Accept="application/vnd.pgrst.object+json";const i=new fo(this);return i.then=(t,s)=>this.then(o=>{var h,c;return((c=(h=o.error)===null||h===void 0?void 0:h.details)===null||c===void 0?void 0:c.includes("Results contain 0 rows"))?t({error:null,data:null,count:o.count,status:200,statusText:"OK",body:null}):t(o)},s),i}csv(){return this.headers.Accept="text/csv",this}}class Dn extends fo{constructor(){super(...arguments);this.cs=this.contains,this.cd=this.containedBy,this.sl=this.rangeLt,this.sr=this.rangeGt,this.nxl=this.rangeGte,this.nxr=this.rangeLte,this.adj=this.rangeAdjacent,this.ov=this.overlaps}not(i,t,s){return this.url.searchParams.append(`${i}`,`not.${t}.${s}`),this}or(i,{foreignTable:t}={}){const s=typeof t=="undefined"?"or":`${t}.or`;return this.url.searchParams.append(s,`(${i})`),this}eq(i,t){return this.url.searchParams.append(`${i}`,`eq.${t}`),this}neq(i,t){return this.url.searchParams.append(`${i}`,`neq.${t}`),this}gt(i,t){return this.url.searchParams.append(`${i}`,`gt.${t}`),this}gte(i,t){return this.url.searchParams.append(`${i}`,`gte.${t}`),this}lt(i,t){return this.url.searchParams.append(`${i}`,`lt.${t}`),this}lte(i,t){return this.url.searchParams.append(`${i}`,`lte.${t}`),this}like(i,t){return this.url.searchParams.append(`${i}`,`like.${t}`),this}ilike(i,t){return this.url.searchParams.append(`${i}`,`ilike.${t}`),this}is(i,t){return this.url.searchParams.append(`${i}`,`is.${t}`),this}in(i,t){const s=t.map(o=>typeof o=="string"&&new RegExp("[,()]").test(o)?`"${o}"`:`${o}`).join(",");return this.url.searchParams.append(`${i}`,`in.(${s})`),this}contains(i,t){return typeof t=="string"?this.url.searchParams.append(`${i}`,`cs.${t}`):Array.isArray(t)?this.url.searchParams.append(`${i}`,`cs.{${t.join(",")}}`):this.url.searchParams.append(`${i}`,`cs.${JSON.stringify(t)}`),this}containedBy(i,t){return typeof t=="string"?this.url.searchParams.append(`${i}`,`cd.${t}`):Array.isArray(t)?this.url.searchParams.append(`${i}`,`cd.{${t.join(",")}}`):this.url.searchParams.append(`${i}`,`cd.${JSON.stringify(t)}`),this}rangeLt(i,t){return this.url.searchParams.append(`${i}`,`sl.${t}`),this}rangeGt(i,t){return this.url.searchParams.append(`${i}`,`sr.${t}`),this}rangeGte(i,t){return this.url.searchParams.append(`${i}`,`nxl.${t}`),this}rangeLte(i,t){return this.url.searchParams.append(`${i}`,`nxr.${t}`),this}rangeAdjacent(i,t){return this.url.searchParams.append(`${i}`,`adj.${t}`),this}overlaps(i,t){return typeof t=="string"?this.url.searchParams.append(`${i}`,`ov.${t}`):this.url.searchParams.append(`${i}`,`ov.{${t.join(",")}}`),this}textSearch(i,t,{config:s,type:o=null}={}){let h="";o==="plain"?h="pl":o==="phrase"?h="ph":o==="websearch"&&(h="w");const c=s===void 0?"":`(${s})`;return this.url.searchParams.append(`${i}`,`${h}fts${c}.${t}`),this}fts(i,t,{config:s}={}){const o=typeof s=="undefined"?"":`(${s})`;return this.url.searchParams.append(`${i}`,`fts${o}.${t}`),this}plfts(i,t,{config:s}={}){const o=typeof s=="undefined"?"":`(${s})`;return this.url.searchParams.append(`${i}`,`plfts${o}.${t}`),this}phfts(i,t,{config:s}={}){const o=typeof s=="undefined"?"":`(${s})`;return this.url.searchParams.append(`${i}`,`phfts${o}.${t}`),this}wfts(i,t,{config:s}={}){const o=typeof s=="undefined"?"":`(${s})`;return this.url.searchParams.append(`${i}`,`wfts${o}.${t}`),this}filter(i,t,s){return this.url.searchParams.append(`${i}`,`${t}.${s}`),this}match(i){return Object.keys(i).forEach(t=>{this.url.searchParams.append(`${t}`,`eq.${i[t]}`)}),this}}class el extends co{constructor(i,{headers:t={},schema:s,fetch:o}={}){super({fetch:o});this.url=new URL(i),this.headers=Object.assign({},t),this.schema=s}select(i="*",{head:t=!1,count:s=null}={}){this.method="GET";let o=!1;const h=i.split("").map(c=>/\s/.test(c)&&!o?"":(c==='"'&&(o=!o),c)).join("");return this.url.searchParams.set("select",h),s&&(this.headers.Prefer=`count=${s}`),t&&(this.method="HEAD"),new Dn(this)}insert(i,{upsert:t=!1,onConflict:s,returning:o="representation",count:h=null}={}){this.method="POST";const c=[`return=${o}`];if(t&&c.push("resolution=merge-duplicates"),t&&s!==void 0&&this.url.searchParams.set("on_conflict",s),this.body=i,h&&c.push(`count=${h}`),this.headers.Prefer=c.join(","),Array.isArray(i)){const d=i.reduce((y,_)=>y.concat(Object.keys(_)),[]);if(d.length>0){const y=[...new Set(d)].map(_=>`"${_}"`);this.url.searchParams.set("columns",y.join(","))}}return new Dn(this)}upsert(i,{onConflict:t,returning:s="representation",count:o=null,ignoreDuplicates:h=!1}={}){this.method="POST";const c=[`resolution=${h?"ignore":"merge"}-duplicates`,`return=${s}`];return t!==void 0&&this.url.searchParams.set("on_conflict",t),this.body=i,o&&c.push(`count=${o}`),this.headers.Prefer=c.join(","),new Dn(this)}update(i,{returning:t="representation",count:s=null}={}){this.method="PATCH";const o=[`return=${t}`];return this.body=i,s&&o.push(`count=${s}`),this.headers.Prefer=o.join(","),new Dn(this)}delete({returning:i="representation",count:t=null}={}){this.method="DELETE";const s=[`return=${i}`];return t&&s.push(`count=${t}`),this.headers.Prefer=s.join(","),new Dn(this)}}class vc extends co{constructor(i,{headers:t={},schema:s,fetch:o}={}){super({fetch:o});this.url=new URL(i),this.headers=Object.assign({},t),this.schema=s}rpc(i,{head:t=!1,count:s=null}={}){return t?(this.method="HEAD",i&&Object.entries(i).forEach(([o,h])=>{this.url.searchParams.append(o,h)})):(this.method="POST",this.body=i),s&&(this.headers.Prefer!==void 0?this.headers.Prefer+=`,count=${s}`:this.headers.Prefer=`count=${s}`),new Dn(this)}}const bc="0.35.0",xc={"X-Client-Info":`postgrest-js/${bc}`};class Lc{constructor(i,{headers:t={},schema:s,fetch:o}={}){this.url=i,this.headers=Object.assign(Object.assign({},xc),t),this.schema=s,this.fetch=o}auth(i){return this.headers.Authorization=`Bearer ${i}`,this}from(i){const t=`${this.url}/${i}`;return new el(t,{headers:this.headers,schema:this.schema,fetch:this.fetch})}rpc(i,t,{head:s=!1,count:o=null}={}){const h=`${this.url}/rpc/${i}`;return new vc(h,{headers:this.headers,schema:this.schema,fetch:this.fetch}).rpc(t,{head:s,count:o})}}var Yt;(function(n){n.abstime="abstime",n.bool="bool",n.date="date",n.daterange="daterange",n.float4="float4",n.float8="float8",n.int2="int2",n.int4="int4",n.int4range="int4range",n.int8="int8",n.int8range="int8range",n.json="json",n.jsonb="jsonb",n.money="money",n.numeric="numeric",n.oid="oid",n.reltime="reltime",n.text="text",n.time="time",n.timestamp="timestamp",n.timestamptz="timestamptz",n.timetz="timetz",n.tsrange="tsrange",n.tstzrange="tstzrange"})(Yt||(Yt={}));const il=(n,i,t={})=>{var s;const o=(s=t.skipTypes)!==null&&s!==void 0?s:[];return Object.keys(i).reduce((h,c)=>(h[c]=wc(c,n,i,o),h),{})},wc=(n,i,t,s)=>{const o=i.find(d=>d.name===n),h=o==null?void 0:o.type,c=t[n];return h&&!s.includes(h)?nl(h,c):po(c)},nl=(n,i)=>{if(n.charAt(0)==="_"){const t=n.slice(1,n.length);return Sc(i,t)}switch(n){case Yt.bool:return kc(i);case Yt.float4:case Yt.float8:case Yt.int2:case Yt.int4:case Yt.int8:case Yt.numeric:case Yt.oid:return Mc(i);case Yt.json:case Yt.jsonb:return Pc(i);case Yt.timestamp:return Cc(i);case Yt.abstime:case Yt.date:case Yt.daterange:case Yt.int4range:case Yt.int8range:case Yt.money:case Yt.reltime:case Yt.text:case Yt.time:case Yt.timestamptz:case Yt.timetz:case Yt.tsrange:case Yt.tstzrange:return po(i);default:return po(i)}},po=n=>n,kc=n=>{switch(n){case"t":return!0;case"f":return!1;default:return n}},Mc=n=>{if(typeof n=="string"){const i=parseFloat(n);if(!Number.isNaN(i))return i}return n},Pc=n=>{if(typeof n=="string")try{return JSON.parse(n)}catch(i){return console.log(`JSON parse error: ${i}`),n}return n},Sc=(n,i)=>{if(typeof n!="string")return n;const t=n.length-1,s=n[t];if(n[0]==="{"&&s==="}"){let h;const c=n.slice(1,t);try{h=JSON.parse("["+c+"]")}catch{h=c?c.split(","):[]}return h.map(d=>nl(i,d))}return n},Cc=n=>typeof n=="string"?n.replace(" ","T"):n,Ec="1.2.1",Tc={"X-Client-Info":`realtime-js/${Ec}`},Oc="1.0.0",rl=1e4,Ic=1e3;var br;(function(n){n[n.connecting=0]="connecting",n[n.open=1]="open",n[n.closing=2]="closing",n[n.closed=3]="closed"})(br||(br={}));var De;(function(n){n.closed="closed",n.errored="errored",n.joined="joined",n.joining="joining",n.leaving="leaving"})(De||(De={}));var ci;(function(n){n.close="phx_close",n.error="phx_error",n.join="phx_join",n.reply="phx_reply",n.leave="phx_leave"})(ci||(ci={}));var mo;(function(n){n.websocket="websocket"})(mo||(mo={}));class sl{constructor(i,t){this.callback=i,this.timerCalc=t,this.timer=void 0,this.tries=0,this.callback=i,this.timerCalc=t}reset(){this.tries=0,clearTimeout(this.timer)}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}class go{constructor(i,t,s={},o=rl){this.channel=i,this.event=t,this.payload=s,this.timeout=o,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(i){this.timeout=i,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref}))}receive(i,t){var s;return this._hasReceived(i)&&t((s=this.receivedResp)===null||s===void 0?void 0:s.response),this.recHooks.push({status:i,callback:t}),this}startTimeout(){this.timeoutTimer||(this.ref=this.channel.socket.makeRef(),this.refEvent=this.channel.replyEventName(this.ref),this.channel.on(this.refEvent,i=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=i,this._matchReceive(i)}),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout))}trigger(i,t){this.refEvent&&this.channel.trigger(this.refEvent,{status:i,response:t})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){!this.refEvent||this.channel.off(this.refEvent)}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:i,response:t}){this.recHooks.filter(s=>s.status===i).forEach(s=>s.callback(t))}_hasReceived(i){return this.receivedResp&&this.receivedResp.status===i}}class Ac{constructor(i,t={},s){this.topic=i,this.params=t,this.socket=s,this.bindings=[],this.state=De.closed,this.joinedOnce=!1,this.pushBuffer=[],this.timeout=this.socket.timeout,this.joinPush=new go(this,ci.join,this.params,this.timeout),this.rejoinTimer=new sl(()=>this.rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=De.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(o=>o.send()),this.pushBuffer=[]}),this.onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this.joinRef()}`),this.state=De.closed,this.socket.remove(this)}),this.onError(o=>{this.isLeaving()||this.isClosed()||(this.socket.log("channel",`error ${this.topic}`,o),this.state=De.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{!this.isJoining()||(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=De.errored,this.rejoinTimer.scheduleTimeout())}),this.on(ci.reply,(o,h)=>{this.trigger(this.replyEventName(h),o)})}rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this.rejoin()}subscribe(i=this.timeout){if(this.joinedOnce)throw"tried to subscribe multiple times. 'subscribe' can only be called a single time per channel instance";return this.joinedOnce=!0,this.rejoin(i),this.joinPush}onClose(i){this.on(ci.close,i)}onError(i){this.on(ci.error,t=>i(t))}on(i,t){this.bindings.push({event:i,callback:t})}off(i){this.bindings=this.bindings.filter(t=>t.event!==i)}canPush(){return this.socket.isConnected()&&this.isJoined()}push(i,t,s=this.timeout){if(!this.joinedOnce)throw`tried to push '${i}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let o=new go(this,i,t,s);return this.canPush()?o.send():(o.startTimeout(),this.pushBuffer.push(o)),o}unsubscribe(i=this.timeout){this.state=De.leaving;let t=()=>{this.socket.log("channel",`leave ${this.topic}`),this.trigger(ci.close,"leave",this.joinRef())};this.joinPush.destroy();let s=new go(this,ci.leave,{},i);return s.receive("ok",()=>t()).receive("timeout",()=>t()),s.send(),this.canPush()||s.trigger("ok",{}),s}onMessage(i,t,s){return t}isMember(i){return this.topic===i}joinRef(){return this.joinPush.ref}sendJoin(i){this.state=De.joining,this.joinPush.resend(i)}rejoin(i=this.timeout){this.isLeaving()||this.sendJoin(i)}trigger(i,t,s){let{close:o,error:h,leave:c,join:d}=ci;if(s&&[o,h,c,d].indexOf(i)>=0&&s!==this.joinRef())return;let _=this.onMessage(i,t,s);if(t&&!_)throw"channel onMessage callbacks must return the payload, modified or unmodified";this.bindings.filter(v=>v.event==="*"?i===(t==null?void 0:t.type):v.event===i).map(v=>v.callback(_,s))}replyEventName(i){return`chan_reply_${i}`}isClosed(){return this.state===De.closed}isErrored(){return this.state===De.errored}isJoined(){return this.state===De.joined}isJoining(){return this.state===De.joining}isLeaving(){return this.state===De.leaving}}const Bc="websocket",Dc="Websocket Client & Server Library implementing the WebSocket protocol as specified in RFC 6455.",Rc=["websocket","websockets","socket","networking","comet","push","RFC-6455","realtime","server","client"],zc="Brian McKelvey <theturtle32@gmail.com> (https://github.com/theturtle32)",Nc=["I\xF1aki Baz Castillo <ibc@aliax.net> (http://dev.sipdoc.net)"],Fc="1.0.34",Gc={type:"git",url:"https://github.com/theturtle32/WebSocket-Node.git"},jc="https://github.com/theturtle32/WebSocket-Node",Uc={node:">=4.0.0"},Zc={bufferutil:"^4.0.1",debug:"^2.2.0","es5-ext":"^0.10.50","typedarray-to-buffer":"^3.1.5","utf-8-validate":"^5.0.2",yaeti:"^0.0.6"},qc={"buffer-equal":"^1.0.0",gulp:"^4.0.2","gulp-jshint":"^2.0.4","jshint-stylish":"^2.2.1",jshint:"^2.0.0",tape:"^4.9.1"},Vc={verbose:!1},Hc={test:"tape test/unit/*.js",gulp:"gulp"},$c="index",Kc={lib:"./lib"},Xc="lib/browser.js",Yc="Apache-2.0";var Jc={name:Bc,description:Dc,keywords:Rc,author:zc,contributors:Nc,version:Fc,repository:Gc,homepage:jc,engines:Uc,dependencies:Zc,devDependencies:qc,config:Vc,scripts:Hc,main:$c,directories:Kc,browser:Xc,license:Yc},Wc=Jc.version,an;if(typeof globalThis=="object")an=globalThis;else try{an=require("es5-ext/global")}catch{}finally{if(!an&&typeof window!="undefined"&&(an=window),!an)throw new Error("Could not determine global this")}var xr=an.WebSocket||an.MozWebSocket,Qc=Wc;function ol(n,i){var t;return i?t=new xr(n,i):t=new xr(n),t}xr&&["CONNECTING","OPEN","CLOSING","CLOSED"].forEach(function(n){Object.defineProperty(ol,n,{get:function(){return xr[n]}})});var tf={w3cwebsocket:xr?ol:null,version:Qc};class ef{constructor(){this.HEADER_LENGTH=1}decode(i,t){return i.constructor===ArrayBuffer?t(this._binaryDecode(i)):t(typeof i=="string"?JSON.parse(i):{})}_binaryDecode(i){const t=new DataView(i),s=new TextDecoder;return this._decodeBroadcast(i,t,s)}_decodeBroadcast(i,t,s){const o=t.getUint8(1),h=t.getUint8(2);let c=this.HEADER_LENGTH+2;const d=s.decode(i.slice(c,c+o));c=c+o;const y=s.decode(i.slice(c,c+h));c=c+h;const _=JSON.parse(s.decode(i.slice(c,i.byteLength)));return{ref:null,topic:d,event:y,payload:_}}}var nf=globalThis&&globalThis.__awaiter||function(n,i,t,s){function o(h){return h instanceof t?h:new t(function(c){c(h)})}return new(t||(t=Promise))(function(h,c){function d(v){try{_(s.next(v))}catch(x){c(x)}}function y(v){try{_(s.throw(v))}catch(x){c(x)}}function _(v){v.done?h(v.value):o(v.value).then(d,y)}_((s=s.apply(n,i||[])).next())})};const rf=()=>{};class sf{constructor(i,t){this.channels=[],this.endPoint="",this.headers=Tc,this.params={},this.timeout=rl,this.transport=tf.w3cwebsocket,this.heartbeatIntervalMs=3e4,this.longpollerTimeout=2e4,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.ref=0,this.logger=rf,this.conn=null,this.sendBuffer=[],this.serializer=new ef,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.endPoint=`${i}/${mo.websocket}`,(t==null?void 0:t.params)&&(this.params=t.params),(t==null?void 0:t.headers)&&(this.headers=Object.assign(Object.assign({},this.headers),t.headers)),(t==null?void 0:t.timeout)&&(this.timeout=t.timeout),(t==null?void 0:t.logger)&&(this.logger=t.logger),(t==null?void 0:t.transport)&&(this.transport=t.transport),(t==null?void 0:t.heartbeatIntervalMs)&&(this.heartbeatIntervalMs=t.heartbeatIntervalMs),(t==null?void 0:t.longpollerTimeout)&&(this.longpollerTimeout=t.longpollerTimeout),this.reconnectAfterMs=(t==null?void 0:t.reconnectAfterMs)?t.reconnectAfterMs:s=>[1e3,2e3,5e3,1e4][s-1]||1e4,this.encode=(t==null?void 0:t.encode)?t.encode:(s,o)=>o(JSON.stringify(s)),this.decode=(t==null?void 0:t.decode)?t.decode:this.serializer.decode.bind(this.serializer),this.reconnectTimer=new sl(()=>nf(this,void 0,void 0,function*(){yield this.disconnect(),this.connect()}),this.reconnectAfterMs)}connect(){this.conn||(this.conn=new this.transport(this.endPointURL(),[],null,this.headers),this.conn&&(this.conn.binaryType="arraybuffer",this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=i=>this._onConnError(i),this.conn.onmessage=i=>this.onConnMessage(i),this.conn.onclose=i=>this._onConnClose(i)))}disconnect(i,t){return new Promise((s,o)=>{try{this.conn&&(this.conn.onclose=function(){},i?this.conn.close(i,t||""):this.conn.close(),this.conn=null,this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.reset()),s({error:null,data:!0})}catch(h){s({error:h,data:!1})}})}log(i,t,s){this.logger(i,t,s)}onOpen(i){this.stateChangeCallbacks.open.push(i)}onClose(i){this.stateChangeCallbacks.close.push(i)}onError(i){this.stateChangeCallbacks.error.push(i)}onMessage(i){this.stateChangeCallbacks.message.push(i)}connectionState(){switch(this.conn&&this.conn.readyState){case br.connecting:return"connecting";case br.open:return"open";case br.closing:return"closing";default:return"closed"}}isConnected(){return this.connectionState()==="open"}remove(i){this.channels=this.channels.filter(t=>t.joinRef()!==i.joinRef())}channel(i,t={}){let s=new Ac(i,t,this);return this.channels.push(s),s}push(i){let{topic:t,event:s,payload:o,ref:h}=i,c=()=>{this.encode(i,d=>{var y;(y=this.conn)===null||y===void 0||y.send(d)})};this.log("push",`${t} ${s} (${h})`,o),this.isConnected()?c():this.sendBuffer.push(c)}onConnMessage(i){this.decode(i.data,t=>{let{topic:s,event:o,payload:h,ref:c}=t;c&&c===this.pendingHeartbeatRef?this.pendingHeartbeatRef=null:o===(h==null?void 0:h.type)&&this._resetHeartbeat(),this.log("receive",`${h.status||""} ${s} ${o} ${c&&"("+c+")"||""}`,h),this.channels.filter(d=>d.isMember(s)).forEach(d=>d.trigger(o,h,c)),this.stateChangeCallbacks.message.forEach(d=>d(t))})}endPointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:Oc}))}makeRef(){let i=this.ref+1;return i===this.ref?this.ref=0:this.ref=i,this.ref.toString()}_onConnOpen(){this.log("transport",`connected to ${this.endPointURL()}`),this._flushSendBuffer(),this.reconnectTimer.reset(),this._resetHeartbeat(),this.stateChangeCallbacks.open.forEach(i=>i())}_onConnClose(i){this.log("transport","close",i),this._triggerChanError(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.scheduleTimeout(),this.stateChangeCallbacks.close.forEach(t=>t(i))}_onConnError(i){this.log("transport",i.message),this._triggerChanError(),this.stateChangeCallbacks.error.forEach(t=>t(i))}_triggerChanError(){this.channels.forEach(i=>i.trigger(ci.error))}_appendParams(i,t){if(Object.keys(t).length===0)return i;const s=i.match(/\?/)?"&":"?",o=new URLSearchParams(t);return`${i}${s}${o}`}_flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(i=>i()),this.sendBuffer=[])}_resetHeartbeat(){this.pendingHeartbeatRef=null,this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this._sendHeartbeat(),this.heartbeatIntervalMs)}_sendHeartbeat(){var i;if(!!this.isConnected()){if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),(i=this.conn)===null||i===void 0||i.close(Ic,"hearbeat timeout");return}this.pendingHeartbeatRef=this.makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef})}}}class of{constructor(i,t,s,o){const h={},c=o==="*"?`realtime:${s}`:`realtime:${s}:${o}`,d=t.Authorization.split(" ")[1];d&&(h.user_token=d),this.subscription=i.channel(c,h)}getPayloadRecords(i){const t={new:{},old:{}};return(i.type==="INSERT"||i.type==="UPDATE")&&(t.new=il(i.columns,i.record)),(i.type==="UPDATE"||i.type==="DELETE")&&(t.old=il(i.columns,i.old_record)),t}on(i,t){return this.subscription.on(i,s=>{let o={schema:s.schema,table:s.table,commit_timestamp:s.commit_timestamp,eventType:s.type,new:{},old:{}};o=Object.assign(Object.assign({},o),this.getPayloadRecords(s)),t(o)}),this}subscribe(i=()=>{}){return this.subscription.onError(t=>i("SUBSCRIPTION_ERROR",t)),this.subscription.onClose(()=>i("CLOSED")),this.subscription.subscribe().receive("ok",()=>i("SUBSCRIBED")).receive("error",t=>i("SUBSCRIPTION_ERROR",t)).receive("timeout",()=>i("RETRYING_AFTER_TIMEOUT")),this.subscription}}class af extends el{constructor(i,{headers:t={},schema:s,realtime:o,table:h,fetch:c}){super(i,{headers:t,schema:s,fetch:c});this._subscription=new of(o,t,s,h),this._realtime=o}on(i,t){return this._realtime.isConnected()||this._realtime.connect(),this._subscription.on(i,t)}}var Lr=globalThis&&globalThis.__awaiter||function(n,i,t,s){function o(h){return h instanceof t?h:new t(function(c){c(h)})}return new(t||(t=Promise))(function(h,c){function d(v){try{_(s.next(v))}catch(x){c(x)}}function y(v){try{_(s.throw(v))}catch(x){c(x)}}function _(v){v.done?h(v.value):o(v.value).then(d,y)}_((s=s.apply(n,i||[])).next())})};const lf=n=>n.msg||n.message||n.error_description||n.error||JSON.stringify(n),hf=(n,i)=>{if(typeof n.json!="function")return i(n);n.json().then(t=>i({message:lf(t),status:(n==null?void 0:n.status)||500}))},uf=(n,i,t,s)=>{const o={method:n,headers:(i==null?void 0:i.headers)||{}};return n==="GET"?o:(o.headers=Object.assign({"Content-Type":"application/json"},i==null?void 0:i.headers),o.body=JSON.stringify(s),Object.assign(Object.assign({},o),t))};function ms(n=fs,i,t,s,o,h){return Lr(this,void 0,void 0,function*(){return new Promise((c,d)=>{n(t,uf(i,s,o,h)).then(y=>{if(!y.ok)throw y;return(s==null?void 0:s.noResolveJson)?c(y):y.json()}).then(y=>c(y)).catch(y=>hf(y,d))})})}function _o(n,i,t,s){return Lr(this,void 0,void 0,function*(){return ms(n,"GET",i,t,s)})}function wr(n,i,t,s,o){return Lr(this,void 0,void 0,function*(){return ms(n,"POST",i,s,o,t)})}function cf(n,i,t,s,o){return Lr(this,void 0,void 0,function*(){return ms(n,"PUT",i,s,o,t)})}function al(n,i,t,s,o){return Lr(this,void 0,void 0,function*(){return ms(n,"DELETE",i,s,o,t)})}const ff="0.0.0",df={"X-Client-Info":`storage-js/${ff}`};var Rn=globalThis&&globalThis.__awaiter||function(n,i,t,s){function o(h){return h instanceof t?h:new t(function(c){c(h)})}return new(t||(t=Promise))(function(h,c){function d(v){try{_(s.next(v))}catch(x){c(x)}}function y(v){try{_(s.throw(v))}catch(x){c(x)}}function _(v){v.done?h(v.value):o(v.value).then(d,y)}_((s=s.apply(n,i||[])).next())})};class pf{constructor(i,t={},s){this.url=i,this.headers=Object.assign(Object.assign({},df),t),this.fetch=s}listBuckets(){return Rn(this,void 0,void 0,function*(){try{return{data:yield _o(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(i){return{data:null,error:i}}})}getBucket(i){return Rn(this,void 0,void 0,function*(){try{return{data:yield _o(this.fetch,`${this.url}/bucket/${i}`,{headers:this.headers}),error:null}}catch(t){return{data:null,error:t}}})}createBucket(i,t={public:!1}){return Rn(this,void 0,void 0,function*(){try{return{data:(yield wr(this.fetch,`${this.url}/bucket`,{id:i,name:i,public:t.public},{headers:this.headers})).name,error:null}}catch(s){return{data:null,error:s}}})}updateBucket(i,t){return Rn(this,void 0,void 0,function*(){try{return{data:yield cf(this.fetch,`${this.url}/bucket/${i}`,{id:i,name:i,public:t.public},{headers:this.headers}),error:null}}catch(s){return{data:null,error:s}}})}emptyBucket(i){return Rn(this,void 0,void 0,function*(){try{return{data:yield wr(this.fetch,`${this.url}/bucket/${i}/empty`,{},{headers:this.headers}),error:null}}catch(t){return{data:null,error:t}}})}deleteBucket(i){return Rn(this,void 0,void 0,function*(){try{return{data:yield al(this.fetch,`${this.url}/bucket/${i}`,{},{headers:this.headers}),error:null}}catch(t){return{data:null,error:t}}})}}var Ni=globalThis&&globalThis.__awaiter||function(n,i,t,s){function o(h){return h instanceof t?h:new t(function(c){c(h)})}return new(t||(t=Promise))(function(h,c){function d(v){try{_(s.next(v))}catch(x){c(x)}}function y(v){try{_(s.throw(v))}catch(x){c(x)}}function _(v){v.done?h(v.value):o(v.value).then(d,y)}_((s=s.apply(n,i||[])).next())})};const mf={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},gf={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class _f{constructor(i,t={},s,o){this.url=i,this.headers=t,this.bucketId=s,this.fetch=o}uploadOrUpdate(i,t,s,o){return Ni(this,void 0,void 0,function*(){try{let h;const c=Object.assign(Object.assign({},gf),o),d=Object.assign(Object.assign({},this.headers),i==="POST"&&{"x-upsert":String(c.upsert)});typeof Blob!="undefined"&&s instanceof Blob?(h=new FormData,h.append("cacheControl",c.cacheControl),h.append("",s)):typeof FormData!="undefined"&&s instanceof FormData?(h=s,h.append("cacheControl",c.cacheControl)):(h=s,d["cache-control"]=`max-age=${c.cacheControl}`,d["content-type"]=c.contentType);const y=this._getFinalPath(t),_=yield fs(`${this.url}/object/${y}`,{method:i,body:h,headers:d});if(_.ok)return{data:{Key:y},error:null};{const v=yield _.json();return{data:null,error:v}}}catch(h){return{data:null,error:h}}})}upload(i,t,s){return Ni(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",i,t,s)})}update(i,t,s){return Ni(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",i,t,s)})}move(i,t){return Ni(this,void 0,void 0,function*(){try{return{data:yield wr(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:i,destinationKey:t},{headers:this.headers}),error:null}}catch(s){return{data:null,error:s}}})}createSignedUrl(i,t){return Ni(this,void 0,void 0,function*(){try{const s=this._getFinalPath(i);let o=yield wr(this.fetch,`${this.url}/object/sign/${s}`,{expiresIn:t},{headers:this.headers});const h=`${this.url}${o.signedURL}`;return o={signedURL:h},{data:o,error:null,signedURL:h}}catch(s){return{data:null,error:s,signedURL:null}}})}download(i){return Ni(this,void 0,void 0,function*(){try{const t=this._getFinalPath(i);return{data:yield(yield _o(this.fetch,`${this.url}/object/${t}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(t){return{data:null,error:t}}})}getPublicUrl(i){try{const t=this._getFinalPath(i),s=`${this.url}/object/public/${t}`;return{data:{publicURL:s},error:null,publicURL:s}}catch(t){return{data:null,error:t,publicURL:null}}}remove(i){return Ni(this,void 0,void 0,function*(){try{return{data:yield al(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:i},{headers:this.headers}),error:null}}catch(t){return{data:null,error:t}}})}list(i,t,s){return Ni(this,void 0,void 0,function*(){try{const o=Object.assign(Object.assign(Object.assign({},mf),t),{prefix:i||""});return{data:yield wr(this.fetch,`${this.url}/object/list/${this.bucketId}`,o,{headers:this.headers},s),error:null}}catch(o){return{data:null,error:o}}})}_getFinalPath(i){return`${this.bucketId}/${i}`}}class yf extends pf{constructor(i,t={},s){super(i,t,s)}from(i){return new _f(this.url,this.headers,i,this.fetch)}}var ll=globalThis&&globalThis.__awaiter||function(n,i,t,s){function o(h){return h instanceof t?h:new t(function(c){c(h)})}return new(t||(t=Promise))(function(h,c){function d(v){try{_(s.next(v))}catch(x){c(x)}}function y(v){try{_(s.throw(v))}catch(x){c(x)}}function _(v){v.done?h(v.value):o(v.value).then(d,y)}_((s=s.apply(n,i||[])).next())})};const vf={schema:"public",autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:Qa};class bf{constructor(i,t,s){if(this.supabaseUrl=i,this.supabaseKey=t,!i)throw new Error("supabaseUrl is required.");if(!t)throw new Error("supabaseKey is required.");i=Yu(i);const o=Object.assign(Object.assign({},vf),s);this.restUrl=`${i}/rest/v1`,this.realtimeUrl=`${i}/realtime/v1`.replace("http","ws"),this.authUrl=`${i}/auth/v1`,this.storageUrl=`${i}/storage/v1`,this.schema=o.schema,this.auth=this._initSupabaseAuthClient(o),this.realtime=this._initRealtimeClient(o.realtime),this.fetch=o.fetch}get storage(){return new yf(this.storageUrl,this._getAuthHeaders(),this.fetch)}from(i){const t=`${this.restUrl}/${i}`;return new af(t,{headers:this._getAuthHeaders(),schema:this.schema,realtime:this.realtime,table:i,fetch:this.fetch})}rpc(i,t,{head:s=!1,count:o=null}={}){return this._initPostgRESTClient().rpc(i,t,{head:s,count:o})}removeSubscription(i){return new Promise(t=>ll(this,void 0,void 0,function*(){try{yield this._closeSubscription(i);const s=this.getSubscriptions().length;if(!s){const{error:o}=yield this.realtime.disconnect();if(o)return t({error:o})}return t({error:null,data:{openSubscriptions:s}})}catch(s){return t({error:s})}}))}_closeSubscription(i){return ll(this,void 0,void 0,function*(){i.isClosed()||(yield this._closeChannel(i))})}getSubscriptions(){return this.realtime.channels}_initSupabaseAuthClient({autoRefreshToken:i,persistSession:t,detectSessionInUrl:s,localStorage:o,headers:h}){const c={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new _c({url:this.authUrl,headers:Object.assign(Object.assign({},h),c),autoRefreshToken:i,persistSession:t,detectSessionInUrl:s,localStorage:o,fetch:this.fetch})}_initRealtimeClient(i){return new sf(this.realtimeUrl,Object.assign(Object.assign({},i),{params:Object.assign(Object.assign({},i==null?void 0:i.params),{apikey:this.supabaseKey})}))}_initPostgRESTClient(){return new Lc(this.restUrl,{headers:this._getAuthHeaders(),schema:this.schema,fetch:this.fetch})}_getAuthHeaders(){var i,t;const s=Qa,o=(t=(i=this.auth.session())===null||i===void 0?void 0:i.access_token)!==null&&t!==void 0?t:this.supabaseKey;return s.apikey=this.supabaseKey,s.Authorization=`Bearer ${o}`,s}_closeChannel(i){return new Promise((t,s)=>{i.unsubscribe().receive("ok",()=>(this.realtime.remove(i),t(!0))).receive("error",o=>s(o))})}}const Zf=(n,i,t)=>new bf(n,i,t);export{Lf as L,Sf as a,os as b,Pf as c,Mf as d,Na as e,Uf as f,wf as g,jh as h,Zf as i,Gf as j,kf as k,Tn as l,jf as m};
//# sourceMappingURL=vendor.9077714b.js.map
